using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

using Intersoft.CISSA.BizService.Utils;
using Intersoft.CISSA.DataAccessLayer.Core;
using Intersoft.CISSA.DataAccessLayer.Model.Context;
using Intersoft.CISSA.DataAccessLayer.Model.Query.Builders;
using Intersoft.CISSA.DataAccessLayer.Model.Workflow;
using Intersoft.CISSA.DataAccessLayer.Model.Query.Sql;
using Intersoft.CISSA.DataAccessLayer.Model.Data;
using Intersoft.CISSA.DataAccessLayer.Model.Documents;
using Intersoft.CISSA.DataAccessLayer.Repository;

using CISSA_REST_API.Models;
using Intersoft.CISSA.DataAccessLayer.Model.Enums;
using Intersoft.CISSA.DataAccessLayer.Model.Query;
using CISSA_REST_API.Models.Address;
using System.Data;

namespace CISSA_REST_API.Util
{
    public static class ReportExecutor
    {
        static IAppServiceProvider InitProvider(string username, Guid userId)
        {
            var dataContextFactory = DataContextFactoryProvider.GetFactory();

            var dataContext = dataContextFactory.CreateMultiDc("DataContexts");
            BaseServiceFactory.CreateBaseServiceFactories();
            var providerFactory = AppServiceProviderFactoryProvider.GetFactory();
            var provider = providerFactory.Create(dataContext);
            var serviceRegistrator = provider.Get<IAppServiceProviderRegistrator>();
            serviceRegistrator.AddService(new UserDataProvider(userId, username));
            return provider;
        }
        public static WorkflowContext CreateContext(string username, Guid? userId)
        {
            if (userId == null)
            {
                userId = new Guid("{DCED7BEA-8A93-4BAF-964B-232E75A758C5}");
            }
            return new WorkflowContext(new WorkflowContextData(Guid.Empty, userId.Value), InitProvider(username, userId.Value));
        }

        //Ежемесячный отчет МСЭК (взрослый/детский)
        public static class NumAwardAppProcess
        {
            public static List<Report1Item> Execute(WorkflowContext context, DateTime fd, DateTime ld)
            {
                var docRepo = context.Documents;
                var report = context.CurrentDocument;
                if (fd == DateTime.MinValue || ld == DateTime.MaxValue || ld <= fd)
                    throw new ApplicationException("Ошибка в периоде!");
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;

                var docs = new string[]
                {
                    "освидетельствовано всего",
                    "Признаны инвалидами",
                    "Первично",
                    "из них жен",
                    "I группа",
                    "II группа",
                    "III группа",
                    "Повторно",
                    "из них жен",
                    "I группа",
                    "II группа",
                    "III группа",
                    "Пенсионеры",
                    "Инвалиды с детства",
                    "Проф. заболевания первично",
                    "Проф. заболевания повторно",
                    "Тр. увечье первично",
                    "Тр. увечье повторно",
                    "% первично",
                    "% повторно",
                    "ЧАЭС первично",
                    "ЧАЭС повторно",
                    "Военнослужащие первично",
                    "Военнослужащие повторно",
                    "Реаблитация полная",
                    "Реаблитация частичная",
                    "Утяжеления",
                    "Необоснованно направленные",
                    "Долечивание по б/л",
                    "Сложная консультация",
                    "Устная консультация",
                    "Дом - инвалидов",
                    "Кресло - коляски",
                    "Даны трудовые рекомендации",
                    "Направлены ОЗ (список ЛОВЗ 1 раз в кватрал)",
                    "Из них трудоустроены",
                    "Направлены на обучение",
                    "Из них обучаются",
                    "Выездные заседания",
                    "Освидетельствования на дому",
                    "Заполнение ИПР",
                    "Напр. в реаб-й центр (список)",
                    "По зрению первично",
                    "По зрению повторно",
                    "По слуху первично",
                    "По слуху повторно",
                    "С нарушением ОДА",
                    "Нуждающейся в протезе рук",
                    "Нуждающие в протезе ног",
                    "Информация в СМИ",
                    "Семинары в ЛПО",
                    "ДЦП",
                    "СПИД",
                    "Нуждающейся в  уходе",
                    "Бессрочные",
                    "Освидетельст. всего дети",
                    "Признаны «Ребенок с ОВЗ»",
                    "Первично",
                    "в т. ч. девочки",
                    "на 2 года",
                    "на 5 лет",
                    "до 18 лет",
                    "Повторно",
                    "в т.ч. девочки",
                    "на 2 года",
                    "на 5 лет",
                    "до 18 лет",
                    "Необоснованно направленные",
                    "Реабилитированы",
                    "Напр.в реабил.центр(список)",
                    "По слуху первично",
                    "По слуху повторно",
                    "ДЦП  первично",
                    "ДЦП  повторно",
                    "ВИЧ  первично",
                    "ВИЧ  повторно",
                    "С нарушением  ОДА",
                    "Нуждающейся  протез рук",
                    "Нуждающейся  протез ног",
                    "Дом инвалидов",
                    "Кресло-коляска",
                    "Сложная консультация",
                    "Устная консультация",
                    "Заполнение ИПР",
                    "В специальный детский сад",
                    "В специальную школу",
                    "В училище (колледж, лицей)",
                    "Инклюзивное  образование",
                    "Нуждающ. в уходе первично",
                    "Нуждающ. в уходе повторно"
                };

                var items = new List<Report1Item>();
                int i2 = 1;
                foreach (var i in docs)
                {
                    var item = new Report1Item();//docRepo.New(reportItemDefId);
                    item.RowType = i;
                    item.RowNo = i2;
                    i2++;
                    items.Add(item);
                }
                CalcItems(context, fd, ld, orgId, items[89], items[88],
                            items[87], items[86], items[85], items[84], items[83], items[82], items[81],
                            items[80], items[79], items[78], items[77], items[76], items[75], items[74],
                            items[73], items[72], items[71], items[70], items[69], items[68], items[67],
                            items[66], items[65], items[64], items[63], items[62], items[61], items[60],
                            items[59], items[58], items[57], items[56], items[55], items[54], items[53],
                            items[52], items[51], items[50], items[49], items[48], items[47], items[46],
                            items[45], items[44], items[43], items[42], items[41], items[40], items[39],
                            items[38], items[37], items[36], items[35], items[34], items[33], items[32],
                            items[31], items[30], items[29], items[28], items[27], items[26], items[25],
                            items[24], items[23], items[22], items[21], items[20], items[19], items[18],
                            items[17], items[16], items[15], items[14], items[13], items[12], items[11],
                            items[10], items[9], items[8], items[7], items[6], items[5], items[4],
                            items[3], items[2], items[1], items[0]
                         );
                return items;
                /*var reportFromDb = GetReport(context, report);
                if (reportFromDb != null)
                {
                    report = reportFromDb;
                    RemoveRows(context, report.Id);
                }

                context.Documents.Save(report);
                foreach (var item in items)
                {
                    item["MonthReportExaminationAdults"] = report.Id;
                    docRepo.Save(item);
                }
                context.CurrentDocument = report;*/
            }
            static Doc GetReport(WorkflowContext context, Doc newReport)
            {
                var qb = new QueryBuilder(reportDefId, context.UserId);
                qb.Where("OrgProfile").Eq(newReport["OrgProfile"]).And("DateFrom").Eq(newReport["DateFrom"]).And("DateTo").Eq(newReport["DateTo"]);
                var query = context.CreateSqlQuery(qb.Def);
                query.AddAttribute("&Id");
                var reportId = Guid.Empty;
                using (var reader = context.CreateSqlReader(query))
                {
                    if (reader.Read()) reportId = reader.GetGuid(0);
                }
                if (reportId != Guid.Empty)
                {
                    var report = context.Documents.LoadById(reportId);
                    report["DateForming"] = newReport["DateForming"];
                    return report;
                }
                return null;
            }
            static object[] getDinamic(WorkflowContext context, Guid actId)
            {
                var qb = new QueryBuilder(dinamicInvalidDefId, context.UserId);
                qb.Where("AdultsMedicalCertificate").Eq(actId);
                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    query.AddAttribute(query.Source, "DisabilityGroup");
                    query.AddAttribute(query.Source, "Year");
                    query.AddOrderAttribute("Year", false);
                    using (var reader = context.CreateSqlReader(query))
                    {
                        if (reader.Read())
                        {
                            var dinamicInval = reader.IsDbNull(0) ? Guid.Empty : reader.GetGuid(0);
                            var dinamicGod = reader.IsDbNull(1) ? string.Empty : reader.GetString(1);
                            return new object[] { dinamicInval, dinamicGod };
                        }
                    }
                }
                return null;
            }
            public static void CalcItems(WorkflowContext context, DateTime fd, DateTime ld, Guid orgId,
            Report1Item item89, Report1Item item88,
            Report1Item item87, Report1Item item86, Report1Item item85, Report1Item item84, Report1Item item83, Report1Item item82, Report1Item item81,
            Report1Item item80, Report1Item item79, Report1Item item78, Report1Item item77, Report1Item item76, Report1Item item75, Report1Item item74,
            Report1Item item73, Report1Item item72, Report1Item item71, Report1Item item70, Report1Item item69, Report1Item item68, Report1Item item67,
            Report1Item item66, Report1Item item65, Report1Item item64, Report1Item item63, Report1Item item62, Report1Item item61, Report1Item item60,
            Report1Item item59, Report1Item item58, Report1Item item57, Report1Item item56, Report1Item item55, Report1Item item54, Report1Item item53,
            Report1Item item52, Report1Item item51, Report1Item item50, Report1Item item49, Report1Item item48, Report1Item item47, Report1Item item46,
            Report1Item item45, Report1Item item44, Report1Item item43, Report1Item item42, Report1Item item41, Report1Item item40, Report1Item item39,
            Report1Item item38, Report1Item item37, Report1Item item36, Report1Item item35, Report1Item item34, Report1Item item33, Report1Item item32,
            Report1Item item31, Report1Item item30, Report1Item item29, Report1Item item28, Report1Item item27, Report1Item item26, Report1Item item25,
            Report1Item item24, Report1Item item23, Report1Item item22, Report1Item item21, Report1Item item20, Report1Item item19, Report1Item item18,
            Report1Item item17, Report1Item item16, Report1Item item15, Report1Item item14, Report1Item item13, Report1Item item12, Report1Item item11,
            Report1Item item10, Report1Item item9, Report1Item item8, Report1Item item7, Report1Item item6, Report1Item item5, Report1Item item4,
            Report1Item item3, Report1Item item2, Report1Item item1, Report1Item item0)
            {
                var qb = new QueryBuilder(adultsActDefId, context.UserId);
                qb.Where("EndDateExamination").Ge(fd).And("EndDateExamination").Le(ld).And("&State").In(new object[] { ApprovedStateId, ArchivedStateId });

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                    query.AddCondition(ExpressionOperation.And, adultsActDefId, "&OrgId", ConditionOperation.Equal, orgId);

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(query.Source, "Examination1");
                    query.AddAttribute(query.Source, "DisabilityGroup");
                    query.AddAttribute(query.Source, "GoalSurvey");
                    query.AddAttribute(query.Source, "goal9");
                    query.AddAttribute(query.Source, "goal11");
                    query.AddAttribute(personSrc, "Gender");
                    query.AddAttribute(query.Source, "AgeOf");
                    query.AddAttribute(query.Source, "CauseOfDisability");
                    query.AddAttribute(query.Source, "goal2");
                    query.AddAttribute(query.Source, "goal18");
                    query.AddAttribute(query.Source, "ReasonOfDirection");
                    query.AddAttribute(query.Source, "goal17");
                    query.AddAttribute(query.Source, "goal91");
                    query.AddAttribute(query.Source, "Wheelchair");
                    query.AddAttribute(query.Source, "01");
                    query.AddAttribute(query.Source, "j1");
                    query.AddAttribute(query.Source, "j2");
                    query.AddAttribute(query.Source, "j3");
                    query.AddAttribute(query.Source, "j4");
                    query.AddAttribute(query.Source, "j7");
                    query.AddAttribute(query.Source, "j8");
                    query.AddAttribute(query.Source, "j9");
                    query.AddAttribute(query.Source, "j10");
                    query.AddAttribute(query.Source, "ConclusionСonditionsAndNatureOfWork");
                    query.AddAttribute(query.Source, "j5");
                    query.AddAttribute(query.Source, "j6");
                    query.AddAttribute(query.Source, "Examination4");
                    query.AddAttribute(query.Source, "IPR");
                    query.AddAttribute(query.Source, "Limit");
                    query.AddAttribute(query.Source, "04");
                    query.AddAttribute(query.Source, "05");
                    query.AddAttribute(query.Source, "Diagnosis");
                    query.AddAttribute(query.Source, "Nadzor");
                    query.AddAttribute(query.Source, "Uhod");
                    query.AddAttribute(query.Source, "Indefinitely");
                    query.AddAttribute(query.Source, "goal1");
                    query.AddAttribute(query.Source, "goal3");
                    query.AddAttribute(query.Source, "goal4");
                    query.AddAttribute(query.Source, "goal5");
                    query.AddAttribute(query.Source, "goal6");
                    query.AddAttribute(query.Source, "goal7");
                    query.AddAttribute(query.Source, "goal8");
                    query.AddAttribute(query.Source, "goal12");
                    query.AddAttribute(query.Source, "goal13");
                    query.AddAttribute(query.Source, "goal14");
                    query.AddAttribute(query.Source, "goal15");
                    query.AddAttribute(query.Source, "goal16");
                    query.AddAttribute(query.Source, "SK");

                    var table = new DataTable();
                    var idList = new List<Guid>();
                    var dynaIdList = new List<Guid>();
                    using (var reader = context.CreateSqlReader(query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        var actId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var exam = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                        var group = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                        var goalSurvey = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                        var goal9 = row[4] is DBNull ? Guid.Empty : (Guid)row[4];
                        var goal11 = row[5] is DBNull ? false : (bool)row[5];
                        var gender = row[6] is DBNull ? Guid.Empty : (Guid)row[6];
                        var ageOf = row[7] is DBNull ? Guid.Empty : (Guid)row[7];
                        var prInv = row[8] is DBNull ? Guid.Empty : (Guid)row[8];
                        var goal2 = row[9] is DBNull ? false : (bool)row[9];
                        var dinamic = getDinamic(context, actId);
                        var dinamicInval = Guid.Empty;
                        var dinamicGod = "";
                        if (dinamic != null)
                        {
                            dinamicInval = (Guid)dinamic[0];
                            dinamicGod = (string)dinamic[1];
                        }
                        var goal18 = row[10] is DBNull ? false : (bool)row[10];
                        var obosn = row[11] is DBNull ? Guid.Empty : (Guid)row[11];
                        var goal17 = row[12] is DBNull ? false : (bool)row[12];
                        var goal91 = row[13] is DBNull ? Guid.Empty : (Guid)row[13];
                        var kk1 = row[14] is DBNull ? false : (bool)row[14];
                        var krk01 = row[15] is DBNull ? false : (bool)row[15];
                        var j1 = row[16] is DBNull ? false : (bool)row[16];
                        var j2 = row[17] is DBNull ? false : (bool)row[17];
                        var j3 = row[18] is DBNull ? false : (bool)row[18];
                        var j4 = row[19] is DBNull ? false : (bool)row[19];
                        var j7 = row[20] is DBNull ? "" : row[20].ToString();
                        var j8 = row[21] is DBNull ? "" : row[21].ToString();
                        var j9 = row[22] is DBNull ? "" : row[22].ToString();
                        var j10 = row[23] is DBNull ? "" : row[23].ToString();
                        var concOfWork = row[24] is DBNull ? Guid.Empty : (Guid)row[24];
                        var j5 = row[25] is DBNull ? Guid.Empty : (Guid)row[25];
                        var j6 = row[26] is DBNull ? Guid.Empty : (Guid)row[26];
                        var exam4 = row[27] is DBNull ? Guid.Empty : (Guid)row[27];
                        var talonIPR = row[28] is DBNull ? false : (bool)row[28];
                        var limit = row[29] is DBNull ? Guid.Empty : (Guid)row[29];
                        var protezHand = row[30] is DBNull ? false : (bool)row[30];
                        var protezLeg = row[31] is DBNull ? false : (bool)row[31];
                        var bolezni = row[32] is DBNull ? Guid.Empty : (Guid)row[32];
                        var nadzor = row[33] is DBNull ? false : (bool)row[33];
                        var uhod = row[34] is DBNull ? false : (bool)row[34];
                        var indefinitely = row[35] is DBNull ? false : (bool)row[35];
                        var goal1 = row[36] is DBNull ? false : (bool)row[36];
                        var goal3 = row[37] is DBNull ? false : (bool)row[37];
                        var goal4 = row[38] is DBNull ? false : (bool)row[38];
                        var goal5 = row[39] is DBNull ? false : (bool)row[39];
                        var goal6 = row[40] is DBNull ? false : (bool)row[40];
                        var goal7 = row[41] is DBNull ? false : (bool)row[41];
                        var goal8 = row[42] is DBNull ? false : (bool)row[42];
                        var goal12 = row[43] is DBNull ? false : (bool)row[43];
                        var goal13 = row[44] is DBNull ? false : (bool)row[44];
                        var goal14 = row[45] is DBNull ? false : (bool)row[45];
                        var goal15 = row[46] is DBNull ? false : (bool)row[46];
                        var goal16 = row[47] is DBNull ? false : (bool)row[47];
                        var sk = row[48] is DBNull ? "" : row[48].ToString();
                        //var exDate = row[38] is DBNull ? (DateTime)row[38] : DateTime.MinValue;
                        if (actId != Guid.Empty)
                        {
                            item0.Gr1 = item0.Gr1 != 0 ? (1 + (int)item0.Gr1) : 1;
                            if (goalSurvey != Guid.Empty && goal9 != Guid.Empty || goalSurvey != Guid.Empty && goal2 ||
                                goalSurvey != Guid.Empty && goal11 || goalSurvey != Guid.Empty && goal17)
                            {
                                item0.Gr1 = item0.Gr1 != 0 ? (1 + (int)item0.Gr1) : 1;
                            }
                            /*  if (goal1 || goal2 || goal3 || goal4 || goal5 || goal6 || goal7 || goal8 || /*goal9 != Guid.Empty ||
                                  goal11 || goal12 || goal13 || goal14 || goal15 || goal16 || goal17 || goal18)
                                  {                                                             
                                      item0.Gr1 = item0.Gr1 != 0 ? (1 + (int)item0.Gr1) : 1;
                                  } */
                            //Признаны инвалидами всего   
                            if (groupId.Contains(group) && exam == prExamId && goalSurvey == goalV ||
                                groupId.Contains(group) && exam == prExamId && goalSurvey == goalV && (goal9 != null) ||
                                groupId.Contains(group) && exam == prExamId && goalSurvey == goalV && goal11 ||
                                groupId.Contains(group) && exam == reExamId && goalSurvey == goalV ||
                                groupId.Contains(group) && exam == reExamId && goalSurvey == goalV && (goal9 != null) ||
                                groupId.Contains(group) && exam == reExamId && goalSurvey == goalV && goal11)
                            {
                                item1.Gr1 = item1.Gr1 != 0 ? (1 + (int)item1.Gr1) : 1;

                                //Признаны инвалидами всего первично
                                if (groupId.Contains(group) && exam == prExamId && goalSurvey == goalV ||
                                   groupId.Contains(group) && exam == prExamId && goalSurvey == goalV && (goal9 != null) ||
                                   groupId.Contains(group) && exam == prExamId && goalSurvey == goalV && goal11)
                                {
                                    item2.Gr1 = item2.Gr1 != 0 ? (1 + (int)item2.Gr1) : 1;
                                    if (gender == female)
                                    {
                                        item3.Gr1 = item3.Gr1 != 0 ? (1 + (int)item3.Gr1) : 1;
                                    }
                                    if (group == group1)
                                    {
                                        item4.Gr1 = item4.Gr1 != 0 ? (1 + (int)item4.Gr1) : 1;
                                    }
                                    if (group == group2)
                                    {
                                        item5.Gr1 = item5.Gr1 != 0 ? (1 + (int)item5.Gr1) : 1;
                                    }
                                    if (group == group3)
                                    {
                                        item6.Gr1 = item6.Gr1 != 0 ? (1 + (int)item6.Gr1) : 1;
                                    }
                                }
                                //Признаны инвалидами всего повторно
                                if (groupId.Contains(group) && exam == reExamId && goalSurvey == goalV ||
                                    groupId.Contains(group) && exam == reExamId && goalSurvey == goalV && (goal9 != null) ||
                                    groupId.Contains(group) && exam == reExamId && goalSurvey == goalV && goal11)
                                {
                                    item7.Gr1 = item7.Gr1 != 0 ? (1 + (int)item7.Gr1) : 1;
                                    if (gender == female)
                                    {
                                        item8.Gr1 = item8.Gr1 != 0 ? (1 + (int)item8.Gr1) : 1;
                                    }
                                    if (group == group1)
                                    {
                                        item9.Gr1 = item9.Gr1 != 0 ? (1 + (int)item9.Gr1) : 1;
                                    }
                                    if (group == group2)
                                    {
                                        item10.Gr1 = item10.Gr1 != 0 ? (1 + (int)item10.Gr1) : 1;
                                    }
                                    if (group == group3)
                                    {
                                        item11.Gr1 = item11.Gr1 != 0 ? (1 + (int)item11.Gr1) : 1;
                                    }
                                }
                            }
                            //Пенсионеры
                            if (goalSurvey == goalV && ageOf == agePensions && groupId.Contains(group))
                            {
                                item12.Gr1 = item12.Gr1 != 0 ? (1 + (int)item12.Gr1) : 1;
                            }
                            //Инвалиды с детства
                            if (prInv == childHood && goalSurvey == goalV ||
                                prInv == childHood && goalSurvey == goalV && (goal9 != null) ||
                                prInv == childHood && goalSurvey == goalV && goal11)
                            {
                                item13.Gr1 = item13.Gr1 != 0 ? (1 + (int)item13.Gr1) : 1;
                            }
                            //Проф заболевания первично
                            if (prInv == profZ && exam == prExamId)
                            {
                                item14.Gr1 = item14.Gr1 != 0 ? (1 + (int)item14.Gr1) : 1;
                            }
                            //Проф заболевания повторно
                            if (prInv == profZ && exam == reExamId)
                            {
                                item15.Gr1 = item15.Gr1 != 0 ? (1 + (int)item15.Gr1) : 1;
                            }
                            //Трудоувечье первично
                            if (exam == prExamId && prInv == trudU)
                            {
                                item16.Gr1 = item16.Gr1 != 0 ? (1 + (int)item16.Gr1) : 1;
                            }
                            //Трудоувечье повторно
                            if (exam == reExamId && prInv == trudU)
                            {
                                item17.Gr1 = item17.Gr1 != 0 ? (1 + (int)item17.Gr1) : 1;
                            }
                            //% первично
                            if (goal2 && exam == prExamId)
                            {
                                item18.Gr1 = item18.Gr1 != 0 ? (1 + (int)item18.Gr1) : 1;
                            }
                            //% повторно
                            if (goal2 && exam == reExamId)
                            {
                                item19.Gr1 = item19.Gr1 != 0 ? (1 + (int)item19.Gr1) : 1;
                            }
                            //ЧАЭС первично
                            if (exam == prExamId && prInv == chaes)
                            {
                                item20.Gr1 = item20.Gr1 != 0 ? (1 + (int)item20.Gr1) : 1;
                            }
                            //ЧАЭС повторно
                            if (exam == reExamId && prInv == chaes)
                            {
                                item21.Gr1 = item21.Gr1 != 0 ? (1 + (int)item21.Gr1) : 1;

                            }
                            //Военнослужащие первично                
                            if (goalSurvey == goalV && prInv == prInvMilitary0 && exam == prExamId ||
                                goalSurvey == goalV && prInv == prInvMilitary1 && exam == prExamId ||
                                goalSurvey == goalV && prInv == prInvMilitary2 && exam == prExamId ||
                                goalSurvey == goalV && prInv == prInvMilitary3 && exam == prExamId)
                            {
                                item22.Gr1 = item22.Gr1 != 0 ? (1 + (int)item22.Gr1) : 1;
                            }
                            //Военнослужащие повторно
                            if (goalSurvey == goalV && prInv == prInvMilitary0 && exam == reExamId ||
                                goalSurvey == goalV && prInv == prInvMilitary1 && exam == reExamId ||
                                goalSurvey == goalV && prInv == prInvMilitary2 && exam == reExamId ||
                                goalSurvey == goalV && prInv == prInvMilitary3 && exam == reExamId)
                            {
                                item23.Gr1 = item23.Gr1 != 0 ? (1 + (int)item23.Gr1) : 1;
                            }
                            //Реаблитация полная               
                            if (goalSurvey == goalV && dinamicInval == dinaGr1 && group == notGroup ||
                                goalSurvey == goalV && dinamicInval == dinaGr2 && group == notGroup ||
                                goalSurvey == goalV && dinamicInval == dinaGr3 && group == notGroup ||
                                goalSurvey == goalV && dinamicInval == dinaChild && group == notGroup ||
                                goal18 && dinamicInval == dinaGr1 && group == notGroup ||
                                goal18 && dinamicInval == dinaGr2 && group == notGroup ||
                                goal18 && dinamicInval == dinaGr3 && group == notGroup)
                            {
                                item24.Gr1 = item24.Gr1 != 0 ? (1 + (int)item24.Gr1) : 1;
                            }
                            //Реаблитация частичная       
                            if (goalSurvey == goalV && dinamicInval == dinaGr1 && group == group2 ||
                                goalSurvey == goalV && dinamicInval == dinaGr1 && group == group3 ||
                                goalSurvey == goalV && dinamicInval == dinaGr2 && group == group3)
                            {
                                item25.Gr1 = item25.Gr1 != 0 ? (1 + (int)item25.Gr1) : 1;
                            }
                            //Утяжеление                                                
                            if (goalSurvey == goalV && dinamicInval == dinaGr3 && group == group2 ||
                                goalSurvey == goalV && dinamicInval == dinaGr2 && group == group1 ||
                                goalSurvey == goalV && dinamicInval == dinaGr3 && group == group1)
                            {
                                item26.Gr1 = item26.Gr1 != 0 ? (1 + (int)item26.Gr1) : 1;
                            }
                            //Необоснованно направленные            
                            if (/*(!dynaIdList.Contains(dinamic)) &&*/ dinamicInval != group1 && exam == prExamId && goalSurvey == goalV && group == notGroup && obosn == neObosN ||
                                /*(!dynaIdList.Contains(dinamic)) &&*/ dinamicInval != group2 && exam == prExamId && goalSurvey == goalV && group == notGroup && obosn == neObosN ||
                                /*(!dynaIdList.Contains(dinamic)) &&*/ dinamicInval != group3 && exam == prExamId && goalSurvey == goalV && group == notGroup && obosn == neObosN ||
                                /*(!dynaIdList.Contains(dinamic)) &&*/ dinamicInval != group1 && exam == prExamId && goalSurvey == goalV && group == Guid.Empty && obosn == neObosN ||
                                /*(!dynaIdList.Contains(dinamic)) &&*/ dinamicInval != group2 && exam == prExamId && goalSurvey == goalV && group == Guid.Empty && obosn == neObosN ||
                                /*(!dynaIdList.Contains(dinamic)) &&*/dinamicInval != group3 && exam == prExamId && goalSurvey == goalV && group == Guid.Empty && obosn == neObosN)
                            {
                                item27.Gr1 = item27.Gr1 != 0 ? (1 + (int)item27.Gr1) : 1;
                            }
                            //Долечивание по б/л 
                            if (goalSurvey == prodBolL || goalSurvey == goalV && group == vremTrsps)
                            {
                                item28.Gr1 = item28.Gr1 != 0 ? (1 + (int)item28.Gr1) : 1;
                            }
                            //Сложная консультация                                                                                                                      
                            if (goal17 && sk != null)
                            {
                                item29.Gr1 = item29.Gr1 != 0 ? (1 + (int)item29.Gr1) : 1;
                            }
                            //Устная консультация 
                            //if () item30.Gr1 = item30.Gr1 != 0 ? (1 + (int)item30.Gr1) : 1; 
                            //ДИ
                            if (goal9 != Guid.Empty && goal91 != Guid.Empty)
                            {
                                item31.Gr1 = item31.Gr1 != 0 ? (1 + (int)item31.Gr1) : 1;
                            }
                            //Кресло-Коляска
                            if (goal11 && kk1 && krk01)
                                item32.Gr1 = item32.Gr1 != 0 ? (1 + (int)item32.Gr1) : 1;

                            //Даны трудовые рекомендации 
                            //j7 -Рекомендуемые виды работ     
                            //j8-Противопоказанные условия труда 
                            //Может работать на дому-J1
                            //Может работать в специально  созданных условях труда: спец цехе-J2 
                            //В обычных условиях производства с предостовлением соответствующих условий труда -J3
                            //С использованием земельного надела-J4 
                            //Заключение об условиях и характере труда (Нетрудоспособен в обычных производственных условиях,Ограниченно трудоспособен)
                            //j9 Продолжать работу
                            //j10 Продолжать учебу                                                                           
                            if (goalSurvey == goalV && j7 != string.Empty && ageOf != agePensions && j9 == string.Empty && obosn != neObosN ||
                                goalSurvey == goalV && j8 != string.Empty && ageOf != agePensions && j9 == string.Empty && obosn != neObosN ||
                                goalSurvey == goalV && concOfWork == ogrTrud && ageOf != agePensions && j9 == string.Empty && obosn != neObosN ||
                                goalSurvey == goalV && concOfWork == ogrTrud && ageOf != agePensions && j9 == string.Empty && obosn != neObosN ||
                                goalSurvey == goalV && j1 && ageOf != agePensions && j9 == string.Empty && obosn != neObosN ||
                                goalSurvey == goalV && j2 && ageOf != agePensions && j9 == string.Empty && obosn != neObosN ||
                                goalSurvey == goalV && j3 && ageOf != agePensions && j9 == string.Empty && obosn != neObosN ||
                                goalSurvey == goalV && j4 && ageOf != agePensions && j9 == string.Empty && obosn != neObosN ||
                                goalSurvey == goalV && j10 != string.Empty && ageOf != agePensions && j9 == string.Empty && obosn != neObosN)
                            {
                                item33.Gr1 = item33.Gr1 != 0 ? (1 + (int)item33.Gr1) : 1;
                            }
                            //Напрпалены ОЗ item34.Gr1 = item34.Gr1 != 0 ? (1 + (int)item34.Gr1) : 1;
                            //из них трудоустр-ы item35.Gr1 = item35.Gr1 != 0 ? (1 + (int)item35.Gr1) : 1;

                            //Направлены на обучение 
                            if (j5 == str471 || j5 == str472 || j5 == str473 || j6 == str474 ||
                                j6 == str475 || j6 == str476 || j5 == str477 || j9 != string.Empty)
                            {
                                item36.Gr1 = item36.Gr1 != 0 ? (1 + (int)item36.Gr1) : 1;
                            }
                            //Из них обучаются       
                            //if () item48.Gr1 = item48.Gr1 != 0 ? (1 + (int)item48.Gr1) : 1; 
                            //Выездные заседания
                            /*if (exam4 == exitMeeting || exam4 == inExitMeeting)
                                item38.Gr1 = item38.Gr1 != 0 ? (1 + (int)item38.Gr1) : 1;
                             */
                            //На дому 
                            if (exam4 == atHouse)
                            {
                                item39.Gr1 = item39.Gr1 != 0 ? (1 + (int)item39.Gr1) : 1;
                            }
                            //Заполнение ИПР   
                            if (talonIPR)
                            {
                                item40.Gr1 = item40.Gr1 != 0 ? (1 + (int)item40.Gr1) : 1;
                            }
                            //Напр. в реаб. центр       
                            //if () item48.Gr1 = item48.Gr1 != 0 ? (1 + (int)item48.Gr1) : 1;

                            //по зрению первично
                            if (exam == prExamId && limit == limit1)
                            {
                                item42.Gr1 = item42.Gr1 != 0 ? (1 + (int)item42.Gr1) : 1;
                            }
                            //по зрению повторно
                            if (exam == reExamId && limit == limit1)
                            {
                                item43.Gr1 = item43.Gr1 != 0 ? (1 + (int)item43.Gr1) : 1;
                            }
                            //по слуху первично
                            if (exam == prExamId && limit == limit2)
                            {
                                item44.Gr1 = item44.Gr1 != 0 ? (1 + (int)item44.Gr1) : 1;
                            }
                            //по слуху повторно
                            if (exam == reExamId && limit == limit2)
                            {
                                item45.Gr1 = item45.Gr1 != 0 ? (1 + (int)item45.Gr1) : 1;
                            }
                            //ОДА
                            if (limit == limit3)
                            {
                                item46.Gr1 = item46.Gr1 != 0 ? (1 + (int)item46.Gr1) : 1;
                            }
                            //Протезы рук
                            if (protezHand)
                            {
                                item47.Gr1 = item47.Gr1 != 0 ? (1 + (int)item47.Gr1) : 1;
                            }
                            //Протезы ног
                            if (protezLeg)
                            {
                                item48.Gr1 = item48.Gr1 != 0 ? (1 + (int)item48.Gr1) : 1;
                            }
                            //Информация в СМИ  item49
                            //Семинары в ЛПО  item50
                            //ДЦП
                            if (goalSurvey == goalV && goal9 == Guid.Empty && goal91 == Guid.Empty && bolezni == dzp1 ||
                                goalSurvey == goalV && goal9 == Guid.Empty && goal91 == Guid.Empty && bolezni == dzp2 ||
                                goalSurvey == goalV && goal9 == Guid.Empty && goal91 == Guid.Empty && bolezni == dzp3 ||
                                goalSurvey == goalV && goal9 != Guid.Empty && goal91 != Guid.Empty && bolezni == dzp1 ||
                                goalSurvey == goalV && goal9 != Guid.Empty && goal91 != Guid.Empty && bolezni == dzp2 ||
                                goalSurvey == goalV && goal9 != Guid.Empty && goal91 != Guid.Empty && bolezni == dzp3)
                            {
                                item51.Gr1 = item51.Gr1 != 0 ? (1 + (int)item51.Gr1) : 1;
                            }
                            //СПИД
                            if (bolezni == vich1 && obosn != neObosN || bolezni == vich2 && obosn != neObosN)
                            {
                                item52.Gr1 = item52.Gr1 != 0 ? (1 + (int)item52.Gr1) : 1;
                            }
                            //Нуждающие постоянном постороннем уходе   
                            if (nadzor || uhod || nadzor && uhod)
                            {
                                item53.Gr1 = item53.Gr1 != 0 ? (1 + (int)item53.Gr1) : 1;
                            }
                            //Бессрочно                                 
                            if (indefinitely)
                                item54.Gr1 = item54.Gr1 != 0 ? (1 + (int)item54.Gr1) : 1;
                        }
                    }
                }
                var qbCh = new QueryBuilder(ChildsCertDefId, context.UserId);
                qbCh.Where("DateOfExamenation").Ge(fd).And("DateOfExamenation").Le(ld).And("&State").In(new object[] { ApprovedStateId, ArchivedStateId });

                using (var queryCh = SqlQueryBuilder.Build(context.DataContext, qbCh.Def))
                {
                    var personSrcCh = queryCh.JoinSource(queryCh.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                    queryCh.AddCondition(ExpressionOperation.And, ChildsCertDefId, "&OrgId", ConditionOperation.Equal, orgId);

                    queryCh.AddAttribute(queryCh.Source, "&Id");
                    queryCh.AddAttribute(queryCh.Source, "goal");
                    queryCh.AddAttribute(queryCh.Source, "goal11");
                    queryCh.AddAttribute(queryCh.Source, "goal9");
                    queryCh.AddAttribute(queryCh.Source, "Examination1");
                    queryCh.AddAttribute(personSrcCh, "Gender");
                    queryCh.AddAttribute(queryCh.Source, "term");
                    queryCh.AddAttribute(queryCh.Source, "ReasonOfDirection");
                    queryCh.AddAttribute(queryCh.Source, "CategoryDisability");
                    queryCh.AddAttribute(queryCh.Source, "RehabilitationCenter");
                    queryCh.AddAttribute(queryCh.Source, "Limit");
                    queryCh.AddAttribute(queryCh.Source, "Diagnosis");
                    queryCh.AddAttribute(queryCh.Source, "04");
                    queryCh.AddAttribute(queryCh.Source, "05");
                    queryCh.AddAttribute(queryCh.Source, "goal91");
                    queryCh.AddAttribute(queryCh.Source, "Wheelchair");
                    queryCh.AddAttribute(queryCh.Source, "01");
                    queryCh.AddAttribute(queryCh.Source, "goal17");
                    queryCh.AddAttribute(queryCh.Source, "IPR");
                    queryCh.AddAttribute(queryCh.Source, "PreschoolEducation1");
                    queryCh.AddAttribute(queryCh.Source, "ObsheeObrazovanie1");
                    queryCh.AddAttribute(queryCh.Source, "ObespProfOrientasya");
                    queryCh.AddAttribute(queryCh.Source, "Nadzor");
                    queryCh.AddAttribute(queryCh.Source, "Uhod");
                    queryCh.AddAttribute(queryCh.Source, "goal1");
                    queryCh.AddAttribute(queryCh.Source, "goal2");
                    queryCh.AddAttribute(queryCh.Source, "goal3");
                    queryCh.AddAttribute(queryCh.Source, "goal4");
                    queryCh.AddAttribute(queryCh.Source, "goal5");
                    queryCh.AddAttribute(queryCh.Source, "goal6");
                    queryCh.AddAttribute(queryCh.Source, "goal7");
                    queryCh.AddAttribute(queryCh.Source, "goal8");
                    queryCh.AddAttribute(queryCh.Source, "goal12");
                    queryCh.AddAttribute(queryCh.Source, "goal13");
                    queryCh.AddAttribute(queryCh.Source, "goal14");
                    queryCh.AddAttribute(queryCh.Source, "goal15");
                    queryCh.AddAttribute(queryCh.Source, "goal16");
                    queryCh.AddAttribute(queryCh.Source, "goal18");
                    queryCh.AddAttribute(queryCh.Source, "ChildTypeSIIMSII");
                    queryCh.AddAttribute(queryCh.Source, "ProfeOrientasiya");

                    var tableCh = new DataTable();
                    //var dynaIdList = new List<Guid>();
                    using (var readerCh = context.CreateSqlReader(queryCh))
                    {
                        readerCh.Open();
                        readerCh.Fill(tableCh);
                        readerCh.Close();
                    }

                    foreach (DataRow row in tableCh.Rows)
                    {
                        var appChId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var goalCh = row[1] is DBNull ? false : (bool)row[1];
                        var goal11 = row[2] is DBNull ? false : (bool)row[2];
                        var goal9 = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                        var exam = row[4] is DBNull ? Guid.Empty : (Guid)row[4];
                        var gender = row[5] is DBNull ? Guid.Empty : (Guid)row[5];
                        var term = row[6] is DBNull ? Guid.Empty : (Guid)row[6];
                        var obosnCh = row[7] is DBNull ? Guid.Empty : (Guid)row[7];
                        var disCategory = row[8] is DBNull ? Guid.Empty : (Guid)row[8];
                        var rehabCenter = row[9] is DBNull ? false : (bool)row[9];
                        var limit = row[10] is DBNull ? Guid.Empty : (Guid)row[10];
                        var diagnos = row[11] is DBNull ? Guid.Empty : (Guid)row[11];
                        var hand = row[12] is DBNull ? false : (bool)row[12];
                        var lag = row[13] is DBNull ? false : (bool)row[13];
                        var goal91 = row[14] is DBNull ? Guid.Empty : (Guid)row[14];
                        var wheelChair = row[15] is DBNull ? false : (bool)row[15];
                        var kk01 = row[16] is DBNull ? false : (bool)row[16];
                        var goal17 = row[17] is DBNull ? false : (bool)row[17];
                        var ipr = row[18] is DBNull ? false : (bool)row[18];
                        var presEduc = row[19] is DBNull ? Guid.Empty : (Guid)row[19];
                        var obsheeObr = row[20] is DBNull ? Guid.Empty : (Guid)row[20];
                        var profObr = row[21] is DBNull ? Guid.Empty : (Guid)row[21];
                        var uhod = row[22] is DBNull ? false : (bool)row[22];
                        var nadzor = row[23] is DBNull ? false : (bool)row[23];
                        var goal1 = row[24] is DBNull ? false : (bool)row[24];
                        var goal2 = row[25] is DBNull ? false : (bool)row[25];
                        var goal3 = row[26] is DBNull ? false : (bool)row[26];
                        var goal4 = row[27] is DBNull ? false : (bool)row[27];
                        var goal5 = row[28] is DBNull ? false : (bool)row[28];
                        var goal6 = row[29] is DBNull ? false : (bool)row[29];
                        var goal7 = row[30] is DBNull ? false : (bool)row[30];
                        var goal8 = row[31] is DBNull ? false : (bool)row[31];
                        var goal12 = row[32] is DBNull ? false : (bool)row[32];
                        var goal13 = row[33] is DBNull ? false : (bool)row[33];
                        var goal14 = row[34] is DBNull ? false : (bool)row[34];
                        var goal15 = row[35] is DBNull ? false : (bool)row[35];
                        var goal16 = row[36] is DBNull ? false : (bool)row[36];
                        var goal18 = row[37] is DBNull ? false : (bool)row[37];
                        var typeSIIMSII = row[38] is DBNull ? Guid.Empty : (Guid)row[38];
                        var profOrien = row[39] is DBNull ? Guid.Empty : (Guid)row[39];

                        if (appChId != Guid.Empty)
                        {
                            item55.Gr1 = item55.Gr1 != 0 ? (1 + (int)item55.Gr1) : 1;
                            if (goalCh && goal9 != Guid.Empty || goalCh && goal2 || goalCh && goal11 || goal11 && goal17)
                                item55.Gr1 = item55.Gr1 != 0 ? (1 + (int)item55.Gr1) : 1;

                            /*if (goal1 || goal2 || goal3 || goal4 || goal5 || goal6 || goal7 || goal8 ||
                                goal9 != Guid.Empty || goal11 || goal12 || goal13 || goal14 || goal15 || goal16 || goal17 || goal18)*/
                            if (goalCh && disCategory == childDis && obosnCh != neObosN)
                            {
                                item56.Gr1 = item56.Gr1 != 0 ? (1 + (int)item56.Gr1) : 1;

                                if (exam == prExamId)
                                {
                                    item57.Gr1 = item57.Gr1 != 0 ? (1 + (int)item57.Gr1) : 1;
                                    if (gender == female)
                                        item58.Gr1 = item58.Gr1 != 0 ? (1 + (int)item58.Gr1) : 1;
                                    if (term == years1 || term == years2)
                                        item59.Gr1 = item59.Gr1 != 0 ? (1 + (int)item59.Gr1) : 1;
                                    if (term == years5)
                                        item60.Gr1 = item60.Gr1 != 0 ? (1 + (int)item60.Gr1) : 1;
                                    if (term == years18)
                                        item61.Gr1 = item61.Gr1 != 0 ? (1 + (int)item61.Gr1) : 1;
                                }
                                if (exam == reExamId)
                                {
                                    item62.Gr1 = item62.Gr1 != 0 ? (1 + (int)item62.Gr1) : 1;
                                    if (gender == female)
                                        item63.Gr1 = item63.Gr1 != 0 ? (1 + (int)item63.Gr1) : 1;
                                    if (term == years1 || term == years2)
                                        item64.Gr1 = item64.Gr1 != 0 ? (1 + (int)item64.Gr1) : 1;
                                    if (term == years5)
                                        item65.Gr1 = item65.Gr1 != 0 ? (1 + (int)item65.Gr1) : 1;
                                    if (term == years18)
                                        item66.Gr1 = item66.Gr1 != 0 ? (1 + (int)item66.Gr1) : 1;
                                }
                            }
                            //необосн. направ-ые
                            if (obosnCh == neObosN)
                                item67.Gr1 = item67.Gr1 != 0 ? (1 + (int)item67.Gr1) : 1;
                            //реабилитированы    
                            if (goalCh && disCategory == dontAscertain && obosnCh != neObosN)
                            {
                                item68.Gr1 = item68.Gr1 != 0 ? (1 + (int)item68.Gr1) : 1;
                            }
                            //реаблит. центр    
                            if (rehabCenter)
                            {
                                item69.Gr1 = item69.Gr1 != 0 ? (1 + (int)item69.Gr1) : 1;
                            }
                            //по слуху первично   
                            if (exam == prExamId && limit == limit2)
                            {
                                item70.Gr1 = item70.Gr1 != 0 ? (1 + (int)item70.Gr1) : 1;
                            }
                            //по слуху повторно   
                            if (exam == reExamId && limit == limit2)
                            {
                                item71.Gr1 = item71.Gr1 != 0 ? (1 + (int)item71.Gr1) : 1;
                            }
                            //ДЦП первично    
                            if (goalCh && disCategory == childDis && diagnos == dzp1 && exam == prExamId ||
                                goalCh && disCategory == childDis && diagnos == dzp2 && exam == prExamId ||
                                goalCh && disCategory == childDis && diagnos == dzp3 && exam == prExamId)
                            {
                                item72.Gr1 = item72.Gr1 != 0 ? (1 + (int)item72.Gr1) : 1;
                            }
                            //ДЦП повторно   
                            if (goalCh && disCategory == childDis && diagnos == dzp1 && exam == reExamId ||
                                goalCh && disCategory == childDis && diagnos == dzp2 && exam == reExamId ||
                                goalCh && disCategory == childDis && diagnos == dzp3 && exam == reExamId)
                            {
                                item73.Gr1 = item73.Gr1 != 0 ? (1 + (int)item73.Gr1) : 1;
                            }
                            //ВИЧ первично   
                            if (exam == prExamId && diagnos == vich1 || exam == prExamId && diagnos == vich2)
                            {
                                item74.Gr1 = item74.Gr1 != 0 ? (1 + (int)item74.Gr1) : 1;
                            }
                            //ВИЧ повторно   
                            if (exam == reExamId && diagnos == vich1 || exam == reExamId && diagnos == vich2)
                            {
                                item75.Gr1 = item75.Gr1 != 0 ? (1 + (int)item75.Gr1) : 1;
                            }
                            //ОДА
                            if (limit == limit3)
                            {
                                item76.Gr1 = item76.Gr1 != 0 ? (1 + (int)item76.Gr1) : 1;
                            }
                            //протез рук
                            if (hand)
                            {
                                item77.Gr1 = item77.Gr1 != 0 ? (1 + (int)item77.Gr1) : 1;
                            }
                            //протез ног
                            if (lag)
                            {
                                item78.Gr1 = item78.Gr1 != 0 ? (1 + (int)item78.Gr1) : 1;
                            }
                            //ДИ              
                            if (goal9 != Guid.Empty || goal91 != Guid.Empty || typeSIIMSII != Guid.Empty)
                            {
                                item79.Gr1 = item79.Gr1 != 0 ? (1 + (int)item79.Gr1) : 1;
                            }
                            //кресло-коляска
                            if (goal11 || wheelChair)
                            {
                                item80.Gr1 = item80.Gr1 != 0 ? (1 + (int)item80.Gr1) : 1;
                            }
                            //СК                        
                            if (goal17)
                            {
                                item81.Gr1 = item81.Gr1 != 0 ? (1 + (int)item81.Gr1) : 1;
                            }
                            //УК
                            /*if(goal17)
                               {
                                    item82.Gr1 = item82.Gr1 != 0 ? (1 + (int)item82.Gr1) : 1;    
                               } */
                            //Заполнение ИПР  
                            if (ipr)
                            {
                                item83.Gr1 = item83.Gr1 != 0 ? (1 + (int)item83.Gr1) : 1;
                            }
                            //в спец. садик
                            if (presEduc == spezSadic1 || presEduc == spezSadic2 || presEduc == spezSadic3 || presEduc == spezSadic4)
                            {
                                item84.Gr1 = item84.Gr1 != 0 ? (1 + (int)item84.Gr1) : 1;
                            }
                            //в спец. школу   
                            if (obsheeObr == sShk1 || obsheeObr == sShk3 ||
                                obsheeObr == sShk4 || obsheeObr == sShk5 || obsheeObr == sShk6)
                            {
                                item85.Gr1 = item85.Gr1 != 0 ? (1 + (int)item85.Gr1) : 1;
                            }
                            //в училище  
                            if (profObr == str281 || profObr == str282 || profObr == str283 || profObr == str284 ||
                                profOrien == profObuch)
                            {
                                item86.Gr1 = item86.Gr1 != 0 ? (1 + (int)item86.Gr1) : 1;
                            }
                            //Инклюзивное обр-е  
                            if (obsheeObr == sShk2)
                            {
                                item87.Gr1 = item87.Gr1 != 0 ? (1 + (int)item87.Gr1) : 1;
                            }
                            //нужд.уходе первично
                            if (exam == prExamId)
                            {
                                if ((uhod || nadzor) || (uhod && nadzor))
                                {
                                    item88.Gr1 = item88.Gr1 != 0 ? (1 + (int)item88.Gr1) : 1;
                                }
                            }
                            //нужд.уходе повторно                                           
                            if (exam == reExamId)
                            {
                                if ((uhod || nadzor) || (uhod && nadzor))
                                {
                                    item89.Gr1 = item89.Gr1 != 0 ? (1 + (int)item89.Gr1) : 1;
                                }
                            }
                        }
                    }
                }
            }

            static void RemoveRows(WorkflowContext context, Guid reportId)
            {
                var docRepo = context.Documents;
                var rows = new List<Guid>();
                var qb = new QueryBuilder(reportItemDefId, context.UserId);
                qb.Where("MonthReportExaminationAdults").Eq(reportId).Or("MonthReportExaminationAdults").IsNull();
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read()) rows.Add(reader.GetGuid(0));
                }
                foreach (var rowId in rows)
                {
                    docRepo.DeleteById(rowId);
                }
            }
            private static readonly Guid reportDefId = new Guid("{6694CFB1-EFB1-45BC-8625-AB5169578413}"); //Основные показатели для взрослых
            private static readonly Guid reportItemDefId = new Guid("{5CA3F22A-30A1-4E7C-A976-21D29E218069}"); //Наименовании столбцов 
            private static readonly Guid adultsStatCardDefId = new Guid("{C77A6FF6-EC0B-4562-81FE-BB3BC17F4FDB}"); //Статистический талон для взрослых 
            private static readonly Guid adultsActDefId = new Guid("{12AE380B-39CE-4753-A556-4083BD4B0F92}"); //Медицинский акт для взрослых
            private static readonly Guid ChildsCertDefId = new Guid("{0ECF44B6-2B2D-4687-B7B0-07BA5F942AC6}"); //Медицинский акт ребенка с ОВЗ 
                                                                                                               // private static readonly Guid childStatCardDefId = new Guid("{363E89D0-5E31-45B5-82B7-42E83DF96E1F}"); //Статистический талон ребенка с ОВЗ
            private static readonly Guid dinamicInvalidDefId = new Guid("{FFBD36FF-615E-49F7-AB5B-9C787C07B981}"); //Динамика инвалидности

            private static readonly Guid prExamId = new Guid("{34129BC5-5B31-4189-87FA-799402F7E99F}"); //Освидетельствование//Первичное
            private static readonly Guid reExamId = new Guid("{A1F1D6CD-C1CD-4BF8-8F4A-DA124D47C250}"); //Освидетельствование//Повторное
                                                                                                        //группа для динамика инвалидности      
            private static readonly Guid dinaGr1 = new Guid("{8B2A4C4E-DBE7-4A49-AB2B-D788C22DC3D5}"); //Первая
            private static readonly Guid dinaGr2 = new Guid("{4E62F6B9-BDFA-4D92-97A0-1E0B3AEDB473}"); //Вторая
            private static readonly Guid dinaGr3 = new Guid("{07F39539-FF02-4F5F-A4EA-D403AFB679CF}"); // Третья
            private static readonly Guid dinaChild = new Guid("{0643F3EA-94C5-4888-BCD3-2CCADE7A3AE4}"); //ребенок ОВЗ

            private static readonly Guid group1 = new Guid("{D145ABA1-EADA-442B-9D8D-AD10BCD126D2}"); //Группа инвалидности//Первая 
            private static readonly Guid group2 = new Guid("{C161DA2D-2883-4211-B444-CBB04DBF33D5}"); //Группа инвалидности//Вторая 
            private static readonly Guid group3 = new Guid("{CCD439CA-1500-4F7A-A1C8-BB474B5DE8AA}"); //Группа инвалидности//Третья
            private static readonly Guid[] groupId = new[]
            {
                new Guid("{D145ABA1-EADA-442B-9D8D-AD10BCD126D2}"),
                new Guid("{C161DA2D-2883-4211-B444-CBB04DBF33D5}"),
                new Guid("{CCD439CA-1500-4F7A-A1C8-BB474B5DE8AA}")
            };
            private static readonly Guid goalV = new Guid("{8FD84B27-FF2A-40A4-A87A-BC254DC9D853}"); //Для установления группы
            private static readonly Guid female = new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"); //Женский
            private static readonly Guid agePensions = new Guid("{9B207DB0-8214-4BA7-A8C4-635EF87B583A}"); //Лицо пенсионного возраста
            private static readonly Guid childHood = new Guid("{9AF55221-0264-4349-9B36-A8E1313250B6}"); //ЛОВЗ с детства
            private static readonly Guid profZ = new Guid("{383E70E5-E9BE-4AE5-B5DF-323D4463DD51}"); //Профессиональное заболевание
            private static readonly Guid trudU = new Guid("{2E3209F0-0002-4DA2-9E63-6FAEDDF1983D}"); //Трудовое увечье
            private static readonly Guid chaes = new Guid("{A6EABF70-F864-4A97-B528-839DE6607B07}"); //Заболевание связано с аварией на ЧАЭС
            private static readonly Guid prInvMilitary0 = new Guid("{0CD8E76E-CF20-41CF-B7EE-4FE85EA39435}");//Причина инвалидности//MilitaryDismissedFromService-13.1
            private static readonly Guid prInvMilitary1 = new Guid("{4A8BC253-701C-44FB-B840-10F6BD8E97BD}"); //ПИ//13.2             
            private static readonly Guid prInvMilitary2 = new Guid("{41313E17-2275-4027-9563-5323FF096E3F}"); //ПИ// Wound-14.1
            private static readonly Guid prInvMilitary3 = new Guid("{119DC79B-42D0-4102-AE42-A902A4EF806B}"); //ПИ// 14.4
            private static readonly Guid notGroup = new Guid("{C52CCD68-96D8-4E0A-A8ED-30B482C1CF18}"); //Группа инвалидности// Не установлена 
            private static readonly Guid neObosN = new Guid("{7C41D8B2-8A96-4C53-BF7B-CB3164E4A1EB}"); //Обоснованность направления//Необосновано
            private static readonly Guid prodBolL = new Guid("{6D34B9A5-A39F-403B-B111-68B1E71D324E}"); //Цель освидетельствования//Продление больничного листа 
            private static readonly Guid vremTrsps = new Guid("{1453DB74-1A01-45FF-B2AA-F20A26DD23D0}"); ////Группа инвалидности//Временно нетрудоспособен
            private static readonly Guid slKons = new Guid("{A08C14A1-403A-402B-AFEC-D37244C60599}"); //Группа инвалидности//Сложная консультация                         
            private static readonly Guid ogrTrud = new Guid("{4B760BC2-6BC4-4B8D-9B4D-0CEB7ADF79AF}"); //Заключение об условиях  и характере труда//Ограниченно трудоспособен
            private static readonly Guid str471 = new Guid("{B1DA2934-3B9E-4F7A-BB3D-8E2478B6A951}"); //Профессиональная ориентация// Профессиональное обучение
            private static readonly Guid str472 = new Guid("{8577E6D1-1ADC-4A23-BFC4-93E8152FDC00}"); //Профессиональная ориентация// Переобучение
            private static readonly Guid str473 = new Guid("{B2FBA0DD-DD44-4D0C-A0AB-5406C00CAEEB}"); //Профессиональная ориентация//Повышение квалификации
            private static readonly Guid str474 = new Guid("{E61F2E04-0097-4609-98E1-3B3D95A25A8F}"); //Обеспечение профессиональной ориентации//В условиях производства                                                       
            private static readonly Guid str475 = new Guid("{1E5508BA-AF0C-4B12-BA06-B3F98FAB9F82}"); //Обеспечение профессиональной ориентации//В профессионально-технических учреждениях системы образования 
            private static readonly Guid str476 = new Guid("{E2F8330E-D94F-4C5A-B6B9-56C42213BCE1}"); //Обеспечение профессиональной ориентации//В профессионально-технических учреждениях системы органов социальной защиты
            private static readonly Guid str477 = new Guid("{8F188272-E396-4146-BDFE-8247D364AE56}"); //Обеспечение профессиональной ориентации //В высших учебных заведениях
            private static readonly Guid exitMeeting = new Guid("{6179EBC1-FD52-4A03-B045-9C9E860D69C4}"); //На выездном заседании        
            private static readonly Guid inExitMeeting = new Guid("{21A5E24D-8C87-4F0A-BDC3-C8E0A5AB27AF}"); //Выезд в лечебно профилактические учреждения       
            private static readonly Guid atHouse = new Guid("{8D7E2F2A-6DDD-4EBC-A770-5BB9D55472BB}"); //Освидетельствование4//На дому
            private static readonly Guid limit1 = new Guid("{AB47477F-7F60-4FD3-BA13-207D70000431}");  //Ограничение //по зрению
            private static readonly Guid limit2 = new Guid("{894A9109-353C-438A-A16B-A4F281D13B09}");  //Ограничение //по слуху с детство    
            private static readonly Guid limit3 = new Guid("{5BBAA168-8823-4110-9AEB-655486832288}");  //Ограничение //с нарушениями опорно-двигательного аппарата
            private static readonly Guid dzp1 = new Guid("{070AADAE-4453-4753-B939-44FD21544953}"); //Умственная отсталость, вследствие ДЦП/ F 70-79                
            private static readonly Guid dzp2 = new Guid("{F6BAE9AD-DDBA-4C71-9A36-E1106E9BCBD9}"); //Детский церебральный паралич/ G 80-83
            private static readonly Guid dzp3 = new Guid("{970AE4FA-9B31-447E-AF8B-9567A8F62F3F}"); //Органическое слабоумие в сочетании ДЦП/ F 00-03
            private static readonly Guid vich1 = new Guid("{07C6C658-D589-48A1-803B-DBCA6603B543}"); //Органическое слабоумие/ F 00-03    
            private static readonly Guid vich2 = new Guid("{EC422C17-E8E4-42A3-AD96-EBCBC07B7C7E}");

            //дети
            private static readonly Guid years1 = new Guid("{C0C639C1-4069-42BD-B9C5-0C4C0EAD41CE}"); //1 год
            private static readonly Guid years2 = new Guid("{CAB664A9-513D-4939-AB17-31ACF97C7592}"); //2 года
            private static readonly Guid years5 = new Guid("{4C270330-A4A0-40B7-9E2C-6726AE4BAD6C}"); //5 лет
            private static readonly Guid years18 = new Guid("{B1F91F0F-EA5C-4DA4-9DE6-C3FC0142E66F}"); //до 18 лет
            private static readonly Guid dontAscertain = new Guid("{BEB4542B-0C03-494A-BD60-AA6BA8E8BF4C}"); //Категория инвалидности-Не установлена    
            private static readonly Guid childDis = new Guid("{5A819CA1-D0D8-419E-BBD7-67C5B20370C1}"); //Кат-я инв-ти-Ребенок с ОВЗ   
            private static readonly Guid spezSadic1 = new Guid("{A0C2F01A-6242-487B-AA04-866E5A88757E}"); //Специализированный садик для слепых и слабовидящих детей
            private static readonly Guid spezSadic2 = new Guid("{D00331F8-86DF-42E4-8C1F-F124F1EB81D6}"); //Специализированный садик для глухих и слабослышащих детей 
            private static readonly Guid spezSadic3 = new Guid("{E57DD5DF-79F9-4666-824D-9319286D52C2}"); //Специализированный садик для детей с нарушениями речи
            private static readonly Guid spezSadic4 = new Guid("{4CDA228B-7B93-42C1-8B34-2C8C67678F3A}"); //Специализированный садик для детей с отклонениями психическом развитии    
            private static readonly Guid sShk1 = new Guid("{95038B6D-062A-457F-9DE9-089C4BA582FF}"); //Специальное (коррекционное) образовательное учреждение для обучающихся, воспитанников с отклонениями в развитиии 
            private static readonly Guid sShk2 = new Guid("{6CC846B2-2636-4CE8-A032-6B5322E23CCD}"); //По инклюзивной программе 
            private static readonly Guid sShk3 = new Guid("{3EF0F49F-FD0B-4562-8980-4863BF750A28}"); //Специальное образовательное учреждение для глухих
            private static readonly Guid sShk4 = new Guid("{6BB331E1-B77C-48FB-A056-3BA7D9B2280B}"); //Специальное образовательное учреждение для глухо-немых
            private static readonly Guid sShk5 = new Guid("{448B9F43-4F36-465A-8F5E-6F5D30348596}"); //Специализированная школа интернат для слепых и слабовидящих детей 
            private static readonly Guid sShk6 = new Guid("{35EBF04E-DDD2-4A5A-85A0-5D5AEF9F047C}"); //Вспомогательная школа
            private static readonly Guid str281 = new Guid("{E61F2E04-0097-4609-98E1-3B3D95A25A8F}"); //Обеспечение профессиональной ориентации //В условиях производства                                         
            private static readonly Guid str282 = new Guid("{1E5508BA-AF0C-4B12-BA06-B3F98FAB9F82}"); //В профессионально-технических учреждениях системы образования
            private static readonly Guid str283 = new Guid("{E2F8330E-D94F-4C5A-B6B9-56C42213BCE1}"); //В профессионально-технических учреждениях системы органов социальной защиты
            private static readonly Guid str284 = new Guid("{8F188272-E396-4146-BDFE-8247D364AE56}"); // В высших учебных заведениях
            private static readonly Guid profObuch = new Guid("{B1DA2934-3B9E-4F7A-BB3D-8E2478B6A951}"); //Профессиональное обучение

            public static readonly Guid ApprovedStateId = new Guid("{32062CB7-C31C-4AFB-ADF3-F9F9AEEFCE59}");  //Подписанные 
            public static readonly Guid ArchivedStateId = new Guid("{5B6F0D85-2ACE-4E7E-81C6-563808A433F3}");  //Архив

            private static readonly Guid personDefId = new Guid("{D71CE61A-9B59-4B5E-8713-8131DBB5BA02}"); //Person 
            public static readonly Guid districtDefId = new Guid("{A3FCA356-82A9-4BBD-872A-8333BEC6E41A}"); //Район
            public static readonly Guid cityDefId = new Guid("{4BB6D32D-5181-4031-BA49-CF5910D6D883}"); //Города районного значения
        }

        //Результаты первичных освидетельствований 1 отчет
        public static class PrimaryExamDisabilities
        {
            public static List<Report_01Item> Execute(WorkflowContext context, int year, string distrSpr)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;

                /******************************************************************************************************************/
                var docs = new string[]
                {
                    "освидетельствовано всего  01  ",
                    "в т. ч. для определения группы инвалидности  02  ",
                    "из них: не признаны   ЛОВЗ	 03  ",
                    "признаны временно нетрудоспособными  04  ",
                    "признаны    ЛОВЗ  05  ",
                    "из числа признанных ЛОВЗ (ст 05)  ЛОВЗ   1 группы  06  ",
                    "ЛОВЗ     2 группы  07  ",
                    "ЛОВЗ     3 группы  08  ",
                    "из числа признанных ЛОВЗ (ст 05) ЛОВЗ вследствие трудового увечья  09  ",
                    "ЛОВЗ вследствие профессионального заболевания  10  ",
                    "ЛОВЗ вследствие общего заболевания  11  ",
                    "в том числе: ЛОВЗ – участники ВОВ  11.1",
                    "ЛОВЗ -  труженики тыла  11.2",
                    "ЛОВЗ   «с детства»  12  ",
                    "ЛОВЗ из числа военнослужащих  13  ",
                    "из них: ЛОВЗ   участники ВОВ  13.1",
                    "ЛОВЗ, вследствие ранений, контузий, травм, увечий, заболеваний, полученных при исполнении обязанностей военной службы  13.2",
                    "ЛОВЗ    вследствие заболеваний, полученных в период   прохождений военной службы  13.3",
                    "ЛОВЗ     вследствие ликвидации аварии ЧАЭС 14  ",
                    "при выполнении обязанностей в/службы  14.1",
                    "из числа признанных ЛОВЗ (ст. 05) инвалидность установлена бессрочно  15  ",
                    "освидетельствование для других целей  16  ",
                    "в том числе предоставление кресла-коляски  16.1",
                    "определение в дом инвалидов  16.2",
                    "установление % утрат проф. трудоспособности  16.3",
                    "для сложных консультаций  16.4"
                };
                var items = new List<Report_01Item>();
                int i2 = 1;
                foreach (var i in docs)
                {
                    var item = new Report_01Item();
                    item.rowName = i;
                    item.rowNo = i2;
                    i2++;
                    items.Add(item);
                }
                CalcItems(context, /*report, */year, orgId, distrSpr, items[25],
                    items[24], items[23], items[22], items[21], items[20], items[19], items[18],
                    items[17], items[16], items[15], items[14], items[13], items[12], items[11],
                    items[10], items[9], items[8], items[7], items[6], items[5], items[4],
                    items[3], items[2], items[1], items[0]);
                return items;
            }
            public static void CalcItems(WorkflowContext context, int year, Guid orgId, string distrSpr,
                Report_01Item item25, Report_01Item item24,
                Report_01Item item23, Report_01Item item22, Report_01Item item21, Report_01Item item20,
                Report_01Item item19, Report_01Item item18, Report_01Item item17, Report_01Item item16,
                Report_01Item item15, Report_01Item item14, Report_01Item item13, Report_01Item item12,
                Report_01Item item11, Report_01Item item10, Report_01Item item9, Report_01Item item8,
                Report_01Item item7, Report_01Item item6, Report_01Item item5, Report_01Item item4,
                Report_01Item item3, Report_01Item item2, Report_01Item item1, Report_01Item item0)
            {
                var qb = new QueryBuilder(adultsStatCardDefId, context.UserId);
                qb.Where("&State").Eq(ApprovedStateId).And("Examination1").Eq(primaryEnumId);

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                    var actSrc = query.JoinSource(query.Source, adultsActDefId, SqlSourceJoinType.Inner, "AdultsMedicalCertificate");
                    var distrSrc = query.JoinSource(actSrc, districtDefId, SqlSourceJoinType.LeftOuter, "DistrictId");
                    var citySrc = query.JoinSource(actSrc, cityDefId, SqlSourceJoinType.LeftOuter, "CityId");
                    query.AddCondition(ExpressionOperation.And, adultsStatCardDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    if (!string.IsNullOrEmpty(distrSpr))
                    query.AddCondition(ExpressionOperation.And, districtDefId, "NumberDis", ConditionOperation.Equal, distrSpr);

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(query.Source, "EndDateExamination");
                    query.AddAttribute(personSrc, "Gender");
                    query.AddAttribute(query.Source, "AgeOf");
                    query.AddAttribute(query.Source, "PlaceWork");
                    query.AddAttribute(query.Source, "GoalSurvey");
                    query.AddAttribute(query.Source, "DisabilityGroup");
                    query.AddAttribute(query.Source, "CauseOfDisability");
                    query.AddAttribute(query.Source, "Indefinitely");
                    query.AddAttribute(query.Source, "goal1");
                    query.AddAttribute(query.Source, "goal2");
                    query.AddAttribute(query.Source, "goal3");
                    query.AddAttribute(query.Source, "goal4");
                    query.AddAttribute(query.Source, "goal5");
                    query.AddAttribute(query.Source, "goal6");
                    query.AddAttribute(query.Source, "goal7");
                    query.AddAttribute(query.Source, "goal8");
                    query.AddAttribute(query.Source, "goal9");
                    query.AddAttribute(query.Source, "goal11");
                    query.AddAttribute(query.Source, "goal12");
                    query.AddAttribute(query.Source, "goal13");
                    query.AddAttribute(query.Source, "goal14");
                    query.AddAttribute(query.Source, "goal15");
                    query.AddAttribute(query.Source, "goal16");
                    query.AddAttribute(query.Source, "goal17");
                    query.AddAttribute(query.Source, "goal18");
                    query.AddAttribute(distrSrc, "DistrictType");
                    query.AddAttribute(citySrc, "DistrictType");

                    var table = new DataTable();
                    using (var reader = context.CreateSqlReader(query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var date = !(row[1] is DBNull) ? (DateTime)row[1] : DateTime.MinValue;
                        var gender = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                        var ageOf = row[3] is DBNull ? Guid.Empty : (Guid)row[3];                        
                        var busy = row[4] is DBNull ? "" : row[4].ToString();
                        var goal = row[5] is DBNull ? Guid.Empty : (Guid)row[5];
                        var group = row[6] is DBNull ? Guid.Empty : (Guid)row[6];
                        var reason = row[7] is DBNull ? Guid.Empty : (Guid)row[7];
                        var indef = row[8] is DBNull ? false : (bool)row[8];
                        var goal1 = row[9] is DBNull ? false : (bool)row[9];
                        var goal2 = row[10] is DBNull ? false : (bool)row[10];
                        var goal3 = row[11] is DBNull ? false : (bool)row[11];
                        var goal4 = row[12] is DBNull ? false : (bool)row[12];
                        var goal5 = row[13] is DBNull ? false : (bool)row[13];
                        var goal6 = row[14] is DBNull ? false : (bool)row[14];
                        var goal7 = row[15] is DBNull ? false : (bool)row[15];
                        var goal8 = row[16] is DBNull ? false : (bool)row[16];
                        var goal9 = row[17] is DBNull ? Guid.Empty : (Guid)row[17];
                        var goal11 = row[18] is DBNull ? false : (bool)row[18];
                        var goal12 = row[19] is DBNull ? false : (bool)row[19];
                        var goal13 = row[20] is DBNull ? false : (bool)row[20];
                        var goal14 = row[21] is DBNull ? false : (bool)row[21];
                        var goal15 = row[22] is DBNull ? false : (bool)row[22];
                        var goal16 = row[23] is DBNull ? false : (bool)row[23];
                        var goal17 = row[24] is DBNull ? false : (bool)row[24];
                        var goal18 = row[25] is DBNull ? false : (bool)row[25];
                        var district = row[26] is DBNull ? Guid.Empty : (Guid)row[26];
                        var city = row[27] is DBNull ? Guid.Empty : (Guid)row[27];

                        if (appId != Guid.Empty)
                        {
                            if (date.Year == year)
                            {
                                item0.gr1 = item0.gr1 != 0 ? (1 + (int)item0.gr1) : 1;
                                if (gender == womanEnumId) item0.gr2 = item0.gr2 != 0 ? (1 + (int)item0.gr2) : 1;
                                if (ageOf == ageOf1EnumId) item0.gr3 = item0.gr3 != 0 ? (1 + (int)item0.gr3) : 1;
                                if (ageOf == ageOf2EnumId) item0.gr4 = item0.gr4 != 0 ? (1 + (int)item0.gr4) : 1;
                                if (ageOf == ageOf3EnumId) item0.gr5 = item0.gr5 != 0 ? (1 + (int)item0.gr5) : 1;
                                if (ageOf == ageOf4EnumId)
                                {
                                    item0.gr6 = item0.gr6 != 0 ? (1 + (int)item0.gr6) : 1;
                                    if (gender == womanEnumId) item0.gr7 = item0.gr7 != 0 ? (1 + (int)item0.gr7) : 1;
                                }
                                if (district == cityEnumId || city == cityEnumId)
                                {
                                    item0.gr8 = item0.gr8 != 0 ? (1 + (int)item0.gr8) : 1;
                                    if (gender == womanEnumId) item0.gr9 = item0.gr9 != 0 ? (1 + (int)item0.gr9) : 1;
                                    if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                        item0.gr10 = item0.gr10 != 0 ? (1 + (int)item0.gr10) : 1;
                                    //if (busy != null) item0.gr11 = item0.gr11 != 0 ? (1 + (int)item0.gr11) : 1;
                                }
                                if (district == villageEnumId || city == villageEnumId)
                                {
                                    item0.gr12 = item0.gr12 != 0 ? (1 + (int)item0.gr12) : 1;
                                    if (gender == womanEnumId) item0.gr13 = item0.gr13 != 0 ? (1 + (int)item0.gr13) : 1;
                                    if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                        item0.gr14 = item0.gr14 != 0 ? (1 + (int)item0.gr14) : 1;
                                    
                                    //if (busy != null) item0.gr15 = item0.gr15 != 0 ? (1 + (int)item0.gr15) : 1;
                                }
                                //для определения гр. инвалидности
                                if (goal == goalForGroup)
                                {
                                    item1.gr1 = item1.gr1 != 0 ? (1 + (int)item1.gr1) : 1;
                                    if (gender == womanEnumId) item1.gr2 = item1.gr2 != 0 ? (1 + (int)item1.gr2) : 1;
                                    if (ageOf == ageOf1EnumId) item1.gr3 = item1.gr3 != 0 ? (1 + (int)item1.gr3) : 1;
                                    if (ageOf == ageOf2EnumId) item1.gr4 = item1.gr4 != 0 ? (1 + (int)item1.gr4) : 1;
                                    if (ageOf == ageOf3EnumId) item1.gr5 = item1.gr5 != 0 ? (1 + (int)item1.gr5) : 1;
                                    if (ageOf == ageOf4EnumId) 
                                    {
                                        item1.gr6 = item1.gr6 != 0 ? (1 + (int)item1.gr6) : 1;
                                        if (gender == womanEnumId) item1.gr7 = item1.gr7 != 0 ? (1 + (int)item1.gr7) : 1;
                                    }
                                    if (district == cityEnumId || city == cityEnumId)
                                    {
                                        item1.gr8 = item1.gr8 != 0 ? (1 + (int)item1.gr8) : 1;
                                        if (gender == womanEnumId) item1.gr9 = item1.gr9 != 0 ? (1 + (int)item1.gr9) : 1;
                                        if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                            item1.gr10 = item1.gr10 != 0 ? (1 + (int)item1.gr10) : 1;
                                        if (busy != null) item1.gr11 = item1.gr11 != 0 ? (1 + (int)item1.gr11) : 1;
                                    }
                                    if (district == villageEnumId || city == villageEnumId)
                                    {
                                        item1.gr12 = item1.gr12 != 0 ? (1 + (int)item1.gr12) : 1;
                                        if (gender == womanEnumId) item1.gr13 = item1.gr13 != 0 ? (1 + (int)item1.gr13) : 1;
                                        if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                            item1.gr14 = item1.gr14 != 0 ? (1 + (int)item1.gr14) : 1;
                                        if (busy != null) item1.gr15 = item1.gr15 != 0 ? (1 + (int)item1.gr15) : 1;
                                    }
                                    //не признанные
                                    if (group == notInstalled)
                                    {                                        
                                        item2.gr1 = item2.gr1 != 0 ? (1 + (int)item2.gr1) : 1;
                                        if (gender == womanEnumId) item2.gr2 = item2.gr2 != 0 ? (1 + (int)item2.gr2) : 1;
                                        if (ageOf == ageOf1EnumId) item2.gr3 = item2.gr3 != 0 ? (1 + (int)item2.gr3) : 1;
                                        if (ageOf == ageOf2EnumId) item2.gr4 = item2.gr4 != 0 ? (1 + (int)item2.gr4) : 1;
                                        if (ageOf == ageOf3EnumId) item2.gr5 = item2.gr5 != 0 ? (1 + (int)item2.gr5) : 1;
                                        if (ageOf == ageOf4EnumId) item2.gr6 = item2.gr6 != 0 ? (1 + (int)item2.gr6) : 1;
                                        {
                                            if (gender == womanEnumId) item2.gr7 = item2.gr7 != 0 ? (1 + (int)item2.gr7) : 1;
                                        }
                                        if (district == cityEnumId || city == cityEnumId)
                                        {
                                            item2.gr8 = item2.gr8 != 0 ? (1 + (int)item2.gr8) : 1;
                                            if (gender == womanEnumId) item2.gr9 = item2.gr9 != 0 ? (1 + (int)item2.gr9) : 1;
                                            if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                item2.gr10 = item2.gr10 != 0 ? (1 + (int)item2.gr10) : 1;
                                            if (busy != null) item2.gr11 = item2.gr11 != 0 ? (1 + (int)item2.gr11) : 1;
                                        }
                                        if (district == villageEnumId || city == villageEnumId)
                                        {
                                            item2.gr12 = item2.gr12 != 0 ? (1 + (int)item2.gr12) : 1;
                                            if (gender == womanEnumId) item2.gr13 = item2.gr13 != 0 ? (1 + (int)item2.gr13) : 1;
                                            if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                item2.gr14 = item2.gr14 != 0 ? (1 + (int)item2.gr14) : 1;
                                            if (busy != null) item2.gr15 = item2.gr15 != 0 ? (1 + (int)item2.gr15) : 1;
                                        }
                                    }
                                    //временно нетрудоспособные
                                    if (group == disabledTemp)
                                    {
                                        item3.gr1 = item3.gr1 != 0 ? (1 + (int)item3.gr1) : 1;
                                        if (gender == womanEnumId) item3.gr2 = item3.gr2 != 0 ? (1 + (int)item3.gr2) : 1;
                                        if (ageOf == ageOf1EnumId) item3.gr3 = item3.gr3 != 0 ? (1 + (int)item3.gr3) : 1;
                                        if (ageOf == ageOf2EnumId) item3.gr4 = item3.gr4 != 0 ? (1 + (int)item3.gr4) : 1;
                                        if (ageOf == ageOf3EnumId) item3.gr5 = item3.gr5 != 0 ? (1 + (int)item3.gr5) : 1;
                                        if (ageOf == ageOf4EnumId) item3.gr6 = item3.gr6 != 0 ? (1 + (int)item3.gr6) : 1;
                                        {
                                            if (gender == womanEnumId) item3.gr7 = item3.gr7 != 0 ? (1 + (int)item3.gr7) : 1;
                                        }
                                        if (district == cityEnumId || city == cityEnumId)
                                        {
                                            item3.gr8 = item3.gr8 != 0 ? (1 + (int)item3.gr8) : 1;
                                            if (gender == womanEnumId) item3.gr9 = item3.gr9 != 0 ? (1 + (int)item3.gr9) : 1;
                                            if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                item3.gr10 = item3.gr10 != 0 ? (1 + (int)item3.gr10) : 1;
                                            if (busy != null) item3.gr11 = item3.gr11 != 0 ? (1 + (int)item3.gr11) : 1;
                                        }
                                        if (district == villageEnumId || city == villageEnumId)
                                        {
                                            item3.gr12 = item3.gr12 != 0 ? (1 + (int)item3.gr12) : 1;
                                            if (gender == womanEnumId) item3.gr13 = item3.gr13 != 0 ? (1 + (int)item3.gr13) : 1;
                                            if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                item3.gr14 = item3.gr14 != 0 ? (1 + (int)item3.gr14) : 1;
                                            if (busy != null) item3.gr15 = item3.gr15 != 0 ? (1 + (int)item3.gr15) : 1;
                                        }
                                    }
                                    if (groupInvalId.Contains(group))
                                    {
                                        item4.gr1 = item4.gr1 != 0 ? (1 + (int)item4.gr1) : 1;
                                        if (gender == womanEnumId) item4.gr2 = item4.gr2 != 0 ? (1 + (int)item4.gr2) : 1;
                                        if (ageOf == ageOf1EnumId) item4.gr3 = item4.gr3 != 0 ? (1 + (int)item4.gr3) : 1;
                                        if (ageOf == ageOf2EnumId) item4.gr4 = item4.gr4 != 0 ? (1 + (int)item4.gr4) : 1;
                                        if (ageOf == ageOf3EnumId) item4.gr5 = item4.gr5 != 0 ? (1 + (int)item4.gr5) : 1;
                                        if (ageOf == ageOf4EnumId) item4.gr6 = item4.gr6 != 0 ? (1 + (int)item4.gr6) : 1;
                                        {
                                            if (gender == womanEnumId) item4.gr7 = item4.gr7 != 0 ? (1 + (int)item4.gr7) : 1;
                                        }
                                        if (district == cityEnumId || city == cityEnumId)
                                        {
                                            item4.gr8 = item4.gr8 != 0 ? (1 + (int)item4.gr8) : 1;
                                            if (gender == womanEnumId) item4.gr9 = item4.gr9 != 0 ? (1 + (int)item4.gr9) : 1;
                                            if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                item4.gr10 = item4.gr10 != 0 ? (1 + (int)item4.gr10) : 1;
                                            if (busy != null) item4.gr11 = item4.gr11 != 0 ? (1 + (int)item4.gr11) : 1;
                                        }
                                        if (district == villageEnumId || city == villageEnumId)
                                        {
                                            item4.gr12 = item4.gr12 != 0 ? (1 + (int)item4.gr12) : 1;
                                            if (gender == womanEnumId) item4.gr13 = item4.gr13 != 0 ? (1 + (int)item4.gr13) : 1;
                                            if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                item4.gr14 = item4.gr14 != 0 ? (1 + (int)item4.gr14) : 1;
                                            if (busy != null) item4.gr15 = item4.gr15 != 0 ? (1 + (int)item4.gr15) : 1;
                                        }
                                        if (group == group1EnumId)
                                        {
                                            item5.gr1 = item5.gr1 != 0 ? (1 + (int)item5.gr1) : 1;
                                            if (gender == womanEnumId) item5.gr2 = item5.gr2 != 0 ? (1 + (int)item5.gr2) : 1;
                                            if (ageOf == ageOf1EnumId) item5.gr3 = item5.gr3 != 0 ? (1 + (int)item5.gr3) : 1;
                                            if (ageOf == ageOf2EnumId) item5.gr4 = item5.gr4 != 0 ? (1 + (int)item5.gr4) : 1;
                                            if (ageOf == ageOf3EnumId) item5.gr5 = item5.gr5 != 0 ? (1 + (int)item5.gr5) : 1;
                                            if (ageOf == ageOf4EnumId) item5.gr6 = item5.gr6 != 0 ? (1 + (int)item5.gr6) : 1;
                                            {
                                                if (gender == womanEnumId) item5.gr7 = item5.gr7 != 0 ? (1 + (int)item5.gr7) : 1;
                                            }
                                            if (district == cityEnumId || city == cityEnumId)
                                            {
                                                item5.gr8 = item5.gr8 != 0 ? (1 + (int)item5.gr8) : 1;
                                                if (gender == womanEnumId) item5.gr9 = item5.gr9 != 0 ? (1 + (int)item5.gr9) : 1;
                                                if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                    item5.gr10 = item5.gr10 != 0 ? (1 + (int)item5.gr10) : 1;
                                                if (busy != null) item5.gr11 = item5.gr11 != 0 ? (1 + (int)item5.gr11) : 1;
                                            }
                                            if (district == villageEnumId || city == villageEnumId)
                                            {
                                                item5.gr12 = item5.gr12 != 0 ? (1 + (int)item5.gr12) : 1;
                                                if (gender == womanEnumId) item5.gr13 = item5.gr13 != 0 ? (1 + (int)item5.gr13) : 1;
                                                if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                    item5.gr14 = item5.gr14 != 0 ? (1 + (int)item5.gr14) : 1;
                                                if (busy != null) item5.gr15 = item5.gr15 != 0 ? (1 + (int)item5.gr15) : 1;
                                            }
                                        }
                                        if (group == group2EnumId)
                                        {
                                            item6.gr1 = item6.gr1 != 0 ? (1 + (int)item6.gr1) : 1;
                                            if (gender == womanEnumId) item6.gr2 = item6.gr2 != 0 ? (1 + (int)item6.gr2) : 1;
                                            if (ageOf == ageOf1EnumId) item6.gr3 = item6.gr3 != 0 ? (1 + (int)item6.gr3) : 1;
                                            if (ageOf == ageOf2EnumId) item6.gr4 = item6.gr4 != 0 ? (1 + (int)item6.gr4) : 1;
                                            if (ageOf == ageOf3EnumId) item6.gr5 = item6.gr5 != 0 ? (1 + (int)item6.gr5) : 1;
                                            if (ageOf == ageOf4EnumId) item6.gr6 = item6.gr6 != 0 ? (1 + (int)item6.gr6) : 1;
                                            {
                                                if (gender == womanEnumId) item6.gr7 = item6.gr7 != 0 ? (1 + (int)item6.gr7) : 1;
                                            }
                                            if (district == cityEnumId || city == cityEnumId)
                                            {
                                                item6.gr8 = item6.gr8 != 0 ? (1 + (int)item6.gr8) : 1;
                                                if (gender == womanEnumId) item6.gr9 = item6.gr9 != 0 ? (1 + (int)item6.gr9) : 1;
                                                if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                    item6.gr10 = item6.gr10 != 0 ? (1 + (int)item6.gr10) : 1;
                                                if (busy != null) item6.gr11 = item6.gr11 != 0 ? (1 + (int)item6.gr11) : 1;
                                            }
                                            if (district == villageEnumId || city == villageEnumId)
                                            {
                                                item6.gr12 = item6.gr12 != 0 ? (1 + (int)item6.gr12) : 1;
                                                if (gender == womanEnumId) item6.gr13 = item6.gr13 != 0 ? (1 + (int)item6.gr13) : 1;
                                                if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                    item6.gr14 = item6.gr14 != 0 ? (1 + (int)item6.gr14) : 1;
                                                if (busy != null) item6.gr15 = item6.gr15 != 0 ? (1 + (int)item6.gr15) : 1;
                                            }
                                        }
                                        if (group == group3EnumId)
                                        {
                                            item7.gr1 = item7.gr1 != 0 ? (1 + (int)item7.gr1) : 1;
                                            if (gender == womanEnumId) item7.gr2 = item7.gr2 != 0 ? (1 + (int)item7.gr2) : 1;
                                            if (ageOf == ageOf1EnumId) item7.gr3 = item7.gr3 != 0 ? (1 + (int)item7.gr3) : 1;
                                            if (ageOf == ageOf2EnumId) item7.gr4 = item7.gr4 != 0 ? (1 + (int)item7.gr4) : 1;
                                            if (ageOf == ageOf3EnumId) item7.gr5 = item7.gr5 != 0 ? (1 + (int)item7.gr5) : 1;
                                            if (ageOf == ageOf4EnumId) item7.gr6 = item7.gr6 != 0 ? (1 + (int)item7.gr6) : 1;
                                            {
                                                if (gender == womanEnumId) item7.gr7 = item7.gr7 != 0 ? (1 + (int)item7.gr7) : 1;
                                            }
                                            if (district == cityEnumId || city == cityEnumId)
                                            {
                                                item7.gr8 = item7.gr8 != 0 ? (1 + (int)item7.gr8) : 1;
                                                if (gender == womanEnumId) item7.gr9 = item7.gr9 != 0 ? (1 + (int)item7.gr9) : 1;
                                                if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                    item7.gr10 = item7.gr10 != 0 ? (1 + (int)item7.gr10) : 1;
                                                if (busy != null) item7.gr11 = item7.gr11 != 0 ? (1 + (int)item7.gr11) : 1;
                                            }
                                            if (district == villageEnumId || city == villageEnumId)
                                            {
                                                item7.gr12 = item7.gr12 != 0 ? (1 + (int)item7.gr12) : 1;
                                                if (gender == womanEnumId) item7.gr13 = item7.gr13 != 0 ? (1 + (int)item7.gr13) : 1;
                                                if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                    item7.gr14 = item7.gr14 != 0 ? (1 + (int)item7.gr14) : 1;
                                                if (busy != null) item7.gr15 = item7.gr15 != 0 ? (1 + (int)item7.gr15) : 1;
                                            }
                                        }
                                        //вследствии трудового увечья
                                        if (reason == reasonDisEnumdId3 && groupInvalId.Contains(group))
                                        {
                                            //item4.gr1 = item4.gr1 != 0 ? (1 + (int)item4.gr1) : 1;
                                            item8.gr1 = item8.gr1 != 0 ? (1 + (int)item8.gr1) : 1;
                                            if (gender == womanEnumId) item8.gr2 = item8.gr2 != 0 ? (1 + (int)item8.gr2) : 1;
                                            if (ageOf == ageOf1EnumId) item8.gr3 = item8.gr3 != 0 ? (1 + (int)item8.gr3) : 1;
                                            if (ageOf == ageOf2EnumId) item8.gr4 = item8.gr4 != 0 ? (1 + (int)item8.gr4) : 1;
                                            if (ageOf == ageOf3EnumId) item8.gr5 = item8.gr5 != 0 ? (1 + (int)item8.gr5) : 1;
                                            if (ageOf == ageOf4EnumId) item8.gr6 = item8.gr6 != 0 ? (1 + (int)item8.gr6) : 1;
                                            {
                                                if (gender == womanEnumId) item8.gr7 = item8.gr7 != 0 ? (1 + (int)item8.gr7) : 1;
                                            }
                                            if (district == cityEnumId || city == cityEnumId)
                                            {
                                                item8.gr8 = item8.gr8 != 0 ? (1 + (int)item8.gr8) : 1;
                                                if (gender == womanEnumId) item8.gr9 = item8.gr9 != 0 ? (1 + (int)item8.gr9) : 1;
                                                if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                    item8.gr10 = item8.gr10 != 0 ? (1 + (int)item8.gr10) : 1;
                                                if (busy != null) item8.gr11 = item8.gr11 != 0 ? (1 + (int)item8.gr11) : 1;
                                            }
                                            if (district == villageEnumId || city == villageEnumId)
                                            {
                                                item8.gr12 = item8.gr12 != 0 ? (1 + (int)item8.gr12) : 1;
                                                if (gender == womanEnumId) item8.gr13 = item8.gr13 != 0 ? (1 + (int)item8.gr13) : 1;
                                                if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                    item8.gr14 = item8.gr14 != 0 ? (1 + (int)item8.gr14) : 1;
                                                if (busy != null) item8.gr15 = item8.gr15 != 0 ? (1 + (int)item8.gr15) : 1;
                                            }
                                        }
                                        //проф. заболевания
                                        if (reason == reasonDisEnumdId4 && groupInvalId.Contains(group))
                                        {
                                            //item4.gr1 = item4.gr1 != 0 ? (1 + (int)item4.gr1) : 1;
                                            item9.gr1 = item9.gr1 != 0 ? (1 + (int)item9.gr1) : 1;
                                            if (gender == womanEnumId) item9.gr2 = item9.gr2 != 0 ? (1 + (int)item9.gr2) : 1;
                                            if (ageOf == ageOf1EnumId) item9.gr3 = item9.gr3 != 0 ? (1 + (int)item9.gr3) : 1;
                                            if (ageOf == ageOf2EnumId) item9.gr4 = item9.gr4 != 0 ? (1 + (int)item9.gr4) : 1;
                                            if (ageOf == ageOf3EnumId) item9.gr5 = item9.gr5 != 0 ? (1 + (int)item9.gr5) : 1;
                                            if (ageOf == ageOf4EnumId) item9.gr6 = item9.gr6 != 0 ? (1 + (int)item9.gr6) : 1;
                                            {
                                                if (gender == womanEnumId) item9.gr7 = item9.gr7 != 0 ? (1 + (int)item9.gr7) : 1;
                                            }
                                            if (district == cityEnumId || city == cityEnumId)
                                            {
                                                item9.gr8 = item9.gr8 != 0 ? (1 + (int)item9.gr8) : 1;
                                                if (gender == womanEnumId) item9.gr9 = item9.gr9 != 0 ? (1 + (int)item9.gr9) : 1;
                                                if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                    item9.gr10 = item9.gr10 != 0 ? (1 + (int)item9.gr10) : 1;
                                                if (busy != null) item9.gr11 = item9.gr11 != 0 ? (1 + (int)item9.gr11) : 1;
                                            }
                                            if (district == villageEnumId || city == villageEnumId)
                                            {
                                                item9.gr12 = item9.gr12 != 0 ? (1 + (int)item9.gr12) : 1;
                                                if (gender == womanEnumId) item9.gr13 = item9.gr13 != 0 ? (1 + (int)item9.gr13) : 1;
                                                if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                    item9.gr14 = item9.gr14 != 0 ? (1 + (int)item9.gr14) : 1;
                                                if (busy != null) item9.gr15 = item9.gr15 != 0 ? (1 + (int)item9.gr15) : 1;
                                            }
                                        }
                                        //общее заболевания
                                        if (reason == reasonDisEnumdId1 && groupInvalId.Contains(group))
                                        {
                                            //item4.gr1 = item4.gr1 != 0 ? (1 + (int)item4.gr1) : 1;
                                            item10.gr1 = item10.gr1 != 0 ? (1 + (int)item10.gr1) : 1;
                                            if (gender == womanEnumId) item10.gr2 = item10.gr2 != 0 ? (1 + (int)item10.gr2) : 1;
                                            if (ageOf == ageOf1EnumId) item10.gr3 = item10.gr3 != 0 ? (1 + (int)item10.gr3) : 1;
                                            if (ageOf == ageOf2EnumId) item10.gr4 = item10.gr4 != 0 ? (1 + (int)item10.gr4) : 1;
                                            if (ageOf == ageOf3EnumId) item10.gr5 = item10.gr5 != 0 ? (1 + (int)item10.gr5) : 1;
                                            if (ageOf == ageOf4EnumId) item10.gr6 = item10.gr6 != 0 ? (1 + (int)item10.gr6) : 1;
                                            {
                                                if (gender == womanEnumId) item10.gr7 = item10.gr7 != 0 ? (1 + (int)item10.gr7) : 1;
                                            }
                                            if (district == cityEnumId || city == cityEnumId)
                                            {
                                                item10.gr8 = item10.gr8 != 0 ? (1 + (int)item10.gr8) : 1;
                                                if (gender == womanEnumId) item10.gr9 = item10.gr9 != 0 ? (1 + (int)item10.gr9) : 1;
                                                if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                    item10.gr10 = item10.gr10 != 0 ? (1 + (int)item10.gr10) : 1;
                                                if (busy != null) item10.gr11 = item10.gr11 != 0 ? (1 + (int)item10.gr11) : 1;
                                            }
                                            if (district == villageEnumId || city == villageEnumId)
                                            {
                                                item10.gr12 = item10.gr12 != 0 ? (1 + (int)item10.gr12) : 1;
                                                if (gender == womanEnumId) item10.gr13 = item10.gr13 != 0 ? (1 + (int)item10.gr13) : 1;
                                                if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                    item10.gr14 = item10.gr14 != 0 ? (1 + (int)item10.gr14) : 1;
                                                if (busy != null) item10.gr15 = item10.gr15 != 0 ? (1 + (int)item10.gr15) : 1;
                                            }
                                            //11.1 item11
                                            //11.2 item12
                                        }
                                        //ЛОВЗ с детства
                                        if (reason == reasonDisEnumdId2 && groupInvalId.Contains(group))
                                        {
                                            //item4.gr1 = item4.gr1 != 0 ? (1 + (int)item4.gr1) : 1;
                                            item13.gr1 = item13.gr1 != 0 ? (1 + (int)item13.gr1) : 1;
                                            if (gender == womanEnumId) item13.gr2 = item13.gr2 != 0 ? (1 + (int)item13.gr2) : 1;
                                            if (ageOf == ageOf1EnumId) item13.gr3 = item13.gr3 != 0 ? (1 + (int)item13.gr3) : 1;
                                            if (ageOf == ageOf2EnumId) item13.gr4 = item13.gr4 != 0 ? (1 + (int)item13.gr4) : 1;
                                            if (ageOf == ageOf3EnumId) item13.gr5 = item13.gr5 != 0 ? (1 + (int)item13.gr5) : 1;
                                            if (ageOf == ageOf4EnumId) item13.gr6 = item13.gr6 != 0 ? (1 + (int)item13.gr6) : 1;
                                            {
                                                if (gender == womanEnumId) item13.gr7 = item13.gr7 != 0 ? (1 + (int)item13.gr7) : 1;
                                            }
                                            if (district == cityEnumId || city == cityEnumId)
                                            {
                                                item13.gr8 = item13.gr8 != 0 ? (1 + (int)item13.gr8) : 1;
                                                if (gender == womanEnumId) item13.gr9 = item13.gr9 != 0 ? (1 + (int)item13.gr9) : 1;
                                                if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                    item13.gr10 = item13.gr10 != 0 ? (1 + (int)item13.gr10) : 1;
                                                if (busy != null) item13.gr11 = item13.gr11 != 0 ? (1 + (int)item13.gr11) : 1;
                                            }
                                            if (district == villageEnumId || city == villageEnumId)
                                            {
                                                item13.gr12 = item13.gr12 != 0 ? (1 + (int)item13.gr12) : 1;
                                                if (gender == womanEnumId) item13.gr13 = item13.gr13 != 0 ? (1 + (int)item13.gr13) : 1;
                                                if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                    item13.gr14 = item13.gr14 != 0 ? (1 + (int)item13.gr14) : 1;
                                                if (busy != null) item13.gr15 = item13.gr15 != 0 ? (1 + (int)item13.gr15) : 1;
                                            }
                                        }
                                        //инвал. из числа военно служащих
                                        if (reason == reasonDisEnumdId5 || reason == reasonDisEnumdId6 || reason == reasonDisEnumdId11 && groupInvalId.Contains(group))
                                        {
                                            //item4.gr1 = item4.gr1 != 0 ? (1 + (int)item4.gr1) : 1;
                                            if (gender == womanEnumId) item14.gr2 = item14.gr2 != 0 ? (1 + (int)item14.gr2) : 1;
                                            if (ageOf == ageOf1EnumId) item14.gr3 = item14.gr3 != 0 ? (1 + (int)item14.gr3) : 1;
                                            if (ageOf == ageOf2EnumId) item14.gr4 = item14.gr4 != 0 ? (1 + (int)item14.gr4) : 1;
                                            if (ageOf == ageOf3EnumId) item14.gr5 = item14.gr5 != 0 ? (1 + (int)item14.gr5) : 1;
                                            if (ageOf == ageOf4EnumId) item14.gr6 = item14.gr6 != 0 ? (1 + (int)item14.gr6) : 1;
                                            {
                                                if (gender == womanEnumId) item14.gr7 = item14.gr7 != 0 ? (1 + (int)item14.gr7) : 1;
                                            }
                                            if (district == cityEnumId || city == cityEnumId)
                                            {
                                                item14.gr8 = item14.gr8 != 0 ? (1 + (int)item14.gr8) : 1;
                                                if (gender == womanEnumId) item14.gr9 = item14.gr9 != 0 ? (1 + (int)item14.gr9) : 1;
                                                if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                    item14.gr10 = item14.gr10 != 0 ? (1 + (int)item14.gr10) : 1;
                                                if (busy != null) item14.gr11 = item14.gr11 != 0 ? (1 + (int)item14.gr11) : 1;
                                            }
                                            if (district == villageEnumId || city == villageEnumId)
                                            {
                                                item14.gr12 = item14.gr12 != 0 ? (1 + (int)item14.gr12) : 1;
                                                if (gender == womanEnumId) item14.gr13 = item14.gr13 != 0 ? (1 + (int)item14.gr13) : 1;
                                                if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                    item14.gr14 = item14.gr14 != 0 ? (1 + (int)item14.gr14) : 1;
                                                if (busy != null) item14.gr15 = item14.gr15 != 0 ? (1 + (int)item14.gr15) : 1;
                                            }
                                            //item15 ВОВ
                                            if (reason == reasonDisEnumdId11)
                                            {
                                                item14.gr1 = item14.gr1 != 0 ? (1 + (int)item14.gr1) : 1;
                                                item16.gr1 = item16.gr1 != 0 ? (1 + (int)item16.gr1) : 1;
                                                if (gender == womanEnumId) item16.gr2 = item16.gr2 != 0 ? (1 + (int)item16.gr2) : 1;
                                                if (ageOf == ageOf1EnumId) item16.gr3 = item16.gr3 != 0 ? (1 + (int)item16.gr3) : 1;
                                                if (ageOf == ageOf2EnumId) item16.gr4 = item16.gr4 != 0 ? (1 + (int)item16.gr4) : 1;
                                                if (ageOf == ageOf3EnumId) item16.gr5 = item16.gr5 != 0 ? (1 + (int)item16.gr5) : 1;
                                                if (ageOf == ageOf4EnumId) item16.gr6 = item16.gr6 != 0 ? (1 + (int)item16.gr6) : 1;
                                                {
                                                    if (gender == womanEnumId) item16.gr7 = item16.gr7 != 0 ? (1 + (int)item16.gr7) : 1;
                                                }
                                                if (district == cityEnumId || city == cityEnumId)
                                                {
                                                    item16.gr8 = item16.gr8 != 0 ? (1 + (int)item16.gr8) : 1;
                                                    if (gender == womanEnumId) item16.gr9 = item16.gr9 != 0 ? (1 + (int)item16.gr9) : 1;
                                                    if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                        item16.gr10 = item16.gr10 != 0 ? (1 + (int)item16.gr10) : 1;
                                                    if (busy != null) item16.gr11 = item16.gr11 != 0 ? (1 + (int)item16.gr11) : 1;
                                                }
                                                if (district == villageEnumId || city == villageEnumId)
                                                {
                                                    item16.gr12 = item16.gr12 != 0 ? (1 + (int)item16.gr12) : 1;
                                                    if (gender == womanEnumId) item16.gr13 = item16.gr13 != 0 ? (1 + (int)item16.gr13) : 1;
                                                    if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                        item16.gr14 = item16.gr14 != 0 ? (1 + (int)item16.gr14) : 1;
                                                    if (busy != null) item16.gr15 = item16.gr15 != 0 ? (1 + (int)item16.gr15) : 1;
                                                }
                                            }
                                            //item16
                                            if (reason == reasonDisEnumdId5)
                                            {
                                                item14.gr1 = item14.gr1 != 0 ? (1 + (int)item14.gr1) : 1;
                                                item16.gr1 = item16.gr1 != 0 ? (1 + (int)item16.gr1) : 1;
                                                if (gender == womanEnumId) item16.gr2 = item16.gr2 != 0 ? (1 + (int)item16.gr2) : 1;
                                                if (ageOf == ageOf1EnumId) item16.gr3 = item16.gr3 != 0 ? (1 + (int)item16.gr3) : 1;
                                                if (ageOf == ageOf2EnumId) item16.gr4 = item16.gr4 != 0 ? (1 + (int)item16.gr4) : 1;
                                                if (ageOf == ageOf3EnumId) item16.gr5 = item16.gr5 != 0 ? (1 + (int)item16.gr5) : 1;
                                                if (ageOf == ageOf4EnumId) item16.gr6 = item16.gr6 != 0 ? (1 + (int)item16.gr6) : 1;
                                                {
                                                    if (gender == womanEnumId) item16.gr7 = item16.gr7 != 0 ? (1 + (int)item16.gr7) : 1;
                                                }
                                                if (district == cityEnumId || city == cityEnumId)
                                                {
                                                    item16.gr8 = item16.gr8 != 0 ? (1 + (int)item16.gr8) : 1;
                                                    if (gender == womanEnumId) item16.gr9 = item16.gr9 != 0 ? (1 + (int)item16.gr9) : 1;
                                                    if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                        item16.gr10 = item16.gr10 != 0 ? (1 + (int)item16.gr10) : 1;
                                                    if (busy != null) item16.gr11 = item16.gr11 != 0 ? (1 + (int)item16.gr11) : 1;
                                                }
                                                if (district == villageEnumId || city == villageEnumId)
                                                {
                                                    item16.gr12 = item16.gr12 != 0 ? (1 + (int)item16.gr12) : 1;
                                                    if (gender == womanEnumId) item16.gr13 = item16.gr13 != 0 ? (1 + (int)item16.gr13) : 1;
                                                    if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                        item16.gr14 = item16.gr14 != 0 ? (1 + (int)item16.gr14) : 1;
                                                    if (busy != null) item16.gr15 = item16.gr15 != 0 ? (1 + (int)item16.gr15) : 1;
                                                }
                                            }
                                            if (reason == reasonDisEnumdId6)
                                            {
                                                item14.gr1 = item14.gr1 != 0 ? (1 + (int)item14.gr1) : 1;
                                                item17.gr1 = item17.gr1 != 0 ? (1 + (int)item17.gr1) : 1;
                                                if (gender == womanEnumId) item17.gr2 = item17.gr2 != 0 ? (1 + (int)item17.gr2) : 1;
                                                if (ageOf == ageOf1EnumId) item17.gr3 = item17.gr3 != 0 ? (1 + (int)item17.gr3) : 1;
                                                if (ageOf == ageOf2EnumId) item17.gr4 = item17.gr4 != 0 ? (1 + (int)item17.gr4) : 1;
                                                if (ageOf == ageOf3EnumId) item17.gr5 = item17.gr5 != 0 ? (1 + (int)item17.gr5) : 1;
                                                if (ageOf == ageOf4EnumId) item17.gr6 = item17.gr6 != 0 ? (1 + (int)item17.gr6) : 1;
                                                {
                                                    if (gender == womanEnumId) item17.gr7 = item17.gr7 != 0 ? (1 + (int)item17.gr7) : 1;
                                                }
                                                if (district == cityEnumId || city == cityEnumId)
                                                {
                                                    item17.gr8 = item17.gr8 != 0 ? (1 + (int)item17.gr8) : 1;
                                                    if (gender == womanEnumId) item17.gr9 = item17.gr9 != 0 ? (1 + (int)item17.gr9) : 1;
                                                    if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                        item17.gr10 = item17.gr10 != 0 ? (1 + (int)item17.gr10) : 1;
                                                    if (busy != null) item17.gr11 = item17.gr11 != 0 ? (1 + (int)item17.gr11) : 1;
                                                }
                                                if (district == villageEnumId || city == villageEnumId)
                                                {
                                                    item17.gr12 = item17.gr12 != 0 ? (1 + (int)item17.gr12) : 1;
                                                    if (gender == womanEnumId) item17.gr13 = item17.gr13 != 0 ? (1 + (int)item17.gr13) : 1;
                                                    if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                        item17.gr14 = item17.gr14 != 0 ? (1 + (int)item17.gr14) : 1;
                                                    if (busy != null) item17.gr15 = item17.gr15 != 0 ? (1 + (int)item17.gr15) : 1;
                                                }
                                            }
                                        }
                                        //ЧАЭС
                                        if (groupInvalId.Contains(group) && reason == reasonDisEnumdId13 || groupInvalId.Contains(group) && reason == reasonDisEnumdId19)
                                        {
                                            //item4.gr1 = item4.gr1 != 0 ? (1 + (int)item4.gr1) : 1;
                                            item18.gr1 = item18.gr1 != 0 ? (1 + (int)item18.gr1) : 1;
                                            if (gender == womanEnumId) item18.gr2 = item18.gr2 != 0 ? (1 + (int)item18.gr2) : 1;
                                            if (ageOf == ageOf1EnumId) item18.gr3 = item18.gr3 != 0 ? (1 + (int)item18.gr3) : 1;
                                            if (ageOf == ageOf2EnumId) item18.gr4 = item18.gr4 != 0 ? (1 + (int)item18.gr4) : 1;
                                            if (ageOf == ageOf3EnumId) item18.gr5 = item18.gr5 != 0 ? (1 + (int)item18.gr5) : 1;
                                            if (ageOf == ageOf4EnumId) item18.gr6 = item18.gr6 != 0 ? (1 + (int)item18.gr6) : 1;
                                            {
                                                if (gender == womanEnumId) item18.gr7 = item18.gr7 != 0 ? (1 + (int)item18.gr7) : 1;
                                            }
                                            if (district == cityEnumId || city == cityEnumId)
                                            {
                                                item18.gr8 = item18.gr8 != 0 ? (1 + (int)item18.gr8) : 1;
                                                if (gender == womanEnumId) item18.gr9 = item18.gr9 != 0 ? (1 + (int)item18.gr9) : 1;
                                                if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                    item18.gr10 = item18.gr10 != 0 ? (1 + (int)item18.gr10) : 1;
                                                if (busy != null) item18.gr11 = item18.gr11 != 0 ? (1 + (int)item18.gr11) : 1;
                                            }
                                            if (district == villageEnumId || city == villageEnumId)
                                            {
                                                item18.gr12 = item18.gr12 != 0 ? (1 + (int)item18.gr12) : 1;
                                                if (gender == womanEnumId) item18.gr13 = item18.gr13 != 0 ? (1 + (int)item18.gr13) : 1;
                                                if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                    item18.gr14 = item18.gr14 != 0 ? (1 + (int)item18.gr14) : 1;
                                                if (busy != null) item18.gr15 = item18.gr15 != 0 ? (1 + (int)item18.gr15) : 1;
                                            }
                                            if (reason == reasonDisEnumdId19)
                                            {
                                                item19.gr1 = item19.gr1 != 0 ? (1 + (int)item19.gr1) : 1;
                                                if (gender == womanEnumId) item19.gr2 = item19.gr2 != 0 ? (1 + (int)item19.gr2) : 1;
                                                if (ageOf == ageOf1EnumId) item19.gr3 = item19.gr3 != 0 ? (1 + (int)item19.gr3) : 1;
                                                if (ageOf == ageOf2EnumId) item19.gr4 = item19.gr4 != 0 ? (1 + (int)item19.gr4) : 1;
                                                if (ageOf == ageOf3EnumId) item19.gr5 = item19.gr5 != 0 ? (1 + (int)item19.gr5) : 1;
                                                if (ageOf == ageOf4EnumId) item19.gr6 = item19.gr6 != 0 ? (1 + (int)item19.gr6) : 1;
                                                {
                                                    if (gender == womanEnumId) item19.gr7 = item19.gr7 != 0 ? (1 + (int)item19.gr7) : 1;
                                                }
                                                if (district == cityEnumId || city == cityEnumId)
                                                {
                                                    item19.gr8 = item19.gr8 != 0 ? (1 + (int)item19.gr8) : 1;
                                                    if (gender == womanEnumId) item19.gr9 = item19.gr9 != 0 ? (1 + (int)item19.gr9) : 1;
                                                    if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                        item19.gr10 = item19.gr10 != 0 ? (1 + (int)item19.gr10) : 1;
                                                    if (busy != null) item19.gr11 = item19.gr11 != 0 ? (1 + (int)item19.gr11) : 1;
                                                }
                                                if (district == villageEnumId || city == villageEnumId)
                                                {
                                                    item19.gr12 = item19.gr12 != 0 ? (1 + (int)item19.gr12) : 1;
                                                    if (gender == womanEnumId) item19.gr13 = item19.gr13 != 0 ? (1 + (int)item19.gr13) : 1;
                                                    if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                        item19.gr14 = item19.gr14 != 0 ? (1 + (int)item19.gr14) : 1;
                                                    if (busy != null) item19.gr15 = item19.gr15 != 0 ? (1 + (int)item19.gr15) : 1;
                                                }
                                            }
                                        }
                                        //бессрочно
                                        if (indef)
                                        {
                                            item20.gr1 = item20.gr1 != 0 ? (1 + (int)item20.gr1) : 1;
                                            if (gender == womanEnumId) item20.gr2 = item20.gr2 != 0 ? (1 + (int)item20.gr2) : 1;
                                            if (ageOf == ageOf1EnumId) item20.gr3 = item20.gr3 != 0 ? (1 + (int)item20.gr3) : 1;
                                            if (ageOf == ageOf2EnumId) item20.gr4 = item20.gr4 != 0 ? (1 + (int)item20.gr4) : 1;
                                            if (ageOf == ageOf3EnumId) item20.gr5 = item20.gr5 != 0 ? (1 + (int)item20.gr5) : 1;
                                            if (ageOf == ageOf4EnumId) item20.gr6 = item20.gr6 != 0 ? (1 + (int)item20.gr6) : 1;
                                            {
                                                if (gender == womanEnumId) item20.gr7 = item20.gr7 != 0 ? (1 + (int)item20.gr7) : 1;
                                            }
                                            if (district == cityEnumId || city == cityEnumId)
                                            {
                                                item20.gr8 = item20.gr8 != 0 ? (1 + (int)item20.gr8) : 1;
                                                if (gender == womanEnumId) item20.gr9 = item20.gr9 != 0 ? (1 + (int)item20.gr9) : 1;
                                                if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                    item20.gr10 = item20.gr10 != 0 ? (1 + (int)item20.gr10) : 1;
                                                if (busy != null) item20.gr11 = item20.gr11 != 0 ? (1 + (int)item20.gr11) : 1;
                                            }
                                            if (district == villageEnumId || city == villageEnumId)
                                            {
                                                item20.gr12 = item20.gr12 != 0 ? (1 + (int)item20.gr12) : 1;
                                                if (gender == womanEnumId) item20.gr13 = item20.gr13 != 0 ? (1 + (int)item20.gr13) : 1;
                                                if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                    item20.gr14 = item20.gr14 != 0 ? (1 + (int)item20.gr14) : 1;
                                                if (busy != null) item20.gr15 = item20.gr15 != 0 ? (1 + (int)item20.gr15) : 1;
                                            }
                                        }                                        
                                    }
                                }
                                //другие цели
                                if (goal1 || goal2 || goal3 || goal4 || goal5 || goal6 || goal7 || goal8 || goal9 != Guid.Empty ||
                                   goal11 || goal12 || goal13 || goal14 || goal15 || goal16 || goal17 || goal18)
                                {
                                    //item0.gr1 = item0.gr1 != 0 ? (1 + (int)item0.gr1) : 1;
                                    item21.gr1 = item21.gr1 != 0 ? (1 + (int)item21.gr1) : 1;
                                    if (gender == womanEnumId) item21.gr2 = item21.gr2 != 0 ? (1 + (int)item21.gr2) : 1;
                                    if (ageOf == ageOf1EnumId) item21.gr3 = item21.gr3 != 0 ? (1 + (int)item21.gr3) : 1;
                                    if (ageOf == ageOf2EnumId) item21.gr4 = item21.gr4 != 0 ? (1 + (int)item21.gr4) : 1;
                                    if (ageOf == ageOf3EnumId) item21.gr5 = item21.gr5 != 0 ? (1 + (int)item21.gr5) : 1;
                                    if (ageOf == ageOf4EnumId) item21.gr6 = item21.gr6 != 0 ? (1 + (int)item21.gr6) : 1;
                                    {
                                        if (gender == womanEnumId) item21.gr7 = item21.gr7 != 0 ? (1 + (int)item21.gr7) : 1;
                                    }
                                    if (district == cityEnumId || city == cityEnumId)
                                    {
                                        item21.gr8 = item21.gr8 != 0 ? (1 + (int)item21.gr8) : 1;
                                        if (gender == womanEnumId) item21.gr9 = item21.gr9 != 0 ? (1 + (int)item21.gr9) : 1;
                                        if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                            item21.gr10 = item21.gr10 != 0 ? (1 + (int)item21.gr10) : 1;
                                        if (busy != null) item21.gr11 = item21.gr11 != 0 ? (1 + (int)item21.gr11) : 1;
                                    }
                                    if (district == villageEnumId || city == villageEnumId)
                                    {
                                        item21.gr12 = item21.gr12 != 0 ? (1 + (int)item21.gr12) : 1;
                                        if (gender == womanEnumId) item21.gr13 = item21.gr13 != 0 ? (1 + (int)item21.gr13) : 1;
                                        if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                            item21.gr14 = item21.gr14 != 0 ? (1 + (int)item21.gr14) : 1;
                                        if (busy != null) item21.gr15 = item21.gr15 != 0 ? (1 + (int)item21.gr15) : 1;
                                    }
                                    if (goal11)
                                    {
                                        item22.gr1 = item22.gr1 != 0 ? (1 + (int)item22.gr1) : 1;
                                        if (gender == womanEnumId) item22.gr2 = item22.gr2 != 0 ? (1 + (int)item22.gr2) : 1;
                                        if (ageOf == ageOf1EnumId) item22.gr3 = item22.gr3 != 0 ? (1 + (int)item22.gr3) : 1;
                                        if (ageOf == ageOf2EnumId) item22.gr4 = item22.gr4 != 0 ? (1 + (int)item22.gr4) : 1;
                                        if (ageOf == ageOf3EnumId) item22.gr5 = item22.gr5 != 0 ? (1 + (int)item22.gr5) : 1;
                                        if (ageOf == ageOf4EnumId) item22.gr6 = item22.gr6 != 0 ? (1 + (int)item22.gr6) : 1;
                                        {
                                            if (gender == womanEnumId) item22.gr7 = item22.gr7 != 0 ? (1 + (int)item22.gr7) : 1;
                                        }
                                        if (district == cityEnumId || city == cityEnumId)
                                        {
                                            item22.gr8 = item22.gr8 != 0 ? (1 + (int)item22.gr8) : 1;
                                            if (gender == womanEnumId) item22.gr9 = item22.gr9 != 0 ? (1 + (int)item22.gr9) : 1;
                                            if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                item22.gr10 = item22.gr10 != 0 ? (1 + (int)item22.gr10) : 1;
                                            if (busy != null) item22.gr11 = item22.gr11 != 0 ? (1 + (int)item22.gr11) : 1;
                                        }
                                        if (district == villageEnumId || city == villageEnumId)
                                        {
                                            item22.gr12 = item22.gr12 != 0 ? (1 + (int)item22.gr12) : 1;
                                            if (gender == womanEnumId) item22.gr13 = item22.gr13 != 0 ? (1 + (int)item22.gr13) : 1;
                                            if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                item22.gr14 = item22.gr14 != 0 ? (1 + (int)item22.gr14) : 1;
                                            if (busy != null) item22.gr15 = item22.gr15 != 0 ? (1 + (int)item22.gr15) : 1;
                                        }
                                    }
                                    if (goal9 != Guid.Empty)
                                    {
                                        item23.gr1 = item23.gr1 != 0 ? (1 + (int)item23.gr1) : 1;
                                        if (gender == womanEnumId) item23.gr2 = item23.gr2 != 0 ? (1 + (int)item23.gr2) : 1;
                                        if (ageOf == ageOf1EnumId) item23.gr3 = item23.gr3 != 0 ? (1 + (int)item23.gr3) : 1;
                                        if (ageOf == ageOf2EnumId) item23.gr4 = item23.gr4 != 0 ? (1 + (int)item23.gr4) : 1;
                                        if (ageOf == ageOf3EnumId) item23.gr5 = item23.gr5 != 0 ? (1 + (int)item23.gr5) : 1;
                                        if (ageOf == ageOf4EnumId) item23.gr6 = item23.gr6 != 0 ? (1 + (int)item23.gr6) : 1;
                                        {
                                            if (gender == womanEnumId) item23.gr7 = item23.gr7 != 0 ? (1 + (int)item23.gr7) : 1;
                                        }
                                        if (district == cityEnumId || city == cityEnumId)
                                        {
                                            item23.gr8 = item23.gr8 != 0 ? (1 + (int)item23.gr8) : 1;
                                            if (gender == womanEnumId) item23.gr9 = item23.gr9 != 0 ? (1 + (int)item23.gr9) : 1;
                                            if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                item23.gr10 = item23.gr10 != 0 ? (1 + (int)item23.gr10) : 1;
                                            if (busy != null) item23.gr11 = item23.gr11 != 0 ? (1 + (int)item23.gr11) : 1;
                                        }
                                        if (district == villageEnumId || city == villageEnumId)
                                        {
                                            item23.gr12 = item23.gr12 != 0 ? (1 + (int)item23.gr12) : 1;
                                            if (gender == womanEnumId) item23.gr13 = item23.gr13 != 0 ? (1 + (int)item23.gr13) : 1;
                                            if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                item23.gr14 = item23.gr14 != 0 ? (1 + (int)item23.gr14) : 1;
                                            if (busy != null) item23.gr15 = item23.gr15 != 0 ? (1 + (int)item23.gr15) : 1;
                                        }
                                    }
                                    if (goal2)
                                    {
                                        item24.gr1 = item24.gr1 != 0 ? (1 + (int)item24.gr1) : 1;
                                        if (gender == womanEnumId) item24.gr2 = item24.gr2 != 0 ? (1 + (int)item24.gr2) : 1;
                                        if (ageOf == ageOf1EnumId) item24.gr3 = item24.gr3 != 0 ? (1 + (int)item24.gr3) : 1;
                                        if (ageOf == ageOf2EnumId) item24.gr4 = item24.gr4 != 0 ? (1 + (int)item24.gr4) : 1;
                                        if (ageOf == ageOf3EnumId) item24.gr5 = item24.gr5 != 0 ? (1 + (int)item24.gr5) : 1;
                                        if (ageOf == ageOf4EnumId) item24.gr6 = item24.gr6 != 0 ? (1 + (int)item24.gr6) : 1;
                                        {
                                            if (gender == womanEnumId) item24.gr7 = item24.gr7 != 0 ? (1 + (int)item24.gr7) : 1;
                                        }
                                        if (district == cityEnumId || city == cityEnumId)
                                        {
                                            item24.gr8 = item24.gr8 != 0 ? (1 + (int)item24.gr8) : 1;
                                            if (gender == womanEnumId) item24.gr9 = item24.gr9 != 0 ? (1 + (int)item24.gr9) : 1;
                                            if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                item24.gr10 = item24.gr10 != 0 ? (1 + (int)item24.gr10) : 1;
                                            if (busy != null) item24.gr11 = item24.gr11 != 0 ? (1 + (int)item24.gr11) : 1;
                                        }
                                        if (district == villageEnumId || city == villageEnumId)
                                        {
                                            item24.gr12 = item24.gr12 != 0 ? (1 + (int)item24.gr12) : 1;
                                            if (gender == womanEnumId) item24.gr13 = item24.gr13 != 0 ? (1 + (int)item24.gr13) : 1;
                                            if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                item24.gr14 = item24.gr14 != 0 ? (1 + (int)item24.gr14) : 1;
                                            if (busy != null) item24.gr15 = item24.gr15 != 0 ? (1 + (int)item24.gr15) : 1;
                                        }
                                    }
                                    if (goal17)
                                    {
                                        item25.gr1 = item25.gr1 != 0 ? (1 + (int)item25.gr1) : 1;
                                        if (gender == womanEnumId) item25.gr2 = item25.gr2 != 0 ? (1 + (int)item25.gr2) : 1;
                                        if (ageOf == ageOf1EnumId) item25.gr3 = item25.gr3 != 0 ? (1 + (int)item25.gr3) : 1;
                                        if (ageOf == ageOf2EnumId) item25.gr4 = item25.gr4 != 0 ? (1 + (int)item25.gr4) : 1;
                                        if (ageOf == ageOf3EnumId) item25.gr5 = item25.gr5 != 0 ? (1 + (int)item25.gr5) : 1;
                                        if (ageOf == ageOf4EnumId) item25.gr6 = item25.gr6 != 0 ? (1 + (int)item25.gr6) : 1;
                                        {
                                            if (gender == womanEnumId) item25.gr7 = item25.gr7 != 0 ? (1 + (int)item25.gr7) : 1;
                                        }
                                        if (district == cityEnumId || city == cityEnumId)
                                        {
                                            item25.gr8 = item25.gr8 != 0 ? (1 + (int)item25.gr8) : 1;
                                            if (gender == womanEnumId) item25.gr9 = item25.gr9 != 0 ? (1 + (int)item25.gr9) : 1;
                                            if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                item25.gr10 = item25.gr10 != 0 ? (1 + (int)item25.gr10) : 1;
                                            if (busy != null) item25.gr11 = item25.gr11 != 0 ? (1 + (int)item25.gr11) : 1;
                                        }
                                        if (district == villageEnumId || city == villageEnumId)
                                        {
                                            item25.gr12 = item25.gr12 != 0 ? (1 + (int)item25.gr12) : 1;
                                            if (gender == womanEnumId) item25.gr13 = item25.gr13 != 0 ? (1 + (int)item25.gr13) : 1;
                                            if (ageOf == ageOf1EnumId || ageOf == ageOf2EnumId || ageOf == ageOf3EnumId)
                                                item25.gr14 = item25.gr14 != 0 ? (1 + (int)item25.gr14) : 1;
                                            if (busy != null) item25.gr15 = item25.gr15 != 0 ? (1 + (int)item25.gr15) : 1;
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            static void RemoveRows(WorkflowContext context, Guid reportId)
            {
                var docRepo = context.Documents;
                var rows = new List<Guid>();
                var qb = new QueryBuilder(reportItemDefId, context.UserId);
                qb.Where("Report").Eq(reportId).Or("Report").IsNull();
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read()) rows.Add(reader.GetGuid(0));
                }
                foreach (var rowId in rows)
                {
                    docRepo.DeleteById(rowId);
                }
            }
            private static readonly Guid reportDefId = new Guid("{17789FEE-2908-4E01-8E16-2ECAF4A75C7A}"); //Отчет о распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности
            private static readonly Guid reportItemDefId = new Guid("{10AB1374-EA9C-493B-B5F6-CD6A40273B9B}"); //Распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности

            private static readonly Guid adultsStatCardDefId = new Guid("{C77A6FF6-EC0B-4562-81FE-BB3BC17F4FDB}"); //Статистический талон для взрослых
            private static readonly Guid adultsActDefId = new Guid("{12AE380B-39CE-4753-A556-4083BD4B0F92}"); //Медицинский акт для взрослых
            private static readonly Guid personDefId = new Guid("{D71CE61A-9B59-4B5E-8713-8131DBB5BA02}"); //Person 
            public static readonly Guid districtDefId = new Guid("{A3FCA356-82A9-4BBD-872A-8333BEC6E41A}"); //Район
            public static readonly Guid cityDefId = new Guid("{4BB6D32D-5181-4031-BA49-CF5910D6D883}"); //Города районного значения

            public static readonly Guid goalForGroup = new Guid("{8FD84B27-FF2A-40A4-A87A-BC254DC9D853}"); //Цель -> Для установления группы

            public static readonly Guid ageOf1EnumId = new Guid("{027AEA0C-3C1D-4354-BEFF-4C89E06AF8B5}"); //От 18-29 лет
            public static readonly Guid ageOf2EnumId = new Guid("{6FC02932-97DD-48B9-93C8-FBD017C86707}"); //От 30-44 лет
            public static readonly Guid ageOf3EnumId = new Guid("{336A7447-4E55-44B8-8BA0-D7A156B7444A}"); //От 45-до пенсионного возраста
            public static readonly Guid ageOf4EnumId = new Guid("{9B207DB0-8214-4BA7-A8C4-635EF87B583A}"); //лицо пенсионного возраста

            public static readonly Guid group1EnumId = new Guid("{D145ABA1-EADA-442B-9D8D-AD10BCD126D2}"); //Первая
            public static readonly Guid group2EnumId = new Guid("{C161DA2D-2883-4211-B444-CBB04DBF33D5}"); //Вторая
            public static readonly Guid group3EnumId = new Guid("{CCD439CA-1500-4F7A-A1C8-BB474B5DE8AA}"); //Третья
            public static readonly Guid notInstalled = new Guid("{C52CCD68-96D8-4E0A-A8ED-30B482C1CF18}"); //Не установлена
            public static readonly Guid disabledTemp = new Guid("{1453DB74-1A01-45FF-B2AA-F20A26DD23D0}"); //Временно нетрудоспособен

            public static readonly Guid cityEnumId = new Guid("{DE3D24A1-64D3-4647-B711-31F334D24416}"); //Городская местность//DistrictType
            public static readonly Guid villageEnumId = new Guid("{65DF9C4D-A18B-4080-855F-4800E2A19C35}"); //Cская местность//DistrictType
            public static readonly Guid womanEnumId = new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"); //Женский пол
            public static readonly Guid primaryEnumId = new Guid("{34129BC5-5B31-4189-87FA-799402F7E99F}"); //Первичное
            public static readonly Guid ApprovedStateId = new Guid("{32062CB7-C31C-4AFB-ADF3-F9F9AEEFCE59}");  //Подписанные

            private static readonly Guid[] groupInvalId = new[]
            {
                new Guid("{D145ABA1-EADA-442B-9D8D-AD10BCD126D2}"),
                new Guid("{C161DA2D-2883-4211-B444-CBB04DBF33D5}"),
                new Guid("{CCD439CA-1500-4F7A-A1C8-BB474B5DE8AA}")
            };
            //причины инвалидности
            private static readonly Guid reasonDisEnumdId1 = new Guid("{3A8053A5-CD06-49D3-A551-2247655B13C3}"); //	Общее заболевание
            private static readonly Guid reasonDisEnumdId2 = new Guid("{9AF55221-0264-4349-9B36-A8E1313250B6}"); //	ЛОВЗ с детства
            private static readonly Guid reasonDisEnumdId3 = new Guid("{2E3209F0-0002-4DA2-9E63-6FAEDDF1983D}"); //	Трудовое увечье
            private static readonly Guid reasonDisEnumdId4 = new Guid("{383E70E5-E9BE-4AE5-B5DF-323D4463DD51}"); //	Профессиональное заболевание
            private static readonly Guid reasonDisEnumdId5 = new Guid("{0CD8E76E-CF20-41CF-B7EE-4FE85EA39435}"); //	Военная травма (если увечье, заболевание получено лицом, проходящим освидетельствование, при "исполнении обязанностей военной службы")
            private static readonly Guid reasonDisEnumdId6 = new Guid("{4A8BC253-701C-44FB-B840-10F6BD8E97BD}"); //	Заболевание "получено в период прохождения военной службы"
            private static readonly Guid reasonDisEnumdId7 = new Guid("{1A607F61-EDDD-4A7B-9FBF-55483127D986}"); //	Заболевание "нет, не связано с военной службой"
            private static readonly Guid reasonDisEnumdId8 = new Guid("{41313E17-2275-4027-9563-5323FF096E3F}"); //	Заболевание "да, получено в период прохождения службы" в органах внутренних дел
            private static readonly Guid reasonDisEnumdId9 = new Guid("{68E6804C-046A-45AD-9AD8-1C50C4026530}"); //	Заболевание "нет, не связано со службой в органах внутренних дел"
            private static readonly Guid reasonDisEnumdId10 = new Guid("{8AA8807E-A40A-44D2-839C-5270E9F2C52C}"); // Ранение (контузия, травма, увечье) "нет, не связано с военной службой"
            private static readonly Guid reasonDisEnumdId11 = new Guid("{04F87DB6-EBB7-4B09-8856-F7DFF538479E}"); //Ранение (контузия, травма, увечье) "да, получено при защите СССР"
            private static readonly Guid reasonDisEnumdId12 = new Guid("{119DC79B-42D0-4102-AE42-A902A4EF806B}"); // Ранение (контузия, травма, увечье) "да, получено при исполнении обязанностей службы в органах внутренних дел"
            private static readonly Guid reasonDisEnumdId13 = new Guid("{A6EABF70-F864-4A97-B528-839DE6607B07}"); // Заболевание связано с катастрофой на ЧАЭС
            private static readonly Guid reasonDisEnumdId14 = new Guid("{9FB37C19-2251-41FD-ABAA-7E3CD243CCDF}"); // Заболевание связано с испытанием ядерного оружия на Семипалатинском полигоне
            private static readonly Guid reasonDisEnumdId15 = new Guid("{1A2B628F-CC8C-49C9-8774-561EB1812AE5}"); // Травма, полученная в событиях, произошедших 6 апреля 2010 года в Таласской области КР
            private static readonly Guid reasonDisEnumdId16 = new Guid("{6FF1C743-3767-4D73-A035-1F8647C88F5F}"); // Травма, полученная в событиях, произошедших 7 апреля 2010 года в городе Бишкек КР
            private static readonly Guid reasonDisEnumdId17 = new Guid("{9289772B-C917-4EC0-BC60-45D69BA8D855}"); // Травма, полученная в событиях, произошедших 13-14, а также 19 мая 2010 года в городе Джалал-Абад КР
            private static readonly Guid reasonDisEnumdId18 = new Guid("{99159F4A-BB7C-4A5C-AD48-B71E7592DF08}"); // Травма, полученная в июньских событиях 2010 года в городе Ош и Ошской, Джалал-Абадской областях КР
            private static readonly Guid reasonDisEnumdId19 = new Guid("{BED228E4-3615-46CC-9D58-3C71B95FBC8D}"); // Травма, получена при исполнении обязанностей военной службы (служебных обязанностей), связана с работами по ликвидации последствий катастрофы на ЧАЭС (других ядерных объектах)
        }

        //Отчет о результатах первичных освидетельствований всех социальных категорий населения (ГОРОДСКАЯ МЕСТНОСТЬ) 
        public static class PrimaryInvalidsOfCity
        {
            public static List<Report1Item> Execute(WorkflowContext context, int year, string distrSpr)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;

                /******************************************************************************************************************/
                var docs = new string[]
                {
                    "всего  01           ",
                    "в том числе: туберкулез  02   А15-19  ",
                    "из них: туберкулез легких  02.1 А15-16  ",
                    "злокачественные новообразования  03   С00-97  ",
                    "б-ни эндокринной с-мы, нар-я обмена веществ  04   Е00-90  ",
                    "из них: заболевания щитовидной железы  04.1 Е00-07  ",
                    "сахарный диабет  04.2 Е10-14  ",
                    "психич-ие расстройства  05   F 00-99 ",
                    "из них шизофрения  05.1 F 20    ",
                    "умственная отсталость  05.2 F 70-79 ",
                    "болезни нервной системы  06   G 00-99 ",
                    "из них: болезни перифери-ческой нервной системы  06.1 G 60-64 ",
                    "болезни органов чувств  07   H 00-95 ",
                    "болезни глаз  07.1 H 00-59 ",
                    "болезни уха и сосцевидного отростка  07.2 H 60-95 ",
                    "болезни системы кровообращения  08   I 00-99 ",
                    "из них: хронические ревматические б-и сердца  08.1 I 05-09 ",
                    "болезни, характеризующиеся повышенным кровяным давлением  08.2 I 10-15 ",
                    "ишемическая болезнь сердца  08.3 I 20-25 ",
                    "цереброваскулярные болезни  08.4 I 60-69 ",
                    "врожденные пороки сердца  09   Q 20-28 ",
                    "болезни органов дыхания  10   J 00-99 ",
                    "из них бронхиальная астма  10.1 J 45    ",
                    "болезни органов пищеварения  11   K 00-93 ",
                    "болезни костно-мышечной системы и соединительной ткани  12   M00-99 ",
                    "из них: ревматоидные  12.1 M05-14  ",
                    "остеохондроз позвоночника  12.2 M 42    ",
                    "болезни мочевывоводящих органов  13   N 00-99 ",
                    "травмы, отравления и другие воздействия внешних причин  14   S 00-Т98",
                    "травма глаз  14.1 S 05    ",
                    "б-ни вследствие возд-я ионизирующего облучения  15   W 88    ",
                    "б-ни вследствие воздействия вибрации  16   W 43    ",
                    "болезни крови  17   D 50-89 ",
                    "доброкачественные новообразования  18   D 10-36 ",
                    "бруцеллез  19   A 23    ",
                    "бруцеллез бытовой  19.1 A 23    ",
                    "эхинококкоз  20   B 67    ",
                    "врожд пороки развития, хромосомные нарушения  21   Q 00-99 ",
                    "болезни вызванные вирусом  ВИЧ (СПИД)  22   B 20-24 ",
                    "прочие болезни  23           ",
                    "по причинам (24, 25, 26 не выходят в строки 01)              ",
                    "трудовое увечье  24           ",
                    "профессиональные болезни  25           ",
                    "ликвидаторы последствий аварии на ЧАЭС  26           ",
                    "Пострадавшие в апрельских событиях 2010 год  27           ",
                    "Пострадавшие в майских и июньских событиях 2010 год  28           "
                };
                var items = new List<Report1Item>();
                int i2 = 1;
                foreach (var i in docs)
                {
                    var item = new Report1Item();
                    item.RowType = i;
                    item.RowNo = i2;
                    i2++;
                    items.Add(item);
                }
                CalcItems(context, /*report, */year, orgId, distrSpr,
                    items[45], items[44], items[43], items[42], items[41], items[40], items[39],
                    items[38], items[37], items[36], items[35], items[34], items[33], items[32],
                    items[31], items[30], items[29], items[28], items[27], items[26], items[25],
                    items[24], items[23], items[22], items[21], items[20], items[19], items[18],
                    items[17], items[16], items[15], items[14], items[13], items[12], items[11],
                    items[10], items[9], items[8], items[7], items[6], items[5], items[4],
                    items[3], items[2], items[1], items[0]);
                return items;
            }
            public static void CalcItems(WorkflowContext context, int year, Guid orgId, string distrSpr,
                    Report1Item item45, Report1Item item44, Report1Item item43, Report1Item item42,
                    Report1Item item41, Report1Item item40_1, Report1Item item40, Report1Item item39,
                    Report1Item item38, Report1Item item37, Report1Item item36, Report1Item item35, Report1Item item34,
                    Report1Item item33, Report1Item item32, Report1Item item31, Report1Item item30,
                    Report1Item item29, Report1Item item28, Report1Item item27, Report1Item item26,
                    Report1Item item25, Report1Item item24, Report1Item item23, Report1Item item22,
                    Report1Item item21, Report1Item item20, Report1Item item19, Report1Item item18,
                    Report1Item item17, Report1Item item16, Report1Item item15, Report1Item item14,
                    Report1Item item13, Report1Item item12, Report1Item item11, Report1Item item10,
                    Report1Item item9, Report1Item item8, Report1Item item7, Report1Item item6,
                    Report1Item item5, Report1Item item4, Report1Item item3, Report1Item item2,
                    Report1Item item1)
            {
                var qb = new QueryBuilder(adultsStatCardDefId, context.UserId);
                qb.Where("&State").Eq(ApprovedStateId).And("Examination1").Eq(primaryEnumId);

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                    var actSrc = query.JoinSource(query.Source, adultsActDefId, SqlSourceJoinType.Inner, "AdultsMedicalCertificate");
                    var distrSrc = query.JoinSource(actSrc, districtDefId, SqlSourceJoinType.LeftOuter, "DistrictId");
                    var citySrc = query.JoinSource(actSrc, cityDefId, SqlSourceJoinType.LeftOuter, "CityId");
                    query.AddCondition(ExpressionOperation.And, adultsStatCardDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    if (!string.IsNullOrEmpty(distrSpr))
                        query.AddCondition(ExpressionOperation.And, districtDefId, "NumberDis", ConditionOperation.Equal, distrSpr);

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(query.Source, "EndDateExamination");
                    query.AddAttribute(query.Source, "AgeOf");
                    query.AddAttribute(query.Source, "DisabilityGroup");
                    query.AddAttribute(query.Source, "PlaceWork");
                    query.AddAttribute(query.Source, "Diagnosis");
                    query.AddAttribute(distrSrc, "DistrictType");
                    query.AddAttribute(citySrc, "DistrictType");
                    query.AddAttribute(personSrc, "Gender");

                    var table = new DataTable();
                    using (var reader = context.CreateSqlReader(query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var date = !(row[1] is DBNull) ? (DateTime)row[1] : DateTime.MinValue;
                        var ageOf = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                        var group = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                        var bysy = row[4] is DBNull ? "" : row[4].ToString();
                        var diagnos = row[5] is DBNull ? Guid.Empty : (Guid)row[5];
                        var district = row[6] is DBNull ? Guid.Empty : (Guid)row[6];
                        var city = row[7] is DBNull ? Guid.Empty : (Guid)row[7];
                        var gender = row[8] is DBNull ? Guid.Empty : (Guid)row[8];

                        if (appId != Guid.Empty)
                        {
                            if (date.Year == year && (district == cityEnumId) ||
                                date.Year == year && (city == cityEnumId))
                            {
                                item1.Total = item1.Total != 0 ? (1 + (int)item1.Total) : 1;

                                if (gender == womanEnumId)
                                {
                                    item1.WomenAll = item1.WomenAll != 0 ? (1 + (int)item1.WomenAll) : 1;
                                }
                                //в том числе в возрасте
                                /*****************************************************************************************************************************/
                                if (ageOf == ageOf1EnumId)
                                {
                                    item1.Total1829 = item1.Total1829 != 0 ? (1 + (int)item1.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item1.Women1829 = item1.Women1829 != 0 ? (1 + (int)item1.Women1829) : 1;
                                    }
                                }
                                if (ageOf == ageOf2EnumId)
                                {
                                    item1.Total3040 = item1.Total3040 != 0 ? (1 + (int)item1.Total3040) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item1.Women3040 = item1.Women3040 != 0 ? (1 + (int)item1.Women3040) : 1;
                                    }
                                }
                                if (ageOf == ageOf3EnumId)
                                {
                                    item1.Total45 = item1.Total45 != 0 ? (1 + (int)item1.Total45) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item1.Women45 = item1.Women45 != 0 ? (1 + (int)item1.Women45) : 1;
                                    }
                                }
                                if (ageOf == ageOf4EnumId)
                                {
                                    item1.TotalPersonsAge = item1.TotalPersonsAge != 0 ? (1 + (int)item1.TotalPersonsAge) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item1.WomenPersonsAge = item1.WomenPersonsAge != 0 ? (1 + (int)item1.WomenPersonsAge) : 1;
                                    }
                                }
                                //Из общего числа признанных ЛОВЗ                                
                                if (group == group1EnumId)
                                {
                                    item1.FirstGroupAll = item1.FirstGroupAll != 0 ? (1 + (int)item1.FirstGroupAll) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item1.WomenFirstGroup = item1.WomenFirstGroup != 0 ? (1 + (int)item1.WomenFirstGroup) : 1;
                                    }
                                    if (bysy != null)
                                    {
                                        item1.BusyFirstGroup = item1.BusyFirstGroup != 0 ? (1 + (int)item1.BusyFirstGroup) : 1;
                                    }
                                }
                                if (group == group2EnumId)
                                {
                                    item1.SecondGroupAll = item1.SecondGroupAll != 0 ? (1 + (int)item1.SecondGroupAll) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item1.WomenSecondGroup = item1.WomenSecondGroup != 0 ? (1 + (int)item1.WomenSecondGroup) : 1;
                                    }
                                    if (bysy != null)
                                    {
                                        item1.BusySecondGroup = item1.BusySecondGroup != 0 ? (1 + (int)item1.BusySecondGroup) : 1;
                                    }
                                }
                                if (group == group3EnumId)
                                {
                                    item1.ThirdGroupAll = item1.ThirdGroupAll != 0 ? (1 + (int)item1.ThirdGroupAll) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item1.WomenThirdGroup = item1.WomenThirdGroup != 0 ? (1 + (int)item1.WomenThirdGroup) : 1;
                                    }
                                    if (bysy != null)
                                    {
                                        item1.BusyThirdGroup = item1.BusyThirdGroup != 0 ? (1 + (int)item1.BusyThirdGroup) : 1;
                                    }
                                }
                                //Туберкулез/ А 15-19
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId2)
                                {
                                    item2.Total1829 = item2.Total1829 != 0 ? (1 + (int)item2.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item2.Women1829 = item2.Women1829 != 0 ? (1 + (int)item2.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item2.Total1829 = item2.Total1829 != 0 ? (1 + (int)item2.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.Women1829 = item2.Women1829 != 0 ? (1 + (int)item2.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item2.Total3040 = item2.Total3040 != 0 ? (1 + (int)item2.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.Women3040 = item2.Women3040 != 0 ? (1 + (int)item2.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item2.Total45 = item2.Total45 != 0 ? (1 + (int)item2.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.Women45 = item2.Women45 != 0 ? (1 + (int)item2.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item2.TotalPersonsAge = item2.TotalPersonsAge != 0 ? (1 + (int)item2.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.WomenPersonsAge = item2.WomenPersonsAge != 0 ? (1 + (int)item2.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item2.FirstGroupAll = item2.FirstGroupAll != 0 ? (1 + (int)item2.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.WomenFirstGroup = item2.WomenFirstGroup != 0 ? (1 + (int)item2.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item2.BusyFirstGroup = item2.BusyFirstGroup != 0 ? (1 + (int)item2.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item2.SecondGroupAll = item2.SecondGroupAll != 0 ? (1 + (int)item2.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.WomenSecondGroup = item2.WomenSecondGroup != 0 ? (1 + (int)item2.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item2.BusySecondGroup = item2.BusySecondGroup != 0 ? (1 + (int)item2.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item2.ThirdGroupAll = item2.ThirdGroupAll != 0 ? (1 + (int)item2.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.WomenThirdGroup = item2.WomenThirdGroup != 0 ? (1 + (int)item2.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item2.BusyThirdGroup = item2.BusyThirdGroup != 0 ? (1 + (int)item2.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //Туберкулез  легких/ А 15-16
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId3)
                                {
                                    item3.Total1829 = item3.Total1829 != 0 ? (1 + (int)item3.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item3.Women1829 = item3.Women1829 != 0 ? (1 + (int)item3.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item3.Total1829 = item3.Total1829 != 0 ? (1 + (int)item3.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.Women1829 = item3.Women1829 != 0 ? (1 + (int)item3.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item3.Total3040 = item3.Total3040 != 0 ? (1 + (int)item3.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.Women3040 = item3.Women3040 != 0 ? (1 + (int)item3.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item3.Total45 = item3.Total45 != 0 ? (1 + (int)item3.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.Women45 = item3.Women45 != 0 ? (1 + (int)item3.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item3.TotalPersonsAge = item3.TotalPersonsAge != 0 ? (1 + (int)item3.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.WomenPersonsAge = item3.WomenPersonsAge != 0 ? (1 + (int)item3.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item3.FirstGroupAll = item3.FirstGroupAll != 0 ? (1 + (int)item3.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.WomenFirstGroup = item3.WomenFirstGroup != 0 ? (1 + (int)item3.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item3.BusyFirstGroup = item3.BusyFirstGroup != 0 ? (1 + (int)item3.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item3.SecondGroupAll = item3.SecondGroupAll != 0 ? (1 + (int)item3.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.WomenSecondGroup = item3.WomenSecondGroup != 0 ? (1 + (int)item3.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item3.BusySecondGroup = item3.BusySecondGroup != 0 ? (1 + (int)item3.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item3.ThirdGroupAll = item3.ThirdGroupAll != 0 ? (1 + (int)item3.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.WomenThirdGroup = item3.WomenThirdGroup != 0 ? (1 + (int)item3.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item3.BusyThirdGroup = item3.BusyThirdGroup != 0 ? (1 + (int)item3.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //Злокачественные новообразования/ С 00-97
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId4)
                                {
                                    item4.Total1829 = item4.Total1829 != 0 ? (1 + (int)item4.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item4.Women1829 = item4.Women1829 != 0 ? (1 + (int)item4.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item4.Total1829 = item4.Total1829 != 0 ? (1 + (int)item4.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item4.Women1829 = item4.Women1829 != 0 ? (1 + (int)item4.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item4.Total3040 = item4.Total3040 != 0 ? (1 + (int)item4.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item4.Women3040 = item4.Women3040 != 0 ? (1 + (int)item4.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item4.Total45 = item4.Total45 != 0 ? (1 + (int)item4.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item4.Women45 = item4.Women45 != 0 ? (1 + (int)item4.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item4.TotalPersonsAge = item4.TotalPersonsAge != 0 ? (1 + (int)item4.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item4.WomenPersonsAge = item4.WomenPersonsAge != 0 ? (1 + (int)item4.WomenPersonsAge) : 1;
                                        }
                                    }
                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item4.FirstGroupAll = item4.FirstGroupAll != 0 ? (1 + (int)item4.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item4.WomenFirstGroup = item4.WomenFirstGroup != 0 ? (1 + (int)item4.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item4.BusyFirstGroup = item4.BusyFirstGroup != 0 ? (1 + (int)item4.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item4.SecondGroupAll = item4.SecondGroupAll != 0 ? (1 + (int)item4.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item4.WomenSecondGroup = item4.WomenSecondGroup != 0 ? (1 + (int)item4.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item4.BusySecondGroup = item4.BusySecondGroup != 0 ? (1 + (int)item4.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item4.ThirdGroupAll = item4.ThirdGroupAll != 0 ? (1 + (int)item4.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item4.WomenThirdGroup = item4.WomenThirdGroup != 0 ? (1 + (int)item4.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item4.BusyThirdGroup = item4.BusyThirdGroup != 0 ? (1 + (int)item4.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //Заболeвания щитовидной железы/ E 00-07
                                if (diagnos == strDiagId5)
                                {
                                    item5.Total1829 = item5.Total1829 != 0 ? (1 + (int)item5.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item5.Women1829 = item5.Women1829 != 0 ? (1 + (int)item5.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item5.Total1829 = item5.Total1829 != 0 ? (1 + (int)item5.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item5.Women1829 = item5.Women1829 != 0 ? (1 + (int)item5.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item5.Total3040 = item5.Total3040 != 0 ? (1 + (int)item5.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item5.Women3040 = item5.Women3040 != 0 ? (1 + (int)item5.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item5.Total45 = item5.Total45 != 0 ? (1 + (int)item5.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item5.Women45 = item5.Women45 != 0 ? (1 + (int)item5.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item5.TotalPersonsAge = item5.TotalPersonsAge != 0 ? (1 + (int)item5.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item5.WomenPersonsAge = item5.WomenPersonsAge != 0 ? (1 + (int)item5.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item5.FirstGroupAll = item5.FirstGroupAll != 0 ? (1 + (int)item5.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item5.WomenFirstGroup = item5.WomenFirstGroup != 0 ? (1 + (int)item5.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item5.BusyFirstGroup = item5.BusyFirstGroup != 0 ? (1 + (int)item5.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item5.SecondGroupAll = item5.SecondGroupAll != 0 ? (1 + (int)item5.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item5.WomenSecondGroup = item5.WomenSecondGroup != 0 ? (1 + (int)item5.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item5.BusySecondGroup = item5.BusySecondGroup != 0 ? (1 + (int)item5.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item5.ThirdGroupAll = item5.ThirdGroupAll != 0 ? (1 + (int)item5.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item5.WomenThirdGroup = item5.WomenThirdGroup != 0 ? (1 + (int)item5.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item5.BusyThirdGroup = item5.BusyThirdGroup != 0 ? (1 + (int)item5.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //Сахарный диабет/ E 10-14
                                if (diagnos == strDiagId6)
                                {
                                    item6.Total1829 = item6.Total1829 != 0 ? (1 + (int)item6.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item6.Women1829 = item6.Women1829 != 0 ? (1 + (int)item6.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item6.Total1829 = item6.Total1829 != 0 ? (1 + (int)item6.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item6.Women1829 = item6.Women1829 != 0 ? (1 + (int)item6.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item6.Total3040 = item6.Total3040 != 0 ? (1 + (int)item6.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item6.Women3040 = item6.Women3040 != 0 ? (1 + (int)item6.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item6.Total45 = item6.Total45 != 0 ? (1 + (int)item6.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item6.Women45 = item6.Women45 != 0 ? (1 + (int)item6.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item6.TotalPersonsAge = item6.TotalPersonsAge != 0 ? (1 + (int)item6.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item6.WomenPersonsAge = item6.WomenPersonsAge != 0 ? (1 + (int)item6.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item6.FirstGroupAll = item6.FirstGroupAll != 0 ? (1 + (int)item6.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item6.WomenFirstGroup = item6.WomenFirstGroup != 0 ? (1 + (int)item6.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item6.BusyFirstGroup = item6.BusyFirstGroup != 0 ? (1 + (int)item6.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item6.SecondGroupAll = item6.SecondGroupAll != 0 ? (1 + (int)item6.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item6.WomenSecondGroup = item6.WomenSecondGroup != 0 ? (1 + (int)item6.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item6.BusySecondGroup = item6.BusySecondGroup != 0 ? (1 + (int)item6.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item6.ThirdGroupAll = item6.ThirdGroupAll != 0 ? (1 + (int)item6.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item6.WomenThirdGroup = item6.WomenThirdGroup != 0 ? (1 + (int)item6.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item6.BusyThirdGroup = item6.BusyThirdGroup != 0 ? (1 + (int)item6.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //Психические расстройства/ F 00-99*******************************************************************************************/
                                if (diagnos == strDiagId7)
                                {
                                    item7.Total1829 = item7.Total1829 != 0 ? (1 + (int)item7.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item7.Women1829 = item7.Women1829 != 0 ? (1 + (int)item7.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item7.Total1829 = item7.Total1829 != 0 ? (1 + (int)item7.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item7.Women1829 = item7.Women1829 != 0 ? (1 + (int)item7.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item7.Total3040 = item7.Total3040 != 0 ? (1 + (int)item7.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item7.Women3040 = item7.Women3040 != 0 ? (1 + (int)item7.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item7.Total45 = item7.Total45 != 0 ? (1 + (int)item7.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item7.Women45 = item7.Women45 != 0 ? (1 + (int)item7.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item7.TotalPersonsAge = item7.TotalPersonsAge != 0 ? (1 + (int)item7.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item7.WomenPersonsAge = item7.WomenPersonsAge != 0 ? (1 + (int)item7.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item7.FirstGroupAll = item7.FirstGroupAll != 0 ? (1 + (int)item7.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item7.WomenFirstGroup = item7.WomenFirstGroup != 0 ? (1 + (int)item7.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item7.BusyFirstGroup = item7.BusyFirstGroup != 0 ? (1 + (int)item7.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item7.SecondGroupAll = item7.SecondGroupAll != 0 ? (1 + (int)item7.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item7.WomenSecondGroup = item7.WomenSecondGroup != 0 ? (1 + (int)item7.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item7.BusySecondGroup = item7.BusySecondGroup != 0 ? (1 + (int)item7.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item7.ThirdGroupAll = item7.ThirdGroupAll != 0 ? (1 + (int)item7.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item7.WomenThirdGroup = item7.WomenThirdGroup != 0 ? (1 + (int)item7.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item7.BusyThirdGroup = item7.BusyThirdGroup != 0 ? (1 + (int)item7.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //Шизофрения/ F 20
                                if (diagnos == strDiagId8)
                                {
                                    item8.Total1829 = item8.Total1829 != 0 ? (1 + (int)item8.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item8.Women1829 = item8.Women1829 != 0 ? (1 + (int)item8.Women1829) : 1;
                                    }
                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item8.Total1829 = item8.Total1829 != 0 ? (1 + (int)item8.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item8.Women1829 = item8.Women1829 != 0 ? (1 + (int)item8.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item8.Total3040 = item8.Total3040 != 0 ? (1 + (int)item8.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item8.Women3040 = item8.Women3040 != 0 ? (1 + (int)item8.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item8.Total45 = item8.Total45 != 0 ? (1 + (int)item8.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item8.Women45 = item8.Women45 != 0 ? (1 + (int)item8.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item8.TotalPersonsAge = item8.TotalPersonsAge != 0 ? (1 + (int)item8.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item8.WomenPersonsAge = item8.WomenPersonsAge != 0 ? (1 + (int)item8.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item8.FirstGroupAll = item8.FirstGroupAll != 0 ? (1 + (int)item8.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item8.WomenFirstGroup = item8.WomenFirstGroup != 0 ? (1 + (int)item8.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item8.BusyFirstGroup = item8.BusyFirstGroup != 0 ? (1 + (int)item8.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item8.SecondGroupAll = item8.SecondGroupAll != 0 ? (1 + (int)item8.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item8.WomenSecondGroup = item8.WomenSecondGroup != 0 ? (1 + (int)item8.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item8.BusySecondGroup = item8.BusySecondGroup != 0 ? (1 + (int)item8.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item8.ThirdGroupAll = item8.ThirdGroupAll != 0 ? (1 + (int)item8.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item8.WomenThirdGroup = item8.WomenThirdGroup != 0 ? (1 + (int)item8.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item8.BusyThirdGroup = item8.BusyThirdGroup != 0 ? (1 + (int)item8.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //Умственная отсталость/ F 70-79
                                if (diagnos == strDiagId9)
                                {
                                    item9.Total1829 = item9.Total1829 != 0 ? (1 + (int)item9.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item9.Women1829 = item9.Women1829 != 0 ? (1 + (int)item9.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item9.Total1829 = item9.Total1829 != 0 ? (1 + (int)item9.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item9.Women1829 = item9.Women1829 != 0 ? (1 + (int)item9.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item9.Total3040 = item9.Total3040 != 0 ? (1 + (int)item9.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item9.Women3040 = item9.Women3040 != 0 ? (1 + (int)item9.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item9.Total45 = item9.Total45 != 0 ? (1 + (int)item9.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item9.Women45 = item9.Women45 != 0 ? (1 + (int)item9.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item9.TotalPersonsAge = item9.TotalPersonsAge != 0 ? (1 + (int)item9.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item9.WomenPersonsAge = item9.WomenPersonsAge != 0 ? (1 + (int)item9.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item9.FirstGroupAll = item9.FirstGroupAll != 0 ? (1 + (int)item9.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item9.WomenFirstGroup = item9.WomenFirstGroup != 0 ? (1 + (int)item9.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item9.BusyFirstGroup = item9.BusyFirstGroup != 0 ? (1 + (int)item9.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item9.SecondGroupAll = item9.SecondGroupAll != 0 ? (1 + (int)item9.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item9.WomenSecondGroup = item9.WomenSecondGroup != 0 ? (1 + (int)item9.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item9.BusySecondGroup = item9.BusySecondGroup != 0 ? (1 + (int)item9.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item9.ThirdGroupAll = item9.ThirdGroupAll != 0 ? (1 + (int)item9.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item9.WomenThirdGroup = item9.WomenThirdGroup != 0 ? (1 + (int)item9.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item9.BusyThirdGroup = item9.BusyThirdGroup != 0 ? (1 + (int)item9.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //болезни нервной системы/ G 00-99
                                if (diagnos == strDiagId10)
                                {
                                    item10.Total1829 = item10.Total1829 != 0 ? (1 + (int)item10.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item10.Women1829 = item10.Women1829 != 0 ? (1 + (int)item10.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item10.Total1829 = item10.Total1829 != 0 ? (1 + (int)item10.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item10.Women1829 = item10.Women1829 != 0 ? (1 + (int)item10.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item10.Total3040 = item10.Total3040 != 0 ? (1 + (int)item10.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item10.Women3040 = item10.Women3040 != 0 ? (1 + (int)item10.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item10.Total45 = item10.Total45 != 0 ? (1 + (int)item10.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item10.Women45 = item10.Women45 != 0 ? (1 + (int)item10.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item10.TotalPersonsAge = item10.TotalPersonsAge != 0 ? (1 + (int)item10.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item10.WomenPersonsAge = item10.WomenPersonsAge != 0 ? (1 + (int)item10.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item10.FirstGroupAll = item10.FirstGroupAll != 0 ? (1 + (int)item10.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item10.WomenFirstGroup = item10.WomenFirstGroup != 0 ? (1 + (int)item10.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item10.BusyFirstGroup = item10.BusyFirstGroup != 0 ? (1 + (int)item10.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item10.SecondGroupAll = item10.SecondGroupAll != 0 ? (1 + (int)item10.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item10.WomenSecondGroup = item10.WomenSecondGroup != 0 ? (1 + (int)item10.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item10.BusySecondGroup = item10.BusySecondGroup != 0 ? (1 + (int)item10.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item10.ThirdGroupAll = item10.ThirdGroupAll != 0 ? (1 + (int)item10.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item10.WomenThirdGroup = item10.WomenThirdGroup != 0 ? (1 + (int)item10.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item10.BusyThirdGroup = item10.BusyThirdGroup != 0 ? (1 + (int)item10.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //болезни периферической нервной системы/ G 60-64                               
                                if (diagnos == strDiagId11)
                                {
                                    item11.Total1829 = item11.Total1829 != 0 ? (1 + (int)item11.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item11.Women1829 = item11.Women1829 != 0 ? (1 + (int)item11.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item11.Total1829 = item11.Total1829 != 0 ? (1 + (int)item11.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item11.Women1829 = item11.Women1829 != 0 ? (1 + (int)item11.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item11.Total3040 = item11.Total3040 != 0 ? (1 + (int)item11.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item11.Women3040 = item11.Women3040 != 0 ? (1 + (int)item11.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item11.Total45 = item11.Total45 != 0 ? (1 + (int)item11.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item11.Women45 = item11.Women45 != 0 ? (1 + (int)item11.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item11.TotalPersonsAge = item11.TotalPersonsAge != 0 ? (1 + (int)item11.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item11.WomenPersonsAge = item11.WomenPersonsAge != 0 ? (1 + (int)item11.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item11.FirstGroupAll = item11.FirstGroupAll != 0 ? (1 + (int)item11.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item11.WomenFirstGroup = item11.WomenFirstGroup != 0 ? (1 + (int)item11.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item11.BusyFirstGroup = item11.BusyFirstGroup != 0 ? (1 + (int)item11.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item11.SecondGroupAll = item11.SecondGroupAll != 0 ? (1 + (int)item11.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item11.WomenSecondGroup = item11.WomenSecondGroup != 0 ? (1 + (int)item11.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item11.BusySecondGroup = item11.BusySecondGroup != 0 ? (1 + (int)item11.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item11.ThirdGroupAll = item11.ThirdGroupAll != 0 ? (1 + (int)item11.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item11.WomenThirdGroup = item11.WomenThirdGroup != 0 ? (1 + (int)item11.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item11.BusyThirdGroup = item11.BusyThirdGroup != 0 ? (1 + (int)item11.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //из них: болезни периферической нервной системы/ G 60-64
                                if (diagnos == strDiagId12)
                                {
                                    item12.Total1829 = item12.Total1829 != 0 ? (1 + (int)item12.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item12.Women1829 = item12.Women1829 != 0 ? (1 + (int)item12.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item12.Total1829 = item12.Total1829 != 0 ? (1 + (int)item12.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item12.Women1829 = item12.Women1829 != 0 ? (1 + (int)item12.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item12.Total3040 = item12.Total3040 != 0 ? (1 + (int)item12.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item12.Women3040 = item12.Women3040 != 0 ? (1 + (int)item12.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item12.Total45 = item12.Total45 != 0 ? (1 + (int)item12.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item12.Women45 = item12.Women45 != 0 ? (1 + (int)item12.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item12.TotalPersonsAge = item12.TotalPersonsAge != 0 ? (1 + (int)item12.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item12.WomenPersonsAge = item12.WomenPersonsAge != 0 ? (1 + (int)item12.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item12.FirstGroupAll = item12.FirstGroupAll != 0 ? (1 + (int)item12.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item12.WomenFirstGroup = item12.WomenFirstGroup != 0 ? (1 + (int)item12.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item12.BusyFirstGroup = item12.BusyFirstGroup != 0 ? (1 + (int)item12.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item12.SecondGroupAll = item12.SecondGroupAll != 0 ? (1 + (int)item12.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item12.WomenSecondGroup = item12.WomenSecondGroup != 0 ? (1 + (int)item12.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item12.BusySecondGroup = item12.BusySecondGroup != 0 ? (1 + (int)item12.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item12.ThirdGroupAll = item12.ThirdGroupAll != 0 ? (1 + (int)item12.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item12.WomenThirdGroup = item12.WomenThirdGroup != 0 ? (1 + (int)item12.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item12.BusyThirdGroup = item12.BusyThirdGroup != 0 ? (1 + (int)item12.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //болезни органов чувст/ H 00-95
                                if (diagnos == strDiagId13)
                                {
                                    item13.Total1829 = item13.Total1829 != 0 ? (1 + (int)item13.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item13.Women1829 = item13.Women1829 != 0 ? (1 + (int)item13.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item13.Total1829 = item13.Total1829 != 0 ? (1 + (int)item13.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item13.Women1829 = item13.Women1829 != 0 ? (1 + (int)item13.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item13.Total3040 = item13.Total3040 != 0 ? (1 + (int)item13.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item13.Women3040 = item13.Women3040 != 0 ? (1 + (int)item13.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item13.Total45 = item13.Total45 != 0 ? (1 + (int)item13.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item13.Women45 = item13.Women45 != 0 ? (1 + (int)item13.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item13.TotalPersonsAge = item13.TotalPersonsAge != 0 ? (1 + (int)item13.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item13.WomenPersonsAge = item13.WomenPersonsAge != 0 ? (1 + (int)item13.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item13.FirstGroupAll = item13.FirstGroupAll != 0 ? (1 + (int)item13.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item13.WomenFirstGroup = item13.WomenFirstGroup != 0 ? (1 + (int)item13.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item13.BusyFirstGroup = item13.BusyFirstGroup != 0 ? (1 + (int)item13.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item13.SecondGroupAll = item13.SecondGroupAll != 0 ? (1 + (int)item13.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item13.WomenSecondGroup = item13.WomenSecondGroup != 0 ? (1 + (int)item13.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item13.BusySecondGroup = item13.BusySecondGroup != 0 ? (1 + (int)item13.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item13.ThirdGroupAll = item13.ThirdGroupAll != 0 ? (1 + (int)item13.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item13.WomenThirdGroup = item13.WomenThirdGroup != 0 ? (1 + (int)item13.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item13.BusyThirdGroup = item13.BusyThirdGroup != 0 ? (1 + (int)item13.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //болезни глаз/ H 00-59
                                if (diagnos == strDiagId14)
                                {
                                    item14.Total1829 = item14.Total1829 != 0 ? (1 + (int)item14.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item14.Women1829 = item14.Women1829 != 0 ? (1 + (int)item14.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item14.Total1829 = item14.Total1829 != 0 ? (1 + (int)item14.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item14.Women1829 = item14.Women1829 != 0 ? (1 + (int)item14.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item14.Total3040 = item14.Total3040 != 0 ? (1 + (int)item14.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item14.Women3040 = item14.Women3040 != 0 ? (1 + (int)item14.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item14.Total45 = item14.Total45 != 0 ? (1 + (int)item14.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item14.Women45 = item14.Women45 != 0 ? (1 + (int)item14.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item14.TotalPersonsAge = item14.TotalPersonsAge != 0 ? (1 + (int)item14.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item14.WomenPersonsAge = item14.WomenPersonsAge != 0 ? (1 + (int)item14.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item14.FirstGroupAll = item14.FirstGroupAll != 0 ? (1 + (int)item14.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item14.WomenFirstGroup = item14.WomenFirstGroup != 0 ? (1 + (int)item14.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item14.BusyFirstGroup = item14.BusyFirstGroup != 0 ? (1 + (int)item14.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item14.SecondGroupAll = item14.SecondGroupAll != 0 ? (1 + (int)item14.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item14.WomenSecondGroup = item14.WomenSecondGroup != 0 ? (1 + (int)item14.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item14.BusySecondGroup = item14.BusySecondGroup != 0 ? (1 + (int)item14.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item14.ThirdGroupAll = item14.ThirdGroupAll != 0 ? (1 + (int)item14.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item14.WomenThirdGroup = item14.WomenThirdGroup != 0 ? (1 + (int)item14.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item14.BusyThirdGroup = item14.BusyThirdGroup != 0 ? (1 + (int)item14.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //болезни уха и сосцевидного отростка/ H 60-95
                                if (diagnos == strDiagId15)
                                {
                                    item15.Total1829 = item15.Total1829 != 0 ? (1 + (int)item15.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item15.Women1829 = item15.Women1829 != 0 ? (1 + (int)item15.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item15.Total1829 = item15.Total1829 != 0 ? (1 + (int)item15.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item15.Women1829 = item15.Women1829 != 0 ? (1 + (int)item15.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item15.Total3040 = item15.Total3040 != 0 ? (1 + (int)item15.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item15.Women3040 = item15.Women3040 != 0 ? (1 + (int)item15.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item15.Total45 = item15.Total45 != 0 ? (1 + (int)item15.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item15.Women45 = item15.Women45 != 0 ? (1 + (int)item15.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item15.TotalPersonsAge = item15.TotalPersonsAge != 0 ? (1 + (int)item15.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item15.WomenPersonsAge = item15.WomenPersonsAge != 0 ? (1 + (int)item15.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item15.FirstGroupAll = item15.FirstGroupAll != 0 ? (1 + (int)item15.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item15.WomenFirstGroup = item15.WomenFirstGroup != 0 ? (1 + (int)item15.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item15.BusyFirstGroup = item15.BusyFirstGroup != 0 ? (1 + (int)item15.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item15.SecondGroupAll = item15.SecondGroupAll != 0 ? (1 + (int)item15.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item15.WomenSecondGroup = item15.WomenSecondGroup != 0 ? (1 + (int)item15.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item15.BusySecondGroup = item15.BusySecondGroup != 0 ? (1 + (int)item15.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item15.ThirdGroupAll = item15.ThirdGroupAll != 0 ? (1 + (int)item15.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item15.WomenThirdGroup = item15.WomenThirdGroup != 0 ? (1 + (int)item15.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item15.BusyThirdGroup = item15.BusyThirdGroup != 0 ? (1 + (int)item15.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //болезни системы кровообращения/ I 00-99
                                if (diagnos == strDiagId16)
                                {
                                    item16.Total1829 = item16.Total1829 != 0 ? (1 + (int)item16.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item16.Women1829 = item16.Women1829 != 0 ? (1 + (int)item16.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item16.Total1829 = item16.Total1829 != 0 ? (1 + (int)item16.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item16.Women1829 = item16.Women1829 != 0 ? (1 + (int)item16.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item16.Total3040 = item16.Total3040 != 0 ? (1 + (int)item16.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item16.Women3040 = item16.Women3040 != 0 ? (1 + (int)item16.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item16.Total45 = item16.Total45 != 0 ? (1 + (int)item16.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item16.Women45 = item16.Women45 != 0 ? (1 + (int)item16.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item16.TotalPersonsAge = item16.TotalPersonsAge != 0 ? (1 + (int)item16.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item16.WomenPersonsAge = item16.WomenPersonsAge != 0 ? (1 + (int)item16.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item16.FirstGroupAll = item16.FirstGroupAll != 0 ? (1 + (int)item16.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item16.WomenFirstGroup = item16.WomenFirstGroup != 0 ? (1 + (int)item16.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item16.BusyFirstGroup = item16.BusyFirstGroup != 0 ? (1 + (int)item16.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item16.SecondGroupAll = item16.SecondGroupAll != 0 ? (1 + (int)item16.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item16.WomenSecondGroup = item16.WomenSecondGroup != 0 ? (1 + (int)item16.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item16.BusySecondGroup = item16.BusySecondGroup != 0 ? (1 + (int)item16.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item16.ThirdGroupAll = item16.ThirdGroupAll != 0 ? (1 + (int)item16.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item16.WomenThirdGroup = item16.WomenThirdGroup != 0 ? (1 + (int)item16.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item16.BusyThirdGroup = item16.BusyThirdGroup != 0 ? (1 + (int)item16.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //из них: хронические ревматические болезни сердца/  I 05-09
                                if (diagnos == strDiagId17)
                                {
                                    item17.Total1829 = item17.Total1829 != 0 ? (1 + (int)item17.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item17.Women1829 = item17.Women1829 != 0 ? (1 + (int)item17.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item17.Total1829 = item17.Total1829 != 0 ? (1 + (int)item17.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item17.Women1829 = item17.Women1829 != 0 ? (1 + (int)item17.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item17.Total3040 = item17.Total3040 != 0 ? (1 + (int)item17.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item17.Women3040 = item17.Women3040 != 0 ? (1 + (int)item17.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item17.Total45 = item17.Total45 != 0 ? (1 + (int)item17.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item17.Women45 = item17.Women45 != 0 ? (1 + (int)item17.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item17.TotalPersonsAge = item17.TotalPersonsAge != 0 ? (1 + (int)item17.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item17.WomenPersonsAge = item17.WomenPersonsAge != 0 ? (1 + (int)item17.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item17.FirstGroupAll = item17.FirstGroupAll != 0 ? (1 + (int)item17.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item17.WomenFirstGroup = item17.WomenFirstGroup != 0 ? (1 + (int)item17.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item17.BusyFirstGroup = item17.BusyFirstGroup != 0 ? (1 + (int)item17.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item17.SecondGroupAll = item17.SecondGroupAll != 0 ? (1 + (int)item17.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item17.WomenSecondGroup = item17.WomenSecondGroup != 0 ? (1 + (int)item17.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item17.BusySecondGroup = item17.BusySecondGroup != 0 ? (1 + (int)item17.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item17.ThirdGroupAll = item17.ThirdGroupAll != 0 ? (1 + (int)item17.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item17.WomenThirdGroup = item17.WomenThirdGroup != 0 ? (1 + (int)item17.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item17.BusyThirdGroup = item17.BusyThirdGroup != 0 ? (1 + (int)item17.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //болезни, характеризующиеся повышенным кровяным давлением/ I 10-15
                                if (diagnos == strDiagId18)
                                {
                                    item18.Total1829 = item18.Total1829 != 0 ? (1 + (int)item18.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item18.Women1829 = item18.Women1829 != 0 ? (1 + (int)item18.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item18.Total1829 = item18.Total1829 != 0 ? (1 + (int)item18.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item18.Women1829 = item18.Women1829 != 0 ? (1 + (int)item18.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item18.Total3040 = item18.Total3040 != 0 ? (1 + (int)item18.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item18.Women3040 = item18.Women3040 != 0 ? (1 + (int)item18.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item18.Total45 = item18.Total45 != 0 ? (1 + (int)item18.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item18.Women45 = item18.Women45 != 0 ? (1 + (int)item18.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item18.TotalPersonsAge = item18.TotalPersonsAge != 0 ? (1 + (int)item18.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item18.WomenPersonsAge = item18.WomenPersonsAge != 0 ? (1 + (int)item18.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item18.FirstGroupAll = item18.FirstGroupAll != 0 ? (1 + (int)item18.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item18.WomenFirstGroup = item18.WomenFirstGroup != 0 ? (1 + (int)item18.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item18.BusyFirstGroup = item18.BusyFirstGroup != 0 ? (1 + (int)item18.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item18.SecondGroupAll = item18.SecondGroupAll != 0 ? (1 + (int)item18.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item18.WomenSecondGroup = item18.WomenSecondGroup != 0 ? (1 + (int)item18.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item18.BusySecondGroup = item18.BusySecondGroup != 0 ? (1 + (int)item18.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item18.ThirdGroupAll = item18.ThirdGroupAll != 0 ? (1 + (int)item18.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item18.WomenThirdGroup = item18.WomenThirdGroup != 0 ? (1 + (int)item18.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item18.BusyThirdGroup = item18.BusyThirdGroup != 0 ? (1 + (int)item18.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId19)
                                {
                                    item19.Total1829 = item19.Total1829 != 0 ? (1 + (int)item19.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item19.Women1829 = item19.Women1829 != 0 ? (1 + (int)item19.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item19.Total1829 = item19.Total1829 != 0 ? (1 + (int)item19.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item19.Women1829 = item19.Women1829 != 0 ? (1 + (int)item19.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item19.Total3040 = item19.Total3040 != 0 ? (1 + (int)item19.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item19.Women3040 = item19.Women3040 != 0 ? (1 + (int)item19.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item19.Total45 = item19.Total45 != 0 ? (1 + (int)item19.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item19.Women45 = item19.Women45 != 0 ? (1 + (int)item19.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item19.TotalPersonsAge = item19.TotalPersonsAge != 0 ? (1 + (int)item19.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item19.WomenPersonsAge = item19.WomenPersonsAge != 0 ? (1 + (int)item19.WomenPersonsAge) : 1;
                                        }
                                    }

                                    if (group == group1EnumId)
                                    {
                                        item19.FirstGroupAll = item19.FirstGroupAll != 0 ? (1 + (int)item19.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item19.WomenFirstGroup = item19.WomenFirstGroup != 0 ? (1 + (int)item19.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item19.BusyFirstGroup = item19.BusyFirstGroup != 0 ? (1 + (int)item19.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item19.SecondGroupAll = item19.SecondGroupAll != 0 ? (1 + (int)item19.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item19.WomenSecondGroup = item19.WomenSecondGroup != 0 ? (1 + (int)item19.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item19.BusySecondGroup = item19.BusySecondGroup != 0 ? (1 + (int)item19.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item19.ThirdGroupAll = item19.ThirdGroupAll != 0 ? (1 + (int)item19.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item19.WomenThirdGroup = item19.WomenThirdGroup != 0 ? (1 + (int)item19.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item19.BusyThirdGroup = item19.BusyThirdGroup != 0 ? (1 + (int)item19.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId20)
                                {
                                    item20.Total1829 = item20.Total1829 != 0 ? (1 + (int)item20.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item20.Women1829 = item20.Women1829 != 0 ? (1 + (int)item20.Women1829) : 1;
                                    }

                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item20.Total1829 = item20.Total1829 != 0 ? (1 + (int)item20.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item20.Women1829 = item20.Women1829 != 0 ? (1 + (int)item20.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item20.Total3040 = item20.Total3040 != 0 ? (1 + (int)item20.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item20.Women3040 = item20.Women3040 != 0 ? (1 + (int)item20.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item20.Total45 = item20.Total45 != 0 ? (1 + (int)item20.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item20.Women45 = item20.Women45 != 0 ? (1 + (int)item20.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item20.TotalPersonsAge = item20.TotalPersonsAge != 0 ? (1 + (int)item20.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item20.WomenPersonsAge = item20.WomenPersonsAge != 0 ? (1 + (int)item20.WomenPersonsAge) : 1;
                                        }
                                    }
                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item20.FirstGroupAll = item20.FirstGroupAll != 0 ? (1 + (int)item20.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item20.WomenFirstGroup = item20.WomenFirstGroup != 0 ? (1 + (int)item20.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item20.BusyFirstGroup = item20.BusyFirstGroup != 0 ? (1 + (int)item20.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item20.SecondGroupAll = item20.SecondGroupAll != 0 ? (1 + (int)item20.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item20.WomenSecondGroup = item20.WomenSecondGroup != 0 ? (1 + (int)item20.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item20.BusySecondGroup = item20.BusySecondGroup != 0 ? (1 + (int)item20.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item20.ThirdGroupAll = item20.ThirdGroupAll != 0 ? (1 + (int)item20.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item20.WomenThirdGroup = item20.WomenThirdGroup != 0 ? (1 + (int)item20.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item20.BusyThirdGroup = item20.BusyThirdGroup != 0 ? (1 + (int)item20.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //ДИАГНОЗ НЕ НАШЛА В СПИСКЕ
                                /*if (diagnos == strDiagId21)
                                {
                                    item21.Total1829 = item21.Total1829 != 0 ? (1 + (int)item21.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item21.Women1829 = item21.Women1829 != 0 ? (1 + (int)item21.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item21.Total1829 = item21.Total1829 != 0 ? (1 + (int)item21.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item21.Women1829 = item21.Women1829 != 0 ? (1 + (int)item21.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item21.Total3040 = item21.Total3040 != 0 ? (1 + (int)item21.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item21.Women3040 = item21.Women3040 != 0 ? (1 + (int)item21.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item21.Total45 = item21.Total45 != 0 ? (1 + (int)item21.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item21.Women45 = item21.Women45 != 0 ? (1 + (int)item21.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item21.TotalPersonsAge = item21.TotalPersonsAge != 0 ? (1 + (int)item21.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item21.WomenPersonsAge = item21.WomenPersonsAge != 0 ? (1 + (int)item21.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item21.FirstGroupAll = item21.FirstGroupAll != 0 ? (1 + (int)item21.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item21.WomenFirstGroup = item21.WomenFirstGroup != 0 ? (1 + (int)item21.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item21.BusyFirstGroup = item21.BusyFirstGroup != 0 ? (1 + (int)item21.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item21.SecondGroupAll = item21.SecondGroupAll != 0 ? (1 + (int)item21.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item21.WomenSecondGroup = item21.WomenSecondGroup != 0 ? (1 + (int)item21.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item21.BusySecondGroup = item21.BusySecondGroup != 0 ? (1 + (int)item21.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item21.ThirdGroupAll = item21.ThirdGroupAll != 0 ? (1 + (int)item21.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item21.WomenThirdGroup = item21.WomenThirdGroup != 0 ? (1 + (int)item21.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item21.BusyThirdGroup = item21.BusyThirdGroup != 0 ? (1 + (int)item21.BusyThirdGroup) : 1;
                                        }
                                    }
                                }*/
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId22)
                                {
                                    item22.Total1829 = item22.Total1829 != 0 ? (1 + (int)item22.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item22.Women1829 = item22.Women1829 != 0 ? (1 + (int)item22.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item22.Total1829 = item22.Total1829 != 0 ? (1 + (int)item22.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item22.Women1829 = item22.Women1829 != 0 ? (1 + (int)item22.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item22.Total3040 = item22.Total3040 != 0 ? (1 + (int)item22.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item22.Women3040 = item22.Women3040 != 0 ? (1 + (int)item22.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item22.Total45 = item22.Total45 != 0 ? (1 + (int)item22.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item22.Women45 = item22.Women45 != 0 ? (1 + (int)item22.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item22.TotalPersonsAge = item22.TotalPersonsAge != 0 ? (1 + (int)item22.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item22.WomenPersonsAge = item22.WomenPersonsAge != 0 ? (1 + (int)item22.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item22.FirstGroupAll = item22.FirstGroupAll != 0 ? (1 + (int)item22.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item22.WomenFirstGroup = item22.WomenFirstGroup != 0 ? (1 + (int)item22.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item22.BusyFirstGroup = item22.BusyFirstGroup != 0 ? (1 + (int)item22.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item22.SecondGroupAll = item22.SecondGroupAll != 0 ? (1 + (int)item22.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item22.WomenSecondGroup = item22.WomenSecondGroup != 0 ? (1 + (int)item22.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item22.BusySecondGroup = item22.BusySecondGroup != 0 ? (1 + (int)item22.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item22.ThirdGroupAll = item22.ThirdGroupAll != 0 ? (1 + (int)item22.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item22.WomenThirdGroup = item22.WomenThirdGroup != 0 ? (1 + (int)item22.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item22.BusyThirdGroup = item22.BusyThirdGroup != 0 ? (1 + (int)item22.BusyThirdGroup) : 1;
                                        }
                                    }
                                }

                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId23)
                                {
                                    item23.Total1829 = item23.Total1829 != 0 ? (1 + (int)item23.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item23.Women1829 = item23.Women1829 != 0 ? (1 + (int)item23.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item23.Total1829 = item23.Total1829 != 0 ? (1 + (int)item23.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item23.Women1829 = item23.Women1829 != 0 ? (1 + (int)item23.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item23.Total3040 = item23.Total3040 != 0 ? (1 + (int)item23.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item23.Women3040 = item23.Women3040 != 0 ? (1 + (int)item23.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item23.Total45 = item23.Total45 != 0 ? (1 + (int)item23.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item23.Women45 = item23.Women45 != 0 ? (1 + (int)item23.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item23.TotalPersonsAge = item23.TotalPersonsAge != 0 ? (1 + (int)item23.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item23.WomenPersonsAge = item23.WomenPersonsAge != 0 ? (1 + (int)item23.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item23.FirstGroupAll = item23.FirstGroupAll != 0 ? (1 + (int)item23.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item23.WomenFirstGroup = item23.WomenFirstGroup != 0 ? (1 + (int)item23.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item23.BusyFirstGroup = item23.BusyFirstGroup != 0 ? (1 + (int)item23.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item23.SecondGroupAll = item23.SecondGroupAll != 0 ? (1 + (int)item23.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item23.WomenSecondGroup = item23.WomenSecondGroup != 0 ? (1 + (int)item23.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item23.BusySecondGroup = item23.BusySecondGroup != 0 ? (1 + (int)item23.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item23.ThirdGroupAll = item23.ThirdGroupAll != 0 ? (1 + (int)item23.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item23.WomenThirdGroup = item23.WomenThirdGroup != 0 ? (1 + (int)item23.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item23.BusyThirdGroup = item23.BusyThirdGroup != 0 ? (1 + (int)item23.BusyThirdGroup) : 1;
                                        }
                                    }
                                }

                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId24)
                                {
                                    item24.Total1829 = item24.Total1829 != 0 ? (1 + (int)item24.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item24.Women1829 = item24.Women1829 != 0 ? (1 + (int)item24.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item24.Total1829 = item24.Total1829 != 0 ? (1 + (int)item24.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item24.Women1829 = item24.Women1829 != 0 ? (1 + (int)item24.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item24.Total3040 = item24.Total3040 != 0 ? (1 + (int)item24.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item24.Women3040 = item24.Women3040 != 0 ? (1 + (int)item24.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item24.Total45 = item24.Total45 != 0 ? (1 + (int)item24.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item24.Women45 = item24.Women45 != 0 ? (1 + (int)item24.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item24.TotalPersonsAge = item24.TotalPersonsAge != 0 ? (1 + (int)item24.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item24.WomenPersonsAge = item24.WomenPersonsAge != 0 ? (1 + (int)item24.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item24.FirstGroupAll = item24.FirstGroupAll != 0 ? (1 + (int)item24.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item24.WomenFirstGroup = item24.WomenFirstGroup != 0 ? (1 + (int)item24.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item24.BusyFirstGroup = item24.BusyFirstGroup != 0 ? (1 + (int)item24.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item24.SecondGroupAll = item24.SecondGroupAll != 0 ? (1 + (int)item24.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item24.WomenSecondGroup = item24.WomenSecondGroup != 0 ? (1 + (int)item24.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item24.BusySecondGroup = item24.BusySecondGroup != 0 ? (1 + (int)item24.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item24.ThirdGroupAll = item24.ThirdGroupAll != 0 ? (1 + (int)item24.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item24.WomenThirdGroup = item24.WomenThirdGroup != 0 ? (1 + (int)item24.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item24.BusyThirdGroup = item24.BusyThirdGroup != 0 ? (1 + (int)item24.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId25)
                                {
                                    item25.Total1829 = item25.Total1829 != 0 ? (1 + (int)item25.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item25.Women1829 = item25.Women1829 != 0 ? (1 + (int)item25.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item25.Total1829 = item25.Total1829 != 0 ? (1 + (int)item25.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item25.Women1829 = item25.Women1829 != 0 ? (1 + (int)item25.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item25.Total3040 = item25.Total3040 != 0 ? (1 + (int)item25.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item25.Women3040 = item25.Women3040 != 0 ? (1 + (int)item25.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item25.Total45 = item25.Total45 != 0 ? (1 + (int)item25.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item25.Women45 = item25.Women45 != 0 ? (1 + (int)item25.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item25.TotalPersonsAge = item25.TotalPersonsAge != 0 ? (1 + (int)item25.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item25.WomenPersonsAge = item25.WomenPersonsAge != 0 ? (1 + (int)item25.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item25.FirstGroupAll = item25.FirstGroupAll != 0 ? (1 + (int)item25.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item25.WomenFirstGroup = item25.WomenFirstGroup != 0 ? (1 + (int)item25.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item25.BusyFirstGroup = item25.BusyFirstGroup != 0 ? (1 + (int)item25.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item25.SecondGroupAll = item25.SecondGroupAll != 0 ? (1 + (int)item25.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item25.WomenSecondGroup = item25.WomenSecondGroup != 0 ? (1 + (int)item25.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item25.BusySecondGroup = item25.BusySecondGroup != 0 ? (1 + (int)item25.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item25.ThirdGroupAll = item25.ThirdGroupAll != 0 ? (1 + (int)item25.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item25.WomenThirdGroup = item25.WomenThirdGroup != 0 ? (1 + (int)item25.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item25.BusyThirdGroup = item25.BusyThirdGroup != 0 ? (1 + (int)item25.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId26)
                                {
                                    item26.Total1829 = item26.Total1829 != 0 ? (1 + (int)item26.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item26.Women1829 = item26.Women1829 != 0 ? (1 + (int)item26.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item26.Total1829 = item26.Total1829 != 0 ? (1 + (int)item26.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item26.Women1829 = item26.Women1829 != 0 ? (1 + (int)item26.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item26.Total3040 = item26.Total3040 != 0 ? (1 + (int)item26.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item26.Women3040 = item26.Women3040 != 0 ? (1 + (int)item26.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item26.Total45 = item26.Total45 != 0 ? (1 + (int)item26.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item26.Women45 = item26.Women45 != 0 ? (1 + (int)item26.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item26.TotalPersonsAge = item26.TotalPersonsAge != 0 ? (1 + (int)item26.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item26.WomenPersonsAge = item26.WomenPersonsAge != 0 ? (1 + (int)item26.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item26.FirstGroupAll = item26.FirstGroupAll != 0 ? (1 + (int)item26.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item26.WomenFirstGroup = item26.WomenFirstGroup != 0 ? (1 + (int)item26.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item26.BusyFirstGroup = item26.BusyFirstGroup != 0 ? (1 + (int)item26.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item26.SecondGroupAll = item26.SecondGroupAll != 0 ? (1 + (int)item26.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item26.WomenSecondGroup = item26.WomenSecondGroup != 0 ? (1 + (int)item26.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item26.BusySecondGroup = item26.BusySecondGroup != 0 ? (1 + (int)item26.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item26.ThirdGroupAll = item26.ThirdGroupAll != 0 ? (1 + (int)item26.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item26.WomenThirdGroup = item26.WomenThirdGroup != 0 ? (1 + (int)item26.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item26.BusyThirdGroup = item26.BusyThirdGroup != 0 ? (1 + (int)item26.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId27)
                                {
                                    item27.Total1829 = item27.Total1829 != 0 ? (1 + (int)item27.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item27.Women1829 = item27.Women1829 != 0 ? (1 + (int)item27.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item27.Total1829 = item27.Total1829 != 0 ? (1 + (int)item27.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item27.Women1829 = item27.Women1829 != 0 ? (1 + (int)item27.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item27.Total3040 = item27.Total3040 != 0 ? (1 + (int)item27.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item27.Women3040 = item27.Women3040 != 0 ? (1 + (int)item27.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item27.Total45 = item27.Total45 != 0 ? (1 + (int)item27.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item27.Women45 = item27.Women45 != 0 ? (1 + (int)item27.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item27.TotalPersonsAge = item27.TotalPersonsAge != 0 ? (1 + (int)item27.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item27.WomenPersonsAge = item27.WomenPersonsAge != 0 ? (1 + (int)item27.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item27.FirstGroupAll = item27.FirstGroupAll != 0 ? (1 + (int)item27.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item27.WomenFirstGroup = item27.WomenFirstGroup != 0 ? (1 + (int)item27.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item27.BusyFirstGroup = item27.BusyFirstGroup != 0 ? (1 + (int)item27.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item27.SecondGroupAll = item27.SecondGroupAll != 0 ? (1 + (int)item27.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item27.WomenSecondGroup = item27.WomenSecondGroup != 0 ? (1 + (int)item27.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item27.BusySecondGroup = item27.BusySecondGroup != 0 ? (1 + (int)item27.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item27.ThirdGroupAll = item27.ThirdGroupAll != 0 ? (1 + (int)item27.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item27.WomenThirdGroup = item27.WomenThirdGroup != 0 ? (1 + (int)item27.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item27.BusyThirdGroup = item27.BusyThirdGroup != 0 ? (1 + (int)item27.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId28)
                                {
                                    item28.Total1829 = item28.Total1829 != 0 ? (1 + (int)item28.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item28.Women1829 = item28.Women1829 != 0 ? (1 + (int)item28.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item28.Total1829 = item28.Total1829 != 0 ? (1 + (int)item28.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item28.Women1829 = item28.Women1829 != 0 ? (1 + (int)item28.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item28.Total3040 = item28.Total3040 != 0 ? (1 + (int)item28.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item28.Women3040 = item28.Women3040 != 0 ? (1 + (int)item28.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item28.Total45 = item28.Total45 != 0 ? (1 + (int)item28.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item28.Women45 = item28.Women45 != 0 ? (1 + (int)item28.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item28.TotalPersonsAge = item28.TotalPersonsAge != 0 ? (1 + (int)item28.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item28.WomenPersonsAge = item28.WomenPersonsAge != 0 ? (1 + (int)item28.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item28.FirstGroupAll = item28.FirstGroupAll != 0 ? (1 + (int)item28.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item28.WomenFirstGroup = item28.WomenFirstGroup != 0 ? (1 + (int)item28.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item28.BusyFirstGroup = item28.BusyFirstGroup != 0 ? (1 + (int)item28.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item28.SecondGroupAll = item28.SecondGroupAll != 0 ? (1 + (int)item28.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item28.WomenSecondGroup = item28.WomenSecondGroup != 0 ? (1 + (int)item28.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item28.BusySecondGroup = item28.BusySecondGroup != 0 ? (1 + (int)item28.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item28.ThirdGroupAll = item28.ThirdGroupAll != 0 ? (1 + (int)item28.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item28.WomenThirdGroup = item28.WomenThirdGroup != 0 ? (1 + (int)item28.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item28.BusyThirdGroup = item28.BusyThirdGroup != 0 ? (1 + (int)item28.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId29)
                                {
                                    item29.Total1829 = item29.Total1829 != 0 ? (1 + (int)item29.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item29.Women1829 = item29.Women1829 != 0 ? (1 + (int)item29.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item29.Total1829 = item29.Total1829 != 0 ? (1 + (int)item29.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item29.Women1829 = item29.Women1829 != 0 ? (1 + (int)item29.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item29.Total3040 = item29.Total3040 != 0 ? (1 + (int)item29.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item29.Women3040 = item29.Women3040 != 0 ? (1 + (int)item29.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item29.Total45 = item29.Total45 != 0 ? (1 + (int)item29.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item29.Women45 = item29.Women45 != 0 ? (1 + (int)item29.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item29.TotalPersonsAge = item29.TotalPersonsAge != 0 ? (1 + (int)item29.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item29.WomenPersonsAge = item29.WomenPersonsAge != 0 ? (1 + (int)item29.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item29.FirstGroupAll = item29.FirstGroupAll != 0 ? (1 + (int)item29.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item29.WomenFirstGroup = item29.WomenFirstGroup != 0 ? (1 + (int)item29.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item29.BusyFirstGroup = item29.BusyFirstGroup != 0 ? (1 + (int)item29.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item29.SecondGroupAll = item29.SecondGroupAll != 0 ? (1 + (int)item29.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item29.WomenSecondGroup = item29.WomenSecondGroup != 0 ? (1 + (int)item29.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item29.BusySecondGroup = item29.BusySecondGroup != 0 ? (1 + (int)item29.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item29.ThirdGroupAll = item29.ThirdGroupAll != 0 ? (1 + (int)item29.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item29.WomenThirdGroup = item29.WomenThirdGroup != 0 ? (1 + (int)item29.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item29.BusyThirdGroup = item29.BusyThirdGroup != 0 ? (1 + (int)item29.BusyThirdGroup) : 1;
                                        }
                                    }
                                }

                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId30)
                                {
                                    item30.Total1829 = item30.Total1829 != 0 ? (1 + (int)item30.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item30.Women1829 = item30.Women1829 != 0 ? (1 + (int)item30.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item30.Total1829 = item30.Total1829 != 0 ? (1 + (int)item30.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item30.Women1829 = item30.Women1829 != 0 ? (1 + (int)item30.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item30.Total3040 = item30.Total3040 != 0 ? (1 + (int)item30.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item30.Women3040 = item30.Women3040 != 0 ? (1 + (int)item30.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item30.Total45 = item30.Total45 != 0 ? (1 + (int)item30.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item30.Women45 = item30.Women45 != 0 ? (1 + (int)item30.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item30.TotalPersonsAge = item30.TotalPersonsAge != 0 ? (1 + (int)item30.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item30.WomenPersonsAge = item30.WomenPersonsAge != 0 ? (1 + (int)item30.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item30.FirstGroupAll = item30.FirstGroupAll != 0 ? (1 + (int)item30.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item30.WomenFirstGroup = item30.WomenFirstGroup != 0 ? (1 + (int)item30.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item30.BusyFirstGroup = item30.BusyFirstGroup != 0 ? (1 + (int)item30.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item30.SecondGroupAll = item30.SecondGroupAll != 0 ? (1 + (int)item30.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item30.WomenSecondGroup = item30.WomenSecondGroup != 0 ? (1 + (int)item30.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item30.BusySecondGroup = item30.BusySecondGroup != 0 ? (1 + (int)item30.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item30.ThirdGroupAll = item30.ThirdGroupAll != 0 ? (1 + (int)item30.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item30.WomenThirdGroup = item30.WomenThirdGroup != 0 ? (1 + (int)item30.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item30.BusyThirdGroup = item30.BusyThirdGroup != 0 ? (1 + (int)item30.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId31)
                                {
                                    item31.Total1829 = item31.Total1829 != 0 ? (1 + (int)item31.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item31.Women1829 = item31.Women1829 != 0 ? (1 + (int)item31.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item31.Total1829 = item31.Total1829 != 0 ? (1 + (int)item31.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item31.Women1829 = item31.Women1829 != 0 ? (1 + (int)item31.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item31.Total3040 = item31.Total3040 != 0 ? (1 + (int)item31.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item31.Women3040 = item31.Women3040 != 0 ? (1 + (int)item31.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item31.Total45 = item31.Total45 != 0 ? (1 + (int)item31.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item31.Women45 = item31.Women45 != 0 ? (1 + (int)item31.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item31.TotalPersonsAge = item31.TotalPersonsAge != 0 ? (1 + (int)item31.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item31.WomenPersonsAge = item31.WomenPersonsAge != 0 ? (1 + (int)item31.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item31.FirstGroupAll = item31.FirstGroupAll != 0 ? (1 + (int)item31.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item31.WomenFirstGroup = item31.WomenFirstGroup != 0 ? (1 + (int)item31.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item31.BusyFirstGroup = item31.BusyFirstGroup != 0 ? (1 + (int)item31.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item31.SecondGroupAll = item31.SecondGroupAll != 0 ? (1 + (int)item31.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item31.WomenSecondGroup = item31.WomenSecondGroup != 0 ? (1 + (int)item31.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item31.BusySecondGroup = item31.BusySecondGroup != 0 ? (1 + (int)item31.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item31.ThirdGroupAll = item31.ThirdGroupAll != 0 ? (1 + (int)item31.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item31.WomenThirdGroup = item31.WomenThirdGroup != 0 ? (1 + (int)item31.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item31.BusyThirdGroup = item31.BusyThirdGroup != 0 ? (1 + (int)item31.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId32)
                                {
                                    item32.Total1829 = item32.Total1829 != 0 ? (1 + (int)item32.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item32.Women1829 = item32.Women1829 != 0 ? (1 + (int)item32.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item32.Total1829 = item32.Total1829 != 0 ? (1 + (int)item32.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item32.Women1829 = item32.Women1829 != 0 ? (1 + (int)item32.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item32.Total3040 = item32.Total3040 != 0 ? (1 + (int)item32.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item32.Women3040 = item32.Women3040 != 0 ? (1 + (int)item32.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item32.Total45 = item32.Total45 != 0 ? (1 + (int)item32.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item32.Women45 = item32.Women45 != 0 ? (1 + (int)item32.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item32.TotalPersonsAge = item32.TotalPersonsAge != 0 ? (1 + (int)item32.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item32.WomenPersonsAge = item32.WomenPersonsAge != 0 ? (1 + (int)item32.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item32.FirstGroupAll = item32.FirstGroupAll != 0 ? (1 + (int)item32.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item32.WomenFirstGroup = item32.WomenFirstGroup != 0 ? (1 + (int)item32.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item32.BusyFirstGroup = item32.BusyFirstGroup != 0 ? (1 + (int)item32.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item32.SecondGroupAll = item32.SecondGroupAll != 0 ? (1 + (int)item32.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item32.WomenSecondGroup = item32.WomenSecondGroup != 0 ? (1 + (int)item32.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item32.BusySecondGroup = item32.BusySecondGroup != 0 ? (1 + (int)item32.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item32.ThirdGroupAll = item32.ThirdGroupAll != 0 ? (1 + (int)item32.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item32.WomenThirdGroup = item32.WomenThirdGroup != 0 ? (1 + (int)item32.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item32.BusyThirdGroup = item32.BusyThirdGroup != 0 ? (1 + (int)item32.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId33)
                                {
                                    item33.Total1829 = item33.Total1829 != 0 ? (1 + (int)item33.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item33.Women1829 = item33.Women1829 != 0 ? (1 + (int)item33.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item33.Total1829 = item33.Total1829 != 0 ? (1 + (int)item33.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item33.Women1829 = item33.Women1829 != 0 ? (1 + (int)item33.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item33.Total3040 = item33.Total3040 != 0 ? (1 + (int)item33.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item33.Women3040 = item33.Women3040 != 0 ? (1 + (int)item33.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item33.Total45 = item33.Total45 != 0 ? (1 + (int)item33.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item33.Women45 = item33.Women45 != 0 ? (1 + (int)item33.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item33.TotalPersonsAge = item33.TotalPersonsAge != 0 ? (1 + (int)item33.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item33.WomenPersonsAge = item33.WomenPersonsAge != 0 ? (1 + (int)item33.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item33.FirstGroupAll = item33.FirstGroupAll != 0 ? (1 + (int)item33.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item33.WomenFirstGroup = item33.WomenFirstGroup != 0 ? (1 + (int)item33.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item33.BusyFirstGroup = item33.BusyFirstGroup != 0 ? (1 + (int)item33.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item33.SecondGroupAll = item33.SecondGroupAll != 0 ? (1 + (int)item33.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item33.WomenSecondGroup = item33.WomenSecondGroup != 0 ? (1 + (int)item33.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item33.BusySecondGroup = item33.BusySecondGroup != 0 ? (1 + (int)item33.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item33.ThirdGroupAll = item33.ThirdGroupAll != 0 ? (1 + (int)item33.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item33.WomenThirdGroup = item33.WomenThirdGroup != 0 ? (1 + (int)item33.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item33.BusyThirdGroup = item33.BusyThirdGroup != 0 ? (1 + (int)item33.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId34)
                                {
                                    item34.Total1829 = item34.Total1829 != 0 ? (1 + (int)item34.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item34.Women1829 = item34.Women1829 != 0 ? (1 + (int)item34.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item34.Total1829 = item34.Total1829 != 0 ? (1 + (int)item34.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item34.Women1829 = item34.Women1829 != 0 ? (1 + (int)item34.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item34.Total3040 = item34.Total3040 != 0 ? (1 + (int)item34.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item34.Women3040 = item34.Women3040 != 0 ? (1 + (int)item34.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item34.Total45 = item34.Total45 != 0 ? (1 + (int)item34.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item34.Women45 = item34.Women45 != 0 ? (1 + (int)item34.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item34.TotalPersonsAge = item34.TotalPersonsAge != 0 ? (1 + (int)item34.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item34.WomenPersonsAge = item34.WomenPersonsAge != 0 ? (1 + (int)item34.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item34.FirstGroupAll = item34.FirstGroupAll != 0 ? (1 + (int)item34.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item34.WomenFirstGroup = item34.WomenFirstGroup != 0 ? (1 + (int)item34.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item34.BusyFirstGroup = item34.BusyFirstGroup != 0 ? (1 + (int)item34.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item34.SecondGroupAll = item34.SecondGroupAll != 0 ? (1 + (int)item34.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item34.WomenSecondGroup = item34.WomenSecondGroup != 0 ? (1 + (int)item34.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item34.BusySecondGroup = item34.BusySecondGroup != 0 ? (1 + (int)item34.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item34.ThirdGroupAll = item34.ThirdGroupAll != 0 ? (1 + (int)item34.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item34.WomenThirdGroup = item34.WomenThirdGroup != 0 ? (1 + (int)item34.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item34.BusyThirdGroup = item34.BusyThirdGroup != 0 ? (1 + (int)item34.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId35)
                                {
                                    item35.Total1829 = item35.Total1829 != 0 ? (1 + (int)item35.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item35.Women1829 = item35.Women1829 != 0 ? (1 + (int)item35.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item35.Total1829 = item35.Total1829 != 0 ? (1 + (int)item35.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item35.Women1829 = item35.Women1829 != 0 ? (1 + (int)item35.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item35.Total3040 = item35.Total3040 != 0 ? (1 + (int)item35.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item35.Women3040 = item35.Women3040 != 0 ? (1 + (int)item35.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item35.Total45 = item35.Total45 != 0 ? (1 + (int)item35.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item35.Women45 = item35.Women45 != 0 ? (1 + (int)item35.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item35.TotalPersonsAge = item35.TotalPersonsAge != 0 ? (1 + (int)item35.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item35.WomenPersonsAge = item35.WomenPersonsAge != 0 ? (1 + (int)item35.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item35.FirstGroupAll = item35.FirstGroupAll != 0 ? (1 + (int)item35.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item35.WomenFirstGroup = item35.WomenFirstGroup != 0 ? (1 + (int)item35.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item35.BusyFirstGroup = item35.BusyFirstGroup != 0 ? (1 + (int)item35.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item35.SecondGroupAll = item35.SecondGroupAll != 0 ? (1 + (int)item35.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item35.WomenSecondGroup = item35.WomenSecondGroup != 0 ? (1 + (int)item35.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item35.BusySecondGroup = item35.BusySecondGroup != 0 ? (1 + (int)item35.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item35.ThirdGroupAll = item35.ThirdGroupAll != 0 ? (1 + (int)item35.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item35.WomenThirdGroup = item35.WomenThirdGroup != 0 ? (1 + (int)item35.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item35.BusyThirdGroup = item35.BusyThirdGroup != 0 ? (1 + (int)item35.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId36)
                                {
                                    item36.Total1829 = item36.Total1829 != 0 ? (1 + (int)item36.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item36.Women1829 = item36.Women1829 != 0 ? (1 + (int)item36.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item36.Total1829 = item36.Total1829 != 0 ? (1 + (int)item36.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item36.Women1829 = item36.Women1829 != 0 ? (1 + (int)item36.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item36.Total3040 = item36.Total3040 != 0 ? (1 + (int)item36.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item36.Women3040 = item36.Women3040 != 0 ? (1 + (int)item36.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item36.Total45 = item36.Total45 != 0 ? (1 + (int)item36.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item36.Women45 = item36.Women45 != 0 ? (1 + (int)item36.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item36.TotalPersonsAge = item36.TotalPersonsAge != 0 ? (1 + (int)item36.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item36.WomenPersonsAge = item36.WomenPersonsAge != 0 ? (1 + (int)item36.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item36.FirstGroupAll = item36.FirstGroupAll != 0 ? (1 + (int)item36.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item36.WomenFirstGroup = item36.WomenFirstGroup != 0 ? (1 + (int)item36.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item36.BusyFirstGroup = item36.BusyFirstGroup != 0 ? (1 + (int)item36.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item36.SecondGroupAll = item36.SecondGroupAll != 0 ? (1 + (int)item36.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item36.WomenSecondGroup = item36.WomenSecondGroup != 0 ? (1 + (int)item36.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item36.BusySecondGroup = item36.BusySecondGroup != 0 ? (1 + (int)item36.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item36.ThirdGroupAll = item36.ThirdGroupAll != 0 ? (1 + (int)item36.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item36.WomenThirdGroup = item36.WomenThirdGroup != 0 ? (1 + (int)item36.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item36.BusyThirdGroup = item36.BusyThirdGroup != 0 ? (1 + (int)item36.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId37)
                                {
                                    item37.Total1829 = item37.Total1829 != 0 ? (1 + (int)item37.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item37.Women1829 = item37.Women1829 != 0 ? (1 + (int)item37.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item37.Total1829 = item37.Total1829 != 0 ? (1 + (int)item37.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item37.Women1829 = item37.Women1829 != 0 ? (1 + (int)item37.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item37.Total3040 = item37.Total3040 != 0 ? (1 + (int)item37.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item37.Women3040 = item37.Women3040 != 0 ? (1 + (int)item37.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item37.Total45 = item37.Total45 != 0 ? (1 + (int)item37.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item37.Women45 = item37.Women45 != 0 ? (1 + (int)item37.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item37.TotalPersonsAge = item37.TotalPersonsAge != 0 ? (1 + (int)item37.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item37.WomenPersonsAge = item37.WomenPersonsAge != 0 ? (1 + (int)item37.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item37.FirstGroupAll = item37.FirstGroupAll != 0 ? (1 + (int)item37.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item37.WomenFirstGroup = item37.WomenFirstGroup != 0 ? (1 + (int)item37.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item37.BusyFirstGroup = item37.BusyFirstGroup != 0 ? (1 + (int)item37.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item37.SecondGroupAll = item37.SecondGroupAll != 0 ? (1 + (int)item37.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item37.WomenSecondGroup = item37.WomenSecondGroup != 0 ? (1 + (int)item37.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item37.BusySecondGroup = item37.BusySecondGroup != 0 ? (1 + (int)item37.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item37.ThirdGroupAll = item37.ThirdGroupAll != 0 ? (1 + (int)item37.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item37.WomenThirdGroup = item37.WomenThirdGroup != 0 ? (1 + (int)item37.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item37.BusyThirdGroup = item37.BusyThirdGroup != 0 ? (1 + (int)item37.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId38)
                                {
                                    item38.Total1829 = item38.Total1829 != 0 ? (1 + (int)item38.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item38.Women1829 = item38.Women1829 != 0 ? (1 + (int)item38.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item38.Total1829 = item38.Total1829 != 0 ? (1 + (int)item38.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item38.Women1829 = item38.Women1829 != 0 ? (1 + (int)item38.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item38.Total3040 = item38.Total3040 != 0 ? (1 + (int)item38.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item38.Women3040 = item38.Women3040 != 0 ? (1 + (int)item38.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item38.Total45 = item38.Total45 != 0 ? (1 + (int)item38.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item38.Women45 = item38.Women45 != 0 ? (1 + (int)item38.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item38.TotalPersonsAge = item38.TotalPersonsAge != 0 ? (1 + (int)item38.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item38.WomenPersonsAge = item38.WomenPersonsAge != 0 ? (1 + (int)item38.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item38.FirstGroupAll = item38.FirstGroupAll != 0 ? (1 + (int)item38.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item38.WomenFirstGroup = item38.WomenFirstGroup != 0 ? (1 + (int)item38.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item38.BusyFirstGroup = item38.BusyFirstGroup != 0 ? (1 + (int)item38.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item38.SecondGroupAll = item38.SecondGroupAll != 0 ? (1 + (int)item38.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item38.WomenSecondGroup = item38.WomenSecondGroup != 0 ? (1 + (int)item38.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item38.BusySecondGroup = item38.BusySecondGroup != 0 ? (1 + (int)item38.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item38.ThirdGroupAll = item38.ThirdGroupAll != 0 ? (1 + (int)item38.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item38.WomenThirdGroup = item38.WomenThirdGroup != 0 ? (1 + (int)item38.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item38.BusyThirdGroup = item38.BusyThirdGroup != 0 ? (1 + (int)item38.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId39)
                                {
                                    item39.Total1829 = item39.Total1829 != 0 ? (1 + (int)item39.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item39.Women1829 = item39.Women1829 != 0 ? (1 + (int)item39.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item39.Total1829 = item39.Total1829 != 0 ? (1 + (int)item39.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item39.Women1829 = item39.Women1829 != 0 ? (1 + (int)item39.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item39.Total3040 = item39.Total3040 != 0 ? (1 + (int)item39.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item39.Women3040 = item39.Women3040 != 0 ? (1 + (int)item39.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item39.Total45 = item39.Total45 != 0 ? (1 + (int)item39.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item39.Women45 = item39.Women45 != 0 ? (1 + (int)item39.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item39.TotalPersonsAge = item39.TotalPersonsAge != 0 ? (1 + (int)item39.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item39.WomenPersonsAge = item39.WomenPersonsAge != 0 ? (1 + (int)item39.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item39.FirstGroupAll = item39.FirstGroupAll != 0 ? (1 + (int)item39.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item39.WomenFirstGroup = item39.WomenFirstGroup != 0 ? (1 + (int)item39.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item39.BusyFirstGroup = item39.BusyFirstGroup != 0 ? (1 + (int)item39.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item39.SecondGroupAll = item39.SecondGroupAll != 0 ? (1 + (int)item39.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item39.WomenSecondGroup = item39.WomenSecondGroup != 0 ? (1 + (int)item39.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item39.BusySecondGroup = item39.BusySecondGroup != 0 ? (1 + (int)item39.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item39.ThirdGroupAll = item39.ThirdGroupAll != 0 ? (1 + (int)item39.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item39.WomenThirdGroup = item39.WomenThirdGroup != 0 ? (1 + (int)item39.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item39.BusyThirdGroup = item39.BusyThirdGroup != 0 ? (1 + (int)item39.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId40)
                                {
                                    item40.Total1829 = item40.Total1829 != 0 ? (1 + (int)item40.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item40.Women1829 = item40.Women1829 != 0 ? (1 + (int)item40.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item40.Total1829 = item40.Total1829 != 0 ? (1 + (int)item40.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40.Women1829 = item40.Women1829 != 0 ? (1 + (int)item40.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item40.Total3040 = item40.Total3040 != 0 ? (1 + (int)item40.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40.Women3040 = item40.Women3040 != 0 ? (1 + (int)item40.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item40.Total45 = item40.Total45 != 0 ? (1 + (int)item40.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40.Women45 = item40.Women45 != 0 ? (1 + (int)item40.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item40.TotalPersonsAge = item40.TotalPersonsAge != 0 ? (1 + (int)item40.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40.WomenPersonsAge = item40.WomenPersonsAge != 0 ? (1 + (int)item40.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item40.FirstGroupAll = item40.FirstGroupAll != 0 ? (1 + (int)item40.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40.WomenFirstGroup = item40.WomenFirstGroup != 0 ? (1 + (int)item40.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item40.BusyFirstGroup = item40.BusyFirstGroup != 0 ? (1 + (int)item40.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item40.SecondGroupAll = item40.SecondGroupAll != 0 ? (1 + (int)item40.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40.WomenSecondGroup = item40.WomenSecondGroup != 0 ? (1 + (int)item40.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item40.BusySecondGroup = item40.BusySecondGroup != 0 ? (1 + (int)item40.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item40.ThirdGroupAll = item40.ThirdGroupAll != 0 ? (1 + (int)item40.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40.WomenThirdGroup = item40.WomenThirdGroup != 0 ? (1 + (int)item40.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item40.BusyThirdGroup = item40.BusyThirdGroup != 0 ? (1 + (int)item40.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId41)
                                {
                                    item41.Total1829 = item41.Total1829 != 0 ? (1 + (int)item41.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item41.Women1829 = item41.Women1829 != 0 ? (1 + (int)item41.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item41.Total1829 = item41.Total1829 != 0 ? (1 + (int)item41.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item41.Women1829 = item41.Women1829 != 0 ? (1 + (int)item41.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item41.Total3040 = item41.Total3040 != 0 ? (1 + (int)item41.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item41.Women3040 = item41.Women3040 != 0 ? (1 + (int)item41.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item41.Total45 = item41.Total45 != 0 ? (1 + (int)item41.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item41.Women45 = item41.Women45 != 0 ? (1 + (int)item41.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item41.TotalPersonsAge = item41.TotalPersonsAge != 0 ? (1 + (int)item41.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item41.WomenPersonsAge = item41.WomenPersonsAge != 0 ? (1 + (int)item41.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item41.FirstGroupAll = item41.FirstGroupAll != 0 ? (1 + (int)item41.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item41.WomenFirstGroup = item41.WomenFirstGroup != 0 ? (1 + (int)item41.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item41.BusyFirstGroup = item41.BusyFirstGroup != 0 ? (1 + (int)item41.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item41.SecondGroupAll = item41.SecondGroupAll != 0 ? (1 + (int)item41.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item41.WomenSecondGroup = item41.WomenSecondGroup != 0 ? (1 + (int)item41.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item41.BusySecondGroup = item41.BusySecondGroup != 0 ? (1 + (int)item41.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item41.ThirdGroupAll = item41.ThirdGroupAll != 0 ? (1 + (int)item41.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item41.WomenThirdGroup = item41.WomenThirdGroup != 0 ? (1 + (int)item41.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item41.BusyThirdGroup = item41.BusyThirdGroup != 0 ? (1 + (int)item41.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId42)
                                {
                                    item42.Total1829 = item42.Total1829 != 0 ? (1 + (int)item42.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item42.Women1829 = item42.Women1829 != 0 ? (1 + (int)item42.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item42.Total1829 = item42.Total1829 != 0 ? (1 + (int)item42.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item42.Women1829 = item42.Women1829 != 0 ? (1 + (int)item42.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item42.Total3040 = item42.Total3040 != 0 ? (1 + (int)item42.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item42.Women3040 = item42.Women3040 != 0 ? (1 + (int)item42.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item42.Total45 = item42.Total45 != 0 ? (1 + (int)item42.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item42.Women45 = item42.Women45 != 0 ? (1 + (int)item42.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item42.TotalPersonsAge = item42.TotalPersonsAge != 0 ? (1 + (int)item42.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item42.WomenPersonsAge = item42.WomenPersonsAge != 0 ? (1 + (int)item42.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item42.FirstGroupAll = item42.FirstGroupAll != 0 ? (1 + (int)item42.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item42.WomenFirstGroup = item42.WomenFirstGroup != 0 ? (1 + (int)item42.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item42.BusyFirstGroup = item42.BusyFirstGroup != 0 ? (1 + (int)item42.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item42.SecondGroupAll = item42.SecondGroupAll != 0 ? (1 + (int)item42.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item42.WomenSecondGroup = item42.WomenSecondGroup != 0 ? (1 + (int)item42.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item42.BusySecondGroup = item42.BusySecondGroup != 0 ? (1 + (int)item42.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item42.ThirdGroupAll = item42.ThirdGroupAll != 0 ? (1 + (int)item42.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item42.WomenThirdGroup = item42.WomenThirdGroup != 0 ? (1 + (int)item42.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item42.BusyThirdGroup = item42.BusyThirdGroup != 0 ? (1 + (int)item42.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId43)
                                {
                                    item43.Total1829 = item43.Total1829 != 0 ? (1 + (int)item43.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item43.Women1829 = item43.Women1829 != 0 ? (1 + (int)item43.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item43.Total1829 = item43.Total1829 != 0 ? (1 + (int)item43.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item43.Women1829 = item43.Women1829 != 0 ? (1 + (int)item43.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item43.Total3040 = item43.Total3040 != 0 ? (1 + (int)item43.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item43.Women3040 = item43.Women3040 != 0 ? (1 + (int)item43.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item43.Total45 = item43.Total45 != 0 ? (1 + (int)item43.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item43.Women45 = item43.Women45 != 0 ? (1 + (int)item43.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item43.TotalPersonsAge = item43.TotalPersonsAge != 0 ? (1 + (int)item43.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item43.WomenPersonsAge = item43.WomenPersonsAge != 0 ? (1 + (int)item43.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item43.FirstGroupAll = item43.FirstGroupAll != 0 ? (1 + (int)item43.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item43.WomenFirstGroup = item43.WomenFirstGroup != 0 ? (1 + (int)item43.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item43.BusyFirstGroup = item43.BusyFirstGroup != 0 ? (1 + (int)item43.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item43.SecondGroupAll = item43.SecondGroupAll != 0 ? (1 + (int)item43.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item43.WomenSecondGroup = item43.WomenSecondGroup != 0 ? (1 + (int)item43.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item43.BusySecondGroup = item43.BusySecondGroup != 0 ? (1 + (int)item43.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item43.ThirdGroupAll = item43.ThirdGroupAll != 0 ? (1 + (int)item43.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item43.WomenThirdGroup = item43.WomenThirdGroup != 0 ? (1 + (int)item43.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item43.BusyThirdGroup = item43.BusyThirdGroup != 0 ? (1 + (int)item43.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId44)
                                {
                                    item44.Total1829 = item44.Total1829 != 0 ? (1 + (int)item44.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item44.Women1829 = item44.Women1829 != 0 ? (1 + (int)item44.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item44.Total1829 = item44.Total1829 != 0 ? (1 + (int)item44.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item44.Women1829 = item44.Women1829 != 0 ? (1 + (int)item44.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item44.Total3040 = item44.Total3040 != 0 ? (1 + (int)item44.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item44.Women3040 = item44.Women3040 != 0 ? (1 + (int)item44.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item44.Total45 = item44.Total45 != 0 ? (1 + (int)item44.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item44.Women45 = item44.Women45 != 0 ? (1 + (int)item44.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item44.TotalPersonsAge = item44.TotalPersonsAge != 0 ? (1 + (int)item44.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item44.WomenPersonsAge = item44.WomenPersonsAge != 0 ? (1 + (int)item44.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item44.FirstGroupAll = item44.FirstGroupAll != 0 ? (1 + (int)item44.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item44.WomenFirstGroup = item44.WomenFirstGroup != 0 ? (1 + (int)item44.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item44.BusyFirstGroup = item44.BusyFirstGroup != 0 ? (1 + (int)item44.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item44.SecondGroupAll = item44.SecondGroupAll != 0 ? (1 + (int)item44.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item44.WomenSecondGroup = item44.WomenSecondGroup != 0 ? (1 + (int)item44.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item44.BusySecondGroup = item44.BusySecondGroup != 0 ? (1 + (int)item44.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item44.ThirdGroupAll = item44.ThirdGroupAll != 0 ? (1 + (int)item44.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item44.WomenThirdGroup = item44.WomenThirdGroup != 0 ? (1 + (int)item44.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item44.BusyThirdGroup = item44.BusyThirdGroup != 0 ? (1 + (int)item44.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId45)
                                {
                                    item45.Total1829 = item45.Total1829 != 0 ? (1 + (int)item45.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item45.Women1829 = item45.Women1829 != 0 ? (1 + (int)item45.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item45.Total1829 = item45.Total1829 != 0 ? (1 + (int)item45.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item45.Women1829 = item45.Women1829 != 0 ? (1 + (int)item45.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item45.Total3040 = item45.Total3040 != 0 ? (1 + (int)item45.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item45.Women3040 = item45.Women3040 != 0 ? (1 + (int)item45.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item45.Total45 = item45.Total45 != 0 ? (1 + (int)item45.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item45.Women45 = item45.Women45 != 0 ? (1 + (int)item45.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item45.TotalPersonsAge = item45.TotalPersonsAge != 0 ? (1 + (int)item45.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item45.WomenPersonsAge = item45.WomenPersonsAge != 0 ? (1 + (int)item45.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item45.FirstGroupAll = item45.FirstGroupAll != 0 ? (1 + (int)item45.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item45.WomenFirstGroup = item45.WomenFirstGroup != 0 ? (1 + (int)item45.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item45.BusyFirstGroup = item45.BusyFirstGroup != 0 ? (1 + (int)item45.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item45.SecondGroupAll = item45.SecondGroupAll != 0 ? (1 + (int)item45.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item45.WomenSecondGroup = item45.WomenSecondGroup != 0 ? (1 + (int)item45.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item45.BusySecondGroup = item45.BusySecondGroup != 0 ? (1 + (int)item45.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item45.ThirdGroupAll = item45.ThirdGroupAll != 0 ? (1 + (int)item45.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item45.WomenThirdGroup = item45.WomenThirdGroup != 0 ? (1 + (int)item45.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item45.BusyThirdGroup = item45.BusyThirdGroup != 0 ? (1 + (int)item45.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                if (diagnos == strDiagId41 || diagnos == strDiagId42 || diagnos == strDiagId43 || diagnos == strDiagId44 || diagnos == strDiagId45)
                                {
                                    item40_1.Total1829 = item40_1.Total1829 != 0 ? (1 + (int)item40_1.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item40_1.Women1829 = item40_1.Women1829 != 0 ? (1 + (int)item40_1.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item40_1.Total1829 = item40_1.Total1829 != 0 ? (1 + (int)item40_1.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40_1.Women1829 = item40_1.Women1829 != 0 ? (1 + (int)item40_1.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item40_1.Total3040 = item40_1.Total3040 != 0 ? (1 + (int)item40_1.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40_1.Women3040 = item40_1.Women3040 != 0 ? (1 + (int)item40_1.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item40_1.Total45 = item40_1.Total45 != 0 ? (1 + (int)item40_1.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40_1.Women45 = item40_1.Women45 != 0 ? (1 + (int)item40_1.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item40_1.TotalPersonsAge = item40_1.TotalPersonsAge != 0 ? (1 + (int)item40_1.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40_1.WomenPersonsAge = item40_1.WomenPersonsAge != 0 ? (1 + (int)item40_1.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item40_1.FirstGroupAll = item40_1.FirstGroupAll != 0 ? (1 + (int)item40_1.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40_1.WomenFirstGroup = item40_1.WomenFirstGroup != 0 ? (1 + (int)item40_1.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item40_1.BusyFirstGroup = item40_1.BusyFirstGroup != 0 ? (1 + (int)item40_1.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item40_1.SecondGroupAll = item40_1.SecondGroupAll != 0 ? (1 + (int)item40_1.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40_1.WomenSecondGroup = item40_1.WomenSecondGroup != 0 ? (1 + (int)item40_1.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item40_1.BusySecondGroup = item40_1.BusySecondGroup != 0 ? (1 + (int)item40_1.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item40_1.ThirdGroupAll = item40_1.ThirdGroupAll != 0 ? (1 + (int)item40_1.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40_1.WomenThirdGroup = item40_1.WomenThirdGroup != 0 ? (1 + (int)item40_1.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item40_1.BusyThirdGroup = item40_1.BusyThirdGroup != 0 ? (1 + (int)item40_1.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            static void RemoveRows(WorkflowContext context, Guid reportId)
            {
                var docRepo = context.Documents;
                var rows = new List<Guid>();
                var qb = new QueryBuilder(reportItemDefId, context.UserId);
                qb.Where("Report").Eq(reportId).Or("Report").IsNull();
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read()) rows.Add(reader.GetGuid(0));
                }
                foreach (var rowId in rows)
                {
                    docRepo.DeleteById(rowId);
                }
            }
            private static readonly Guid reportDefId = new Guid("{17789FEE-2908-4E01-8E16-2ECAF4A75C7A}"); //Отчет о распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности
            private static readonly Guid reportItemDefId = new Guid("{10AB1374-EA9C-493B-B5F6-CD6A40273B9B}"); //Распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности

            private static readonly Guid adultsStatCardDefId = new Guid("{C77A6FF6-EC0B-4562-81FE-BB3BC17F4FDB}"); //Статистический талон для взрослых
            private static readonly Guid adultsActDefId = new Guid("{12AE380B-39CE-4753-A556-4083BD4B0F92}"); //Медицинский акт для взрослых
            private static readonly Guid personDefId = new Guid("{D71CE61A-9B59-4B5E-8713-8131DBB5BA02}"); //Person 
            public static readonly Guid districtDefId = new Guid("{A3FCA356-82A9-4BBD-872A-8333BEC6E41A}"); //Район
            public static readonly Guid cityDefId = new Guid("{4BB6D32D-5181-4031-BA49-CF5910D6D883}"); //Города районного значения

            public static readonly Guid ageOf1EnumId = new Guid("{027AEA0C-3C1D-4354-BEFF-4C89E06AF8B5}"); //От 18-29 лет
            public static readonly Guid ageOf2EnumId = new Guid("{6FC02932-97DD-48B9-93C8-FBD017C86707}"); //От 30-44 лет
            public static readonly Guid ageOf3EnumId = new Guid("{336A7447-4E55-44B8-8BA0-D7A156B7444A}"); //От 45-до пенсионного возраста
            public static readonly Guid ageOf4EnumId = new Guid("{9B207DB0-8214-4BA7-A8C4-635EF87B583A}"); //лицо пенсионного возраста

            public static readonly Guid group1EnumId = new Guid("{D145ABA1-EADA-442B-9D8D-AD10BCD126D2}"); //Первая
            public static readonly Guid group2EnumId = new Guid("{C161DA2D-2883-4211-B444-CBB04DBF33D5}"); //Вторая
            public static readonly Guid group3EnumId = new Guid("{CCD439CA-1500-4F7A-A1C8-BB474B5DE8AA}"); //Третья

            public static readonly Guid cityEnumId = new Guid("{DE3D24A1-64D3-4647-B711-31F334D24416}"); //Городская местность//DistrictType
            public static readonly Guid womanEnumId = new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"); //Женский пол
            public static readonly Guid primaryEnumId = new Guid("{34129BC5-5B31-4189-87FA-799402F7E99F}"); //Первичное
            public static readonly Guid ApprovedStateId = new Guid("{32062CB7-C31C-4AFB-ADF3-F9F9AEEFCE59}");  //Подписанные

            //диагнозы
            private static readonly Guid strDiagId2 = new Guid("{9FF329FE-F547-42BE-817F-ED989FFB6573}"); //Туберкулез/ А 15-19
            private static readonly Guid strDiagId3 = new Guid("{99BC4A06-B78C-4A88-9F5C-AD4835563758}"); //Туберкулез  легких/ А 15-16
            private static readonly Guid strDiagId4 = new Guid("{2F9950BC-62B8-4B2B-865A-1C9C080CCC4E}"); //Злокачественные новообразования/ С 00-97
            private static readonly Guid strDiagId5 = new Guid("{C9CDD032-DC56-4027-A7D8-DBFE2F29BDE2}"); //Болезни эндокринной системы, нарушения обмена веществ/ Е 00-90
            private static readonly Guid strDiagId6 = new Guid("{C22D27F2-89F8-4355-A962-8EDE8294D052}"); //Заболeвания щитовидной железы/ E 00-07
            private static readonly Guid strDiagId7 = new Guid("{81E09427-D877-4C77-8609-E813D1BAF5FF}"); //Сахарный диабет/ E 10-14
            private static readonly Guid strDiagId8 = new Guid("{7ACAB39A-5CEE-4EF0-AAAB-10764F111DC0}"); //Психические расстройства/ F 00-99
            private static readonly Guid strDiagId9 = new Guid("{1F2922AB-423A-4997-BAB8-5D18538B5A15}"); //Шизофрения/ F 20
            private static readonly Guid strDiagId10 = new Guid("{22E82EC9-8BAA-48FD-AFD8-17619B0AD476}"); //Умственная отсталость/ F 70-79
            private static readonly Guid strDiagId11 = new Guid("{4BB66F12-B96C-4917-BFB3-0947D41AFA52}"); //Болезни нервной системы/ G 00-99     
            private static readonly Guid strDiagId12 = new Guid("{DFE168E8-7E30-4D8A-9AEF-54382B0A3932}"); //Болезни периферической нервной системы/ G 50-64  
            private static readonly Guid strDiagId13 = new Guid("{40012DC1-53A1-4EE7-8F93-85547C827DB5}"); //Болезни органов чувств/ H 00-95
            private static readonly Guid strDiagId14 = new Guid("{24483E18-28AC-4981-9C29-B94075BE9725}"); //Болезни глаз/ H 00-59  
            private static readonly Guid strDiagId15 = new Guid("{558D6E2E-E1E0-4D37-B200-A94D9953099F}"); //Болезни уха и сосцевидного отростка/ H 60-95
            private static readonly Guid strDiagId16 = new Guid("{E3D6EF80-B5E4-4DAE-9832-19FAD50A80F3}"); //Болезни системы кровообращения/ I 00-99 
            private static readonly Guid strDiagId17 = new Guid("{D71970B1-0562-4905-AC26-77DE739CAF5C}"); //Хронические ревматические болезни сердца/  I 05-09
            private static readonly Guid strDiagId18 = new Guid("{E6D6A67F-ED33-4879-B1C2-9BC173BB457B}"); //Повышенное кровеносное давление/ I 10-15  
            private static readonly Guid strDiagId19 = new Guid("{10712C7B-4FDC-4B6F-A50B-B7858FDD1211}"); //Ишемическая болезнь сердца/ I 20-25
            private static readonly Guid strDiagId20 = new Guid("{9549B0FD-2F0D-488A-8228-E990B01288D8}"); //Цереброваскулярные болезни/ I 60-69
            //private static readonly Guid strDiagId21 = new Guid("В СПИСКЕ ДИАГНОЗОВ НЕ НАШЛА"); //врожденные пороки сердца Q 20-28
            private static readonly Guid strDiagId22 = new Guid("{3363DE1E-864C-4063-BED7-4526F673AFF6}"); //Болезни органов дыхания / J 00-99
            private static readonly Guid strDiagId23 = new Guid("{866F3B61-AFCF-45F5-97BE-E0C23B87393C}"); //Бронхиальная астма/ J 45
            private static readonly Guid strDiagId24 = new Guid("{05479FEC-BC19-42B8-A0EC-37C63CE91205}"); //Болезни органов пищеварения/ K 00-93
            private static readonly Guid strDiagId25 = new Guid("{ECC9E612-FB40-4344-8298-5CD8BA40635F}"); //Болезни костно-мешечной системы и соединительной ткани/ M 00-99
            private static readonly Guid strDiagId26 = new Guid("{B3000363-8258-4F07-8234-0DE79E053660}"); //Ревматоидные/ M 05-14 
            private static readonly Guid strDiagId27 = new Guid("{1D4E81CB-2315-44C9-BDF3-B0FA874B8E61}"); //Остеохондроз позвоночника/ M 42
            private static readonly Guid strDiagId28 = new Guid("{3E0E50B5-9A3A-4DA2-A098-7147CB19833D}"); //Болезни мочевыводящих органов/ N 00-99
            private static readonly Guid strDiagId29 = new Guid("{82D1F915-CADF-4E7F-91A9-36B84CAB5A85}"); //Травмы, отравления и другие воздействия внешних причин/ S00 T98    
            private static readonly Guid strDiagId30 = new Guid("{FC38C0AE-2C54-4609-B728-517D5BC481CF}"); //Травма глаз/ T 90.4   
            private static readonly Guid strDiagId31 = new Guid("{961BB1B1-2C65-4833-86FA-2FC02CBCDDA8}"); //Болезни вследствие воздействия ионизирующего облучения/ W 88
            private static readonly Guid strDiagId32 = new Guid("{F702AAD3-523D-4914-8B97-5D2B9905D231}"); //Болезни вследствие воздействия вибрации/ W 43 
            private static readonly Guid strDiagId33 = new Guid("{E7271846-9AAA-4C52-AA19-CB01C3B765A2}"); //Болезни крови, кроветворных органов/ D 50-89
            private static readonly Guid strDiagId34 = new Guid("{41F09403-B4B7-46CA-92BF-B716523AFDE9}"); //Доброкачественные новообразования/ D 10-36
            private static readonly Guid strDiagId35 = new Guid("{D4050056-32C3-48FD-9718-EA7FE3294E82}"); //Бруцеллез/ A 23
            private static readonly Guid strDiagId36 = new Guid("{1DEDD889-4336-4622-85C0-9DDD1FF432D9}"); //Бруцеллез бытовой/ A 23
            private static readonly Guid strDiagId37 = new Guid("{F3B64F5D-6A6C-4343-B5B5-7B5E3CB92474}"); //Эхинококкоз/ B 67     
            private static readonly Guid strDiagId38 = new Guid("{0CEAC906-B3D2-4AD8-9DE6-D3FA384F2CDF}"); //Врожденные пороки развития, хромосомные развития/ Q 00-99
            private static readonly Guid strDiagId39 = new Guid("{07C6C658-D589-48A1-803B-DBCA6603B543}"); //Болезни вызванные вирусом ВИЧ (СПИД)/ B 20-24
            private static readonly Guid strDiagId40 = new Guid("{0ADE4B55-DF1D-46EA-954B-F3F9FB7CAE08}"); //Прочие болезни / Прочие
            private static readonly Guid strDiagId41 = new Guid("{25029E6F-916F-44DE-86B0-C018A8055D4F}"); //Трудовое увечье    
            private static readonly Guid strDiagId42 = new Guid("{8F30CA1F-9187-463E-9D26-1BD525BF45F6}"); //Профессиональные болезни
            private static readonly Guid strDiagId43 = new Guid("{CBEBAF9D-B67D-4BB3-B715-DB252DC2C018}"); //Ликвидаторы последствий аварии на ЧАЭС
            private static readonly Guid strDiagId44 = new Guid("{C0B08AFD-85BB-4DB1-8D9D-6ED3CA43438E}"); //Пострадавшие в событиях 2010г. Бишкек, Талас    
            private static readonly Guid strDiagId45 = new Guid("{6A2CF4F5-E0FC-4D70-9DD3-DA23F3049CD2}"); //Пострадавшие в событиях 2010г. Ош, Жалал-Абад   
        }

        //Отчет о результатах первичных освидетельствований всех социальных категорий населения (СЕЛЬСКАЯ МЕСТНОСТЬ) 
        public static class PrimaryInvalidsOfVillage
        {
            public static List<Report1Item> Execute(WorkflowContext context, int year, string distrSpr)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;

                /******************************************************************************************************************/
                var docs = new string[]
                {
                    "всего  01           ",
                    "в том числе: туберкулез  02   А15-19  ",
                    "из них: туберкулез легких  02.1 А15-16  ",
                    "злокачественные новообразования  03   С00-97  ",
                    "б-ни эндокринной с-мы, нар-я обмена веществ  04   Е00-90  ",
                    "из них: заболевания щитовидной железы  04.1 Е00-07  ",
                    "сахарный диабет  04.2 Е10-14  ",
                    "психич-ие расстройства  05   F 00-99 ",
                    "из них шизофрения  05.1 F 20    ",
                    "умственная отсталость  05.2 F 70-79 ",
                    "болезни нервной системы  06   G 00-99 ",
                    "из них: болезни перифери-ческой нервной системы  06.1 G 60-64 ",
                    "болезни органов чувств  07   H 00-95 ",
                    "болезни глаз  07.1 H 00-59 ",
                    "болезни уха и сосцевидного отростка  07.2 H 60-95 ",
                    "болезни системы кровообращения  08   I 00-99 ",
                    "из них: хронические ревматические б-и сердца  08.1 I 05-09 ",
                    "болезни, характеризующиеся повышенным кровяным давлением  08.2 I 10-15 ",
                    "ишемическая болезнь сердца  08.3 I 20-25 ",
                    "цереброваскулярные болезни  08.4 I 60-69 ",
                    "врожденные пороки сердца  09   Q 20-28 ",
                    "болезни органов дыхания  10   J 00-99 ",
                    "из них бронхиальная астма  10.1 J 45    ",
                    "болезни органов пищеварения  11   K 00-93 ",
                    "болезни костно-мышечной системы и соединительной ткани  12   M00-99 ",
                    "из них: ревматоидные  12.1 M05-14  ",
                    "остеохондроз позвоночника  12.2 M 42    ",
                    "болезни мочевывоводящих органов  13   N 00-99 ",
                    "травмы, отравления и другие воздействия внешних причин  14   S 00-Т98",
                    "травма глаз  14.1 S 05    ",
                    "б-ни вследствие возд-я ионизирующего облучения  15   W 88    ",
                    "б-ни вследствие воздействия вибрации  16   W 43    ",
                    "болезни крови  17   D 50-89 ",
                    "доброкачественные новообразования  18   D 10-36 ",
                    "бруцеллез  19   A 23    ",
                    "бруцеллез бытовой  19.1 A 23    ",
                    "эхинококкоз  20   B 67    ",
                    "врожд пороки развития, хромосомные нарушения  21   Q 00-99 ",
                    "болезни вызванные вирусом  ВИЧ (СПИД)  22   B 20-24 ",
                    "прочие болезни  23           ",
                    "по причинам (24, 25, 26 не выходят в строки 01)              ",
                    "трудовое увечье  24           ",
                    "профессиональные болезни  25           ",
                    "ликвидаторы последствий аварии на ЧАЭС  26           ",
                    "Пострадавшие в апрельских событиях 2010 год  27           ",
                    "Пострадавшие в майских и июньских событиях 2010 год  28           "
                };
                var items = new List<Report1Item>();
                int i2 = 1;
                foreach (var i in docs)
                {
                    var item = new Report1Item();
                    item.RowType = i;
                    item.RowNo = i2;
                    i2++;
                    items.Add(item);
                }
                CalcItems(context, /*report, */year, orgId, distrSpr,
                    items[45], items[44], items[43], items[42], items[41], items[40], items[39],
                    items[38], items[37], items[36], items[35], items[34], items[33], items[32],
                    items[31], items[30], items[29], items[28], items[27], items[26], items[25],
                    items[24], items[23], items[22], items[21], items[20], items[19], items[18],
                    items[17], items[16], items[15], items[14], items[13], items[12], items[11],
                    items[10], items[9], items[8], items[7], items[6], items[5], items[4],
                    items[3], items[2], items[1], items[0]);
                return items;
            }
            public static void CalcItems(WorkflowContext context, int year, Guid orgId, string distrSpr,
                    Report1Item item45, Report1Item item44, Report1Item item43, Report1Item item42,
                    Report1Item item41, Report1Item item40_1, Report1Item item40, Report1Item item39, Report1Item item38,
                    Report1Item item37, Report1Item item36, Report1Item item35, Report1Item item34,
                    Report1Item item33, Report1Item item32, Report1Item item31, Report1Item item30,
                    Report1Item item29, Report1Item item28, Report1Item item27, Report1Item item26,
                    Report1Item item25, Report1Item item24, Report1Item item23, Report1Item item22,
                    Report1Item item21, Report1Item item20, Report1Item item19, Report1Item item18,
                    Report1Item item17, Report1Item item16, Report1Item item15, Report1Item item14,
                    Report1Item item13, Report1Item item12, Report1Item item11, Report1Item item10,
                    Report1Item item9, Report1Item item8, Report1Item item7, Report1Item item6,
                    Report1Item item5, Report1Item item4, Report1Item item3, Report1Item item2,
                    Report1Item item1)
            {
                var qb = new QueryBuilder(adultsStatCardDefId, context.UserId);
                qb.Where("&State").Eq(ApprovedStateId).And("Examination1").Eq(primaryEnumId);

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                    var actSrc = query.JoinSource(query.Source, adultsActDefId, SqlSourceJoinType.Inner, "AdultsMedicalCertificate");
                    var distrSrc = query.JoinSource(actSrc, districtDefId, SqlSourceJoinType.LeftOuter, "DistrictId");
                    var citySrc = query.JoinSource(actSrc, cityDefId, SqlSourceJoinType.LeftOuter, "CityId");
                    query.AddCondition(ExpressionOperation.And, adultsStatCardDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    if (!string.IsNullOrEmpty(distrSpr))
                        query.AddCondition(ExpressionOperation.And, districtDefId, "NumberDis", ConditionOperation.Equal, distrSpr);

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(query.Source, "EndDateExamination");
                    query.AddAttribute(query.Source, "AgeOf");
                    query.AddAttribute(query.Source, "DisabilityGroup");
                    query.AddAttribute(query.Source, "PlaceWork");
                    query.AddAttribute(query.Source, "Diagnosis");
                    query.AddAttribute(distrSrc, "DistrictType");
                    query.AddAttribute(citySrc, "DistrictType");
                    query.AddAttribute(personSrc, "Gender");

                    var table = new DataTable();
                    using (var reader = context.CreateSqlReader(query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var date = !(row[1] is DBNull) ? (DateTime)row[1] : DateTime.MinValue;
                        var ageOf = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                        var group = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                        var bysy = row[4] is DBNull ? "" : row[4].ToString();
                        var diagnos = row[5] is DBNull ? Guid.Empty : (Guid)row[5];
                        var district = row[6] is DBNull ? Guid.Empty : (Guid)row[6];
                        var city = row[7] is DBNull ? Guid.Empty : (Guid)row[7];
                        var gender = row[8] is DBNull ? Guid.Empty : (Guid)row[8];

                        if (appId != Guid.Empty)
                        {
                            if (date.Year == year && (district == villageEnumId) ||
                                date.Year == year && (city == villageEnumId))
                            {
                                item1.Total = item1.Total != 0 ? (1 + (int)item1.Total) : 1;

                                if (gender == womanEnumId)
                                {
                                    item1.WomenAll = item1.WomenAll != 0 ? (1 + (int)item1.WomenAll) : 1;
                                }
                                //в том числе в возрасте
                                /*****************************************************************************************************************************/
                                if (ageOf == ageOf1EnumId)
                                {
                                    item1.Total1829 = item1.Total1829 != 0 ? (1 + (int)item1.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item1.Women1829 = item1.Women1829 != 0 ? (1 + (int)item1.Women1829) : 1;
                                    }
                                }
                                if (ageOf == ageOf2EnumId)
                                {
                                    item1.Total3040 = item1.Total3040 != 0 ? (1 + (int)item1.Total3040) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item1.Women3040 = item1.Women3040 != 0 ? (1 + (int)item1.Women3040) : 1;
                                    }
                                }
                                if (ageOf == ageOf3EnumId)
                                {
                                    item1.Total45 = item1.Total45 != 0 ? (1 + (int)item1.Total45) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item1.Women45 = item1.Women45 != 0 ? (1 + (int)item1.Women45) : 1;
                                    }
                                }
                                if (ageOf == ageOf4EnumId)
                                {
                                    item1.TotalPersonsAge = item1.TotalPersonsAge != 0 ? (1 + (int)item1.TotalPersonsAge) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item1.WomenPersonsAge = item1.WomenPersonsAge != 0 ? (1 + (int)item1.WomenPersonsAge) : 1;
                                    }
                                }
                                //Из общего числа признанных ЛОВЗ                                
                                if (group == group1EnumId)
                                {
                                    item1.FirstGroupAll = item1.FirstGroupAll != 0 ? (1 + (int)item1.FirstGroupAll) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item1.WomenFirstGroup = item1.WomenFirstGroup != 0 ? (1 + (int)item1.WomenFirstGroup) : 1;
                                    }
                                    if (bysy != null)
                                    {
                                        item1.BusyFirstGroup = item1.BusyFirstGroup != 0 ? (1 + (int)item1.BusyFirstGroup) : 1;
                                    }
                                }
                                if (group == group2EnumId)
                                {
                                    item1.SecondGroupAll = item1.SecondGroupAll != 0 ? (1 + (int)item1.SecondGroupAll) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item1.WomenSecondGroup = item1.WomenSecondGroup != 0 ? (1 + (int)item1.WomenSecondGroup) : 1;
                                    }
                                    if (bysy != null)
                                    {
                                        item1.BusySecondGroup = item1.BusySecondGroup != 0 ? (1 + (int)item1.BusySecondGroup) : 1;
                                    }
                                }
                                if (group == group3EnumId)
                                {
                                    item1.ThirdGroupAll = item1.ThirdGroupAll != 0 ? (1 + (int)item1.ThirdGroupAll) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item1.WomenThirdGroup = item1.WomenThirdGroup != 0 ? (1 + (int)item1.WomenThirdGroup) : 1;
                                    }
                                    if (bysy != null)
                                    {
                                        item1.BusyThirdGroup = item1.BusyThirdGroup != 0 ? (1 + (int)item1.BusyThirdGroup) : 1;
                                    }
                                }
                                //Туберкулез/ А 15-19
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId2)
                                {
                                    item2.Total1829 = item2.Total1829 != 0 ? (1 + (int)item2.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item2.Women1829 = item2.Women1829 != 0 ? (1 + (int)item2.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item2.Total1829 = item2.Total1829 != 0 ? (1 + (int)item2.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.Women1829 = item2.Women1829 != 0 ? (1 + (int)item2.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item2.Total3040 = item2.Total3040 != 0 ? (1 + (int)item2.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.Women3040 = item2.Women3040 != 0 ? (1 + (int)item2.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item2.Total45 = item2.Total45 != 0 ? (1 + (int)item2.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.Women45 = item2.Women45 != 0 ? (1 + (int)item2.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item2.TotalPersonsAge = item2.TotalPersonsAge != 0 ? (1 + (int)item2.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.WomenPersonsAge = item2.WomenPersonsAge != 0 ? (1 + (int)item2.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item2.FirstGroupAll = item2.FirstGroupAll != 0 ? (1 + (int)item2.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.WomenFirstGroup = item2.WomenFirstGroup != 0 ? (1 + (int)item2.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item2.BusyFirstGroup = item2.BusyFirstGroup != 0 ? (1 + (int)item2.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item2.SecondGroupAll = item2.SecondGroupAll != 0 ? (1 + (int)item2.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.WomenSecondGroup = item2.WomenSecondGroup != 0 ? (1 + (int)item2.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item2.BusySecondGroup = item2.BusySecondGroup != 0 ? (1 + (int)item2.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item2.ThirdGroupAll = item2.ThirdGroupAll != 0 ? (1 + (int)item2.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.WomenThirdGroup = item2.WomenThirdGroup != 0 ? (1 + (int)item2.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item2.BusyThirdGroup = item2.BusyThirdGroup != 0 ? (1 + (int)item2.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //Туберкулез  легких/ А 15-16
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId3)
                                {
                                    item3.Total1829 = item3.Total1829 != 0 ? (1 + (int)item3.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item3.Women1829 = item3.Women1829 != 0 ? (1 + (int)item3.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item3.Total1829 = item3.Total1829 != 0 ? (1 + (int)item3.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.Women1829 = item3.Women1829 != 0 ? (1 + (int)item3.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item3.Total3040 = item3.Total3040 != 0 ? (1 + (int)item3.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.Women3040 = item3.Women3040 != 0 ? (1 + (int)item3.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item3.Total45 = item3.Total45 != 0 ? (1 + (int)item3.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.Women45 = item3.Women45 != 0 ? (1 + (int)item3.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item3.TotalPersonsAge = item3.TotalPersonsAge != 0 ? (1 + (int)item3.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.WomenPersonsAge = item3.WomenPersonsAge != 0 ? (1 + (int)item3.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item3.FirstGroupAll = item3.FirstGroupAll != 0 ? (1 + (int)item3.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.WomenFirstGroup = item3.WomenFirstGroup != 0 ? (1 + (int)item3.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item3.BusyFirstGroup = item3.BusyFirstGroup != 0 ? (1 + (int)item3.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item3.SecondGroupAll = item3.SecondGroupAll != 0 ? (1 + (int)item3.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.WomenSecondGroup = item3.WomenSecondGroup != 0 ? (1 + (int)item3.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item3.BusySecondGroup = item3.BusySecondGroup != 0 ? (1 + (int)item3.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item3.ThirdGroupAll = item3.ThirdGroupAll != 0 ? (1 + (int)item3.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.WomenThirdGroup = item3.WomenThirdGroup != 0 ? (1 + (int)item3.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item3.BusyThirdGroup = item3.BusyThirdGroup != 0 ? (1 + (int)item3.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //Злокачественные новообразования/ С 00-97
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId4)
                                {
                                    item4.Total1829 = item4.Total1829 != 0 ? (1 + (int)item4.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item4.Women1829 = item4.Women1829 != 0 ? (1 + (int)item4.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item4.Total1829 = item4.Total1829 != 0 ? (1 + (int)item4.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item4.Women1829 = item4.Women1829 != 0 ? (1 + (int)item4.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item4.Total3040 = item4.Total3040 != 0 ? (1 + (int)item4.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item4.Women3040 = item4.Women3040 != 0 ? (1 + (int)item4.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item4.Total45 = item4.Total45 != 0 ? (1 + (int)item4.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item4.Women45 = item4.Women45 != 0 ? (1 + (int)item4.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item4.TotalPersonsAge = item4.TotalPersonsAge != 0 ? (1 + (int)item4.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item4.WomenPersonsAge = item4.WomenPersonsAge != 0 ? (1 + (int)item4.WomenPersonsAge) : 1;
                                        }
                                    }
                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item4.FirstGroupAll = item4.FirstGroupAll != 0 ? (1 + (int)item4.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item4.WomenFirstGroup = item4.WomenFirstGroup != 0 ? (1 + (int)item4.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item4.BusyFirstGroup = item4.BusyFirstGroup != 0 ? (1 + (int)item4.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item4.SecondGroupAll = item4.SecondGroupAll != 0 ? (1 + (int)item4.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item4.WomenSecondGroup = item4.WomenSecondGroup != 0 ? (1 + (int)item4.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item4.BusySecondGroup = item4.BusySecondGroup != 0 ? (1 + (int)item4.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item4.ThirdGroupAll = item4.ThirdGroupAll != 0 ? (1 + (int)item4.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item4.WomenThirdGroup = item4.WomenThirdGroup != 0 ? (1 + (int)item4.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item4.BusyThirdGroup = item4.BusyThirdGroup != 0 ? (1 + (int)item4.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //Заболeвания щитовидной железы/ E 00-07
                                if (diagnos == strDiagId5)
                                {
                                    item5.Total1829 = item5.Total1829 != 0 ? (1 + (int)item5.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item5.Women1829 = item5.Women1829 != 0 ? (1 + (int)item5.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item5.Total1829 = item5.Total1829 != 0 ? (1 + (int)item5.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item5.Women1829 = item5.Women1829 != 0 ? (1 + (int)item5.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item5.Total3040 = item5.Total3040 != 0 ? (1 + (int)item5.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item5.Women3040 = item5.Women3040 != 0 ? (1 + (int)item5.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item5.Total45 = item5.Total45 != 0 ? (1 + (int)item5.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item5.Women45 = item5.Women45 != 0 ? (1 + (int)item5.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item5.TotalPersonsAge = item5.TotalPersonsAge != 0 ? (1 + (int)item5.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item5.WomenPersonsAge = item5.WomenPersonsAge != 0 ? (1 + (int)item5.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item5.FirstGroupAll = item5.FirstGroupAll != 0 ? (1 + (int)item5.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item5.WomenFirstGroup = item5.WomenFirstGroup != 0 ? (1 + (int)item5.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item5.BusyFirstGroup = item5.BusyFirstGroup != 0 ? (1 + (int)item5.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item5.SecondGroupAll = item5.SecondGroupAll != 0 ? (1 + (int)item5.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item5.WomenSecondGroup = item5.WomenSecondGroup != 0 ? (1 + (int)item5.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item5.BusySecondGroup = item5.BusySecondGroup != 0 ? (1 + (int)item5.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item5.ThirdGroupAll = item5.ThirdGroupAll != 0 ? (1 + (int)item5.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item5.WomenThirdGroup = item5.WomenThirdGroup != 0 ? (1 + (int)item5.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item5.BusyThirdGroup = item5.BusyThirdGroup != 0 ? (1 + (int)item5.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //Сахарный диабет/ E 10-14
                                if (diagnos == strDiagId6)
                                {
                                    item6.Total1829 = item6.Total1829 != 0 ? (1 + (int)item6.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item6.Women1829 = item6.Women1829 != 0 ? (1 + (int)item6.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item6.Total1829 = item6.Total1829 != 0 ? (1 + (int)item6.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item6.Women1829 = item6.Women1829 != 0 ? (1 + (int)item6.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item6.Total3040 = item6.Total3040 != 0 ? (1 + (int)item6.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item6.Women3040 = item6.Women3040 != 0 ? (1 + (int)item6.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item6.Total45 = item6.Total45 != 0 ? (1 + (int)item6.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item6.Women45 = item6.Women45 != 0 ? (1 + (int)item6.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item6.TotalPersonsAge = item6.TotalPersonsAge != 0 ? (1 + (int)item6.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item6.WomenPersonsAge = item6.WomenPersonsAge != 0 ? (1 + (int)item6.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item6.FirstGroupAll = item6.FirstGroupAll != 0 ? (1 + (int)item6.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item6.WomenFirstGroup = item6.WomenFirstGroup != 0 ? (1 + (int)item6.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item6.BusyFirstGroup = item6.BusyFirstGroup != 0 ? (1 + (int)item6.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item6.SecondGroupAll = item6.SecondGroupAll != 0 ? (1 + (int)item6.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item6.WomenSecondGroup = item6.WomenSecondGroup != 0 ? (1 + (int)item6.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item6.BusySecondGroup = item6.BusySecondGroup != 0 ? (1 + (int)item6.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item6.ThirdGroupAll = item6.ThirdGroupAll != 0 ? (1 + (int)item6.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item6.WomenThirdGroup = item6.WomenThirdGroup != 0 ? (1 + (int)item6.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item6.BusyThirdGroup = item6.BusyThirdGroup != 0 ? (1 + (int)item6.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //Психические расстройства/ F 00-99*******************************************************************************************/
                                if (diagnos == strDiagId7)
                                {
                                    item7.Total1829 = item7.Total1829 != 0 ? (1 + (int)item7.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item7.Women1829 = item7.Women1829 != 0 ? (1 + (int)item7.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item7.Total1829 = item7.Total1829 != 0 ? (1 + (int)item7.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item7.Women1829 = item7.Women1829 != 0 ? (1 + (int)item7.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item7.Total3040 = item7.Total3040 != 0 ? (1 + (int)item7.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item7.Women3040 = item7.Women3040 != 0 ? (1 + (int)item7.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item7.Total45 = item7.Total45 != 0 ? (1 + (int)item7.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item7.Women45 = item7.Women45 != 0 ? (1 + (int)item7.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item7.TotalPersonsAge = item7.TotalPersonsAge != 0 ? (1 + (int)item7.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item7.WomenPersonsAge = item7.WomenPersonsAge != 0 ? (1 + (int)item7.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item7.FirstGroupAll = item7.FirstGroupAll != 0 ? (1 + (int)item7.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item7.WomenFirstGroup = item7.WomenFirstGroup != 0 ? (1 + (int)item7.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item7.BusyFirstGroup = item7.BusyFirstGroup != 0 ? (1 + (int)item7.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item7.SecondGroupAll = item7.SecondGroupAll != 0 ? (1 + (int)item7.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item7.WomenSecondGroup = item7.WomenSecondGroup != 0 ? (1 + (int)item7.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item7.BusySecondGroup = item7.BusySecondGroup != 0 ? (1 + (int)item7.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item7.ThirdGroupAll = item7.ThirdGroupAll != 0 ? (1 + (int)item7.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item7.WomenThirdGroup = item7.WomenThirdGroup != 0 ? (1 + (int)item7.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item7.BusyThirdGroup = item7.BusyThirdGroup != 0 ? (1 + (int)item7.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //Шизофрения/ F 20
                                if (diagnos == strDiagId8)
                                {
                                    item8.Total1829 = item8.Total1829 != 0 ? (1 + (int)item8.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item8.Women1829 = item8.Women1829 != 0 ? (1 + (int)item8.Women1829) : 1;
                                    }
                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item8.Total1829 = item8.Total1829 != 0 ? (1 + (int)item8.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item8.Women1829 = item8.Women1829 != 0 ? (1 + (int)item8.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item8.Total3040 = item8.Total3040 != 0 ? (1 + (int)item8.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item8.Women3040 = item8.Women3040 != 0 ? (1 + (int)item8.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item8.Total45 = item8.Total45 != 0 ? (1 + (int)item8.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item8.Women45 = item8.Women45 != 0 ? (1 + (int)item8.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item8.TotalPersonsAge = item8.TotalPersonsAge != 0 ? (1 + (int)item8.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item8.WomenPersonsAge = item8.WomenPersonsAge != 0 ? (1 + (int)item8.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item8.FirstGroupAll = item8.FirstGroupAll != 0 ? (1 + (int)item8.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item8.WomenFirstGroup = item8.WomenFirstGroup != 0 ? (1 + (int)item8.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item8.BusyFirstGroup = item8.BusyFirstGroup != 0 ? (1 + (int)item8.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item8.SecondGroupAll = item8.SecondGroupAll != 0 ? (1 + (int)item8.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item8.WomenSecondGroup = item8.WomenSecondGroup != 0 ? (1 + (int)item8.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item8.BusySecondGroup = item8.BusySecondGroup != 0 ? (1 + (int)item8.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item8.ThirdGroupAll = item8.ThirdGroupAll != 0 ? (1 + (int)item8.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item8.WomenThirdGroup = item8.WomenThirdGroup != 0 ? (1 + (int)item8.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item8.BusyThirdGroup = item8.BusyThirdGroup != 0 ? (1 + (int)item8.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //Умственная отсталость/ F 70-79
                                if (diagnos == strDiagId9)
                                {
                                    item9.Total1829 = item9.Total1829 != 0 ? (1 + (int)item9.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item9.Women1829 = item9.Women1829 != 0 ? (1 + (int)item9.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item9.Total1829 = item9.Total1829 != 0 ? (1 + (int)item9.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item9.Women1829 = item9.Women1829 != 0 ? (1 + (int)item9.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item9.Total3040 = item9.Total3040 != 0 ? (1 + (int)item9.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item9.Women3040 = item9.Women3040 != 0 ? (1 + (int)item9.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item9.Total45 = item9.Total45 != 0 ? (1 + (int)item9.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item9.Women45 = item9.Women45 != 0 ? (1 + (int)item9.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item9.TotalPersonsAge = item9.TotalPersonsAge != 0 ? (1 + (int)item9.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item9.WomenPersonsAge = item9.WomenPersonsAge != 0 ? (1 + (int)item9.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item9.FirstGroupAll = item9.FirstGroupAll != 0 ? (1 + (int)item9.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item9.WomenFirstGroup = item9.WomenFirstGroup != 0 ? (1 + (int)item9.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item9.BusyFirstGroup = item9.BusyFirstGroup != 0 ? (1 + (int)item9.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item9.SecondGroupAll = item9.SecondGroupAll != 0 ? (1 + (int)item9.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item9.WomenSecondGroup = item9.WomenSecondGroup != 0 ? (1 + (int)item9.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item9.BusySecondGroup = item9.BusySecondGroup != 0 ? (1 + (int)item9.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item9.ThirdGroupAll = item9.ThirdGroupAll != 0 ? (1 + (int)item9.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item9.WomenThirdGroup = item9.WomenThirdGroup != 0 ? (1 + (int)item9.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item9.BusyThirdGroup = item9.BusyThirdGroup != 0 ? (1 + (int)item9.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //болезни нервной системы/ G 00-99
                                if (diagnos == strDiagId10)
                                {
                                    item10.Total1829 = item10.Total1829 != 0 ? (1 + (int)item10.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item10.Women1829 = item10.Women1829 != 0 ? (1 + (int)item10.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item10.Total1829 = item10.Total1829 != 0 ? (1 + (int)item10.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item10.Women1829 = item10.Women1829 != 0 ? (1 + (int)item10.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item10.Total3040 = item10.Total3040 != 0 ? (1 + (int)item10.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item10.Women3040 = item10.Women3040 != 0 ? (1 + (int)item10.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item10.Total45 = item10.Total45 != 0 ? (1 + (int)item10.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item10.Women45 = item10.Women45 != 0 ? (1 + (int)item10.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item10.TotalPersonsAge = item10.TotalPersonsAge != 0 ? (1 + (int)item10.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item10.WomenPersonsAge = item10.WomenPersonsAge != 0 ? (1 + (int)item10.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item10.FirstGroupAll = item10.FirstGroupAll != 0 ? (1 + (int)item10.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item10.WomenFirstGroup = item10.WomenFirstGroup != 0 ? (1 + (int)item10.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item10.BusyFirstGroup = item10.BusyFirstGroup != 0 ? (1 + (int)item10.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item10.SecondGroupAll = item10.SecondGroupAll != 0 ? (1 + (int)item10.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item10.WomenSecondGroup = item10.WomenSecondGroup != 0 ? (1 + (int)item10.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item10.BusySecondGroup = item10.BusySecondGroup != 0 ? (1 + (int)item10.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item10.ThirdGroupAll = item10.ThirdGroupAll != 0 ? (1 + (int)item10.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item10.WomenThirdGroup = item10.WomenThirdGroup != 0 ? (1 + (int)item10.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item10.BusyThirdGroup = item10.BusyThirdGroup != 0 ? (1 + (int)item10.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //болезни периферической нервной системы/ G 60-64                               
                                if (diagnos == strDiagId11)
                                {
                                    item11.Total1829 = item11.Total1829 != 0 ? (1 + (int)item11.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item11.Women1829 = item11.Women1829 != 0 ? (1 + (int)item11.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item11.Total1829 = item11.Total1829 != 0 ? (1 + (int)item11.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item11.Women1829 = item11.Women1829 != 0 ? (1 + (int)item11.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item11.Total3040 = item11.Total3040 != 0 ? (1 + (int)item11.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item11.Women3040 = item11.Women3040 != 0 ? (1 + (int)item11.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item11.Total45 = item11.Total45 != 0 ? (1 + (int)item11.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item11.Women45 = item11.Women45 != 0 ? (1 + (int)item11.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item11.TotalPersonsAge = item11.TotalPersonsAge != 0 ? (1 + (int)item11.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item11.WomenPersonsAge = item11.WomenPersonsAge != 0 ? (1 + (int)item11.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item11.FirstGroupAll = item11.FirstGroupAll != 0 ? (1 + (int)item11.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item11.WomenFirstGroup = item11.WomenFirstGroup != 0 ? (1 + (int)item11.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item11.BusyFirstGroup = item11.BusyFirstGroup != 0 ? (1 + (int)item11.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item11.SecondGroupAll = item11.SecondGroupAll != 0 ? (1 + (int)item11.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item11.WomenSecondGroup = item11.WomenSecondGroup != 0 ? (1 + (int)item11.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item11.BusySecondGroup = item11.BusySecondGroup != 0 ? (1 + (int)item11.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item11.ThirdGroupAll = item11.ThirdGroupAll != 0 ? (1 + (int)item11.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item11.WomenThirdGroup = item11.WomenThirdGroup != 0 ? (1 + (int)item11.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item11.BusyThirdGroup = item11.BusyThirdGroup != 0 ? (1 + (int)item11.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //из них: болезни периферической нервной системы/ G 60-64
                                if (diagnos == strDiagId12)
                                {
                                    item12.Total1829 = item12.Total1829 != 0 ? (1 + (int)item12.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item12.Women1829 = item12.Women1829 != 0 ? (1 + (int)item12.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item12.Total1829 = item12.Total1829 != 0 ? (1 + (int)item12.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item12.Women1829 = item12.Women1829 != 0 ? (1 + (int)item12.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item12.Total3040 = item12.Total3040 != 0 ? (1 + (int)item12.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item12.Women3040 = item12.Women3040 != 0 ? (1 + (int)item12.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item12.Total45 = item12.Total45 != 0 ? (1 + (int)item12.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item12.Women45 = item12.Women45 != 0 ? (1 + (int)item12.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item12.TotalPersonsAge = item12.TotalPersonsAge != 0 ? (1 + (int)item12.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item12.WomenPersonsAge = item12.WomenPersonsAge != 0 ? (1 + (int)item12.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item12.FirstGroupAll = item12.FirstGroupAll != 0 ? (1 + (int)item12.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item12.WomenFirstGroup = item12.WomenFirstGroup != 0 ? (1 + (int)item12.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item12.BusyFirstGroup = item12.BusyFirstGroup != 0 ? (1 + (int)item12.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item12.SecondGroupAll = item12.SecondGroupAll != 0 ? (1 + (int)item12.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item12.WomenSecondGroup = item12.WomenSecondGroup != 0 ? (1 + (int)item12.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item12.BusySecondGroup = item12.BusySecondGroup != 0 ? (1 + (int)item12.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item12.ThirdGroupAll = item12.ThirdGroupAll != 0 ? (1 + (int)item12.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item12.WomenThirdGroup = item12.WomenThirdGroup != 0 ? (1 + (int)item12.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item12.BusyThirdGroup = item12.BusyThirdGroup != 0 ? (1 + (int)item12.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //болезни органов чувст/ H 00-95
                                if (diagnos == strDiagId13)
                                {
                                    item13.Total1829 = item13.Total1829 != 0 ? (1 + (int)item13.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item13.Women1829 = item13.Women1829 != 0 ? (1 + (int)item13.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item13.Total1829 = item13.Total1829 != 0 ? (1 + (int)item13.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item13.Women1829 = item13.Women1829 != 0 ? (1 + (int)item13.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item13.Total3040 = item13.Total3040 != 0 ? (1 + (int)item13.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item13.Women3040 = item13.Women3040 != 0 ? (1 + (int)item13.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item13.Total45 = item13.Total45 != 0 ? (1 + (int)item13.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item13.Women45 = item13.Women45 != 0 ? (1 + (int)item13.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item13.TotalPersonsAge = item13.TotalPersonsAge != 0 ? (1 + (int)item13.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item13.WomenPersonsAge = item13.WomenPersonsAge != 0 ? (1 + (int)item13.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item13.FirstGroupAll = item13.FirstGroupAll != 0 ? (1 + (int)item13.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item13.WomenFirstGroup = item13.WomenFirstGroup != 0 ? (1 + (int)item13.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item13.BusyFirstGroup = item13.BusyFirstGroup != 0 ? (1 + (int)item13.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item13.SecondGroupAll = item13.SecondGroupAll != 0 ? (1 + (int)item13.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item13.WomenSecondGroup = item13.WomenSecondGroup != 0 ? (1 + (int)item13.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item13.BusySecondGroup = item13.BusySecondGroup != 0 ? (1 + (int)item13.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item13.ThirdGroupAll = item13.ThirdGroupAll != 0 ? (1 + (int)item13.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item13.WomenThirdGroup = item13.WomenThirdGroup != 0 ? (1 + (int)item13.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item13.BusyThirdGroup = item13.BusyThirdGroup != 0 ? (1 + (int)item13.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //болезни глаз/ H 00-59
                                if (diagnos == strDiagId14)
                                {
                                    item14.Total1829 = item14.Total1829 != 0 ? (1 + (int)item14.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item14.Women1829 = item14.Women1829 != 0 ? (1 + (int)item14.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item14.Total1829 = item14.Total1829 != 0 ? (1 + (int)item14.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item14.Women1829 = item14.Women1829 != 0 ? (1 + (int)item14.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item14.Total3040 = item14.Total3040 != 0 ? (1 + (int)item14.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item14.Women3040 = item14.Women3040 != 0 ? (1 + (int)item14.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item14.Total45 = item14.Total45 != 0 ? (1 + (int)item14.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item14.Women45 = item14.Women45 != 0 ? (1 + (int)item14.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item14.TotalPersonsAge = item14.TotalPersonsAge != 0 ? (1 + (int)item14.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item14.WomenPersonsAge = item14.WomenPersonsAge != 0 ? (1 + (int)item14.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item14.FirstGroupAll = item14.FirstGroupAll != 0 ? (1 + (int)item14.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item14.WomenFirstGroup = item14.WomenFirstGroup != 0 ? (1 + (int)item14.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item14.BusyFirstGroup = item14.BusyFirstGroup != 0 ? (1 + (int)item14.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item14.SecondGroupAll = item14.SecondGroupAll != 0 ? (1 + (int)item14.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item14.WomenSecondGroup = item14.WomenSecondGroup != 0 ? (1 + (int)item14.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item14.BusySecondGroup = item14.BusySecondGroup != 0 ? (1 + (int)item14.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item14.ThirdGroupAll = item14.ThirdGroupAll != 0 ? (1 + (int)item14.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item14.WomenThirdGroup = item14.WomenThirdGroup != 0 ? (1 + (int)item14.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item14.BusyThirdGroup = item14.BusyThirdGroup != 0 ? (1 + (int)item14.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //болезни уха и сосцевидного отростка/ H 60-95
                                if (diagnos == strDiagId15)
                                {
                                    item15.Total1829 = item15.Total1829 != 0 ? (1 + (int)item15.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item15.Women1829 = item15.Women1829 != 0 ? (1 + (int)item15.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item15.Total1829 = item15.Total1829 != 0 ? (1 + (int)item15.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item15.Women1829 = item15.Women1829 != 0 ? (1 + (int)item15.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item15.Total3040 = item15.Total3040 != 0 ? (1 + (int)item15.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item15.Women3040 = item15.Women3040 != 0 ? (1 + (int)item15.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item15.Total45 = item15.Total45 != 0 ? (1 + (int)item15.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item15.Women45 = item15.Women45 != 0 ? (1 + (int)item15.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item15.TotalPersonsAge = item15.TotalPersonsAge != 0 ? (1 + (int)item15.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item15.WomenPersonsAge = item15.WomenPersonsAge != 0 ? (1 + (int)item15.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item15.FirstGroupAll = item15.FirstGroupAll != 0 ? (1 + (int)item15.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item15.WomenFirstGroup = item15.WomenFirstGroup != 0 ? (1 + (int)item15.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item15.BusyFirstGroup = item15.BusyFirstGroup != 0 ? (1 + (int)item15.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item15.SecondGroupAll = item15.SecondGroupAll != 0 ? (1 + (int)item15.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item15.WomenSecondGroup = item15.WomenSecondGroup != 0 ? (1 + (int)item15.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item15.BusySecondGroup = item15.BusySecondGroup != 0 ? (1 + (int)item15.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item15.ThirdGroupAll = item15.ThirdGroupAll != 0 ? (1 + (int)item15.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item15.WomenThirdGroup = item15.WomenThirdGroup != 0 ? (1 + (int)item15.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item15.BusyThirdGroup = item15.BusyThirdGroup != 0 ? (1 + (int)item15.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //болезни системы кровообращения/ I 00-99
                                if (diagnos == strDiagId16)
                                {
                                    item16.Total1829 = item16.Total1829 != 0 ? (1 + (int)item16.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item16.Women1829 = item16.Women1829 != 0 ? (1 + (int)item16.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item16.Total1829 = item16.Total1829 != 0 ? (1 + (int)item16.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item16.Women1829 = item16.Women1829 != 0 ? (1 + (int)item16.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item16.Total3040 = item16.Total3040 != 0 ? (1 + (int)item16.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item16.Women3040 = item16.Women3040 != 0 ? (1 + (int)item16.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item16.Total45 = item16.Total45 != 0 ? (1 + (int)item16.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item16.Women45 = item16.Women45 != 0 ? (1 + (int)item16.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item16.TotalPersonsAge = item16.TotalPersonsAge != 0 ? (1 + (int)item16.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item16.WomenPersonsAge = item16.WomenPersonsAge != 0 ? (1 + (int)item16.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item16.FirstGroupAll = item16.FirstGroupAll != 0 ? (1 + (int)item16.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item16.WomenFirstGroup = item16.WomenFirstGroup != 0 ? (1 + (int)item16.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item16.BusyFirstGroup = item16.BusyFirstGroup != 0 ? (1 + (int)item16.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item16.SecondGroupAll = item16.SecondGroupAll != 0 ? (1 + (int)item16.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item16.WomenSecondGroup = item16.WomenSecondGroup != 0 ? (1 + (int)item16.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item16.BusySecondGroup = item16.BusySecondGroup != 0 ? (1 + (int)item16.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item16.ThirdGroupAll = item16.ThirdGroupAll != 0 ? (1 + (int)item16.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item16.WomenThirdGroup = item16.WomenThirdGroup != 0 ? (1 + (int)item16.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item16.BusyThirdGroup = item16.BusyThirdGroup != 0 ? (1 + (int)item16.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //из них: хронические ревматические болезни сердца/  I 05-09
                                if (diagnos == strDiagId17)
                                {
                                    item17.Total1829 = item17.Total1829 != 0 ? (1 + (int)item17.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item17.Women1829 = item17.Women1829 != 0 ? (1 + (int)item17.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item17.Total1829 = item17.Total1829 != 0 ? (1 + (int)item17.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item17.Women1829 = item17.Women1829 != 0 ? (1 + (int)item17.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item17.Total3040 = item17.Total3040 != 0 ? (1 + (int)item17.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item17.Women3040 = item17.Women3040 != 0 ? (1 + (int)item17.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item17.Total45 = item17.Total45 != 0 ? (1 + (int)item17.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item17.Women45 = item17.Women45 != 0 ? (1 + (int)item17.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item17.TotalPersonsAge = item17.TotalPersonsAge != 0 ? (1 + (int)item17.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item17.WomenPersonsAge = item17.WomenPersonsAge != 0 ? (1 + (int)item17.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item17.FirstGroupAll = item17.FirstGroupAll != 0 ? (1 + (int)item17.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item17.WomenFirstGroup = item17.WomenFirstGroup != 0 ? (1 + (int)item17.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item17.BusyFirstGroup = item17.BusyFirstGroup != 0 ? (1 + (int)item17.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item17.SecondGroupAll = item17.SecondGroupAll != 0 ? (1 + (int)item17.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item17.WomenSecondGroup = item17.WomenSecondGroup != 0 ? (1 + (int)item17.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item17.BusySecondGroup = item17.BusySecondGroup != 0 ? (1 + (int)item17.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item17.ThirdGroupAll = item17.ThirdGroupAll != 0 ? (1 + (int)item17.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item17.WomenThirdGroup = item17.WomenThirdGroup != 0 ? (1 + (int)item17.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item17.BusyThirdGroup = item17.BusyThirdGroup != 0 ? (1 + (int)item17.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //болезни, характеризующиеся повышенным кровяным давлением/ I 10-15
                                if (diagnos == strDiagId18)
                                {
                                    item18.Total1829 = item18.Total1829 != 0 ? (1 + (int)item18.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item18.Women1829 = item18.Women1829 != 0 ? (1 + (int)item18.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item18.Total1829 = item18.Total1829 != 0 ? (1 + (int)item18.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item18.Women1829 = item18.Women1829 != 0 ? (1 + (int)item18.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item18.Total3040 = item18.Total3040 != 0 ? (1 + (int)item18.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item18.Women3040 = item18.Women3040 != 0 ? (1 + (int)item18.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item18.Total45 = item18.Total45 != 0 ? (1 + (int)item18.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item18.Women45 = item18.Women45 != 0 ? (1 + (int)item18.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item18.TotalPersonsAge = item18.TotalPersonsAge != 0 ? (1 + (int)item18.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item18.WomenPersonsAge = item18.WomenPersonsAge != 0 ? (1 + (int)item18.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item18.FirstGroupAll = item18.FirstGroupAll != 0 ? (1 + (int)item18.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item18.WomenFirstGroup = item18.WomenFirstGroup != 0 ? (1 + (int)item18.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item18.BusyFirstGroup = item18.BusyFirstGroup != 0 ? (1 + (int)item18.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item18.SecondGroupAll = item18.SecondGroupAll != 0 ? (1 + (int)item18.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item18.WomenSecondGroup = item18.WomenSecondGroup != 0 ? (1 + (int)item18.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item18.BusySecondGroup = item18.BusySecondGroup != 0 ? (1 + (int)item18.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item18.ThirdGroupAll = item18.ThirdGroupAll != 0 ? (1 + (int)item18.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item18.WomenThirdGroup = item18.WomenThirdGroup != 0 ? (1 + (int)item18.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item18.BusyThirdGroup = item18.BusyThirdGroup != 0 ? (1 + (int)item18.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId19)
                                {
                                    item19.Total1829 = item19.Total1829 != 0 ? (1 + (int)item19.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item19.Women1829 = item19.Women1829 != 0 ? (1 + (int)item19.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item19.Total1829 = item19.Total1829 != 0 ? (1 + (int)item19.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item19.Women1829 = item19.Women1829 != 0 ? (1 + (int)item19.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item19.Total3040 = item19.Total3040 != 0 ? (1 + (int)item19.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item19.Women3040 = item19.Women3040 != 0 ? (1 + (int)item19.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item19.Total45 = item19.Total45 != 0 ? (1 + (int)item19.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item19.Women45 = item19.Women45 != 0 ? (1 + (int)item19.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item19.TotalPersonsAge = item19.TotalPersonsAge != 0 ? (1 + (int)item19.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item19.WomenPersonsAge = item19.WomenPersonsAge != 0 ? (1 + (int)item19.WomenPersonsAge) : 1;
                                        }
                                    }

                                    if (group == group1EnumId)
                                    {
                                        item19.FirstGroupAll = item19.FirstGroupAll != 0 ? (1 + (int)item19.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item19.WomenFirstGroup = item19.WomenFirstGroup != 0 ? (1 + (int)item19.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item19.BusyFirstGroup = item19.BusyFirstGroup != 0 ? (1 + (int)item19.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item19.SecondGroupAll = item19.SecondGroupAll != 0 ? (1 + (int)item19.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item19.WomenSecondGroup = item19.WomenSecondGroup != 0 ? (1 + (int)item19.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item19.BusySecondGroup = item19.BusySecondGroup != 0 ? (1 + (int)item19.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item19.ThirdGroupAll = item19.ThirdGroupAll != 0 ? (1 + (int)item19.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item19.WomenThirdGroup = item19.WomenThirdGroup != 0 ? (1 + (int)item19.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item19.BusyThirdGroup = item19.BusyThirdGroup != 0 ? (1 + (int)item19.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId20)
                                {
                                    item20.Total1829 = item20.Total1829 != 0 ? (1 + (int)item20.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item20.Women1829 = item20.Women1829 != 0 ? (1 + (int)item20.Women1829) : 1;
                                    }

                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item20.Total1829 = item20.Total1829 != 0 ? (1 + (int)item20.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item20.Women1829 = item20.Women1829 != 0 ? (1 + (int)item20.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item20.Total3040 = item20.Total3040 != 0 ? (1 + (int)item20.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item20.Women3040 = item20.Women3040 != 0 ? (1 + (int)item20.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item20.Total45 = item20.Total45 != 0 ? (1 + (int)item20.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item20.Women45 = item20.Women45 != 0 ? (1 + (int)item20.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item20.TotalPersonsAge = item20.TotalPersonsAge != 0 ? (1 + (int)item20.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item20.WomenPersonsAge = item20.WomenPersonsAge != 0 ? (1 + (int)item20.WomenPersonsAge) : 1;
                                        }
                                    }
                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item20.FirstGroupAll = item20.FirstGroupAll != 0 ? (1 + (int)item20.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item20.WomenFirstGroup = item20.WomenFirstGroup != 0 ? (1 + (int)item20.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item20.BusyFirstGroup = item20.BusyFirstGroup != 0 ? (1 + (int)item20.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item20.SecondGroupAll = item20.SecondGroupAll != 0 ? (1 + (int)item20.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item20.WomenSecondGroup = item20.WomenSecondGroup != 0 ? (1 + (int)item20.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item20.BusySecondGroup = item20.BusySecondGroup != 0 ? (1 + (int)item20.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item20.ThirdGroupAll = item20.ThirdGroupAll != 0 ? (1 + (int)item20.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item20.WomenThirdGroup = item20.WomenThirdGroup != 0 ? (1 + (int)item20.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item20.BusyThirdGroup = item20.BusyThirdGroup != 0 ? (1 + (int)item20.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //ДИАГНОЗ НЕ НАШЛА В СПИСКЕ
                                /*if (diagnos == strDiagId21)
                                {
                                    item21.Total1829 = item21.Total1829 != 0 ? (1 + (int)item21.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item21.Women1829 = item21.Women1829 != 0 ? (1 + (int)item21.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item21.Total1829 = item21.Total1829 != 0 ? (1 + (int)item21.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item21.Women1829 = item21.Women1829 != 0 ? (1 + (int)item21.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item21.Total3040 = item21.Total3040 != 0 ? (1 + (int)item21.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item21.Women3040 = item21.Women3040 != 0 ? (1 + (int)item21.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item21.Total45 = item21.Total45 != 0 ? (1 + (int)item21.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item21.Women45 = item21.Women45 != 0 ? (1 + (int)item21.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item21.TotalPersonsAge = item21.TotalPersonsAge != 0 ? (1 + (int)item21.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item21.WomenPersonsAge = item21.WomenPersonsAge != 0 ? (1 + (int)item21.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item21.FirstGroupAll = item21.FirstGroupAll != 0 ? (1 + (int)item21.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item21.WomenFirstGroup = item21.WomenFirstGroup != 0 ? (1 + (int)item21.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item21.BusyFirstGroup = item21.BusyFirstGroup != 0 ? (1 + (int)item21.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item21.SecondGroupAll = item21.SecondGroupAll != 0 ? (1 + (int)item21.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item21.WomenSecondGroup = item21.WomenSecondGroup != 0 ? (1 + (int)item21.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item21.BusySecondGroup = item21.BusySecondGroup != 0 ? (1 + (int)item21.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item21.ThirdGroupAll = item21.ThirdGroupAll != 0 ? (1 + (int)item21.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item21.WomenThirdGroup = item21.WomenThirdGroup != 0 ? (1 + (int)item21.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item21.BusyThirdGroup = item21.BusyThirdGroup != 0 ? (1 + (int)item21.BusyThirdGroup) : 1;
                                        }
                                    }
                                }*/
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId22)
                                {
                                    item22.Total1829 = item22.Total1829 != 0 ? (1 + (int)item22.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item22.Women1829 = item22.Women1829 != 0 ? (1 + (int)item22.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item22.Total1829 = item22.Total1829 != 0 ? (1 + (int)item22.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item22.Women1829 = item22.Women1829 != 0 ? (1 + (int)item22.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item22.Total3040 = item22.Total3040 != 0 ? (1 + (int)item22.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item22.Women3040 = item22.Women3040 != 0 ? (1 + (int)item22.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item22.Total45 = item22.Total45 != 0 ? (1 + (int)item22.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item22.Women45 = item22.Women45 != 0 ? (1 + (int)item22.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item22.TotalPersonsAge = item22.TotalPersonsAge != 0 ? (1 + (int)item22.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item22.WomenPersonsAge = item22.WomenPersonsAge != 0 ? (1 + (int)item22.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item22.FirstGroupAll = item22.FirstGroupAll != 0 ? (1 + (int)item22.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item22.WomenFirstGroup = item22.WomenFirstGroup != 0 ? (1 + (int)item22.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item22.BusyFirstGroup = item22.BusyFirstGroup != 0 ? (1 + (int)item22.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item22.SecondGroupAll = item22.SecondGroupAll != 0 ? (1 + (int)item22.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item22.WomenSecondGroup = item22.WomenSecondGroup != 0 ? (1 + (int)item22.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item22.BusySecondGroup = item22.BusySecondGroup != 0 ? (1 + (int)item22.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item22.ThirdGroupAll = item22.ThirdGroupAll != 0 ? (1 + (int)item22.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item22.WomenThirdGroup = item22.WomenThirdGroup != 0 ? (1 + (int)item22.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item22.BusyThirdGroup = item22.BusyThirdGroup != 0 ? (1 + (int)item22.BusyThirdGroup) : 1;
                                        }
                                    }
                                }

                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId23)
                                {
                                    item23.Total1829 = item23.Total1829 != 0 ? (1 + (int)item23.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item23.Women1829 = item23.Women1829 != 0 ? (1 + (int)item23.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item23.Total1829 = item23.Total1829 != 0 ? (1 + (int)item23.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item23.Women1829 = item23.Women1829 != 0 ? (1 + (int)item23.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item23.Total3040 = item23.Total3040 != 0 ? (1 + (int)item23.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item23.Women3040 = item23.Women3040 != 0 ? (1 + (int)item23.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item23.Total45 = item23.Total45 != 0 ? (1 + (int)item23.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item23.Women45 = item23.Women45 != 0 ? (1 + (int)item23.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item23.TotalPersonsAge = item23.TotalPersonsAge != 0 ? (1 + (int)item23.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item23.WomenPersonsAge = item23.WomenPersonsAge != 0 ? (1 + (int)item23.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item23.FirstGroupAll = item23.FirstGroupAll != 0 ? (1 + (int)item23.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item23.WomenFirstGroup = item23.WomenFirstGroup != 0 ? (1 + (int)item23.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item23.BusyFirstGroup = item23.BusyFirstGroup != 0 ? (1 + (int)item23.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item23.SecondGroupAll = item23.SecondGroupAll != 0 ? (1 + (int)item23.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item23.WomenSecondGroup = item23.WomenSecondGroup != 0 ? (1 + (int)item23.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item23.BusySecondGroup = item23.BusySecondGroup != 0 ? (1 + (int)item23.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item23.ThirdGroupAll = item23.ThirdGroupAll != 0 ? (1 + (int)item23.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item23.WomenThirdGroup = item23.WomenThirdGroup != 0 ? (1 + (int)item23.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item23.BusyThirdGroup = item23.BusyThirdGroup != 0 ? (1 + (int)item23.BusyThirdGroup) : 1;
                                        }
                                    }
                                }

                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId24)
                                {
                                    item24.Total1829 = item24.Total1829 != 0 ? (1 + (int)item24.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item24.Women1829 = item24.Women1829 != 0 ? (1 + (int)item24.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item24.Total1829 = item24.Total1829 != 0 ? (1 + (int)item24.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item24.Women1829 = item24.Women1829 != 0 ? (1 + (int)item24.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item24.Total3040 = item24.Total3040 != 0 ? (1 + (int)item24.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item24.Women3040 = item24.Women3040 != 0 ? (1 + (int)item24.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item24.Total45 = item24.Total45 != 0 ? (1 + (int)item24.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item24.Women45 = item24.Women45 != 0 ? (1 + (int)item24.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item24.TotalPersonsAge = item24.TotalPersonsAge != 0 ? (1 + (int)item24.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item24.WomenPersonsAge = item24.WomenPersonsAge != 0 ? (1 + (int)item24.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item24.FirstGroupAll = item24.FirstGroupAll != 0 ? (1 + (int)item24.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item24.WomenFirstGroup = item24.WomenFirstGroup != 0 ? (1 + (int)item24.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item24.BusyFirstGroup = item24.BusyFirstGroup != 0 ? (1 + (int)item24.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item24.SecondGroupAll = item24.SecondGroupAll != 0 ? (1 + (int)item24.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item24.WomenSecondGroup = item24.WomenSecondGroup != 0 ? (1 + (int)item24.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item24.BusySecondGroup = item24.BusySecondGroup != 0 ? (1 + (int)item24.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item24.ThirdGroupAll = item24.ThirdGroupAll != 0 ? (1 + (int)item24.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item24.WomenThirdGroup = item24.WomenThirdGroup != 0 ? (1 + (int)item24.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item24.BusyThirdGroup = item24.BusyThirdGroup != 0 ? (1 + (int)item24.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId25)
                                {
                                    item25.Total1829 = item25.Total1829 != 0 ? (1 + (int)item25.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item25.Women1829 = item25.Women1829 != 0 ? (1 + (int)item25.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item25.Total1829 = item25.Total1829 != 0 ? (1 + (int)item25.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item25.Women1829 = item25.Women1829 != 0 ? (1 + (int)item25.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item25.Total3040 = item25.Total3040 != 0 ? (1 + (int)item25.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item25.Women3040 = item25.Women3040 != 0 ? (1 + (int)item25.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item25.Total45 = item25.Total45 != 0 ? (1 + (int)item25.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item25.Women45 = item25.Women45 != 0 ? (1 + (int)item25.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item25.TotalPersonsAge = item25.TotalPersonsAge != 0 ? (1 + (int)item25.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item25.WomenPersonsAge = item25.WomenPersonsAge != 0 ? (1 + (int)item25.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item25.FirstGroupAll = item25.FirstGroupAll != 0 ? (1 + (int)item25.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item25.WomenFirstGroup = item25.WomenFirstGroup != 0 ? (1 + (int)item25.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item25.BusyFirstGroup = item25.BusyFirstGroup != 0 ? (1 + (int)item25.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item25.SecondGroupAll = item25.SecondGroupAll != 0 ? (1 + (int)item25.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item25.WomenSecondGroup = item25.WomenSecondGroup != 0 ? (1 + (int)item25.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item25.BusySecondGroup = item25.BusySecondGroup != 0 ? (1 + (int)item25.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item25.ThirdGroupAll = item25.ThirdGroupAll != 0 ? (1 + (int)item25.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item25.WomenThirdGroup = item25.WomenThirdGroup != 0 ? (1 + (int)item25.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item25.BusyThirdGroup = item25.BusyThirdGroup != 0 ? (1 + (int)item25.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId26)
                                {
                                    item26.Total1829 = item26.Total1829 != 0 ? (1 + (int)item26.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item26.Women1829 = item26.Women1829 != 0 ? (1 + (int)item26.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item26.Total1829 = item26.Total1829 != 0 ? (1 + (int)item26.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item26.Women1829 = item26.Women1829 != 0 ? (1 + (int)item26.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item26.Total3040 = item26.Total3040 != 0 ? (1 + (int)item26.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item26.Women3040 = item26.Women3040 != 0 ? (1 + (int)item26.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item26.Total45 = item26.Total45 != 0 ? (1 + (int)item26.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item26.Women45 = item26.Women45 != 0 ? (1 + (int)item26.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item26.TotalPersonsAge = item26.TotalPersonsAge != 0 ? (1 + (int)item26.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item26.WomenPersonsAge = item26.WomenPersonsAge != 0 ? (1 + (int)item26.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item26.FirstGroupAll = item26.FirstGroupAll != 0 ? (1 + (int)item26.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item26.WomenFirstGroup = item26.WomenFirstGroup != 0 ? (1 + (int)item26.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item26.BusyFirstGroup = item26.BusyFirstGroup != 0 ? (1 + (int)item26.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item26.SecondGroupAll = item26.SecondGroupAll != 0 ? (1 + (int)item26.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item26.WomenSecondGroup = item26.WomenSecondGroup != 0 ? (1 + (int)item26.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item26.BusySecondGroup = item26.BusySecondGroup != 0 ? (1 + (int)item26.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item26.ThirdGroupAll = item26.ThirdGroupAll != 0 ? (1 + (int)item26.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item26.WomenThirdGroup = item26.WomenThirdGroup != 0 ? (1 + (int)item26.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item26.BusyThirdGroup = item26.BusyThirdGroup != 0 ? (1 + (int)item26.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId27)
                                {
                                    item27.Total1829 = item27.Total1829 != 0 ? (1 + (int)item27.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item27.Women1829 = item27.Women1829 != 0 ? (1 + (int)item27.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item27.Total1829 = item27.Total1829 != 0 ? (1 + (int)item27.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item27.Women1829 = item27.Women1829 != 0 ? (1 + (int)item27.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item27.Total3040 = item27.Total3040 != 0 ? (1 + (int)item27.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item27.Women3040 = item27.Women3040 != 0 ? (1 + (int)item27.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item27.Total45 = item27.Total45 != 0 ? (1 + (int)item27.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item27.Women45 = item27.Women45 != 0 ? (1 + (int)item27.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item27.TotalPersonsAge = item27.TotalPersonsAge != 0 ? (1 + (int)item27.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item27.WomenPersonsAge = item27.WomenPersonsAge != 0 ? (1 + (int)item27.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item27.FirstGroupAll = item27.FirstGroupAll != 0 ? (1 + (int)item27.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item27.WomenFirstGroup = item27.WomenFirstGroup != 0 ? (1 + (int)item27.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item27.BusyFirstGroup = item27.BusyFirstGroup != 0 ? (1 + (int)item27.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item27.SecondGroupAll = item27.SecondGroupAll != 0 ? (1 + (int)item27.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item27.WomenSecondGroup = item27.WomenSecondGroup != 0 ? (1 + (int)item27.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item27.BusySecondGroup = item27.BusySecondGroup != 0 ? (1 + (int)item27.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item27.ThirdGroupAll = item27.ThirdGroupAll != 0 ? (1 + (int)item27.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item27.WomenThirdGroup = item27.WomenThirdGroup != 0 ? (1 + (int)item27.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item27.BusyThirdGroup = item27.BusyThirdGroup != 0 ? (1 + (int)item27.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId28)
                                {
                                    item28.Total1829 = item28.Total1829 != 0 ? (1 + (int)item28.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item28.Women1829 = item28.Women1829 != 0 ? (1 + (int)item28.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item28.Total1829 = item28.Total1829 != 0 ? (1 + (int)item28.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item28.Women1829 = item28.Women1829 != 0 ? (1 + (int)item28.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item28.Total3040 = item28.Total3040 != 0 ? (1 + (int)item28.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item28.Women3040 = item28.Women3040 != 0 ? (1 + (int)item28.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item28.Total45 = item28.Total45 != 0 ? (1 + (int)item28.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item28.Women45 = item28.Women45 != 0 ? (1 + (int)item28.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item28.TotalPersonsAge = item28.TotalPersonsAge != 0 ? (1 + (int)item28.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item28.WomenPersonsAge = item28.WomenPersonsAge != 0 ? (1 + (int)item28.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item28.FirstGroupAll = item28.FirstGroupAll != 0 ? (1 + (int)item28.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item28.WomenFirstGroup = item28.WomenFirstGroup != 0 ? (1 + (int)item28.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item28.BusyFirstGroup = item28.BusyFirstGroup != 0 ? (1 + (int)item28.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item28.SecondGroupAll = item28.SecondGroupAll != 0 ? (1 + (int)item28.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item28.WomenSecondGroup = item28.WomenSecondGroup != 0 ? (1 + (int)item28.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item28.BusySecondGroup = item28.BusySecondGroup != 0 ? (1 + (int)item28.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item28.ThirdGroupAll = item28.ThirdGroupAll != 0 ? (1 + (int)item28.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item28.WomenThirdGroup = item28.WomenThirdGroup != 0 ? (1 + (int)item28.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item28.BusyThirdGroup = item28.BusyThirdGroup != 0 ? (1 + (int)item28.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId29)
                                {
                                    item29.Total1829 = item29.Total1829 != 0 ? (1 + (int)item29.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item29.Women1829 = item29.Women1829 != 0 ? (1 + (int)item29.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item29.Total1829 = item29.Total1829 != 0 ? (1 + (int)item29.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item29.Women1829 = item29.Women1829 != 0 ? (1 + (int)item29.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item29.Total3040 = item29.Total3040 != 0 ? (1 + (int)item29.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item29.Women3040 = item29.Women3040 != 0 ? (1 + (int)item29.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item29.Total45 = item29.Total45 != 0 ? (1 + (int)item29.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item29.Women45 = item29.Women45 != 0 ? (1 + (int)item29.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item29.TotalPersonsAge = item29.TotalPersonsAge != 0 ? (1 + (int)item29.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item29.WomenPersonsAge = item29.WomenPersonsAge != 0 ? (1 + (int)item29.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item29.FirstGroupAll = item29.FirstGroupAll != 0 ? (1 + (int)item29.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item29.WomenFirstGroup = item29.WomenFirstGroup != 0 ? (1 + (int)item29.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item29.BusyFirstGroup = item29.BusyFirstGroup != 0 ? (1 + (int)item29.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item29.SecondGroupAll = item29.SecondGroupAll != 0 ? (1 + (int)item29.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item29.WomenSecondGroup = item29.WomenSecondGroup != 0 ? (1 + (int)item29.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item29.BusySecondGroup = item29.BusySecondGroup != 0 ? (1 + (int)item29.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item29.ThirdGroupAll = item29.ThirdGroupAll != 0 ? (1 + (int)item29.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item29.WomenThirdGroup = item29.WomenThirdGroup != 0 ? (1 + (int)item29.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item29.BusyThirdGroup = item29.BusyThirdGroup != 0 ? (1 + (int)item29.BusyThirdGroup) : 1;
                                        }
                                    }
                                }

                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId30)
                                {
                                    item30.Total1829 = item30.Total1829 != 0 ? (1 + (int)item30.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item30.Women1829 = item30.Women1829 != 0 ? (1 + (int)item30.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item30.Total1829 = item30.Total1829 != 0 ? (1 + (int)item30.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item30.Women1829 = item30.Women1829 != 0 ? (1 + (int)item30.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item30.Total3040 = item30.Total3040 != 0 ? (1 + (int)item30.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item30.Women3040 = item30.Women3040 != 0 ? (1 + (int)item30.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item30.Total45 = item30.Total45 != 0 ? (1 + (int)item30.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item30.Women45 = item30.Women45 != 0 ? (1 + (int)item30.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item30.TotalPersonsAge = item30.TotalPersonsAge != 0 ? (1 + (int)item30.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item30.WomenPersonsAge = item30.WomenPersonsAge != 0 ? (1 + (int)item30.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item30.FirstGroupAll = item30.FirstGroupAll != 0 ? (1 + (int)item30.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item30.WomenFirstGroup = item30.WomenFirstGroup != 0 ? (1 + (int)item30.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item30.BusyFirstGroup = item30.BusyFirstGroup != 0 ? (1 + (int)item30.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item30.SecondGroupAll = item30.SecondGroupAll != 0 ? (1 + (int)item30.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item30.WomenSecondGroup = item30.WomenSecondGroup != 0 ? (1 + (int)item30.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item30.BusySecondGroup = item30.BusySecondGroup != 0 ? (1 + (int)item30.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item30.ThirdGroupAll = item30.ThirdGroupAll != 0 ? (1 + (int)item30.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item30.WomenThirdGroup = item30.WomenThirdGroup != 0 ? (1 + (int)item30.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item30.BusyThirdGroup = item30.BusyThirdGroup != 0 ? (1 + (int)item30.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId31)
                                {
                                    item31.Total1829 = item31.Total1829 != 0 ? (1 + (int)item31.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item31.Women1829 = item31.Women1829 != 0 ? (1 + (int)item31.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item31.Total1829 = item31.Total1829 != 0 ? (1 + (int)item31.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item31.Women1829 = item31.Women1829 != 0 ? (1 + (int)item31.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item31.Total3040 = item31.Total3040 != 0 ? (1 + (int)item31.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item31.Women3040 = item31.Women3040 != 0 ? (1 + (int)item31.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item31.Total45 = item31.Total45 != 0 ? (1 + (int)item31.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item31.Women45 = item31.Women45 != 0 ? (1 + (int)item31.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item31.TotalPersonsAge = item31.TotalPersonsAge != 0 ? (1 + (int)item31.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item31.WomenPersonsAge = item31.WomenPersonsAge != 0 ? (1 + (int)item31.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item31.FirstGroupAll = item31.FirstGroupAll != 0 ? (1 + (int)item31.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item31.WomenFirstGroup = item31.WomenFirstGroup != 0 ? (1 + (int)item31.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item31.BusyFirstGroup = item31.BusyFirstGroup != 0 ? (1 + (int)item31.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item31.SecondGroupAll = item31.SecondGroupAll != 0 ? (1 + (int)item31.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item31.WomenSecondGroup = item31.WomenSecondGroup != 0 ? (1 + (int)item31.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item31.BusySecondGroup = item31.BusySecondGroup != 0 ? (1 + (int)item31.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item31.ThirdGroupAll = item31.ThirdGroupAll != 0 ? (1 + (int)item31.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item31.WomenThirdGroup = item31.WomenThirdGroup != 0 ? (1 + (int)item31.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item31.BusyThirdGroup = item31.BusyThirdGroup != 0 ? (1 + (int)item31.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId32)
                                {
                                    item32.Total1829 = item32.Total1829 != 0 ? (1 + (int)item32.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item32.Women1829 = item32.Women1829 != 0 ? (1 + (int)item32.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item32.Total1829 = item32.Total1829 != 0 ? (1 + (int)item32.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item32.Women1829 = item32.Women1829 != 0 ? (1 + (int)item32.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item32.Total3040 = item32.Total3040 != 0 ? (1 + (int)item32.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item32.Women3040 = item32.Women3040 != 0 ? (1 + (int)item32.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item32.Total45 = item32.Total45 != 0 ? (1 + (int)item32.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item32.Women45 = item32.Women45 != 0 ? (1 + (int)item32.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item32.TotalPersonsAge = item32.TotalPersonsAge != 0 ? (1 + (int)item32.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item32.WomenPersonsAge = item32.WomenPersonsAge != 0 ? (1 + (int)item32.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item32.FirstGroupAll = item32.FirstGroupAll != 0 ? (1 + (int)item32.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item32.WomenFirstGroup = item32.WomenFirstGroup != 0 ? (1 + (int)item32.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item32.BusyFirstGroup = item32.BusyFirstGroup != 0 ? (1 + (int)item32.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item32.SecondGroupAll = item32.SecondGroupAll != 0 ? (1 + (int)item32.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item32.WomenSecondGroup = item32.WomenSecondGroup != 0 ? (1 + (int)item32.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item32.BusySecondGroup = item32.BusySecondGroup != 0 ? (1 + (int)item32.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item32.ThirdGroupAll = item32.ThirdGroupAll != 0 ? (1 + (int)item32.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item32.WomenThirdGroup = item32.WomenThirdGroup != 0 ? (1 + (int)item32.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item32.BusyThirdGroup = item32.BusyThirdGroup != 0 ? (1 + (int)item32.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId33)
                                {
                                    item33.Total1829 = item33.Total1829 != 0 ? (1 + (int)item33.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item33.Women1829 = item33.Women1829 != 0 ? (1 + (int)item33.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item33.Total1829 = item33.Total1829 != 0 ? (1 + (int)item33.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item33.Women1829 = item33.Women1829 != 0 ? (1 + (int)item33.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item33.Total3040 = item33.Total3040 != 0 ? (1 + (int)item33.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item33.Women3040 = item33.Women3040 != 0 ? (1 + (int)item33.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item33.Total45 = item33.Total45 != 0 ? (1 + (int)item33.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item33.Women45 = item33.Women45 != 0 ? (1 + (int)item33.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item33.TotalPersonsAge = item33.TotalPersonsAge != 0 ? (1 + (int)item33.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item33.WomenPersonsAge = item33.WomenPersonsAge != 0 ? (1 + (int)item33.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item33.FirstGroupAll = item33.FirstGroupAll != 0 ? (1 + (int)item33.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item33.WomenFirstGroup = item33.WomenFirstGroup != 0 ? (1 + (int)item33.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item33.BusyFirstGroup = item33.BusyFirstGroup != 0 ? (1 + (int)item33.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item33.SecondGroupAll = item33.SecondGroupAll != 0 ? (1 + (int)item33.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item33.WomenSecondGroup = item33.WomenSecondGroup != 0 ? (1 + (int)item33.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item33.BusySecondGroup = item33.BusySecondGroup != 0 ? (1 + (int)item33.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item33.ThirdGroupAll = item33.ThirdGroupAll != 0 ? (1 + (int)item33.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item33.WomenThirdGroup = item33.WomenThirdGroup != 0 ? (1 + (int)item33.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item33.BusyThirdGroup = item33.BusyThirdGroup != 0 ? (1 + (int)item33.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId34)
                                {
                                    item34.Total1829 = item34.Total1829 != 0 ? (1 + (int)item34.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item34.Women1829 = item34.Women1829 != 0 ? (1 + (int)item34.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item34.Total1829 = item34.Total1829 != 0 ? (1 + (int)item34.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item34.Women1829 = item34.Women1829 != 0 ? (1 + (int)item34.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item34.Total3040 = item34.Total3040 != 0 ? (1 + (int)item34.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item34.Women3040 = item34.Women3040 != 0 ? (1 + (int)item34.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item34.Total45 = item34.Total45 != 0 ? (1 + (int)item34.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item34.Women45 = item34.Women45 != 0 ? (1 + (int)item34.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item34.TotalPersonsAge = item34.TotalPersonsAge != 0 ? (1 + (int)item34.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item34.WomenPersonsAge = item34.WomenPersonsAge != 0 ? (1 + (int)item34.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item34.FirstGroupAll = item34.FirstGroupAll != 0 ? (1 + (int)item34.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item34.WomenFirstGroup = item34.WomenFirstGroup != 0 ? (1 + (int)item34.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item34.BusyFirstGroup = item34.BusyFirstGroup != 0 ? (1 + (int)item34.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item34.SecondGroupAll = item34.SecondGroupAll != 0 ? (1 + (int)item34.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item34.WomenSecondGroup = item34.WomenSecondGroup != 0 ? (1 + (int)item34.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item34.BusySecondGroup = item34.BusySecondGroup != 0 ? (1 + (int)item34.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item34.ThirdGroupAll = item34.ThirdGroupAll != 0 ? (1 + (int)item34.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item34.WomenThirdGroup = item34.WomenThirdGroup != 0 ? (1 + (int)item34.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item34.BusyThirdGroup = item34.BusyThirdGroup != 0 ? (1 + (int)item34.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId35)
                                {
                                    item35.Total1829 = item35.Total1829 != 0 ? (1 + (int)item35.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item35.Women1829 = item35.Women1829 != 0 ? (1 + (int)item35.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item35.Total1829 = item35.Total1829 != 0 ? (1 + (int)item35.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item35.Women1829 = item35.Women1829 != 0 ? (1 + (int)item35.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item35.Total3040 = item35.Total3040 != 0 ? (1 + (int)item35.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item35.Women3040 = item35.Women3040 != 0 ? (1 + (int)item35.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item35.Total45 = item35.Total45 != 0 ? (1 + (int)item35.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item35.Women45 = item35.Women45 != 0 ? (1 + (int)item35.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item35.TotalPersonsAge = item35.TotalPersonsAge != 0 ? (1 + (int)item35.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item35.WomenPersonsAge = item35.WomenPersonsAge != 0 ? (1 + (int)item35.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item35.FirstGroupAll = item35.FirstGroupAll != 0 ? (1 + (int)item35.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item35.WomenFirstGroup = item35.WomenFirstGroup != 0 ? (1 + (int)item35.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item35.BusyFirstGroup = item35.BusyFirstGroup != 0 ? (1 + (int)item35.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item35.SecondGroupAll = item35.SecondGroupAll != 0 ? (1 + (int)item35.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item35.WomenSecondGroup = item35.WomenSecondGroup != 0 ? (1 + (int)item35.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item35.BusySecondGroup = item35.BusySecondGroup != 0 ? (1 + (int)item35.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item35.ThirdGroupAll = item35.ThirdGroupAll != 0 ? (1 + (int)item35.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item35.WomenThirdGroup = item35.WomenThirdGroup != 0 ? (1 + (int)item35.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item35.BusyThirdGroup = item35.BusyThirdGroup != 0 ? (1 + (int)item35.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId36)
                                {
                                    item36.Total1829 = item36.Total1829 != 0 ? (1 + (int)item36.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item36.Women1829 = item36.Women1829 != 0 ? (1 + (int)item36.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item36.Total1829 = item36.Total1829 != 0 ? (1 + (int)item36.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item36.Women1829 = item36.Women1829 != 0 ? (1 + (int)item36.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item36.Total3040 = item36.Total3040 != 0 ? (1 + (int)item36.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item36.Women3040 = item36.Women3040 != 0 ? (1 + (int)item36.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item36.Total45 = item36.Total45 != 0 ? (1 + (int)item36.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item36.Women45 = item36.Women45 != 0 ? (1 + (int)item36.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item36.TotalPersonsAge = item36.TotalPersonsAge != 0 ? (1 + (int)item36.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item36.WomenPersonsAge = item36.WomenPersonsAge != 0 ? (1 + (int)item36.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item36.FirstGroupAll = item36.FirstGroupAll != 0 ? (1 + (int)item36.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item36.WomenFirstGroup = item36.WomenFirstGroup != 0 ? (1 + (int)item36.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item36.BusyFirstGroup = item36.BusyFirstGroup != 0 ? (1 + (int)item36.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item36.SecondGroupAll = item36.SecondGroupAll != 0 ? (1 + (int)item36.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item36.WomenSecondGroup = item36.WomenSecondGroup != 0 ? (1 + (int)item36.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item36.BusySecondGroup = item36.BusySecondGroup != 0 ? (1 + (int)item36.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item36.ThirdGroupAll = item36.ThirdGroupAll != 0 ? (1 + (int)item36.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item36.WomenThirdGroup = item36.WomenThirdGroup != 0 ? (1 + (int)item36.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item36.BusyThirdGroup = item36.BusyThirdGroup != 0 ? (1 + (int)item36.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId37)
                                {
                                    item37.Total1829 = item37.Total1829 != 0 ? (1 + (int)item37.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item37.Women1829 = item37.Women1829 != 0 ? (1 + (int)item37.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item37.Total1829 = item37.Total1829 != 0 ? (1 + (int)item37.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item37.Women1829 = item37.Women1829 != 0 ? (1 + (int)item37.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item37.Total3040 = item37.Total3040 != 0 ? (1 + (int)item37.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item37.Women3040 = item37.Women3040 != 0 ? (1 + (int)item37.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item37.Total45 = item37.Total45 != 0 ? (1 + (int)item37.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item37.Women45 = item37.Women45 != 0 ? (1 + (int)item37.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item37.TotalPersonsAge = item37.TotalPersonsAge != 0 ? (1 + (int)item37.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item37.WomenPersonsAge = item37.WomenPersonsAge != 0 ? (1 + (int)item37.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item37.FirstGroupAll = item37.FirstGroupAll != 0 ? (1 + (int)item37.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item37.WomenFirstGroup = item37.WomenFirstGroup != 0 ? (1 + (int)item37.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item37.BusyFirstGroup = item37.BusyFirstGroup != 0 ? (1 + (int)item37.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item37.SecondGroupAll = item37.SecondGroupAll != 0 ? (1 + (int)item37.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item37.WomenSecondGroup = item37.WomenSecondGroup != 0 ? (1 + (int)item37.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item37.BusySecondGroup = item37.BusySecondGroup != 0 ? (1 + (int)item37.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item37.ThirdGroupAll = item37.ThirdGroupAll != 0 ? (1 + (int)item37.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item37.WomenThirdGroup = item37.WomenThirdGroup != 0 ? (1 + (int)item37.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item37.BusyThirdGroup = item37.BusyThirdGroup != 0 ? (1 + (int)item37.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId38)
                                {
                                    item38.Total1829 = item38.Total1829 != 0 ? (1 + (int)item38.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item38.Women1829 = item38.Women1829 != 0 ? (1 + (int)item38.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item38.Total1829 = item38.Total1829 != 0 ? (1 + (int)item38.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item38.Women1829 = item38.Women1829 != 0 ? (1 + (int)item38.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item38.Total3040 = item38.Total3040 != 0 ? (1 + (int)item38.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item38.Women3040 = item38.Women3040 != 0 ? (1 + (int)item38.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item38.Total45 = item38.Total45 != 0 ? (1 + (int)item38.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item38.Women45 = item38.Women45 != 0 ? (1 + (int)item38.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item38.TotalPersonsAge = item38.TotalPersonsAge != 0 ? (1 + (int)item38.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item38.WomenPersonsAge = item38.WomenPersonsAge != 0 ? (1 + (int)item38.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item38.FirstGroupAll = item38.FirstGroupAll != 0 ? (1 + (int)item38.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item38.WomenFirstGroup = item38.WomenFirstGroup != 0 ? (1 + (int)item38.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item38.BusyFirstGroup = item38.BusyFirstGroup != 0 ? (1 + (int)item38.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item38.SecondGroupAll = item38.SecondGroupAll != 0 ? (1 + (int)item38.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item38.WomenSecondGroup = item38.WomenSecondGroup != 0 ? (1 + (int)item38.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item38.BusySecondGroup = item38.BusySecondGroup != 0 ? (1 + (int)item38.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item38.ThirdGroupAll = item38.ThirdGroupAll != 0 ? (1 + (int)item38.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item38.WomenThirdGroup = item38.WomenThirdGroup != 0 ? (1 + (int)item38.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item38.BusyThirdGroup = item38.BusyThirdGroup != 0 ? (1 + (int)item38.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId39)
                                {
                                    item39.Total1829 = item39.Total1829 != 0 ? (1 + (int)item39.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item39.Women1829 = item39.Women1829 != 0 ? (1 + (int)item39.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item39.Total1829 = item39.Total1829 != 0 ? (1 + (int)item39.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item39.Women1829 = item39.Women1829 != 0 ? (1 + (int)item39.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item39.Total3040 = item39.Total3040 != 0 ? (1 + (int)item39.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item39.Women3040 = item39.Women3040 != 0 ? (1 + (int)item39.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item39.Total45 = item39.Total45 != 0 ? (1 + (int)item39.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item39.Women45 = item39.Women45 != 0 ? (1 + (int)item39.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item39.TotalPersonsAge = item39.TotalPersonsAge != 0 ? (1 + (int)item39.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item39.WomenPersonsAge = item39.WomenPersonsAge != 0 ? (1 + (int)item39.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item39.FirstGroupAll = item39.FirstGroupAll != 0 ? (1 + (int)item39.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item39.WomenFirstGroup = item39.WomenFirstGroup != 0 ? (1 + (int)item39.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item39.BusyFirstGroup = item39.BusyFirstGroup != 0 ? (1 + (int)item39.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item39.SecondGroupAll = item39.SecondGroupAll != 0 ? (1 + (int)item39.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item39.WomenSecondGroup = item39.WomenSecondGroup != 0 ? (1 + (int)item39.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item39.BusySecondGroup = item39.BusySecondGroup != 0 ? (1 + (int)item39.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item39.ThirdGroupAll = item39.ThirdGroupAll != 0 ? (1 + (int)item39.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item39.WomenThirdGroup = item39.WomenThirdGroup != 0 ? (1 + (int)item39.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item39.BusyThirdGroup = item39.BusyThirdGroup != 0 ? (1 + (int)item39.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId40)
                                {
                                    item40.Total1829 = item40.Total1829 != 0 ? (1 + (int)item40.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item40.Women1829 = item40.Women1829 != 0 ? (1 + (int)item40.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item40.Total1829 = item40.Total1829 != 0 ? (1 + (int)item40.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40.Women1829 = item40.Women1829 != 0 ? (1 + (int)item40.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item40.Total3040 = item40.Total3040 != 0 ? (1 + (int)item40.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40.Women3040 = item40.Women3040 != 0 ? (1 + (int)item40.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item40.Total45 = item40.Total45 != 0 ? (1 + (int)item40.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40.Women45 = item40.Women45 != 0 ? (1 + (int)item40.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item40.TotalPersonsAge = item40.TotalPersonsAge != 0 ? (1 + (int)item40.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40.WomenPersonsAge = item40.WomenPersonsAge != 0 ? (1 + (int)item40.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item40.FirstGroupAll = item40.FirstGroupAll != 0 ? (1 + (int)item40.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40.WomenFirstGroup = item40.WomenFirstGroup != 0 ? (1 + (int)item40.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item40.BusyFirstGroup = item40.BusyFirstGroup != 0 ? (1 + (int)item40.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item40.SecondGroupAll = item40.SecondGroupAll != 0 ? (1 + (int)item40.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40.WomenSecondGroup = item40.WomenSecondGroup != 0 ? (1 + (int)item40.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item40.BusySecondGroup = item40.BusySecondGroup != 0 ? (1 + (int)item40.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item40.ThirdGroupAll = item40.ThirdGroupAll != 0 ? (1 + (int)item40.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40.WomenThirdGroup = item40.WomenThirdGroup != 0 ? (1 + (int)item40.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item40.BusyThirdGroup = item40.BusyThirdGroup != 0 ? (1 + (int)item40.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId41)
                                {
                                    item41.Total1829 = item41.Total1829 != 0 ? (1 + (int)item41.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item41.Women1829 = item41.Women1829 != 0 ? (1 + (int)item41.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item41.Total1829 = item41.Total1829 != 0 ? (1 + (int)item41.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item41.Women1829 = item41.Women1829 != 0 ? (1 + (int)item41.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item41.Total3040 = item41.Total3040 != 0 ? (1 + (int)item41.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item41.Women3040 = item41.Women3040 != 0 ? (1 + (int)item41.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item41.Total45 = item41.Total45 != 0 ? (1 + (int)item41.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item41.Women45 = item41.Women45 != 0 ? (1 + (int)item41.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item41.TotalPersonsAge = item41.TotalPersonsAge != 0 ? (1 + (int)item41.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item41.WomenPersonsAge = item41.WomenPersonsAge != 0 ? (1 + (int)item41.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item41.FirstGroupAll = item41.FirstGroupAll != 0 ? (1 + (int)item41.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item41.WomenFirstGroup = item41.WomenFirstGroup != 0 ? (1 + (int)item41.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item41.BusyFirstGroup = item41.BusyFirstGroup != 0 ? (1 + (int)item41.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item41.SecondGroupAll = item41.SecondGroupAll != 0 ? (1 + (int)item41.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item41.WomenSecondGroup = item41.WomenSecondGroup != 0 ? (1 + (int)item41.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item41.BusySecondGroup = item41.BusySecondGroup != 0 ? (1 + (int)item41.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item41.ThirdGroupAll = item41.ThirdGroupAll != 0 ? (1 + (int)item41.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item41.WomenThirdGroup = item41.WomenThirdGroup != 0 ? (1 + (int)item41.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item41.BusyThirdGroup = item41.BusyThirdGroup != 0 ? (1 + (int)item41.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId42)
                                {
                                    item42.Total1829 = item42.Total1829 != 0 ? (1 + (int)item42.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item42.Women1829 = item42.Women1829 != 0 ? (1 + (int)item42.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item42.Total1829 = item42.Total1829 != 0 ? (1 + (int)item42.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item42.Women1829 = item42.Women1829 != 0 ? (1 + (int)item42.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item42.Total3040 = item42.Total3040 != 0 ? (1 + (int)item42.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item42.Women3040 = item42.Women3040 != 0 ? (1 + (int)item42.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item42.Total45 = item42.Total45 != 0 ? (1 + (int)item42.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item42.Women45 = item42.Women45 != 0 ? (1 + (int)item42.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item42.TotalPersonsAge = item42.TotalPersonsAge != 0 ? (1 + (int)item42.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item42.WomenPersonsAge = item42.WomenPersonsAge != 0 ? (1 + (int)item42.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item42.FirstGroupAll = item42.FirstGroupAll != 0 ? (1 + (int)item42.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item42.WomenFirstGroup = item42.WomenFirstGroup != 0 ? (1 + (int)item42.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item42.BusyFirstGroup = item42.BusyFirstGroup != 0 ? (1 + (int)item42.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item42.SecondGroupAll = item42.SecondGroupAll != 0 ? (1 + (int)item42.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item42.WomenSecondGroup = item42.WomenSecondGroup != 0 ? (1 + (int)item42.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item42.BusySecondGroup = item42.BusySecondGroup != 0 ? (1 + (int)item42.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item42.ThirdGroupAll = item42.ThirdGroupAll != 0 ? (1 + (int)item42.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item42.WomenThirdGroup = item42.WomenThirdGroup != 0 ? (1 + (int)item42.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item42.BusyThirdGroup = item42.BusyThirdGroup != 0 ? (1 + (int)item42.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId43)
                                {
                                    item43.Total1829 = item43.Total1829 != 0 ? (1 + (int)item43.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item43.Women1829 = item43.Women1829 != 0 ? (1 + (int)item43.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item43.Total1829 = item43.Total1829 != 0 ? (1 + (int)item43.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item43.Women1829 = item43.Women1829 != 0 ? (1 + (int)item43.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item43.Total3040 = item43.Total3040 != 0 ? (1 + (int)item43.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item43.Women3040 = item43.Women3040 != 0 ? (1 + (int)item43.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item43.Total45 = item43.Total45 != 0 ? (1 + (int)item43.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item43.Women45 = item43.Women45 != 0 ? (1 + (int)item43.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item43.TotalPersonsAge = item43.TotalPersonsAge != 0 ? (1 + (int)item43.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item43.WomenPersonsAge = item43.WomenPersonsAge != 0 ? (1 + (int)item43.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item43.FirstGroupAll = item43.FirstGroupAll != 0 ? (1 + (int)item43.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item43.WomenFirstGroup = item43.WomenFirstGroup != 0 ? (1 + (int)item43.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item43.BusyFirstGroup = item43.BusyFirstGroup != 0 ? (1 + (int)item43.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item43.SecondGroupAll = item43.SecondGroupAll != 0 ? (1 + (int)item43.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item43.WomenSecondGroup = item43.WomenSecondGroup != 0 ? (1 + (int)item43.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item43.BusySecondGroup = item43.BusySecondGroup != 0 ? (1 + (int)item43.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item43.ThirdGroupAll = item43.ThirdGroupAll != 0 ? (1 + (int)item43.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item43.WomenThirdGroup = item43.WomenThirdGroup != 0 ? (1 + (int)item43.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item43.BusyThirdGroup = item43.BusyThirdGroup != 0 ? (1 + (int)item43.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId44)
                                {
                                    item44.Total1829 = item44.Total1829 != 0 ? (1 + (int)item44.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item44.Women1829 = item44.Women1829 != 0 ? (1 + (int)item44.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item44.Total1829 = item44.Total1829 != 0 ? (1 + (int)item44.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item44.Women1829 = item44.Women1829 != 0 ? (1 + (int)item44.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item44.Total3040 = item44.Total3040 != 0 ? (1 + (int)item44.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item44.Women3040 = item44.Women3040 != 0 ? (1 + (int)item44.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item44.Total45 = item44.Total45 != 0 ? (1 + (int)item44.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item44.Women45 = item44.Women45 != 0 ? (1 + (int)item44.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item44.TotalPersonsAge = item44.TotalPersonsAge != 0 ? (1 + (int)item44.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item44.WomenPersonsAge = item44.WomenPersonsAge != 0 ? (1 + (int)item44.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item44.FirstGroupAll = item44.FirstGroupAll != 0 ? (1 + (int)item44.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item44.WomenFirstGroup = item44.WomenFirstGroup != 0 ? (1 + (int)item44.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item44.BusyFirstGroup = item44.BusyFirstGroup != 0 ? (1 + (int)item44.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item44.SecondGroupAll = item44.SecondGroupAll != 0 ? (1 + (int)item44.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item44.WomenSecondGroup = item44.WomenSecondGroup != 0 ? (1 + (int)item44.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item44.BusySecondGroup = item44.BusySecondGroup != 0 ? (1 + (int)item44.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item44.ThirdGroupAll = item44.ThirdGroupAll != 0 ? (1 + (int)item44.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item44.WomenThirdGroup = item44.WomenThirdGroup != 0 ? (1 + (int)item44.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item44.BusyThirdGroup = item44.BusyThirdGroup != 0 ? (1 + (int)item44.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId45)
                                {
                                    item45.Total1829 = item45.Total1829 != 0 ? (1 + (int)item45.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item45.Women1829 = item45.Women1829 != 0 ? (1 + (int)item45.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item45.Total1829 = item45.Total1829 != 0 ? (1 + (int)item45.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item45.Women1829 = item45.Women1829 != 0 ? (1 + (int)item45.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item45.Total3040 = item45.Total3040 != 0 ? (1 + (int)item45.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item45.Women3040 = item45.Women3040 != 0 ? (1 + (int)item45.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item45.Total45 = item45.Total45 != 0 ? (1 + (int)item45.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item45.Women45 = item45.Women45 != 0 ? (1 + (int)item45.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item45.TotalPersonsAge = item45.TotalPersonsAge != 0 ? (1 + (int)item45.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item45.WomenPersonsAge = item45.WomenPersonsAge != 0 ? (1 + (int)item45.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item45.FirstGroupAll = item45.FirstGroupAll != 0 ? (1 + (int)item45.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item45.WomenFirstGroup = item45.WomenFirstGroup != 0 ? (1 + (int)item45.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item45.BusyFirstGroup = item45.BusyFirstGroup != 0 ? (1 + (int)item45.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item45.SecondGroupAll = item45.SecondGroupAll != 0 ? (1 + (int)item45.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item45.WomenSecondGroup = item45.WomenSecondGroup != 0 ? (1 + (int)item45.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item45.BusySecondGroup = item45.BusySecondGroup != 0 ? (1 + (int)item45.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item45.ThirdGroupAll = item45.ThirdGroupAll != 0 ? (1 + (int)item45.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item45.WomenThirdGroup = item45.WomenThirdGroup != 0 ? (1 + (int)item45.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item45.BusyThirdGroup = item45.BusyThirdGroup != 0 ? (1 + (int)item45.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                if (diagnos == strDiagId41 || diagnos == strDiagId42 || diagnos == strDiagId43 || diagnos == strDiagId44 || diagnos == strDiagId45)
                                {
                                    item40_1.Total1829 = item40_1.Total1829 != 0 ? (1 + (int)item40_1.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item40_1.Women1829 = item40_1.Women1829 != 0 ? (1 + (int)item40_1.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item40_1.Total1829 = item40_1.Total1829 != 0 ? (1 + (int)item40_1.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40_1.Women1829 = item40_1.Women1829 != 0 ? (1 + (int)item40_1.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item40_1.Total3040 = item40_1.Total3040 != 0 ? (1 + (int)item40_1.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40_1.Women3040 = item40_1.Women3040 != 0 ? (1 + (int)item40_1.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item40_1.Total45 = item40_1.Total45 != 0 ? (1 + (int)item40_1.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40_1.Women45 = item40_1.Women45 != 0 ? (1 + (int)item40_1.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item40_1.TotalPersonsAge = item40_1.TotalPersonsAge != 0 ? (1 + (int)item40_1.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40_1.WomenPersonsAge = item40_1.WomenPersonsAge != 0 ? (1 + (int)item40_1.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item40_1.FirstGroupAll = item40_1.FirstGroupAll != 0 ? (1 + (int)item40_1.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40_1.WomenFirstGroup = item40_1.WomenFirstGroup != 0 ? (1 + (int)item40_1.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item40_1.BusyFirstGroup = item40_1.BusyFirstGroup != 0 ? (1 + (int)item40_1.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item40_1.SecondGroupAll = item40_1.SecondGroupAll != 0 ? (1 + (int)item40_1.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40_1.WomenSecondGroup = item40_1.WomenSecondGroup != 0 ? (1 + (int)item40_1.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item40_1.BusySecondGroup = item40_1.BusySecondGroup != 0 ? (1 + (int)item40_1.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item40_1.ThirdGroupAll = item40_1.ThirdGroupAll != 0 ? (1 + (int)item40_1.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40_1.WomenThirdGroup = item40_1.WomenThirdGroup != 0 ? (1 + (int)item40_1.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item40_1.BusyThirdGroup = item40_1.BusyThirdGroup != 0 ? (1 + (int)item40_1.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            static void RemoveRows(WorkflowContext context, Guid reportId)
            {
                var docRepo = context.Documents;
                var rows = new List<Guid>();
                var qb = new QueryBuilder(reportItemDefId, context.UserId);
                qb.Where("Report").Eq(reportId).Or("Report").IsNull();
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read()) rows.Add(reader.GetGuid(0));
                }
                foreach (var rowId in rows)
                {
                    docRepo.DeleteById(rowId);
                }
            }
            private static readonly Guid reportDefId = new Guid("{17789FEE-2908-4E01-8E16-2ECAF4A75C7A}"); //Отчет о распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности
            private static readonly Guid reportItemDefId = new Guid("{10AB1374-EA9C-493B-B5F6-CD6A40273B9B}"); //Распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности

            private static readonly Guid adultsStatCardDefId = new Guid("{C77A6FF6-EC0B-4562-81FE-BB3BC17F4FDB}"); //Статистический талон для взрослых
            private static readonly Guid adultsActDefId = new Guid("{12AE380B-39CE-4753-A556-4083BD4B0F92}"); //Медицинский акт для взрослых

            private static readonly Guid personDefId = new Guid("{D71CE61A-9B59-4B5E-8713-8131DBB5BA02}"); //Person 
            public static readonly Guid districtDefId = new Guid("{A3FCA356-82A9-4BBD-872A-8333BEC6E41A}"); //Район
            public static readonly Guid cityDefId = new Guid("{4BB6D32D-5181-4031-BA49-CF5910D6D883}"); //Города районного значения

            public static readonly Guid ageOf1EnumId = new Guid("{027AEA0C-3C1D-4354-BEFF-4C89E06AF8B5}"); //От 18-29 лет
            public static readonly Guid ageOf2EnumId = new Guid("{6FC02932-97DD-48B9-93C8-FBD017C86707}"); //От 30-44 лет
            public static readonly Guid ageOf3EnumId = new Guid("{336A7447-4E55-44B8-8BA0-D7A156B7444A}"); //От 45-до пенсионного возраста
            public static readonly Guid ageOf4EnumId = new Guid("{9B207DB0-8214-4BA7-A8C4-635EF87B583A}"); //лицо пенсионного возраста

            public static readonly Guid group1EnumId = new Guid("{D145ABA1-EADA-442B-9D8D-AD10BCD126D2}"); //Первая
            public static readonly Guid group2EnumId = new Guid("{C161DA2D-2883-4211-B444-CBB04DBF33D5}"); //Вторая
            public static readonly Guid group3EnumId = new Guid("{CCD439CA-1500-4F7A-A1C8-BB474B5DE8AA}"); //Третья

            public static readonly Guid villageEnumId = new Guid("{65DF9C4D-A18B-4080-855F-4800E2A19C35}"); //Cельская местность//DistrictType
            public static readonly Guid womanEnumId = new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"); //Женский пол
            public static readonly Guid primaryEnumId = new Guid("{34129BC5-5B31-4189-87FA-799402F7E99F}"); //Первичное
            public static readonly Guid ApprovedStateId = new Guid("{32062CB7-C31C-4AFB-ADF3-F9F9AEEFCE59}");  //Подписанные

            //диагнозы
            private static readonly Guid strDiagId2 = new Guid("{9FF329FE-F547-42BE-817F-ED989FFB6573}"); //Туберкулез/ А 15-19
            private static readonly Guid strDiagId3 = new Guid("{99BC4A06-B78C-4A88-9F5C-AD4835563758}"); //Туберкулез  легких/ А 15-16
            private static readonly Guid strDiagId4 = new Guid("{2F9950BC-62B8-4B2B-865A-1C9C080CCC4E}"); //Злокачественные новообразования/ С 00-97
            private static readonly Guid strDiagId5 = new Guid("{C9CDD032-DC56-4027-A7D8-DBFE2F29BDE2}"); //Болезни эндокринной системы, нарушения обмена веществ/ Е 00-90
            private static readonly Guid strDiagId6 = new Guid("{C22D27F2-89F8-4355-A962-8EDE8294D052}"); //Заболeвания щитовидной железы/ E 00-07
            private static readonly Guid strDiagId7 = new Guid("{81E09427-D877-4C77-8609-E813D1BAF5FF}"); //Сахарный диабет/ E 10-14
            private static readonly Guid strDiagId8 = new Guid("{7ACAB39A-5CEE-4EF0-AAAB-10764F111DC0}"); //Психические расстройства/ F 00-99
            private static readonly Guid strDiagId9 = new Guid("{1F2922AB-423A-4997-BAB8-5D18538B5A15}"); //Шизофрения/ F 20
            private static readonly Guid strDiagId10 = new Guid("{22E82EC9-8BAA-48FD-AFD8-17619B0AD476}"); //Умственная отсталость/ F 70-79
            private static readonly Guid strDiagId11 = new Guid("{4BB66F12-B96C-4917-BFB3-0947D41AFA52}"); //Болезни нервной системы/ G 00-99     
            private static readonly Guid strDiagId12 = new Guid("{DFE168E8-7E30-4D8A-9AEF-54382B0A3932}"); //Болезни периферической нервной системы/ G 50-64  
            private static readonly Guid strDiagId13 = new Guid("{40012DC1-53A1-4EE7-8F93-85547C827DB5}"); //Болезни органов чувств/ H 00-95
            private static readonly Guid strDiagId14 = new Guid("{24483E18-28AC-4981-9C29-B94075BE9725}"); //Болезни глаз/ H 00-59  
            private static readonly Guid strDiagId15 = new Guid("{558D6E2E-E1E0-4D37-B200-A94D9953099F}"); //Болезни уха и сосцевидного отростка/ H 60-95
            private static readonly Guid strDiagId16 = new Guid("{E3D6EF80-B5E4-4DAE-9832-19FAD50A80F3}"); //Болезни системы кровообращения/ I 00-99 
            private static readonly Guid strDiagId17 = new Guid("{D71970B1-0562-4905-AC26-77DE739CAF5C}"); //Хронические ревматические болезни сердца/  I 05-09
            private static readonly Guid strDiagId18 = new Guid("{E6D6A67F-ED33-4879-B1C2-9BC173BB457B}"); //Повышенное кровеносное давление/ I 10-15  
            private static readonly Guid strDiagId19 = new Guid("{10712C7B-4FDC-4B6F-A50B-B7858FDD1211}"); //Ишемическая болезнь сердца/ I 20-25
            private static readonly Guid strDiagId20 = new Guid("{9549B0FD-2F0D-488A-8228-E990B01288D8}"); //Цереброваскулярные болезни/ I 60-69
            //private static readonly Guid strDiagId21 = new Guid("В СПИСКЕ ДИАГНОЗОВ НЕ НАШЛА"); //врожденные пороки сердца Q 20-28
            private static readonly Guid strDiagId22 = new Guid("{3363DE1E-864C-4063-BED7-4526F673AFF6}"); //Болезни органов дыхания / J 00-99
            private static readonly Guid strDiagId23 = new Guid("{866F3B61-AFCF-45F5-97BE-E0C23B87393C}"); //Бронхиальная астма/ J 45
            private static readonly Guid strDiagId24 = new Guid("{05479FEC-BC19-42B8-A0EC-37C63CE91205}"); //Болезни органов пищеварения/ K 00-93
            private static readonly Guid strDiagId25 = new Guid("{ECC9E612-FB40-4344-8298-5CD8BA40635F}"); //Болезни костно-мешечной системы и соединительной ткани/ M 00-99
            private static readonly Guid strDiagId26 = new Guid("{B3000363-8258-4F07-8234-0DE79E053660}"); //Ревматоидные/ M 05-14 
            private static readonly Guid strDiagId27 = new Guid("{1D4E81CB-2315-44C9-BDF3-B0FA874B8E61}"); //Остеохондроз позвоночника/ M 42
            private static readonly Guid strDiagId28 = new Guid("{3E0E50B5-9A3A-4DA2-A098-7147CB19833D}"); //Болезни мочевыводящих органов/ N 00-99
            private static readonly Guid strDiagId29 = new Guid("{82D1F915-CADF-4E7F-91A9-36B84CAB5A85}"); //Травмы, отравления и другие воздействия внешних причин/ S00 T98    
            private static readonly Guid strDiagId30 = new Guid("{FC38C0AE-2C54-4609-B728-517D5BC481CF}"); //Травма глаз/ T 90.4   
            private static readonly Guid strDiagId31 = new Guid("{961BB1B1-2C65-4833-86FA-2FC02CBCDDA8}"); //Болезни вследствие воздействия ионизирующего облучения/ W 88
            private static readonly Guid strDiagId32 = new Guid("{F702AAD3-523D-4914-8B97-5D2B9905D231}"); //Болезни вследствие воздействия вибрации/ W 43 
            private static readonly Guid strDiagId33 = new Guid("{E7271846-9AAA-4C52-AA19-CB01C3B765A2}"); //Болезни крови, кроветворных органов/ D 50-89
            private static readonly Guid strDiagId34 = new Guid("{41F09403-B4B7-46CA-92BF-B716523AFDE9}"); //Доброкачественные новообразования/ D 10-36
            private static readonly Guid strDiagId35 = new Guid("{D4050056-32C3-48FD-9718-EA7FE3294E82}"); //Бруцеллез/ A 23
            private static readonly Guid strDiagId36 = new Guid("{1DEDD889-4336-4622-85C0-9DDD1FF432D9}"); //Бруцеллез бытовой/ A 23
            private static readonly Guid strDiagId37 = new Guid("{F3B64F5D-6A6C-4343-B5B5-7B5E3CB92474}"); //Эхинококкоз/ B 67     
            private static readonly Guid strDiagId38 = new Guid("{0CEAC906-B3D2-4AD8-9DE6-D3FA384F2CDF}"); //Врожденные пороки развития, хромосомные развития/ Q 00-99
            private static readonly Guid strDiagId39 = new Guid("{07C6C658-D589-48A1-803B-DBCA6603B543}"); //Болезни вызванные вирусом ВИЧ (СПИД)/ B 20-24
            private static readonly Guid strDiagId40 = new Guid("{0ADE4B55-DF1D-46EA-954B-F3F9FB7CAE08}"); //Прочие болезни / Прочие
            private static readonly Guid strDiagId41 = new Guid("{25029E6F-916F-44DE-86B0-C018A8055D4F}"); //Трудовое увечье    
            private static readonly Guid strDiagId42 = new Guid("{8F30CA1F-9187-463E-9D26-1BD525BF45F6}"); //Профессиональные болезни
            private static readonly Guid strDiagId43 = new Guid("{CBEBAF9D-B67D-4BB3-B715-DB252DC2C018}"); //Ликвидаторы последствий аварии на ЧАЭС
            private static readonly Guid strDiagId44 = new Guid("{C0B08AFD-85BB-4DB1-8D9D-6ED3CA43438E}"); //Пострадавшие в событиях 2010г. Бишкек, Талас    
            private static readonly Guid strDiagId45 = new Guid("{6A2CF4F5-E0FC-4D70-9DD3-DA23F3049CD2}"); //Пострадавшие в событиях 2010г. Ош, Жалал-Абад   
        }

        //Отчет о результатах первичных освидетельствований всех социальных категорий населения (ГОРОДСКАЯ/СЕЛЬСКАЯ МЕСТНОСТЬ) 
        public static class PrimaryInvalidsOfCityVillage
        {
            public static List<Report1Item> Execute(WorkflowContext context, int year, string distrSpr)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;

                /******************************************************************************************************************/
                var docs = new string[]
                {
                    "всего  01           ",
                    "в том числе: туберкулез  02   А15-19  ",
                    "из них: туберкулез легких  02.1 А15-16  ",
                    "злокачественные новообразования  03   С00-97  ",
                    "б-ни эндокринной с-мы, нар-я обмена веществ  04   Е00-90  ",
                    "из них: заболевания щитовидной железы  04.1 Е00-07  ",
                    "сахарный диабет  04.2 Е10-14  ",
                    "психич-ие расстройства  05   F 00-99 ",
                    "из них шизофрения  05.1 F 20    ",
                    "умственная отсталость  05.2 F 70-79 ",
                    "болезни нервной системы  06   G 00-99 ",
                    "из них: болезни перифери-ческой нервной системы  06.1 G 60-64 ",
                    "болезни органов чувств  07   H 00-95 ",
                    "болезни глаз  07.1 H 00-59 ",
                    "болезни уха и сосцевидного отростка  07.2 H 60-95 ",
                    "болезни системы кровообращения  08   I 00-99 ",
                    "из них: хронические ревматические б-и сердца  08.1 I 05-09 ",
                    "болезни, характеризующиеся повышенным кровяным давлением  08.2 I 10-15 ",
                    "ишемическая болезнь сердца  08.3 I 20-25 ",
                    "цереброваскулярные болезни  08.4 I 60-69 ",
                    "врожденные пороки сердца  09   Q 20-28 ",
                    "болезни органов дыхания  10   J 00-99 ",
                    "из них бронхиальная астма  10.1 J 45    ",
                    "болезни органов пищеварения  11   K 00-93 ",
                    "болезни костно-мышечной системы и соединительной ткани  12   M00-99 ",
                    "из них: ревматоидные  12.1 M05-14  ",
                    "остеохондроз позвоночника  12.2 M 42    ",
                    "болезни мочевывоводящих органов  13   N 00-99 ",
                    "травмы, отравления и другие воздействия внешних причин  14   S 00-Т98",
                    "травма глаз  14.1 S 05    ",
                    "б-ни вследствие возд-я ионизирующего облучения  15   W 88    ",
                    "б-ни вследствие воздействия вибрации  16   W 43    ",
                    "болезни крови  17   D 50-89 ",
                    "доброкачественные новообразования  18   D 10-36 ",
                    "бруцеллез  19   A 23    ",
                    "бруцеллез бытовой  19.1 A 23    ",
                    "эхинококкоз  20   B 67    ",
                    "врожд пороки развития, хромосомные нарушения  21   Q 00-99 ",
                    "болезни вызванные вирусом  ВИЧ (СПИД)  22   B 20-24 ",
                    "прочие болезни  23           ",
                    "по причинам (24, 25, 26 не выходят в строки 01)              ",
                    "трудовое увечье  24           ",
                    "профессиональные болезни  25           ",
                    "ликвидаторы последствий аварии на ЧАЭС  26           ",
                    "Пострадавшие в апрельских событиях 2010 год  27           ",
                    "Пострадавшие в майских и июньских событиях 2010 год  28           "
                };
                var items = new List<Report1Item>();
                int i2 = 1;
                foreach (var i in docs)
                {
                    var item = new Report1Item();
                    item.RowType = i;
                    item.RowNo = i2;
                    //item.RowICD = 
                    i2++;
                    items.Add(item);
                }
                CalcItems(context, /*report, */year, orgId, distrSpr,
                    items[45], items[44], items[43], items[42], items[41], items[40], items[39],
                    items[38], items[37], items[36], items[35], items[34], items[33], items[32],
                    items[31], items[30], items[29], items[28], items[27], items[26], items[25],
                    items[24], items[23], items[22], items[21], items[20], items[19], items[18],
                    items[17], items[16], items[15], items[14], items[13], items[12], items[11],
                    items[10], items[9], items[8], items[7], items[6], items[5], items[4],
                    items[3], items[2], items[1], items[0]);
                return items;
            }
            public static void CalcItems(WorkflowContext context, int year, Guid orgId, string distrSpr,
                    Report1Item item45, Report1Item item44, Report1Item item43, Report1Item item42,
                    Report1Item item41, Report1Item item40_1, Report1Item item40, Report1Item item39, Report1Item item38,
                    Report1Item item37, Report1Item item36, Report1Item item35, Report1Item item34,
                    Report1Item item33, Report1Item item32, Report1Item item31, Report1Item item30,
                    Report1Item item29, Report1Item item28, Report1Item item27, Report1Item item26,
                    Report1Item item25, Report1Item item24, Report1Item item23, Report1Item item22,
                    Report1Item item21, Report1Item item20, Report1Item item19, Report1Item item18,
                    Report1Item item17, Report1Item item16, Report1Item item15, Report1Item item14,
                    Report1Item item13, Report1Item item12, Report1Item item11, Report1Item item10,
                    Report1Item item9, Report1Item item8, Report1Item item7, Report1Item item6,
                    Report1Item item5, Report1Item item4, Report1Item item3, Report1Item item2,
                    Report1Item item1)
            {
                var qb = new QueryBuilder(adultsStatCardDefId, context.UserId);
                qb.Where("&State").Eq(ApprovedStateId).And("Examination1").Eq(primaryEnumId);

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                    var actSrc = query.JoinSource(query.Source, adultsActDefId, SqlSourceJoinType.Inner, "AdultsMedicalCertificate");
                    var distrSrc = query.JoinSource(actSrc, districtDefId, SqlSourceJoinType.LeftOuter, "DistrictId");
                    var citySrc = query.JoinSource(actSrc, cityDefId, SqlSourceJoinType.LeftOuter, "CityId");
                    query.AddCondition(ExpressionOperation.And, adultsStatCardDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    if (!string.IsNullOrEmpty(distrSpr))
                        query.AddCondition(ExpressionOperation.And, districtDefId, "NumberDis", ConditionOperation.Equal, distrSpr);

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(query.Source, "EndDateExamination");
                    query.AddAttribute(query.Source, "AgeOf");
                    query.AddAttribute(query.Source, "DisabilityGroup");
                    query.AddAttribute(query.Source, "PlaceWork");
                    query.AddAttribute(query.Source, "Diagnosis");
                    query.AddAttribute(distrSrc, "DistrictType");
                    query.AddAttribute(citySrc, "DistrictType");
                    query.AddAttribute(personSrc, "Gender");

                    var table = new DataTable();
                    using (var reader = context.CreateSqlReader(query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var date = !(row[1] is DBNull) ? (DateTime)row[1] : DateTime.MinValue;
                        var ageOf = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                        var group = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                        var bysy = row[4] is DBNull ? "" : row[4].ToString();
                        var diagnos = row[5] is DBNull ? Guid.Empty : (Guid)row[5];
                        var district = row[6] is DBNull ? Guid.Empty : (Guid)row[6];
                        var city = row[7] is DBNull ? Guid.Empty : (Guid)row[7];
                        var gender = row[8] is DBNull ? Guid.Empty : (Guid)row[8];

                        if (appId != Guid.Empty)
                        {
                            if (date.Year == year && (district == villageEnumId) ||
                                date.Year == year && (city == villageEnumId) ||
                                date.Year == year && (district == cityEnumId) ||
                                date.Year == year && (city == cityEnumId))
                            {
                                item1.Total = item1.Total != 0 ? (1 + (int)item1.Total) : 1;

                                if (gender == womanEnumId)
                                {
                                    item1.WomenAll = item1.WomenAll != 0 ? (1 + (int)item1.WomenAll) : 1;
                                }
                                //в том числе в возрасте
                                /*****************************************************************************************************************************/
                                if (ageOf == ageOf1EnumId)
                                {
                                    item1.Total1829 = item1.Total1829 != 0 ? (1 + (int)item1.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item1.Women1829 = item1.Women1829 != 0 ? (1 + (int)item1.Women1829) : 1;
                                    }
                                }
                                if (ageOf == ageOf2EnumId)
                                {
                                    item1.Total3040 = item1.Total3040 != 0 ? (1 + (int)item1.Total3040) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item1.Women3040 = item1.Women3040 != 0 ? (1 + (int)item1.Women3040) : 1;
                                    }
                                }
                                if (ageOf == ageOf3EnumId)
                                {
                                    item1.Total45 = item1.Total45 != 0 ? (1 + (int)item1.Total45) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item1.Women45 = item1.Women45 != 0 ? (1 + (int)item1.Women45) : 1;
                                    }
                                }
                                if (ageOf == ageOf4EnumId)
                                {
                                    item1.TotalPersonsAge = item1.TotalPersonsAge != 0 ? (1 + (int)item1.TotalPersonsAge) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item1.WomenPersonsAge = item1.WomenPersonsAge != 0 ? (1 + (int)item1.WomenPersonsAge) : 1;
                                    }
                                }
                                //Из общего числа признанных ЛОВЗ                                
                                if (group == group1EnumId)
                                {
                                    item1.FirstGroupAll = item1.FirstGroupAll != 0 ? (1 + (int)item1.FirstGroupAll) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item1.WomenFirstGroup = item1.WomenFirstGroup != 0 ? (1 + (int)item1.WomenFirstGroup) : 1;
                                    }
                                    if (bysy != null)
                                    {
                                        item1.BusyFirstGroup = item1.BusyFirstGroup != 0 ? (1 + (int)item1.BusyFirstGroup) : 1;
                                    }
                                }
                                if (group == group2EnumId)
                                {
                                    item1.SecondGroupAll = item1.SecondGroupAll != 0 ? (1 + (int)item1.SecondGroupAll) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item1.WomenSecondGroup = item1.WomenSecondGroup != 0 ? (1 + (int)item1.WomenSecondGroup) : 1;
                                    }
                                    if (bysy != null)
                                    {
                                        item1.BusySecondGroup = item1.BusySecondGroup != 0 ? (1 + (int)item1.BusySecondGroup) : 1;
                                    }
                                }
                                if (group == group3EnumId)
                                {
                                    item1.ThirdGroupAll = item1.ThirdGroupAll != 0 ? (1 + (int)item1.ThirdGroupAll) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item1.WomenThirdGroup = item1.WomenThirdGroup != 0 ? (1 + (int)item1.WomenThirdGroup) : 1;
                                    }
                                    if (bysy != null)
                                    {
                                        item1.BusyThirdGroup = item1.BusyThirdGroup != 0 ? (1 + (int)item1.BusyThirdGroup) : 1;
                                    }
                                }
                                //Туберкулез/ А 15-19
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId2)
                                {
                                    item2.Total1829 = item2.Total1829 != 0 ? (1 + (int)item2.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item2.Women1829 = item2.Women1829 != 0 ? (1 + (int)item2.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item2.Total1829 = item2.Total1829 != 0 ? (1 + (int)item2.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.Women1829 = item2.Women1829 != 0 ? (1 + (int)item2.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item2.Total3040 = item2.Total3040 != 0 ? (1 + (int)item2.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.Women3040 = item2.Women3040 != 0 ? (1 + (int)item2.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item2.Total45 = item2.Total45 != 0 ? (1 + (int)item2.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.Women45 = item2.Women45 != 0 ? (1 + (int)item2.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item2.TotalPersonsAge = item2.TotalPersonsAge != 0 ? (1 + (int)item2.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.WomenPersonsAge = item2.WomenPersonsAge != 0 ? (1 + (int)item2.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item2.FirstGroupAll = item2.FirstGroupAll != 0 ? (1 + (int)item2.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.WomenFirstGroup = item2.WomenFirstGroup != 0 ? (1 + (int)item2.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item2.BusyFirstGroup = item2.BusyFirstGroup != 0 ? (1 + (int)item2.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item2.SecondGroupAll = item2.SecondGroupAll != 0 ? (1 + (int)item2.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.WomenSecondGroup = item2.WomenSecondGroup != 0 ? (1 + (int)item2.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item2.BusySecondGroup = item2.BusySecondGroup != 0 ? (1 + (int)item2.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item2.ThirdGroupAll = item2.ThirdGroupAll != 0 ? (1 + (int)item2.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.WomenThirdGroup = item2.WomenThirdGroup != 0 ? (1 + (int)item2.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item2.BusyThirdGroup = item2.BusyThirdGroup != 0 ? (1 + (int)item2.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //Туберкулез  легких/ А 15-16
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId3)
                                {
                                    item3.Total1829 = item3.Total1829 != 0 ? (1 + (int)item3.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item3.Women1829 = item3.Women1829 != 0 ? (1 + (int)item3.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item3.Total1829 = item3.Total1829 != 0 ? (1 + (int)item3.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.Women1829 = item3.Women1829 != 0 ? (1 + (int)item3.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item3.Total3040 = item3.Total3040 != 0 ? (1 + (int)item3.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.Women3040 = item3.Women3040 != 0 ? (1 + (int)item3.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item3.Total45 = item3.Total45 != 0 ? (1 + (int)item3.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.Women45 = item3.Women45 != 0 ? (1 + (int)item3.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item3.TotalPersonsAge = item3.TotalPersonsAge != 0 ? (1 + (int)item3.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.WomenPersonsAge = item3.WomenPersonsAge != 0 ? (1 + (int)item3.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item3.FirstGroupAll = item3.FirstGroupAll != 0 ? (1 + (int)item3.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.WomenFirstGroup = item3.WomenFirstGroup != 0 ? (1 + (int)item3.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item3.BusyFirstGroup = item3.BusyFirstGroup != 0 ? (1 + (int)item3.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item3.SecondGroupAll = item3.SecondGroupAll != 0 ? (1 + (int)item3.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.WomenSecondGroup = item3.WomenSecondGroup != 0 ? (1 + (int)item3.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item3.BusySecondGroup = item3.BusySecondGroup != 0 ? (1 + (int)item3.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item3.ThirdGroupAll = item3.ThirdGroupAll != 0 ? (1 + (int)item3.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.WomenThirdGroup = item3.WomenThirdGroup != 0 ? (1 + (int)item3.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item3.BusyThirdGroup = item3.BusyThirdGroup != 0 ? (1 + (int)item3.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //Злокачественные новообразования/ С 00-97
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId4)
                                {
                                    item4.Total1829 = item4.Total1829 != 0 ? (1 + (int)item4.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item4.Women1829 = item4.Women1829 != 0 ? (1 + (int)item4.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item4.Total1829 = item4.Total1829 != 0 ? (1 + (int)item4.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item4.Women1829 = item4.Women1829 != 0 ? (1 + (int)item4.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item4.Total3040 = item4.Total3040 != 0 ? (1 + (int)item4.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item4.Women3040 = item4.Women3040 != 0 ? (1 + (int)item4.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item4.Total45 = item4.Total45 != 0 ? (1 + (int)item4.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item4.Women45 = item4.Women45 != 0 ? (1 + (int)item4.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item4.TotalPersonsAge = item4.TotalPersonsAge != 0 ? (1 + (int)item4.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item4.WomenPersonsAge = item4.WomenPersonsAge != 0 ? (1 + (int)item4.WomenPersonsAge) : 1;
                                        }
                                    }
                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item4.FirstGroupAll = item4.FirstGroupAll != 0 ? (1 + (int)item4.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item4.WomenFirstGroup = item4.WomenFirstGroup != 0 ? (1 + (int)item4.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item4.BusyFirstGroup = item4.BusyFirstGroup != 0 ? (1 + (int)item4.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item4.SecondGroupAll = item4.SecondGroupAll != 0 ? (1 + (int)item4.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item4.WomenSecondGroup = item4.WomenSecondGroup != 0 ? (1 + (int)item4.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item4.BusySecondGroup = item4.BusySecondGroup != 0 ? (1 + (int)item4.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item4.ThirdGroupAll = item4.ThirdGroupAll != 0 ? (1 + (int)item4.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item4.WomenThirdGroup = item4.WomenThirdGroup != 0 ? (1 + (int)item4.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item4.BusyThirdGroup = item4.BusyThirdGroup != 0 ? (1 + (int)item4.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //Заболeвания щитовидной железы/ E 00-07
                                if (diagnos == strDiagId5)
                                {
                                    item5.Total1829 = item5.Total1829 != 0 ? (1 + (int)item5.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item5.Women1829 = item5.Women1829 != 0 ? (1 + (int)item5.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item5.Total1829 = item5.Total1829 != 0 ? (1 + (int)item5.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item5.Women1829 = item5.Women1829 != 0 ? (1 + (int)item5.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item5.Total3040 = item5.Total3040 != 0 ? (1 + (int)item5.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item5.Women3040 = item5.Women3040 != 0 ? (1 + (int)item5.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item5.Total45 = item5.Total45 != 0 ? (1 + (int)item5.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item5.Women45 = item5.Women45 != 0 ? (1 + (int)item5.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item5.TotalPersonsAge = item5.TotalPersonsAge != 0 ? (1 + (int)item5.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item5.WomenPersonsAge = item5.WomenPersonsAge != 0 ? (1 + (int)item5.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item5.FirstGroupAll = item5.FirstGroupAll != 0 ? (1 + (int)item5.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item5.WomenFirstGroup = item5.WomenFirstGroup != 0 ? (1 + (int)item5.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item5.BusyFirstGroup = item5.BusyFirstGroup != 0 ? (1 + (int)item5.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item5.SecondGroupAll = item5.SecondGroupAll != 0 ? (1 + (int)item5.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item5.WomenSecondGroup = item5.WomenSecondGroup != 0 ? (1 + (int)item5.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item5.BusySecondGroup = item5.BusySecondGroup != 0 ? (1 + (int)item5.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item5.ThirdGroupAll = item5.ThirdGroupAll != 0 ? (1 + (int)item5.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item5.WomenThirdGroup = item5.WomenThirdGroup != 0 ? (1 + (int)item5.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item5.BusyThirdGroup = item5.BusyThirdGroup != 0 ? (1 + (int)item5.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //Сахарный диабет/ E 10-14
                                if (diagnos == strDiagId6)
                                {
                                    item6.Total1829 = item6.Total1829 != 0 ? (1 + (int)item6.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item6.Women1829 = item6.Women1829 != 0 ? (1 + (int)item6.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item6.Total1829 = item6.Total1829 != 0 ? (1 + (int)item6.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item6.Women1829 = item6.Women1829 != 0 ? (1 + (int)item6.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item6.Total3040 = item6.Total3040 != 0 ? (1 + (int)item6.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item6.Women3040 = item6.Women3040 != 0 ? (1 + (int)item6.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item6.Total45 = item6.Total45 != 0 ? (1 + (int)item6.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item6.Women45 = item6.Women45 != 0 ? (1 + (int)item6.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item6.TotalPersonsAge = item6.TotalPersonsAge != 0 ? (1 + (int)item6.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item6.WomenPersonsAge = item6.WomenPersonsAge != 0 ? (1 + (int)item6.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item6.FirstGroupAll = item6.FirstGroupAll != 0 ? (1 + (int)item6.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item6.WomenFirstGroup = item6.WomenFirstGroup != 0 ? (1 + (int)item6.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item6.BusyFirstGroup = item6.BusyFirstGroup != 0 ? (1 + (int)item6.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item6.SecondGroupAll = item6.SecondGroupAll != 0 ? (1 + (int)item6.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item6.WomenSecondGroup = item6.WomenSecondGroup != 0 ? (1 + (int)item6.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item6.BusySecondGroup = item6.BusySecondGroup != 0 ? (1 + (int)item6.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item6.ThirdGroupAll = item6.ThirdGroupAll != 0 ? (1 + (int)item6.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item6.WomenThirdGroup = item6.WomenThirdGroup != 0 ? (1 + (int)item6.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item6.BusyThirdGroup = item6.BusyThirdGroup != 0 ? (1 + (int)item6.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //Психические расстройства/ F 00-99*******************************************************************************************/
                                if (diagnos == strDiagId7)
                                {
                                    item7.Total1829 = item7.Total1829 != 0 ? (1 + (int)item7.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item7.Women1829 = item7.Women1829 != 0 ? (1 + (int)item7.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item7.Total1829 = item7.Total1829 != 0 ? (1 + (int)item7.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item7.Women1829 = item7.Women1829 != 0 ? (1 + (int)item7.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item7.Total3040 = item7.Total3040 != 0 ? (1 + (int)item7.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item7.Women3040 = item7.Women3040 != 0 ? (1 + (int)item7.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item7.Total45 = item7.Total45 != 0 ? (1 + (int)item7.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item7.Women45 = item7.Women45 != 0 ? (1 + (int)item7.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item7.TotalPersonsAge = item7.TotalPersonsAge != 0 ? (1 + (int)item7.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item7.WomenPersonsAge = item7.WomenPersonsAge != 0 ? (1 + (int)item7.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item7.FirstGroupAll = item7.FirstGroupAll != 0 ? (1 + (int)item7.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item7.WomenFirstGroup = item7.WomenFirstGroup != 0 ? (1 + (int)item7.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item7.BusyFirstGroup = item7.BusyFirstGroup != 0 ? (1 + (int)item7.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item7.SecondGroupAll = item7.SecondGroupAll != 0 ? (1 + (int)item7.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item7.WomenSecondGroup = item7.WomenSecondGroup != 0 ? (1 + (int)item7.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item7.BusySecondGroup = item7.BusySecondGroup != 0 ? (1 + (int)item7.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item7.ThirdGroupAll = item7.ThirdGroupAll != 0 ? (1 + (int)item7.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item7.WomenThirdGroup = item7.WomenThirdGroup != 0 ? (1 + (int)item7.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item7.BusyThirdGroup = item7.BusyThirdGroup != 0 ? (1 + (int)item7.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //Шизофрения/ F 20
                                if (diagnos == strDiagId8)
                                {
                                    item8.Total1829 = item8.Total1829 != 0 ? (1 + (int)item8.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item8.Women1829 = item8.Women1829 != 0 ? (1 + (int)item8.Women1829) : 1;
                                    }
                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item8.Total1829 = item8.Total1829 != 0 ? (1 + (int)item8.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item8.Women1829 = item8.Women1829 != 0 ? (1 + (int)item8.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item8.Total3040 = item8.Total3040 != 0 ? (1 + (int)item8.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item8.Women3040 = item8.Women3040 != 0 ? (1 + (int)item8.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item8.Total45 = item8.Total45 != 0 ? (1 + (int)item8.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item8.Women45 = item8.Women45 != 0 ? (1 + (int)item8.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item8.TotalPersonsAge = item8.TotalPersonsAge != 0 ? (1 + (int)item8.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item8.WomenPersonsAge = item8.WomenPersonsAge != 0 ? (1 + (int)item8.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item8.FirstGroupAll = item8.FirstGroupAll != 0 ? (1 + (int)item8.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item8.WomenFirstGroup = item8.WomenFirstGroup != 0 ? (1 + (int)item8.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item8.BusyFirstGroup = item8.BusyFirstGroup != 0 ? (1 + (int)item8.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item8.SecondGroupAll = item8.SecondGroupAll != 0 ? (1 + (int)item8.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item8.WomenSecondGroup = item8.WomenSecondGroup != 0 ? (1 + (int)item8.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item8.BusySecondGroup = item8.BusySecondGroup != 0 ? (1 + (int)item8.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item8.ThirdGroupAll = item8.ThirdGroupAll != 0 ? (1 + (int)item8.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item8.WomenThirdGroup = item8.WomenThirdGroup != 0 ? (1 + (int)item8.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item8.BusyThirdGroup = item8.BusyThirdGroup != 0 ? (1 + (int)item8.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //Умственная отсталость/ F 70-79
                                if (diagnos == strDiagId9)
                                {
                                    item9.Total1829 = item9.Total1829 != 0 ? (1 + (int)item9.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item9.Women1829 = item9.Women1829 != 0 ? (1 + (int)item9.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item9.Total1829 = item9.Total1829 != 0 ? (1 + (int)item9.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item9.Women1829 = item9.Women1829 != 0 ? (1 + (int)item9.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item9.Total3040 = item9.Total3040 != 0 ? (1 + (int)item9.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item9.Women3040 = item9.Women3040 != 0 ? (1 + (int)item9.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item9.Total45 = item9.Total45 != 0 ? (1 + (int)item9.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item9.Women45 = item9.Women45 != 0 ? (1 + (int)item9.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item9.TotalPersonsAge = item9.TotalPersonsAge != 0 ? (1 + (int)item9.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item9.WomenPersonsAge = item9.WomenPersonsAge != 0 ? (1 + (int)item9.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item9.FirstGroupAll = item9.FirstGroupAll != 0 ? (1 + (int)item9.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item9.WomenFirstGroup = item9.WomenFirstGroup != 0 ? (1 + (int)item9.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item9.BusyFirstGroup = item9.BusyFirstGroup != 0 ? (1 + (int)item9.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item9.SecondGroupAll = item9.SecondGroupAll != 0 ? (1 + (int)item9.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item9.WomenSecondGroup = item9.WomenSecondGroup != 0 ? (1 + (int)item9.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item9.BusySecondGroup = item9.BusySecondGroup != 0 ? (1 + (int)item9.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item9.ThirdGroupAll = item9.ThirdGroupAll != 0 ? (1 + (int)item9.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item9.WomenThirdGroup = item9.WomenThirdGroup != 0 ? (1 + (int)item9.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item9.BusyThirdGroup = item9.BusyThirdGroup != 0 ? (1 + (int)item9.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //болезни нервной системы/ G 00-99
                                if (diagnos == strDiagId10)
                                {
                                    item10.Total1829 = item10.Total1829 != 0 ? (1 + (int)item10.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item10.Women1829 = item10.Women1829 != 0 ? (1 + (int)item10.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item10.Total1829 = item10.Total1829 != 0 ? (1 + (int)item10.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item10.Women1829 = item10.Women1829 != 0 ? (1 + (int)item10.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item10.Total3040 = item10.Total3040 != 0 ? (1 + (int)item10.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item10.Women3040 = item10.Women3040 != 0 ? (1 + (int)item10.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item10.Total45 = item10.Total45 != 0 ? (1 + (int)item10.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item10.Women45 = item10.Women45 != 0 ? (1 + (int)item10.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item10.TotalPersonsAge = item10.TotalPersonsAge != 0 ? (1 + (int)item10.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item10.WomenPersonsAge = item10.WomenPersonsAge != 0 ? (1 + (int)item10.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item10.FirstGroupAll = item10.FirstGroupAll != 0 ? (1 + (int)item10.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item10.WomenFirstGroup = item10.WomenFirstGroup != 0 ? (1 + (int)item10.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item10.BusyFirstGroup = item10.BusyFirstGroup != 0 ? (1 + (int)item10.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item10.SecondGroupAll = item10.SecondGroupAll != 0 ? (1 + (int)item10.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item10.WomenSecondGroup = item10.WomenSecondGroup != 0 ? (1 + (int)item10.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item10.BusySecondGroup = item10.BusySecondGroup != 0 ? (1 + (int)item10.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item10.ThirdGroupAll = item10.ThirdGroupAll != 0 ? (1 + (int)item10.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item10.WomenThirdGroup = item10.WomenThirdGroup != 0 ? (1 + (int)item10.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item10.BusyThirdGroup = item10.BusyThirdGroup != 0 ? (1 + (int)item10.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //болезни периферической нервной системы/ G 60-64                               
                                if (diagnos == strDiagId11)
                                {
                                    item11.Total1829 = item11.Total1829 != 0 ? (1 + (int)item11.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item11.Women1829 = item11.Women1829 != 0 ? (1 + (int)item11.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item11.Total1829 = item11.Total1829 != 0 ? (1 + (int)item11.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item11.Women1829 = item11.Women1829 != 0 ? (1 + (int)item11.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item11.Total3040 = item11.Total3040 != 0 ? (1 + (int)item11.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item11.Women3040 = item11.Women3040 != 0 ? (1 + (int)item11.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item11.Total45 = item11.Total45 != 0 ? (1 + (int)item11.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item11.Women45 = item11.Women45 != 0 ? (1 + (int)item11.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item11.TotalPersonsAge = item11.TotalPersonsAge != 0 ? (1 + (int)item11.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item11.WomenPersonsAge = item11.WomenPersonsAge != 0 ? (1 + (int)item11.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item11.FirstGroupAll = item11.FirstGroupAll != 0 ? (1 + (int)item11.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item11.WomenFirstGroup = item11.WomenFirstGroup != 0 ? (1 + (int)item11.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item11.BusyFirstGroup = item11.BusyFirstGroup != 0 ? (1 + (int)item11.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item11.SecondGroupAll = item11.SecondGroupAll != 0 ? (1 + (int)item11.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item11.WomenSecondGroup = item11.WomenSecondGroup != 0 ? (1 + (int)item11.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item11.BusySecondGroup = item11.BusySecondGroup != 0 ? (1 + (int)item11.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item11.ThirdGroupAll = item11.ThirdGroupAll != 0 ? (1 + (int)item11.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item11.WomenThirdGroup = item11.WomenThirdGroup != 0 ? (1 + (int)item11.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item11.BusyThirdGroup = item11.BusyThirdGroup != 0 ? (1 + (int)item11.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //из них: болезни периферической нервной системы/ G 60-64
                                if (diagnos == strDiagId12)
                                {
                                    item12.Total1829 = item12.Total1829 != 0 ? (1 + (int)item12.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item12.Women1829 = item12.Women1829 != 0 ? (1 + (int)item12.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item12.Total1829 = item12.Total1829 != 0 ? (1 + (int)item12.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item12.Women1829 = item12.Women1829 != 0 ? (1 + (int)item12.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item12.Total3040 = item12.Total3040 != 0 ? (1 + (int)item12.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item12.Women3040 = item12.Women3040 != 0 ? (1 + (int)item12.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item12.Total45 = item12.Total45 != 0 ? (1 + (int)item12.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item12.Women45 = item12.Women45 != 0 ? (1 + (int)item12.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item12.TotalPersonsAge = item12.TotalPersonsAge != 0 ? (1 + (int)item12.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item12.WomenPersonsAge = item12.WomenPersonsAge != 0 ? (1 + (int)item12.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item12.FirstGroupAll = item12.FirstGroupAll != 0 ? (1 + (int)item12.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item12.WomenFirstGroup = item12.WomenFirstGroup != 0 ? (1 + (int)item12.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item12.BusyFirstGroup = item12.BusyFirstGroup != 0 ? (1 + (int)item12.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item12.SecondGroupAll = item12.SecondGroupAll != 0 ? (1 + (int)item12.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item12.WomenSecondGroup = item12.WomenSecondGroup != 0 ? (1 + (int)item12.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item12.BusySecondGroup = item12.BusySecondGroup != 0 ? (1 + (int)item12.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item12.ThirdGroupAll = item12.ThirdGroupAll != 0 ? (1 + (int)item12.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item12.WomenThirdGroup = item12.WomenThirdGroup != 0 ? (1 + (int)item12.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item12.BusyThirdGroup = item12.BusyThirdGroup != 0 ? (1 + (int)item12.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //болезни органов чувст/ H 00-95
                                if (diagnos == strDiagId13)
                                {
                                    item13.Total1829 = item13.Total1829 != 0 ? (1 + (int)item13.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item13.Women1829 = item13.Women1829 != 0 ? (1 + (int)item13.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item13.Total1829 = item13.Total1829 != 0 ? (1 + (int)item13.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item13.Women1829 = item13.Women1829 != 0 ? (1 + (int)item13.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item13.Total3040 = item13.Total3040 != 0 ? (1 + (int)item13.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item13.Women3040 = item13.Women3040 != 0 ? (1 + (int)item13.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item13.Total45 = item13.Total45 != 0 ? (1 + (int)item13.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item13.Women45 = item13.Women45 != 0 ? (1 + (int)item13.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item13.TotalPersonsAge = item13.TotalPersonsAge != 0 ? (1 + (int)item13.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item13.WomenPersonsAge = item13.WomenPersonsAge != 0 ? (1 + (int)item13.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item13.FirstGroupAll = item13.FirstGroupAll != 0 ? (1 + (int)item13.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item13.WomenFirstGroup = item13.WomenFirstGroup != 0 ? (1 + (int)item13.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item13.BusyFirstGroup = item13.BusyFirstGroup != 0 ? (1 + (int)item13.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item13.SecondGroupAll = item13.SecondGroupAll != 0 ? (1 + (int)item13.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item13.WomenSecondGroup = item13.WomenSecondGroup != 0 ? (1 + (int)item13.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item13.BusySecondGroup = item13.BusySecondGroup != 0 ? (1 + (int)item13.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item13.ThirdGroupAll = item13.ThirdGroupAll != 0 ? (1 + (int)item13.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item13.WomenThirdGroup = item13.WomenThirdGroup != 0 ? (1 + (int)item13.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item13.BusyThirdGroup = item13.BusyThirdGroup != 0 ? (1 + (int)item13.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //болезни глаз/ H 00-59
                                if (diagnos == strDiagId14)
                                {
                                    item14.Total1829 = item14.Total1829 != 0 ? (1 + (int)item14.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item14.Women1829 = item14.Women1829 != 0 ? (1 + (int)item14.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item14.Total1829 = item14.Total1829 != 0 ? (1 + (int)item14.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item14.Women1829 = item14.Women1829 != 0 ? (1 + (int)item14.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item14.Total3040 = item14.Total3040 != 0 ? (1 + (int)item14.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item14.Women3040 = item14.Women3040 != 0 ? (1 + (int)item14.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item14.Total45 = item14.Total45 != 0 ? (1 + (int)item14.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item14.Women45 = item14.Women45 != 0 ? (1 + (int)item14.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item14.TotalPersonsAge = item14.TotalPersonsAge != 0 ? (1 + (int)item14.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item14.WomenPersonsAge = item14.WomenPersonsAge != 0 ? (1 + (int)item14.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item14.FirstGroupAll = item14.FirstGroupAll != 0 ? (1 + (int)item14.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item14.WomenFirstGroup = item14.WomenFirstGroup != 0 ? (1 + (int)item14.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item14.BusyFirstGroup = item14.BusyFirstGroup != 0 ? (1 + (int)item14.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item14.SecondGroupAll = item14.SecondGroupAll != 0 ? (1 + (int)item14.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item14.WomenSecondGroup = item14.WomenSecondGroup != 0 ? (1 + (int)item14.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item14.BusySecondGroup = item14.BusySecondGroup != 0 ? (1 + (int)item14.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item14.ThirdGroupAll = item14.ThirdGroupAll != 0 ? (1 + (int)item14.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item14.WomenThirdGroup = item14.WomenThirdGroup != 0 ? (1 + (int)item14.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item14.BusyThirdGroup = item14.BusyThirdGroup != 0 ? (1 + (int)item14.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //болезни уха и сосцевидного отростка/ H 60-95
                                if (diagnos == strDiagId15)
                                {
                                    item15.Total1829 = item15.Total1829 != 0 ? (1 + (int)item15.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item15.Women1829 = item15.Women1829 != 0 ? (1 + (int)item15.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item15.Total1829 = item15.Total1829 != 0 ? (1 + (int)item15.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item15.Women1829 = item15.Women1829 != 0 ? (1 + (int)item15.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item15.Total3040 = item15.Total3040 != 0 ? (1 + (int)item15.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item15.Women3040 = item15.Women3040 != 0 ? (1 + (int)item15.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item15.Total45 = item15.Total45 != 0 ? (1 + (int)item15.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item15.Women45 = item15.Women45 != 0 ? (1 + (int)item15.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item15.TotalPersonsAge = item15.TotalPersonsAge != 0 ? (1 + (int)item15.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item15.WomenPersonsAge = item15.WomenPersonsAge != 0 ? (1 + (int)item15.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item15.FirstGroupAll = item15.FirstGroupAll != 0 ? (1 + (int)item15.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item15.WomenFirstGroup = item15.WomenFirstGroup != 0 ? (1 + (int)item15.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item15.BusyFirstGroup = item15.BusyFirstGroup != 0 ? (1 + (int)item15.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item15.SecondGroupAll = item15.SecondGroupAll != 0 ? (1 + (int)item15.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item15.WomenSecondGroup = item15.WomenSecondGroup != 0 ? (1 + (int)item15.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item15.BusySecondGroup = item15.BusySecondGroup != 0 ? (1 + (int)item15.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item15.ThirdGroupAll = item15.ThirdGroupAll != 0 ? (1 + (int)item15.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item15.WomenThirdGroup = item15.WomenThirdGroup != 0 ? (1 + (int)item15.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item15.BusyThirdGroup = item15.BusyThirdGroup != 0 ? (1 + (int)item15.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //болезни системы кровообращения/ I 00-99
                                if (diagnos == strDiagId16)
                                {
                                    item16.Total1829 = item16.Total1829 != 0 ? (1 + (int)item16.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item16.Women1829 = item16.Women1829 != 0 ? (1 + (int)item16.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item16.Total1829 = item16.Total1829 != 0 ? (1 + (int)item16.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item16.Women1829 = item16.Women1829 != 0 ? (1 + (int)item16.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item16.Total3040 = item16.Total3040 != 0 ? (1 + (int)item16.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item16.Women3040 = item16.Women3040 != 0 ? (1 + (int)item16.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item16.Total45 = item16.Total45 != 0 ? (1 + (int)item16.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item16.Women45 = item16.Women45 != 0 ? (1 + (int)item16.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item16.TotalPersonsAge = item16.TotalPersonsAge != 0 ? (1 + (int)item16.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item16.WomenPersonsAge = item16.WomenPersonsAge != 0 ? (1 + (int)item16.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item16.FirstGroupAll = item16.FirstGroupAll != 0 ? (1 + (int)item16.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item16.WomenFirstGroup = item16.WomenFirstGroup != 0 ? (1 + (int)item16.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item16.BusyFirstGroup = item16.BusyFirstGroup != 0 ? (1 + (int)item16.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item16.SecondGroupAll = item16.SecondGroupAll != 0 ? (1 + (int)item16.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item16.WomenSecondGroup = item16.WomenSecondGroup != 0 ? (1 + (int)item16.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item16.BusySecondGroup = item16.BusySecondGroup != 0 ? (1 + (int)item16.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item16.ThirdGroupAll = item16.ThirdGroupAll != 0 ? (1 + (int)item16.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item16.WomenThirdGroup = item16.WomenThirdGroup != 0 ? (1 + (int)item16.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item16.BusyThirdGroup = item16.BusyThirdGroup != 0 ? (1 + (int)item16.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //из них: хронические ревматические болезни сердца/  I 05-09
                                if (diagnos == strDiagId17)
                                {
                                    item17.Total1829 = item17.Total1829 != 0 ? (1 + (int)item17.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item17.Women1829 = item17.Women1829 != 0 ? (1 + (int)item17.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item17.Total1829 = item17.Total1829 != 0 ? (1 + (int)item17.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item17.Women1829 = item17.Women1829 != 0 ? (1 + (int)item17.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item17.Total3040 = item17.Total3040 != 0 ? (1 + (int)item17.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item17.Women3040 = item17.Women3040 != 0 ? (1 + (int)item17.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item17.Total45 = item17.Total45 != 0 ? (1 + (int)item17.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item17.Women45 = item17.Women45 != 0 ? (1 + (int)item17.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item17.TotalPersonsAge = item17.TotalPersonsAge != 0 ? (1 + (int)item17.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item17.WomenPersonsAge = item17.WomenPersonsAge != 0 ? (1 + (int)item17.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item17.FirstGroupAll = item17.FirstGroupAll != 0 ? (1 + (int)item17.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item17.WomenFirstGroup = item17.WomenFirstGroup != 0 ? (1 + (int)item17.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item17.BusyFirstGroup = item17.BusyFirstGroup != 0 ? (1 + (int)item17.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item17.SecondGroupAll = item17.SecondGroupAll != 0 ? (1 + (int)item17.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item17.WomenSecondGroup = item17.WomenSecondGroup != 0 ? (1 + (int)item17.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item17.BusySecondGroup = item17.BusySecondGroup != 0 ? (1 + (int)item17.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item17.ThirdGroupAll = item17.ThirdGroupAll != 0 ? (1 + (int)item17.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item17.WomenThirdGroup = item17.WomenThirdGroup != 0 ? (1 + (int)item17.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item17.BusyThirdGroup = item17.BusyThirdGroup != 0 ? (1 + (int)item17.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //болезни, характеризующиеся повышенным кровяным давлением/ I 10-15
                                if (diagnos == strDiagId18)
                                {
                                    item18.Total1829 = item18.Total1829 != 0 ? (1 + (int)item18.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item18.Women1829 = item18.Women1829 != 0 ? (1 + (int)item18.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item18.Total1829 = item18.Total1829 != 0 ? (1 + (int)item18.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item18.Women1829 = item18.Women1829 != 0 ? (1 + (int)item18.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item18.Total3040 = item18.Total3040 != 0 ? (1 + (int)item18.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item18.Women3040 = item18.Women3040 != 0 ? (1 + (int)item18.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item18.Total45 = item18.Total45 != 0 ? (1 + (int)item18.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item18.Women45 = item18.Women45 != 0 ? (1 + (int)item18.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item18.TotalPersonsAge = item18.TotalPersonsAge != 0 ? (1 + (int)item18.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item18.WomenPersonsAge = item18.WomenPersonsAge != 0 ? (1 + (int)item18.WomenPersonsAge) : 1;
                                        }
                                    }

                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item18.FirstGroupAll = item18.FirstGroupAll != 0 ? (1 + (int)item18.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item18.WomenFirstGroup = item18.WomenFirstGroup != 0 ? (1 + (int)item18.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item18.BusyFirstGroup = item18.BusyFirstGroup != 0 ? (1 + (int)item18.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item18.SecondGroupAll = item18.SecondGroupAll != 0 ? (1 + (int)item18.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item18.WomenSecondGroup = item18.WomenSecondGroup != 0 ? (1 + (int)item18.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item18.BusySecondGroup = item18.BusySecondGroup != 0 ? (1 + (int)item18.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item18.ThirdGroupAll = item18.ThirdGroupAll != 0 ? (1 + (int)item18.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item18.WomenThirdGroup = item18.WomenThirdGroup != 0 ? (1 + (int)item18.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item18.BusyThirdGroup = item18.BusyThirdGroup != 0 ? (1 + (int)item18.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId19)
                                {
                                    item19.Total1829 = item19.Total1829 != 0 ? (1 + (int)item19.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item19.Women1829 = item19.Women1829 != 0 ? (1 + (int)item19.Women1829) : 1;
                                    }

                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item19.Total1829 = item19.Total1829 != 0 ? (1 + (int)item19.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item19.Women1829 = item19.Women1829 != 0 ? (1 + (int)item19.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item19.Total3040 = item19.Total3040 != 0 ? (1 + (int)item19.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item19.Women3040 = item19.Women3040 != 0 ? (1 + (int)item19.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item19.Total45 = item19.Total45 != 0 ? (1 + (int)item19.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item19.Women45 = item19.Women45 != 0 ? (1 + (int)item19.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item19.TotalPersonsAge = item19.TotalPersonsAge != 0 ? (1 + (int)item19.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item19.WomenPersonsAge = item19.WomenPersonsAge != 0 ? (1 + (int)item19.WomenPersonsAge) : 1;
                                        }
                                    }

                                    if (group == group1EnumId)
                                    {
                                        item19.FirstGroupAll = item19.FirstGroupAll != 0 ? (1 + (int)item19.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item19.WomenFirstGroup = item19.WomenFirstGroup != 0 ? (1 + (int)item19.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item19.BusyFirstGroup = item19.BusyFirstGroup != 0 ? (1 + (int)item19.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item19.SecondGroupAll = item19.SecondGroupAll != 0 ? (1 + (int)item19.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item19.WomenSecondGroup = item19.WomenSecondGroup != 0 ? (1 + (int)item19.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item19.BusySecondGroup = item19.BusySecondGroup != 0 ? (1 + (int)item19.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item19.ThirdGroupAll = item19.ThirdGroupAll != 0 ? (1 + (int)item19.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item19.WomenThirdGroup = item19.WomenThirdGroup != 0 ? (1 + (int)item19.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item19.BusyThirdGroup = item19.BusyThirdGroup != 0 ? (1 + (int)item19.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId20)
                                {
                                    item20.Total1829 = item20.Total1829 != 0 ? (1 + (int)item20.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item20.Women1829 = item20.Women1829 != 0 ? (1 + (int)item20.Women1829) : 1;
                                    }

                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item20.Total1829 = item20.Total1829 != 0 ? (1 + (int)item20.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item20.Women1829 = item20.Women1829 != 0 ? (1 + (int)item20.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item20.Total3040 = item20.Total3040 != 0 ? (1 + (int)item20.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item20.Women3040 = item20.Women3040 != 0 ? (1 + (int)item20.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item20.Total45 = item20.Total45 != 0 ? (1 + (int)item20.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item20.Women45 = item20.Women45 != 0 ? (1 + (int)item20.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item20.TotalPersonsAge = item20.TotalPersonsAge != 0 ? (1 + (int)item20.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item20.WomenPersonsAge = item20.WomenPersonsAge != 0 ? (1 + (int)item20.WomenPersonsAge) : 1;
                                        }
                                    }
                                    /*****************************************************************************************************************************/
                                    if (group == group1EnumId)
                                    {
                                        item20.FirstGroupAll = item20.FirstGroupAll != 0 ? (1 + (int)item20.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item20.WomenFirstGroup = item20.WomenFirstGroup != 0 ? (1 + (int)item20.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item20.BusyFirstGroup = item20.BusyFirstGroup != 0 ? (1 + (int)item20.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item20.SecondGroupAll = item20.SecondGroupAll != 0 ? (1 + (int)item20.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item20.WomenSecondGroup = item20.WomenSecondGroup != 0 ? (1 + (int)item20.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item20.BusySecondGroup = item20.BusySecondGroup != 0 ? (1 + (int)item20.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item20.ThirdGroupAll = item20.ThirdGroupAll != 0 ? (1 + (int)item20.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item20.WomenThirdGroup = item20.WomenThirdGroup != 0 ? (1 + (int)item20.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item20.BusyThirdGroup = item20.BusyThirdGroup != 0 ? (1 + (int)item20.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                //ДИАГНОЗ НЕ НАШЛА В СПИСКЕ
                                /*if (diagnos == strDiagId21)
                                {
                                    item21.Total1829 = item21.Total1829 != 0 ? (1 + (int)item21.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item21.Women1829 = item21.Women1829 != 0 ? (1 + (int)item21.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item21.Total1829 = item21.Total1829 != 0 ? (1 + (int)item21.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item21.Women1829 = item21.Women1829 != 0 ? (1 + (int)item21.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item21.Total3040 = item21.Total3040 != 0 ? (1 + (int)item21.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item21.Women3040 = item21.Women3040 != 0 ? (1 + (int)item21.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item21.Total45 = item21.Total45 != 0 ? (1 + (int)item21.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item21.Women45 = item21.Women45 != 0 ? (1 + (int)item21.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item21.TotalPersonsAge = item21.TotalPersonsAge != 0 ? (1 + (int)item21.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item21.WomenPersonsAge = item21.WomenPersonsAge != 0 ? (1 + (int)item21.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item21.FirstGroupAll = item21.FirstGroupAll != 0 ? (1 + (int)item21.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item21.WomenFirstGroup = item21.WomenFirstGroup != 0 ? (1 + (int)item21.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item21.BusyFirstGroup = item21.BusyFirstGroup != 0 ? (1 + (int)item21.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item21.SecondGroupAll = item21.SecondGroupAll != 0 ? (1 + (int)item21.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item21.WomenSecondGroup = item21.WomenSecondGroup != 0 ? (1 + (int)item21.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item21.BusySecondGroup = item21.BusySecondGroup != 0 ? (1 + (int)item21.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item21.ThirdGroupAll = item21.ThirdGroupAll != 0 ? (1 + (int)item21.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item21.WomenThirdGroup = item21.WomenThirdGroup != 0 ? (1 + (int)item21.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item21.BusyThirdGroup = item21.BusyThirdGroup != 0 ? (1 + (int)item21.BusyThirdGroup) : 1;
                                        }
                                    }
                                }*/
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId22)
                                {
                                    item22.Total1829 = item22.Total1829 != 0 ? (1 + (int)item22.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item22.Women1829 = item22.Women1829 != 0 ? (1 + (int)item22.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item22.Total1829 = item22.Total1829 != 0 ? (1 + (int)item22.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item22.Women1829 = item22.Women1829 != 0 ? (1 + (int)item22.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item22.Total3040 = item22.Total3040 != 0 ? (1 + (int)item22.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item22.Women3040 = item22.Women3040 != 0 ? (1 + (int)item22.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item22.Total45 = item22.Total45 != 0 ? (1 + (int)item22.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item22.Women45 = item22.Women45 != 0 ? (1 + (int)item22.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item22.TotalPersonsAge = item22.TotalPersonsAge != 0 ? (1 + (int)item22.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item22.WomenPersonsAge = item22.WomenPersonsAge != 0 ? (1 + (int)item22.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item22.FirstGroupAll = item22.FirstGroupAll != 0 ? (1 + (int)item22.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item22.WomenFirstGroup = item22.WomenFirstGroup != 0 ? (1 + (int)item22.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item22.BusyFirstGroup = item22.BusyFirstGroup != 0 ? (1 + (int)item22.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item22.SecondGroupAll = item22.SecondGroupAll != 0 ? (1 + (int)item22.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item22.WomenSecondGroup = item22.WomenSecondGroup != 0 ? (1 + (int)item22.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item22.BusySecondGroup = item22.BusySecondGroup != 0 ? (1 + (int)item22.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item22.ThirdGroupAll = item22.ThirdGroupAll != 0 ? (1 + (int)item22.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item22.WomenThirdGroup = item22.WomenThirdGroup != 0 ? (1 + (int)item22.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item22.BusyThirdGroup = item22.BusyThirdGroup != 0 ? (1 + (int)item22.BusyThirdGroup) : 1;
                                        }
                                    }
                                }

                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId23)
                                {
                                    item23.Total1829 = item23.Total1829 != 0 ? (1 + (int)item23.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item23.Women1829 = item23.Women1829 != 0 ? (1 + (int)item23.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item23.Total1829 = item23.Total1829 != 0 ? (1 + (int)item23.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item23.Women1829 = item23.Women1829 != 0 ? (1 + (int)item23.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item23.Total3040 = item23.Total3040 != 0 ? (1 + (int)item23.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item23.Women3040 = item23.Women3040 != 0 ? (1 + (int)item23.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item23.Total45 = item23.Total45 != 0 ? (1 + (int)item23.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item23.Women45 = item23.Women45 != 0 ? (1 + (int)item23.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item23.TotalPersonsAge = item23.TotalPersonsAge != 0 ? (1 + (int)item23.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item23.WomenPersonsAge = item23.WomenPersonsAge != 0 ? (1 + (int)item23.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item23.FirstGroupAll = item23.FirstGroupAll != 0 ? (1 + (int)item23.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item23.WomenFirstGroup = item23.WomenFirstGroup != 0 ? (1 + (int)item23.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item23.BusyFirstGroup = item23.BusyFirstGroup != 0 ? (1 + (int)item23.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item23.SecondGroupAll = item23.SecondGroupAll != 0 ? (1 + (int)item23.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item23.WomenSecondGroup = item23.WomenSecondGroup != 0 ? (1 + (int)item23.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item23.BusySecondGroup = item23.BusySecondGroup != 0 ? (1 + (int)item23.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item23.ThirdGroupAll = item23.ThirdGroupAll != 0 ? (1 + (int)item23.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item23.WomenThirdGroup = item23.WomenThirdGroup != 0 ? (1 + (int)item23.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item23.BusyThirdGroup = item23.BusyThirdGroup != 0 ? (1 + (int)item23.BusyThirdGroup) : 1;
                                        }
                                    }
                                }

                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId24)
                                {
                                    item24.Total1829 = item24.Total1829 != 0 ? (1 + (int)item24.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item24.Women1829 = item24.Women1829 != 0 ? (1 + (int)item24.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item24.Total1829 = item24.Total1829 != 0 ? (1 + (int)item24.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item24.Women1829 = item24.Women1829 != 0 ? (1 + (int)item24.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item24.Total3040 = item24.Total3040 != 0 ? (1 + (int)item24.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item24.Women3040 = item24.Women3040 != 0 ? (1 + (int)item24.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item24.Total45 = item24.Total45 != 0 ? (1 + (int)item24.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item24.Women45 = item24.Women45 != 0 ? (1 + (int)item24.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item24.TotalPersonsAge = item24.TotalPersonsAge != 0 ? (1 + (int)item24.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item24.WomenPersonsAge = item24.WomenPersonsAge != 0 ? (1 + (int)item24.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item24.FirstGroupAll = item24.FirstGroupAll != 0 ? (1 + (int)item24.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item24.WomenFirstGroup = item24.WomenFirstGroup != 0 ? (1 + (int)item24.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item24.BusyFirstGroup = item24.BusyFirstGroup != 0 ? (1 + (int)item24.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item24.SecondGroupAll = item24.SecondGroupAll != 0 ? (1 + (int)item24.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item24.WomenSecondGroup = item24.WomenSecondGroup != 0 ? (1 + (int)item24.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item24.BusySecondGroup = item24.BusySecondGroup != 0 ? (1 + (int)item24.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item24.ThirdGroupAll = item24.ThirdGroupAll != 0 ? (1 + (int)item24.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item24.WomenThirdGroup = item24.WomenThirdGroup != 0 ? (1 + (int)item24.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item24.BusyThirdGroup = item24.BusyThirdGroup != 0 ? (1 + (int)item24.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId25)
                                {
                                    item25.Total1829 = item25.Total1829 != 0 ? (1 + (int)item25.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item25.Women1829 = item25.Women1829 != 0 ? (1 + (int)item25.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item25.Total1829 = item25.Total1829 != 0 ? (1 + (int)item25.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item25.Women1829 = item25.Women1829 != 0 ? (1 + (int)item25.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item25.Total3040 = item25.Total3040 != 0 ? (1 + (int)item25.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item25.Women3040 = item25.Women3040 != 0 ? (1 + (int)item25.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item25.Total45 = item25.Total45 != 0 ? (1 + (int)item25.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item25.Women45 = item25.Women45 != 0 ? (1 + (int)item25.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item25.TotalPersonsAge = item25.TotalPersonsAge != 0 ? (1 + (int)item25.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item25.WomenPersonsAge = item25.WomenPersonsAge != 0 ? (1 + (int)item25.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item25.FirstGroupAll = item25.FirstGroupAll != 0 ? (1 + (int)item25.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item25.WomenFirstGroup = item25.WomenFirstGroup != 0 ? (1 + (int)item25.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item25.BusyFirstGroup = item25.BusyFirstGroup != 0 ? (1 + (int)item25.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item25.SecondGroupAll = item25.SecondGroupAll != 0 ? (1 + (int)item25.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item25.WomenSecondGroup = item25.WomenSecondGroup != 0 ? (1 + (int)item25.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item25.BusySecondGroup = item25.BusySecondGroup != 0 ? (1 + (int)item25.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item25.ThirdGroupAll = item25.ThirdGroupAll != 0 ? (1 + (int)item25.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item25.WomenThirdGroup = item25.WomenThirdGroup != 0 ? (1 + (int)item25.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item25.BusyThirdGroup = item25.BusyThirdGroup != 0 ? (1 + (int)item25.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId26)
                                {
                                    item26.Total1829 = item26.Total1829 != 0 ? (1 + (int)item26.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item26.Women1829 = item26.Women1829 != 0 ? (1 + (int)item26.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item26.Total1829 = item26.Total1829 != 0 ? (1 + (int)item26.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item26.Women1829 = item26.Women1829 != 0 ? (1 + (int)item26.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item26.Total3040 = item26.Total3040 != 0 ? (1 + (int)item26.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item26.Women3040 = item26.Women3040 != 0 ? (1 + (int)item26.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item26.Total45 = item26.Total45 != 0 ? (1 + (int)item26.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item26.Women45 = item26.Women45 != 0 ? (1 + (int)item26.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item26.TotalPersonsAge = item26.TotalPersonsAge != 0 ? (1 + (int)item26.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item26.WomenPersonsAge = item26.WomenPersonsAge != 0 ? (1 + (int)item26.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item26.FirstGroupAll = item26.FirstGroupAll != 0 ? (1 + (int)item26.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item26.WomenFirstGroup = item26.WomenFirstGroup != 0 ? (1 + (int)item26.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item26.BusyFirstGroup = item26.BusyFirstGroup != 0 ? (1 + (int)item26.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item26.SecondGroupAll = item26.SecondGroupAll != 0 ? (1 + (int)item26.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item26.WomenSecondGroup = item26.WomenSecondGroup != 0 ? (1 + (int)item26.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item26.BusySecondGroup = item26.BusySecondGroup != 0 ? (1 + (int)item26.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item26.ThirdGroupAll = item26.ThirdGroupAll != 0 ? (1 + (int)item26.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item26.WomenThirdGroup = item26.WomenThirdGroup != 0 ? (1 + (int)item26.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item26.BusyThirdGroup = item26.BusyThirdGroup != 0 ? (1 + (int)item26.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId27)
                                {
                                    item27.Total1829 = item27.Total1829 != 0 ? (1 + (int)item27.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item27.Women1829 = item27.Women1829 != 0 ? (1 + (int)item27.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item27.Total1829 = item27.Total1829 != 0 ? (1 + (int)item27.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item27.Women1829 = item27.Women1829 != 0 ? (1 + (int)item27.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item27.Total3040 = item27.Total3040 != 0 ? (1 + (int)item27.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item27.Women3040 = item27.Women3040 != 0 ? (1 + (int)item27.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item27.Total45 = item27.Total45 != 0 ? (1 + (int)item27.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item27.Women45 = item27.Women45 != 0 ? (1 + (int)item27.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item27.TotalPersonsAge = item27.TotalPersonsAge != 0 ? (1 + (int)item27.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item27.WomenPersonsAge = item27.WomenPersonsAge != 0 ? (1 + (int)item27.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item27.FirstGroupAll = item27.FirstGroupAll != 0 ? (1 + (int)item27.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item27.WomenFirstGroup = item27.WomenFirstGroup != 0 ? (1 + (int)item27.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item27.BusyFirstGroup = item27.BusyFirstGroup != 0 ? (1 + (int)item27.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item27.SecondGroupAll = item27.SecondGroupAll != 0 ? (1 + (int)item27.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item27.WomenSecondGroup = item27.WomenSecondGroup != 0 ? (1 + (int)item27.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item27.BusySecondGroup = item27.BusySecondGroup != 0 ? (1 + (int)item27.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item27.ThirdGroupAll = item27.ThirdGroupAll != 0 ? (1 + (int)item27.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item27.WomenThirdGroup = item27.WomenThirdGroup != 0 ? (1 + (int)item27.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item27.BusyThirdGroup = item27.BusyThirdGroup != 0 ? (1 + (int)item27.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId28)
                                {
                                    item28.Total1829 = item28.Total1829 != 0 ? (1 + (int)item28.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item28.Women1829 = item28.Women1829 != 0 ? (1 + (int)item28.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item28.Total1829 = item28.Total1829 != 0 ? (1 + (int)item28.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item28.Women1829 = item28.Women1829 != 0 ? (1 + (int)item28.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item28.Total3040 = item28.Total3040 != 0 ? (1 + (int)item28.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item28.Women3040 = item28.Women3040 != 0 ? (1 + (int)item28.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item28.Total45 = item28.Total45 != 0 ? (1 + (int)item28.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item28.Women45 = item28.Women45 != 0 ? (1 + (int)item28.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item28.TotalPersonsAge = item28.TotalPersonsAge != 0 ? (1 + (int)item28.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item28.WomenPersonsAge = item28.WomenPersonsAge != 0 ? (1 + (int)item28.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item28.FirstGroupAll = item28.FirstGroupAll != 0 ? (1 + (int)item28.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item28.WomenFirstGroup = item28.WomenFirstGroup != 0 ? (1 + (int)item28.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item28.BusyFirstGroup = item28.BusyFirstGroup != 0 ? (1 + (int)item28.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item28.SecondGroupAll = item28.SecondGroupAll != 0 ? (1 + (int)item28.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item28.WomenSecondGroup = item28.WomenSecondGroup != 0 ? (1 + (int)item28.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item28.BusySecondGroup = item28.BusySecondGroup != 0 ? (1 + (int)item28.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item28.ThirdGroupAll = item28.ThirdGroupAll != 0 ? (1 + (int)item28.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item28.WomenThirdGroup = item28.WomenThirdGroup != 0 ? (1 + (int)item28.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item28.BusyThirdGroup = item28.BusyThirdGroup != 0 ? (1 + (int)item28.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId29)
                                {
                                    item29.Total1829 = item29.Total1829 != 0 ? (1 + (int)item29.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item29.Women1829 = item29.Women1829 != 0 ? (1 + (int)item29.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item29.Total1829 = item29.Total1829 != 0 ? (1 + (int)item29.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item29.Women1829 = item29.Women1829 != 0 ? (1 + (int)item29.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item29.Total3040 = item29.Total3040 != 0 ? (1 + (int)item29.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item29.Women3040 = item29.Women3040 != 0 ? (1 + (int)item29.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item29.Total45 = item29.Total45 != 0 ? (1 + (int)item29.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item29.Women45 = item29.Women45 != 0 ? (1 + (int)item29.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item29.TotalPersonsAge = item29.TotalPersonsAge != 0 ? (1 + (int)item29.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item29.WomenPersonsAge = item29.WomenPersonsAge != 0 ? (1 + (int)item29.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item29.FirstGroupAll = item29.FirstGroupAll != 0 ? (1 + (int)item29.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item29.WomenFirstGroup = item29.WomenFirstGroup != 0 ? (1 + (int)item29.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item29.BusyFirstGroup = item29.BusyFirstGroup != 0 ? (1 + (int)item29.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item29.SecondGroupAll = item29.SecondGroupAll != 0 ? (1 + (int)item29.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item29.WomenSecondGroup = item29.WomenSecondGroup != 0 ? (1 + (int)item29.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item29.BusySecondGroup = item29.BusySecondGroup != 0 ? (1 + (int)item29.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item29.ThirdGroupAll = item29.ThirdGroupAll != 0 ? (1 + (int)item29.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item29.WomenThirdGroup = item29.WomenThirdGroup != 0 ? (1 + (int)item29.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item29.BusyThirdGroup = item29.BusyThirdGroup != 0 ? (1 + (int)item29.BusyThirdGroup) : 1;
                                        }
                                    }
                                }

                                /*****************************************************************************************************************************/
                                if (diagnos == strDiagId30)
                                {
                                    item30.Total1829 = item30.Total1829 != 0 ? (1 + (int)item30.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item30.Women1829 = item30.Women1829 != 0 ? (1 + (int)item30.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item30.Total1829 = item30.Total1829 != 0 ? (1 + (int)item30.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item30.Women1829 = item30.Women1829 != 0 ? (1 + (int)item30.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item30.Total3040 = item30.Total3040 != 0 ? (1 + (int)item30.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item30.Women3040 = item30.Women3040 != 0 ? (1 + (int)item30.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item30.Total45 = item30.Total45 != 0 ? (1 + (int)item30.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item30.Women45 = item30.Women45 != 0 ? (1 + (int)item30.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item30.TotalPersonsAge = item30.TotalPersonsAge != 0 ? (1 + (int)item30.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item30.WomenPersonsAge = item30.WomenPersonsAge != 0 ? (1 + (int)item30.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item30.FirstGroupAll = item30.FirstGroupAll != 0 ? (1 + (int)item30.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item30.WomenFirstGroup = item30.WomenFirstGroup != 0 ? (1 + (int)item30.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item30.BusyFirstGroup = item30.BusyFirstGroup != 0 ? (1 + (int)item30.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item30.SecondGroupAll = item30.SecondGroupAll != 0 ? (1 + (int)item30.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item30.WomenSecondGroup = item30.WomenSecondGroup != 0 ? (1 + (int)item30.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item30.BusySecondGroup = item30.BusySecondGroup != 0 ? (1 + (int)item30.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item30.ThirdGroupAll = item30.ThirdGroupAll != 0 ? (1 + (int)item30.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item30.WomenThirdGroup = item30.WomenThirdGroup != 0 ? (1 + (int)item30.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item30.BusyThirdGroup = item30.BusyThirdGroup != 0 ? (1 + (int)item30.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId31)
                                {
                                    item31.Total1829 = item31.Total1829 != 0 ? (1 + (int)item31.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item31.Women1829 = item31.Women1829 != 0 ? (1 + (int)item31.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item31.Total1829 = item31.Total1829 != 0 ? (1 + (int)item31.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item31.Women1829 = item31.Women1829 != 0 ? (1 + (int)item31.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item31.Total3040 = item31.Total3040 != 0 ? (1 + (int)item31.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item31.Women3040 = item31.Women3040 != 0 ? (1 + (int)item31.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item31.Total45 = item31.Total45 != 0 ? (1 + (int)item31.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item31.Women45 = item31.Women45 != 0 ? (1 + (int)item31.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item31.TotalPersonsAge = item31.TotalPersonsAge != 0 ? (1 + (int)item31.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item31.WomenPersonsAge = item31.WomenPersonsAge != 0 ? (1 + (int)item31.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item31.FirstGroupAll = item31.FirstGroupAll != 0 ? (1 + (int)item31.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item31.WomenFirstGroup = item31.WomenFirstGroup != 0 ? (1 + (int)item31.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item31.BusyFirstGroup = item31.BusyFirstGroup != 0 ? (1 + (int)item31.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item31.SecondGroupAll = item31.SecondGroupAll != 0 ? (1 + (int)item31.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item31.WomenSecondGroup = item31.WomenSecondGroup != 0 ? (1 + (int)item31.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item31.BusySecondGroup = item31.BusySecondGroup != 0 ? (1 + (int)item31.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item31.ThirdGroupAll = item31.ThirdGroupAll != 0 ? (1 + (int)item31.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item31.WomenThirdGroup = item31.WomenThirdGroup != 0 ? (1 + (int)item31.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item31.BusyThirdGroup = item31.BusyThirdGroup != 0 ? (1 + (int)item31.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId32)
                                {
                                    item32.Total1829 = item32.Total1829 != 0 ? (1 + (int)item32.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item32.Women1829 = item32.Women1829 != 0 ? (1 + (int)item32.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item32.Total1829 = item32.Total1829 != 0 ? (1 + (int)item32.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item32.Women1829 = item32.Women1829 != 0 ? (1 + (int)item32.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item32.Total3040 = item32.Total3040 != 0 ? (1 + (int)item32.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item32.Women3040 = item32.Women3040 != 0 ? (1 + (int)item32.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item32.Total45 = item32.Total45 != 0 ? (1 + (int)item32.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item32.Women45 = item32.Women45 != 0 ? (1 + (int)item32.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item32.TotalPersonsAge = item32.TotalPersonsAge != 0 ? (1 + (int)item32.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item32.WomenPersonsAge = item32.WomenPersonsAge != 0 ? (1 + (int)item32.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item32.FirstGroupAll = item32.FirstGroupAll != 0 ? (1 + (int)item32.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item32.WomenFirstGroup = item32.WomenFirstGroup != 0 ? (1 + (int)item32.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item32.BusyFirstGroup = item32.BusyFirstGroup != 0 ? (1 + (int)item32.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item32.SecondGroupAll = item32.SecondGroupAll != 0 ? (1 + (int)item32.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item32.WomenSecondGroup = item32.WomenSecondGroup != 0 ? (1 + (int)item32.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item32.BusySecondGroup = item32.BusySecondGroup != 0 ? (1 + (int)item32.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item32.ThirdGroupAll = item32.ThirdGroupAll != 0 ? (1 + (int)item32.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item32.WomenThirdGroup = item32.WomenThirdGroup != 0 ? (1 + (int)item32.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item32.BusyThirdGroup = item32.BusyThirdGroup != 0 ? (1 + (int)item32.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId33)
                                {
                                    item33.Total1829 = item33.Total1829 != 0 ? (1 + (int)item33.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item33.Women1829 = item33.Women1829 != 0 ? (1 + (int)item33.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item33.Total1829 = item33.Total1829 != 0 ? (1 + (int)item33.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item33.Women1829 = item33.Women1829 != 0 ? (1 + (int)item33.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item33.Total3040 = item33.Total3040 != 0 ? (1 + (int)item33.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item33.Women3040 = item33.Women3040 != 0 ? (1 + (int)item33.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item33.Total45 = item33.Total45 != 0 ? (1 + (int)item33.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item33.Women45 = item33.Women45 != 0 ? (1 + (int)item33.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item33.TotalPersonsAge = item33.TotalPersonsAge != 0 ? (1 + (int)item33.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item33.WomenPersonsAge = item33.WomenPersonsAge != 0 ? (1 + (int)item33.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item33.FirstGroupAll = item33.FirstGroupAll != 0 ? (1 + (int)item33.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item33.WomenFirstGroup = item33.WomenFirstGroup != 0 ? (1 + (int)item33.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item33.BusyFirstGroup = item33.BusyFirstGroup != 0 ? (1 + (int)item33.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item33.SecondGroupAll = item33.SecondGroupAll != 0 ? (1 + (int)item33.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item33.WomenSecondGroup = item33.WomenSecondGroup != 0 ? (1 + (int)item33.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item33.BusySecondGroup = item33.BusySecondGroup != 0 ? (1 + (int)item33.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item33.ThirdGroupAll = item33.ThirdGroupAll != 0 ? (1 + (int)item33.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item33.WomenThirdGroup = item33.WomenThirdGroup != 0 ? (1 + (int)item33.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item33.BusyThirdGroup = item33.BusyThirdGroup != 0 ? (1 + (int)item33.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId34)
                                {
                                    item34.Total1829 = item34.Total1829 != 0 ? (1 + (int)item34.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item34.Women1829 = item34.Women1829 != 0 ? (1 + (int)item34.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item34.Total1829 = item34.Total1829 != 0 ? (1 + (int)item34.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item34.Women1829 = item34.Women1829 != 0 ? (1 + (int)item34.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item34.Total3040 = item34.Total3040 != 0 ? (1 + (int)item34.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item34.Women3040 = item34.Women3040 != 0 ? (1 + (int)item34.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item34.Total45 = item34.Total45 != 0 ? (1 + (int)item34.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item34.Women45 = item34.Women45 != 0 ? (1 + (int)item34.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item34.TotalPersonsAge = item34.TotalPersonsAge != 0 ? (1 + (int)item34.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item34.WomenPersonsAge = item34.WomenPersonsAge != 0 ? (1 + (int)item34.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item34.FirstGroupAll = item34.FirstGroupAll != 0 ? (1 + (int)item34.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item34.WomenFirstGroup = item34.WomenFirstGroup != 0 ? (1 + (int)item34.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item34.BusyFirstGroup = item34.BusyFirstGroup != 0 ? (1 + (int)item34.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item34.SecondGroupAll = item34.SecondGroupAll != 0 ? (1 + (int)item34.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item34.WomenSecondGroup = item34.WomenSecondGroup != 0 ? (1 + (int)item34.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item34.BusySecondGroup = item34.BusySecondGroup != 0 ? (1 + (int)item34.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item34.ThirdGroupAll = item34.ThirdGroupAll != 0 ? (1 + (int)item34.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item34.WomenThirdGroup = item34.WomenThirdGroup != 0 ? (1 + (int)item34.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item34.BusyThirdGroup = item34.BusyThirdGroup != 0 ? (1 + (int)item34.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId35)
                                {
                                    item35.Total1829 = item35.Total1829 != 0 ? (1 + (int)item35.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item35.Women1829 = item35.Women1829 != 0 ? (1 + (int)item35.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item35.Total1829 = item35.Total1829 != 0 ? (1 + (int)item35.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item35.Women1829 = item35.Women1829 != 0 ? (1 + (int)item35.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item35.Total3040 = item35.Total3040 != 0 ? (1 + (int)item35.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item35.Women3040 = item35.Women3040 != 0 ? (1 + (int)item35.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item35.Total45 = item35.Total45 != 0 ? (1 + (int)item35.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item35.Women45 = item35.Women45 != 0 ? (1 + (int)item35.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item35.TotalPersonsAge = item35.TotalPersonsAge != 0 ? (1 + (int)item35.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item35.WomenPersonsAge = item35.WomenPersonsAge != 0 ? (1 + (int)item35.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item35.FirstGroupAll = item35.FirstGroupAll != 0 ? (1 + (int)item35.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item35.WomenFirstGroup = item35.WomenFirstGroup != 0 ? (1 + (int)item35.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item35.BusyFirstGroup = item35.BusyFirstGroup != 0 ? (1 + (int)item35.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item35.SecondGroupAll = item35.SecondGroupAll != 0 ? (1 + (int)item35.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item35.WomenSecondGroup = item35.WomenSecondGroup != 0 ? (1 + (int)item35.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item35.BusySecondGroup = item35.BusySecondGroup != 0 ? (1 + (int)item35.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item35.ThirdGroupAll = item35.ThirdGroupAll != 0 ? (1 + (int)item35.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item35.WomenThirdGroup = item35.WomenThirdGroup != 0 ? (1 + (int)item35.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item35.BusyThirdGroup = item35.BusyThirdGroup != 0 ? (1 + (int)item35.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId36)
                                {
                                    item36.Total1829 = item36.Total1829 != 0 ? (1 + (int)item36.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item36.Women1829 = item36.Women1829 != 0 ? (1 + (int)item36.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item36.Total1829 = item36.Total1829 != 0 ? (1 + (int)item36.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item36.Women1829 = item36.Women1829 != 0 ? (1 + (int)item36.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item36.Total3040 = item36.Total3040 != 0 ? (1 + (int)item36.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item36.Women3040 = item36.Women3040 != 0 ? (1 + (int)item36.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item36.Total45 = item36.Total45 != 0 ? (1 + (int)item36.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item36.Women45 = item36.Women45 != 0 ? (1 + (int)item36.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item36.TotalPersonsAge = item36.TotalPersonsAge != 0 ? (1 + (int)item36.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item36.WomenPersonsAge = item36.WomenPersonsAge != 0 ? (1 + (int)item36.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item36.FirstGroupAll = item36.FirstGroupAll != 0 ? (1 + (int)item36.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item36.WomenFirstGroup = item36.WomenFirstGroup != 0 ? (1 + (int)item36.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item36.BusyFirstGroup = item36.BusyFirstGroup != 0 ? (1 + (int)item36.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item36.SecondGroupAll = item36.SecondGroupAll != 0 ? (1 + (int)item36.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item36.WomenSecondGroup = item36.WomenSecondGroup != 0 ? (1 + (int)item36.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item36.BusySecondGroup = item36.BusySecondGroup != 0 ? (1 + (int)item36.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item36.ThirdGroupAll = item36.ThirdGroupAll != 0 ? (1 + (int)item36.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item36.WomenThirdGroup = item36.WomenThirdGroup != 0 ? (1 + (int)item36.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item36.BusyThirdGroup = item36.BusyThirdGroup != 0 ? (1 + (int)item36.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId37)
                                {
                                    item37.Total1829 = item37.Total1829 != 0 ? (1 + (int)item37.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item37.Women1829 = item37.Women1829 != 0 ? (1 + (int)item37.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item37.Total1829 = item37.Total1829 != 0 ? (1 + (int)item37.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item37.Women1829 = item37.Women1829 != 0 ? (1 + (int)item37.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item37.Total3040 = item37.Total3040 != 0 ? (1 + (int)item37.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item37.Women3040 = item37.Women3040 != 0 ? (1 + (int)item37.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item37.Total45 = item37.Total45 != 0 ? (1 + (int)item37.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item37.Women45 = item37.Women45 != 0 ? (1 + (int)item37.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item37.TotalPersonsAge = item37.TotalPersonsAge != 0 ? (1 + (int)item37.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item37.WomenPersonsAge = item37.WomenPersonsAge != 0 ? (1 + (int)item37.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item37.FirstGroupAll = item37.FirstGroupAll != 0 ? (1 + (int)item37.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item37.WomenFirstGroup = item37.WomenFirstGroup != 0 ? (1 + (int)item37.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item37.BusyFirstGroup = item37.BusyFirstGroup != 0 ? (1 + (int)item37.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item37.SecondGroupAll = item37.SecondGroupAll != 0 ? (1 + (int)item37.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item37.WomenSecondGroup = item37.WomenSecondGroup != 0 ? (1 + (int)item37.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item37.BusySecondGroup = item37.BusySecondGroup != 0 ? (1 + (int)item37.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item37.ThirdGroupAll = item37.ThirdGroupAll != 0 ? (1 + (int)item37.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item37.WomenThirdGroup = item37.WomenThirdGroup != 0 ? (1 + (int)item37.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item37.BusyThirdGroup = item37.BusyThirdGroup != 0 ? (1 + (int)item37.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId38)
                                {
                                    item38.Total1829 = item38.Total1829 != 0 ? (1 + (int)item38.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item38.Women1829 = item38.Women1829 != 0 ? (1 + (int)item38.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item38.Total1829 = item38.Total1829 != 0 ? (1 + (int)item38.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item38.Women1829 = item38.Women1829 != 0 ? (1 + (int)item38.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item38.Total3040 = item38.Total3040 != 0 ? (1 + (int)item38.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item38.Women3040 = item38.Women3040 != 0 ? (1 + (int)item38.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item38.Total45 = item38.Total45 != 0 ? (1 + (int)item38.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item38.Women45 = item38.Women45 != 0 ? (1 + (int)item38.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item38.TotalPersonsAge = item38.TotalPersonsAge != 0 ? (1 + (int)item38.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item38.WomenPersonsAge = item38.WomenPersonsAge != 0 ? (1 + (int)item38.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item38.FirstGroupAll = item38.FirstGroupAll != 0 ? (1 + (int)item38.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item38.WomenFirstGroup = item38.WomenFirstGroup != 0 ? (1 + (int)item38.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item38.BusyFirstGroup = item38.BusyFirstGroup != 0 ? (1 + (int)item38.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item38.SecondGroupAll = item38.SecondGroupAll != 0 ? (1 + (int)item38.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item38.WomenSecondGroup = item38.WomenSecondGroup != 0 ? (1 + (int)item38.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item38.BusySecondGroup = item38.BusySecondGroup != 0 ? (1 + (int)item38.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item38.ThirdGroupAll = item38.ThirdGroupAll != 0 ? (1 + (int)item38.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item38.WomenThirdGroup = item38.WomenThirdGroup != 0 ? (1 + (int)item38.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item38.BusyThirdGroup = item38.BusyThirdGroup != 0 ? (1 + (int)item38.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId39)
                                {
                                    item39.Total1829 = item39.Total1829 != 0 ? (1 + (int)item39.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item39.Women1829 = item39.Women1829 != 0 ? (1 + (int)item39.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item39.Total1829 = item39.Total1829 != 0 ? (1 + (int)item39.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item39.Women1829 = item39.Women1829 != 0 ? (1 + (int)item39.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item39.Total3040 = item39.Total3040 != 0 ? (1 + (int)item39.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item39.Women3040 = item39.Women3040 != 0 ? (1 + (int)item39.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item39.Total45 = item39.Total45 != 0 ? (1 + (int)item39.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item39.Women45 = item39.Women45 != 0 ? (1 + (int)item39.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item39.TotalPersonsAge = item39.TotalPersonsAge != 0 ? (1 + (int)item39.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item39.WomenPersonsAge = item39.WomenPersonsAge != 0 ? (1 + (int)item39.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item39.FirstGroupAll = item39.FirstGroupAll != 0 ? (1 + (int)item39.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item39.WomenFirstGroup = item39.WomenFirstGroup != 0 ? (1 + (int)item39.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item39.BusyFirstGroup = item39.BusyFirstGroup != 0 ? (1 + (int)item39.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item39.SecondGroupAll = item39.SecondGroupAll != 0 ? (1 + (int)item39.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item39.WomenSecondGroup = item39.WomenSecondGroup != 0 ? (1 + (int)item39.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item39.BusySecondGroup = item39.BusySecondGroup != 0 ? (1 + (int)item39.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item39.ThirdGroupAll = item39.ThirdGroupAll != 0 ? (1 + (int)item39.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item39.WomenThirdGroup = item39.WomenThirdGroup != 0 ? (1 + (int)item39.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item39.BusyThirdGroup = item39.BusyThirdGroup != 0 ? (1 + (int)item39.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId40)
                                {
                                    item40.Total1829 = item40.Total1829 != 0 ? (1 + (int)item40.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item40.Women1829 = item40.Women1829 != 0 ? (1 + (int)item40.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item40.Total1829 = item40.Total1829 != 0 ? (1 + (int)item40.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40.Women1829 = item40.Women1829 != 0 ? (1 + (int)item40.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item40.Total3040 = item40.Total3040 != 0 ? (1 + (int)item40.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40.Women3040 = item40.Women3040 != 0 ? (1 + (int)item40.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item40.Total45 = item40.Total45 != 0 ? (1 + (int)item40.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40.Women45 = item40.Women45 != 0 ? (1 + (int)item40.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item40.TotalPersonsAge = item40.TotalPersonsAge != 0 ? (1 + (int)item40.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40.WomenPersonsAge = item40.WomenPersonsAge != 0 ? (1 + (int)item40.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item40.FirstGroupAll = item40.FirstGroupAll != 0 ? (1 + (int)item40.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40.WomenFirstGroup = item40.WomenFirstGroup != 0 ? (1 + (int)item40.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item40.BusyFirstGroup = item40.BusyFirstGroup != 0 ? (1 + (int)item40.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item40.SecondGroupAll = item40.SecondGroupAll != 0 ? (1 + (int)item40.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40.WomenSecondGroup = item40.WomenSecondGroup != 0 ? (1 + (int)item40.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item40.BusySecondGroup = item40.BusySecondGroup != 0 ? (1 + (int)item40.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item40.ThirdGroupAll = item40.ThirdGroupAll != 0 ? (1 + (int)item40.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40.WomenThirdGroup = item40.WomenThirdGroup != 0 ? (1 + (int)item40.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item40.BusyThirdGroup = item40.BusyThirdGroup != 0 ? (1 + (int)item40.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId41)
                                {
                                    item41.Total1829 = item41.Total1829 != 0 ? (1 + (int)item41.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item41.Women1829 = item41.Women1829 != 0 ? (1 + (int)item41.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item41.Total1829 = item41.Total1829 != 0 ? (1 + (int)item41.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item41.Women1829 = item41.Women1829 != 0 ? (1 + (int)item41.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item41.Total3040 = item41.Total3040 != 0 ? (1 + (int)item41.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item41.Women3040 = item41.Women3040 != 0 ? (1 + (int)item41.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item41.Total45 = item41.Total45 != 0 ? (1 + (int)item41.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item41.Women45 = item41.Women45 != 0 ? (1 + (int)item41.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item41.TotalPersonsAge = item41.TotalPersonsAge != 0 ? (1 + (int)item41.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item41.WomenPersonsAge = item41.WomenPersonsAge != 0 ? (1 + (int)item41.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item41.FirstGroupAll = item41.FirstGroupAll != 0 ? (1 + (int)item41.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item41.WomenFirstGroup = item41.WomenFirstGroup != 0 ? (1 + (int)item41.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item41.BusyFirstGroup = item41.BusyFirstGroup != 0 ? (1 + (int)item41.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item41.SecondGroupAll = item41.SecondGroupAll != 0 ? (1 + (int)item41.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item41.WomenSecondGroup = item41.WomenSecondGroup != 0 ? (1 + (int)item41.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item41.BusySecondGroup = item41.BusySecondGroup != 0 ? (1 + (int)item41.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item41.ThirdGroupAll = item41.ThirdGroupAll != 0 ? (1 + (int)item41.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item41.WomenThirdGroup = item41.WomenThirdGroup != 0 ? (1 + (int)item41.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item41.BusyThirdGroup = item41.BusyThirdGroup != 0 ? (1 + (int)item41.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId42)
                                {
                                    item42.Total1829 = item42.Total1829 != 0 ? (1 + (int)item42.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item42.Women1829 = item42.Women1829 != 0 ? (1 + (int)item42.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item42.Total1829 = item42.Total1829 != 0 ? (1 + (int)item42.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item42.Women1829 = item42.Women1829 != 0 ? (1 + (int)item42.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item42.Total3040 = item42.Total3040 != 0 ? (1 + (int)item42.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item42.Women3040 = item42.Women3040 != 0 ? (1 + (int)item42.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item42.Total45 = item42.Total45 != 0 ? (1 + (int)item42.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item42.Women45 = item42.Women45 != 0 ? (1 + (int)item42.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item42.TotalPersonsAge = item42.TotalPersonsAge != 0 ? (1 + (int)item42.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item42.WomenPersonsAge = item42.WomenPersonsAge != 0 ? (1 + (int)item42.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item42.FirstGroupAll = item42.FirstGroupAll != 0 ? (1 + (int)item42.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item42.WomenFirstGroup = item42.WomenFirstGroup != 0 ? (1 + (int)item42.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item42.BusyFirstGroup = item42.BusyFirstGroup != 0 ? (1 + (int)item42.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item42.SecondGroupAll = item42.SecondGroupAll != 0 ? (1 + (int)item42.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item42.WomenSecondGroup = item42.WomenSecondGroup != 0 ? (1 + (int)item42.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item42.BusySecondGroup = item42.BusySecondGroup != 0 ? (1 + (int)item42.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item42.ThirdGroupAll = item42.ThirdGroupAll != 0 ? (1 + (int)item42.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item42.WomenThirdGroup = item42.WomenThirdGroup != 0 ? (1 + (int)item42.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item42.BusyThirdGroup = item42.BusyThirdGroup != 0 ? (1 + (int)item42.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId43)
                                {
                                    item43.Total1829 = item43.Total1829 != 0 ? (1 + (int)item43.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item43.Women1829 = item43.Women1829 != 0 ? (1 + (int)item43.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item43.Total1829 = item43.Total1829 != 0 ? (1 + (int)item43.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item43.Women1829 = item43.Women1829 != 0 ? (1 + (int)item43.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item43.Total3040 = item43.Total3040 != 0 ? (1 + (int)item43.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item43.Women3040 = item43.Women3040 != 0 ? (1 + (int)item43.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item43.Total45 = item43.Total45 != 0 ? (1 + (int)item43.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item43.Women45 = item43.Women45 != 0 ? (1 + (int)item43.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item43.TotalPersonsAge = item43.TotalPersonsAge != 0 ? (1 + (int)item43.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item43.WomenPersonsAge = item43.WomenPersonsAge != 0 ? (1 + (int)item43.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item43.FirstGroupAll = item43.FirstGroupAll != 0 ? (1 + (int)item43.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item43.WomenFirstGroup = item43.WomenFirstGroup != 0 ? (1 + (int)item43.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item43.BusyFirstGroup = item43.BusyFirstGroup != 0 ? (1 + (int)item43.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item43.SecondGroupAll = item43.SecondGroupAll != 0 ? (1 + (int)item43.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item43.WomenSecondGroup = item43.WomenSecondGroup != 0 ? (1 + (int)item43.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item43.BusySecondGroup = item43.BusySecondGroup != 0 ? (1 + (int)item43.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item43.ThirdGroupAll = item43.ThirdGroupAll != 0 ? (1 + (int)item43.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item43.WomenThirdGroup = item43.WomenThirdGroup != 0 ? (1 + (int)item43.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item43.BusyThirdGroup = item43.BusyThirdGroup != 0 ? (1 + (int)item43.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId44)
                                {
                                    item44.Total1829 = item44.Total1829 != 0 ? (1 + (int)item44.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item44.Women1829 = item44.Women1829 != 0 ? (1 + (int)item44.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item44.Total1829 = item44.Total1829 != 0 ? (1 + (int)item44.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item44.Women1829 = item44.Women1829 != 0 ? (1 + (int)item44.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item44.Total3040 = item44.Total3040 != 0 ? (1 + (int)item44.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item44.Women3040 = item44.Women3040 != 0 ? (1 + (int)item44.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item44.Total45 = item44.Total45 != 0 ? (1 + (int)item44.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item44.Women45 = item44.Women45 != 0 ? (1 + (int)item44.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item44.TotalPersonsAge = item44.TotalPersonsAge != 0 ? (1 + (int)item44.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item44.WomenPersonsAge = item44.WomenPersonsAge != 0 ? (1 + (int)item44.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item44.FirstGroupAll = item44.FirstGroupAll != 0 ? (1 + (int)item44.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item44.WomenFirstGroup = item44.WomenFirstGroup != 0 ? (1 + (int)item44.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item44.BusyFirstGroup = item44.BusyFirstGroup != 0 ? (1 + (int)item44.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item44.SecondGroupAll = item44.SecondGroupAll != 0 ? (1 + (int)item44.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item44.WomenSecondGroup = item44.WomenSecondGroup != 0 ? (1 + (int)item44.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item44.BusySecondGroup = item44.BusySecondGroup != 0 ? (1 + (int)item44.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item44.ThirdGroupAll = item44.ThirdGroupAll != 0 ? (1 + (int)item44.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item44.WomenThirdGroup = item44.WomenThirdGroup != 0 ? (1 + (int)item44.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item44.BusyThirdGroup = item44.BusyThirdGroup != 0 ? (1 + (int)item44.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                /****************************************************************************************************/
                                if (diagnos == strDiagId45)
                                {
                                    item45.Total1829 = item45.Total1829 != 0 ? (1 + (int)item45.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item45.Women1829 = item45.Women1829 != 0 ? (1 + (int)item45.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item45.Total1829 = item45.Total1829 != 0 ? (1 + (int)item45.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item45.Women1829 = item45.Women1829 != 0 ? (1 + (int)item45.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item45.Total3040 = item45.Total3040 != 0 ? (1 + (int)item45.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item45.Women3040 = item45.Women3040 != 0 ? (1 + (int)item45.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item45.Total45 = item45.Total45 != 0 ? (1 + (int)item45.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item45.Women45 = item45.Women45 != 0 ? (1 + (int)item45.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item45.TotalPersonsAge = item45.TotalPersonsAge != 0 ? (1 + (int)item45.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item45.WomenPersonsAge = item45.WomenPersonsAge != 0 ? (1 + (int)item45.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item45.FirstGroupAll = item45.FirstGroupAll != 0 ? (1 + (int)item45.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item45.WomenFirstGroup = item45.WomenFirstGroup != 0 ? (1 + (int)item45.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item45.BusyFirstGroup = item45.BusyFirstGroup != 0 ? (1 + (int)item45.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item45.SecondGroupAll = item45.SecondGroupAll != 0 ? (1 + (int)item45.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item45.WomenSecondGroup = item45.WomenSecondGroup != 0 ? (1 + (int)item45.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item45.BusySecondGroup = item45.BusySecondGroup != 0 ? (1 + (int)item45.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item45.ThirdGroupAll = item45.ThirdGroupAll != 0 ? (1 + (int)item45.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item45.WomenThirdGroup = item45.WomenThirdGroup != 0 ? (1 + (int)item45.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item45.BusyThirdGroup = item45.BusyThirdGroup != 0 ? (1 + (int)item45.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                                if (diagnos == strDiagId41 || diagnos == strDiagId42 || diagnos == strDiagId43 || diagnos == strDiagId44 || diagnos == strDiagId45)
                                {
                                    item40_1.Total1829 = item40_1.Total1829 != 0 ? (1 + (int)item40_1.Total1829) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item40_1.Women1829 = item40_1.Women1829 != 0 ? (1 + (int)item40_1.Women1829) : 1;
                                    }
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item40_1.Total1829 = item40_1.Total1829 != 0 ? (1 + (int)item40_1.Total1829) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40_1.Women1829 = item40_1.Women1829 != 0 ? (1 + (int)item40_1.Women1829) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item40_1.Total3040 = item40_1.Total3040 != 0 ? (1 + (int)item40_1.Total3040) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40_1.Women3040 = item40_1.Women3040 != 0 ? (1 + (int)item40_1.Women3040) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item40_1.Total45 = item40_1.Total45 != 0 ? (1 + (int)item40_1.Total45) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40_1.Women45 = item40_1.Women45 != 0 ? (1 + (int)item40_1.Women45) : 1;
                                        }
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item40_1.TotalPersonsAge = item40_1.TotalPersonsAge != 0 ? (1 + (int)item40_1.TotalPersonsAge) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40_1.WomenPersonsAge = item40_1.WomenPersonsAge != 0 ? (1 + (int)item40_1.WomenPersonsAge) : 1;
                                        }
                                    }
                                    if (group == group1EnumId)
                                    {
                                        item40_1.FirstGroupAll = item40_1.FirstGroupAll != 0 ? (1 + (int)item40_1.FirstGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40_1.WomenFirstGroup = item40_1.WomenFirstGroup != 0 ? (1 + (int)item40_1.WomenFirstGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item40_1.BusyFirstGroup = item40_1.BusyFirstGroup != 0 ? (1 + (int)item40_1.BusyFirstGroup) : 1;
                                        }
                                    }
                                    if (group == group2EnumId)
                                    {
                                        item40_1.SecondGroupAll = item40_1.SecondGroupAll != 0 ? (1 + (int)item40_1.SecondGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40_1.WomenSecondGroup = item40_1.WomenSecondGroup != 0 ? (1 + (int)item40_1.WomenSecondGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item40_1.BusySecondGroup = item40_1.BusySecondGroup != 0 ? (1 + (int)item40_1.BusySecondGroup) : 1;
                                        }
                                    }
                                    if (group == group3EnumId)
                                    {
                                        item40_1.ThirdGroupAll = item40_1.ThirdGroupAll != 0 ? (1 + (int)item40_1.ThirdGroupAll) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item40_1.WomenThirdGroup = item40_1.WomenThirdGroup != 0 ? (1 + (int)item40_1.WomenThirdGroup) : 1;
                                        }
                                        if (bysy != null)
                                        {
                                            item40_1.BusyThirdGroup = item40_1.BusyThirdGroup != 0 ? (1 + (int)item40_1.BusyThirdGroup) : 1;
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            static void RemoveRows(WorkflowContext context, Guid reportId)
            {
                var docRepo = context.Documents;
                var rows = new List<Guid>();
                var qb = new QueryBuilder(reportItemDefId, context.UserId);
                qb.Where("Report").Eq(reportId).Or("Report").IsNull();
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read()) rows.Add(reader.GetGuid(0));
                }
                foreach (var rowId in rows)
                {
                    docRepo.DeleteById(rowId);
                }
            }
            private static readonly Guid reportDefId = new Guid("{17789FEE-2908-4E01-8E16-2ECAF4A75C7A}"); //Отчет о распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности
            private static readonly Guid reportItemDefId = new Guid("{10AB1374-EA9C-493B-B5F6-CD6A40273B9B}"); //Распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности

            private static readonly Guid adultsStatCardDefId = new Guid("{C77A6FF6-EC0B-4562-81FE-BB3BC17F4FDB}"); //Статистический талон для взрослых
            private static readonly Guid adultsActDefId = new Guid("{12AE380B-39CE-4753-A556-4083BD4B0F92}"); //Медицинский акт для взрослых
            private static readonly Guid personDefId = new Guid("{D71CE61A-9B59-4B5E-8713-8131DBB5BA02}"); //Person 
            public static readonly Guid districtDefId = new Guid("{A3FCA356-82A9-4BBD-872A-8333BEC6E41A}"); //Район
            public static readonly Guid cityDefId = new Guid("{4BB6D32D-5181-4031-BA49-CF5910D6D883}"); //Города районного значения

            public static readonly Guid ageOf1EnumId = new Guid("{027AEA0C-3C1D-4354-BEFF-4C89E06AF8B5}"); //От 18-29 лет
            public static readonly Guid ageOf2EnumId = new Guid("{6FC02932-97DD-48B9-93C8-FBD017C86707}"); //От 30-44 лет
            public static readonly Guid ageOf3EnumId = new Guid("{336A7447-4E55-44B8-8BA0-D7A156B7444A}"); //От 45-до пенсионного возраста
            public static readonly Guid ageOf4EnumId = new Guid("{9B207DB0-8214-4BA7-A8C4-635EF87B583A}"); //лицо пенсионного возраста

            public static readonly Guid group1EnumId = new Guid("{D145ABA1-EADA-442B-9D8D-AD10BCD126D2}"); //Первая
            public static readonly Guid group2EnumId = new Guid("{C161DA2D-2883-4211-B444-CBB04DBF33D5}"); //Вторая
            public static readonly Guid group3EnumId = new Guid("{CCD439CA-1500-4F7A-A1C8-BB474B5DE8AA}"); //Третья

            public static readonly Guid cityEnumId = new Guid("{DE3D24A1-64D3-4647-B711-31F334D24416}"); //Городская местность//DistrictType
            public static readonly Guid villageEnumId = new Guid("{65DF9C4D-A18B-4080-855F-4800E2A19C35}"); //Cская местность//DistrictType
            public static readonly Guid womanEnumId = new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"); //Женский пол
            public static readonly Guid primaryEnumId = new Guid("{34129BC5-5B31-4189-87FA-799402F7E99F}"); //Первичное
            public static readonly Guid ApprovedStateId = new Guid("{32062CB7-C31C-4AFB-ADF3-F9F9AEEFCE59}");  //Подписанные

            //диагнозы
            private static readonly Guid strDiagId2 = new Guid("{9FF329FE-F547-42BE-817F-ED989FFB6573}"); //Туберкулез/ А 15-19
            private static readonly Guid strDiagId3 = new Guid("{99BC4A06-B78C-4A88-9F5C-AD4835563758}"); //Туберкулез  легких/ А 15-16
            private static readonly Guid strDiagId4 = new Guid("{2F9950BC-62B8-4B2B-865A-1C9C080CCC4E}"); //Злокачественные новообразования/ С 00-97
            private static readonly Guid strDiagId5 = new Guid("{C9CDD032-DC56-4027-A7D8-DBFE2F29BDE2}"); //Болезни эндокринной системы, нарушения обмена веществ/ Е 00-90
            private static readonly Guid strDiagId6 = new Guid("{C22D27F2-89F8-4355-A962-8EDE8294D052}"); //Заболeвания щитовидной железы/ E 00-07
            private static readonly Guid strDiagId7 = new Guid("{81E09427-D877-4C77-8609-E813D1BAF5FF}"); //Сахарный диабет/ E 10-14
            private static readonly Guid strDiagId8 = new Guid("{7ACAB39A-5CEE-4EF0-AAAB-10764F111DC0}"); //Психические расстройства/ F 00-99
            private static readonly Guid strDiagId9 = new Guid("{1F2922AB-423A-4997-BAB8-5D18538B5A15}"); //Шизофрения/ F 20
            private static readonly Guid strDiagId10 = new Guid("{22E82EC9-8BAA-48FD-AFD8-17619B0AD476}"); //Умственная отсталость/ F 70-79
            private static readonly Guid strDiagId11 = new Guid("{4BB66F12-B96C-4917-BFB3-0947D41AFA52}"); //Болезни нервной системы/ G 00-99     
            private static readonly Guid strDiagId12 = new Guid("{DFE168E8-7E30-4D8A-9AEF-54382B0A3932}"); //Болезни периферической нервной системы/ G 50-64  
            private static readonly Guid strDiagId13 = new Guid("{40012DC1-53A1-4EE7-8F93-85547C827DB5}"); //Болезни органов чувств/ H 00-95
            private static readonly Guid strDiagId14 = new Guid("{24483E18-28AC-4981-9C29-B94075BE9725}"); //Болезни глаз/ H 00-59  
            private static readonly Guid strDiagId15 = new Guid("{558D6E2E-E1E0-4D37-B200-A94D9953099F}"); //Болезни уха и сосцевидного отростка/ H 60-95
            private static readonly Guid strDiagId16 = new Guid("{E3D6EF80-B5E4-4DAE-9832-19FAD50A80F3}"); //Болезни системы кровообращения/ I 00-99 
            private static readonly Guid strDiagId17 = new Guid("{D71970B1-0562-4905-AC26-77DE739CAF5C}"); //Хронические ревматические болезни сердца/  I 05-09
            private static readonly Guid strDiagId18 = new Guid("{E6D6A67F-ED33-4879-B1C2-9BC173BB457B}"); //Повышенное кровеносное давление/ I 10-15  
            private static readonly Guid strDiagId19 = new Guid("{10712C7B-4FDC-4B6F-A50B-B7858FDD1211}"); //Ишемическая болезнь сердца/ I 20-25
            private static readonly Guid strDiagId20 = new Guid("{9549B0FD-2F0D-488A-8228-E990B01288D8}"); //Цереброваскулярные болезни/ I 60-69
            //private static readonly Guid strDiagId21 = new Guid("В СПИСКЕ ДИАГНОЗОВ НЕ НАШЛА"); //врожденные пороки сердца Q 20-28
            private static readonly Guid strDiagId22 = new Guid("{3363DE1E-864C-4063-BED7-4526F673AFF6}"); //Болезни органов дыхания / J 00-99
            private static readonly Guid strDiagId23 = new Guid("{866F3B61-AFCF-45F5-97BE-E0C23B87393C}"); //Бронхиальная астма/ J 45
            private static readonly Guid strDiagId24 = new Guid("{05479FEC-BC19-42B8-A0EC-37C63CE91205}"); //Болезни органов пищеварения/ K 00-93
            private static readonly Guid strDiagId25 = new Guid("{ECC9E612-FB40-4344-8298-5CD8BA40635F}"); //Болезни костно-мешечной системы и соединительной ткани/ M 00-99
            private static readonly Guid strDiagId26 = new Guid("{B3000363-8258-4F07-8234-0DE79E053660}"); //Ревматоидные/ M 05-14 
            private static readonly Guid strDiagId27 = new Guid("{1D4E81CB-2315-44C9-BDF3-B0FA874B8E61}"); //Остеохондроз позвоночника/ M 42
            private static readonly Guid strDiagId28 = new Guid("{3E0E50B5-9A3A-4DA2-A098-7147CB19833D}"); //Болезни мочевыводящих органов/ N 00-99
            private static readonly Guid strDiagId29 = new Guid("{82D1F915-CADF-4E7F-91A9-36B84CAB5A85}"); //Травмы, отравления и другие воздействия внешних причин/ S00 T98    
            private static readonly Guid strDiagId30 = new Guid("{FC38C0AE-2C54-4609-B728-517D5BC481CF}"); //Травма глаз/ T 90.4   
            private static readonly Guid strDiagId31 = new Guid("{961BB1B1-2C65-4833-86FA-2FC02CBCDDA8}"); //Болезни вследствие воздействия ионизирующего облучения/ W 88
            private static readonly Guid strDiagId32 = new Guid("{F702AAD3-523D-4914-8B97-5D2B9905D231}"); //Болезни вследствие воздействия вибрации/ W 43 
            private static readonly Guid strDiagId33 = new Guid("{E7271846-9AAA-4C52-AA19-CB01C3B765A2}"); //Болезни крови, кроветворных органов/ D 50-89
            private static readonly Guid strDiagId34 = new Guid("{41F09403-B4B7-46CA-92BF-B716523AFDE9}"); //Доброкачественные новообразования/ D 10-36
            private static readonly Guid strDiagId35 = new Guid("{D4050056-32C3-48FD-9718-EA7FE3294E82}"); //Бруцеллез/ A 23
            private static readonly Guid strDiagId36 = new Guid("{1DEDD889-4336-4622-85C0-9DDD1FF432D9}"); //Бруцеллез бытовой/ A 23
            private static readonly Guid strDiagId37 = new Guid("{F3B64F5D-6A6C-4343-B5B5-7B5E3CB92474}"); //Эхинококкоз/ B 67     
            private static readonly Guid strDiagId38 = new Guid("{0CEAC906-B3D2-4AD8-9DE6-D3FA384F2CDF}"); //Врожденные пороки развития, хромосомные развития/ Q 00-99
            private static readonly Guid strDiagId39 = new Guid("{07C6C658-D589-48A1-803B-DBCA6603B543}"); //Болезни вызванные вирусом ВИЧ (СПИД)/ B 20-24
            private static readonly Guid strDiagId40 = new Guid("{0ADE4B55-DF1D-46EA-954B-F3F9FB7CAE08}"); //Прочие болезни / Прочие
            private static readonly Guid strDiagId41 = new Guid("{25029E6F-916F-44DE-86B0-C018A8055D4F}"); //Трудовое увечье    
            private static readonly Guid strDiagId42 = new Guid("{8F30CA1F-9187-463E-9D26-1BD525BF45F6}"); //Профессиональные болезни
            private static readonly Guid strDiagId43 = new Guid("{CBEBAF9D-B67D-4BB3-B715-DB252DC2C018}"); //Ликвидаторы последствий аварии на ЧАЭС
            private static readonly Guid strDiagId44 = new Guid("{C0B08AFD-85BB-4DB1-8D9D-6ED3CA43438E}"); //Пострадавшие в событиях 2010г. Бишкек, Талас    
            private static readonly Guid strDiagId45 = new Guid("{6A2CF4F5-E0FC-4D70-9DD3-DA23F3049CD2}"); //Пострадавшие в событиях 2010г. Ош, Жалал-Абад   
        }

        //Результат переосвидетельствования инвалидов из числа проживающих (ГОРОДСКАЯ/СЕЛЬСКАЯ МЕСТНОСТЬ) 
        public static class ReExamInvalidsOfCityVillage
        {
            public static Report_5 Execute(WorkflowContext context, int year, string distrSpr)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;

                var docs = new string[]
                {
                    "всего  02",
                    "в том числе: I группа  03",
                    "II группа  04",
                    "III группа  05",
                    "ребенок инвалид  06"
                };
                var items = new List<Report5Item>();
                var report = new Report_5();
                int i2 = 1;
                foreach (var i in docs)
                {
                    var item = new Report5Item();
                    item.RowType = i;
                    item.RowNo = i2;
                    i2++;
                    items.Add(item);
                }
                CalcItems(context, year, orgId, distrSpr,
                        items[4], items[3], items[2], items[1], items[0], report);
                report.Items = items.ToArray();
                return report;
            }
            public static void CalcItems(WorkflowContext context, int year, Guid orgId, string distrSpr,
                Report5Item item4, Report5Item item3, Report5Item item2, Report5Item item1, Report5Item item0, Report_5 report)
            {
                var qb = new QueryBuilder(adultsStatCardDefId, context.UserId);
                qb.Where("&State").Eq(ApprovedStateId).And("Examination1").Eq(repetEnumId);

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                    var actSrc = query.JoinSource(query.Source, adultsActDefId, SqlSourceJoinType.Inner, "AdultsMedicalCertificate");
                    var distrSrc = query.JoinSource(actSrc, districtDefId, SqlSourceJoinType.LeftOuter, "DistrictId");
                    var citySrc = query.JoinSource(actSrc, cityDefId, SqlSourceJoinType.LeftOuter, "CityId");
                    query.AddCondition(ExpressionOperation.And, adultsActDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    if (!string.IsNullOrEmpty(distrSpr))
                        query.AddCondition(ExpressionOperation.And, districtDefId, "NumberDis", ConditionOperation.Equal, distrSpr);

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(query.Source, "EndDateExamination");
                    query.AddAttribute(personSrc, "Gender");
                    query.AddAttribute(query.Source, "DisabilityGroup");
                    query.AddAttribute(query.Source, "Indefinitely");
                    query.AddAttribute(query.Source, "PlaceWork");
                    query.AddAttribute(distrSrc, "DistrictType");
                    query.AddAttribute(citySrc, "DistrictType");
                    query.AddAttribute(query.Source, "goal1");
                    query.AddAttribute(query.Source, "goal2");
                    query.AddAttribute(query.Source, "goal3");
                    query.AddAttribute(query.Source, "goal4");
                    query.AddAttribute(query.Source, "goal5");
                    query.AddAttribute(query.Source, "goal6");
                    query.AddAttribute(query.Source, "goal7");
                    query.AddAttribute(query.Source, "goal8");
                    query.AddAttribute(query.Source, "goal9");
                    query.AddAttribute(query.Source, "goal11");
                    query.AddAttribute(query.Source, "goal12");
                    query.AddAttribute(query.Source, "goal13");
                    query.AddAttribute(query.Source, "goal16");
                    query.AddAttribute(query.Source, "goal17");
                    query.AddAttribute(query.Source, "AgeOf");
                    query.AddAttribute(query.Source, "GoalSurvey");
                    query.AddAttribute(actSrc, "&Id");

                    int c0 = 0; int c1 = 0; int c3 = 0; int c4 = 0; int c5 = 0;
                    int c6 = 0; int c7 = 0; int c8 = 0; int c9 = 0; int c10 = 0;
                    int c11 = 0;  int c12 = 0; int c13 = 0; int c14 = 0;
                    int c15 = 0; int c16 = 0; int c17 = 0; int c18 = 0;
                    int c19 = 0; int c20 = 0; int c21 = 0; int c22 = 0; int c23 = 0; int c24 = 0;

                    var table = new DataTable();
                    using (var reader = context.CreateSqlReader(query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var date = !(row[1] is DBNull) ? (DateTime)row[1] : DateTime.MinValue;
                        var gender = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                        var group = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                        var indef = row[4] is DBNull ? false : (bool)row[4];
                        var bysy = row[5] is DBNull ? "" : row[5].ToString();
                        var district = row[6] is DBNull ? Guid.Empty : (Guid)row[6];
                        var city = row[7] is DBNull ? Guid.Empty : (Guid)row[7];
                        var goal1 = row[8] is DBNull ? false : (bool)row[8];
                        var goal2 = row[9] is DBNull ? false : (bool)row[9];
                        var goal3 = row[10] is DBNull ? false : (bool)row[10];
                        var goal4 = row[11] is DBNull ? false : (bool)row[11];
                        var goal5 = row[12] is DBNull ? false : (bool)row[12];
                        var goal6 = row[13] is DBNull ? false : (bool)row[13];
                        var goal7 = row[14] is DBNull ? false : (bool)row[14];
                        var goal8 = row[15] is DBNull ? false : (bool)row[15];
                        var goal9 = row[16] is DBNull ? Guid.Empty : (Guid)row[16];
                        var goal11 = row[17] is DBNull ? false : (bool)row[17];
                        var goal12 = row[18] is DBNull ? false : (bool)row[18];
                        var goal13 = row[19] is DBNull ? false : (bool)row[19];
                        var goal16 = row[20] is DBNull ? false : (bool)row[20];
                        var goal17 = row[21] is DBNull ? false : (bool)row[21];
                        var ageOf = row[22] is DBNull ? Guid.Empty : (Guid)row[22];
                        var goalGroup = row[23] is DBNull ? Guid.Empty : (Guid)row[23];
                        var actId = row[24] is DBNull ? Guid.Empty : (Guid)row[24];

                        var dinamic = getDinamic(context, actId);
                        var dinamicGroup = Guid.Empty;
                        var dinamicGod = "";
                        if (dinamic != null)
                        {
                            dinamicGroup = (Guid)dinamic[0];
                            dinamicGod = (string)dinamic[1];
                        }

                        if (appId != Guid.Empty)
                        {
                            if (date.Year == year)
                            {
                                c0++; //общее число переосв-х                                
                                if (goalGroup != Guid.Empty)
                                {
                                    c1++; //2 строка
                                }
                                if (dinamicGroup != Guid.Empty)
                                {
                                    item0.gr1 = item0.gr1 != 0 ? (1 + (int)item0.gr1) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item0.gr2 = item0.gr2 != 0 ? (1 + (int)item0.gr2) : 1;
                                    }
                                    //из них признаны инвалидами
                                    if (group == group1EnumId || group == group2EnumId || group == disGroup3EnumId)
                                    {
                                        item0.gr3 = item0.gr3 != 0 ? (1 + (int)item0.gr3) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item0.gr4 = item0.gr4 != 0 ? (1 + (int)item0.gr4) : 1;
                                        }
                                        if (indef)
                                        {
                                            item0.gr5 = item0.gr5 != 0 ? (1 + (int)item0.gr5) : 1;
                                        }
                                        //I gr
                                        if (group == group1EnumId)
                                        {
                                            item0.gr6 = item0.gr6 != 0 ? (1 + (int)item0.gr6) : 1;
                                            if (bysy != null)
                                            {
                                                item0.gr7 = item0.gr7 != 0 ? (1 + (int)item0.gr7) : 1;
                                            }
                                        }
                                        //II gr
                                        if (group == group2EnumId)
                                        {
                                            item0.gr8 = item0.gr8 != 0 ? (1 + (int)item0.gr8) : 1;
                                            if (bysy != null)
                                            {
                                                item0.gr9 = item0.gr9 != 0 ? (1 + (int)item0.gr9) : 1;
                                            }
                                        }
                                        //III gr
                                        if (group == group3EnumId)
                                        {
                                            item0.gr10 = item0.gr10 != 0 ? (1 + (int)item0.gr10) : 1;
                                            if (bysy != null)
                                            {
                                                item0.gr11 = item0.gr11 != 0 ? (1 + (int)item0.gr11) : 1;
                                            }
                                        }
                                    }
                                    //not set group
                                    if (group == notSetGrEnumId)
                                    {
                                        item0.gr12 = item0.gr12 != 0 ? (1 + (int)item0.gr12) : 1;
                                        if (bysy != null)
                                        {
                                            item0.gr13 = item0.gr13 != 0 ? (1 + (int)item0.gr13) : 1;
                                        }
                                    }
                                    if (dinamicGroup == disGroup1EnumId)
                                    {
                                        item1.gr1 = item1.gr1 != 0 ? (1 + (int)item1.gr1) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item1.gr2 = item1.gr2 != 0 ? (1 + (int)item1.gr2) : 1;
                                        }
                                        //из них признаны инвалидами
                                        if (group == group1EnumId || group == group2EnumId || group == disGroup3EnumId)
                                        {
                                            item1.gr3 = item1.gr3 != 0 ? (1 + (int)item1.gr3) : 1;
                                            if (gender == womanEnumId)
                                            {
                                                item1.gr4 = item1.gr4 != 0 ? (1 + (int)item1.gr4) : 1;
                                            }
                                            if (indef)
                                            {
                                                item1.gr5 = item1.gr5 != 0 ? (1 + (int)item1.gr5) : 1;
                                            }
                                            //I gr
                                            if (group == group1EnumId)
                                            {
                                                item1.gr6 = item1.gr6 != 0 ? (1 + (int)item1.gr6) : 1;
                                                if (bysy != null)
                                                {
                                                    item1.gr7 = item1.gr7 != 0 ? (1 + (int)item1.gr7) : 1;
                                                }
                                            }
                                            //II gr
                                            if (group == group2EnumId)
                                            {
                                                item1.gr8 = item1.gr8 != 0 ? (1 + (int)item1.gr8) : 1;
                                                if (bysy != null)
                                                {
                                                    item1.gr9 = item1.gr9 != 0 ? (1 + (int)item1.gr9) : 1;
                                                }
                                            }
                                            //III gr
                                            if (group == group3EnumId)
                                            {
                                                item1.gr10 = item1.gr10 != 0 ? (1 + (int)item1.gr10) : 1;
                                                if (bysy != null)
                                                {
                                                    item1.gr11 = item1.gr11 != 0 ? (1 + (int)item1.gr11) : 1;
                                                }
                                            }
                                        }
                                        //not set group
                                        if (group == notSetGrEnumId)
                                        {
                                            item1.gr12 = item1.gr12 != 0 ? (1 + (int)item1.gr12) : 1;
                                            if (bysy != null)
                                            {
                                                item1.gr13 = item1.gr13 != 0 ? (1 + (int)item1.gr13) : 1;
                                            }
                                        }
                                    }
                                    if (dinamicGroup == disGroup2EnumId)
                                    {
                                        item2.gr1 = item2.gr1 != 0 ? (1 + (int)item2.gr1) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.gr2 = item2.gr2 != 0 ? (1 + (int)item2.gr2) : 1;
                                        }
                                        //из них признаны инвалидами
                                        if (group == group1EnumId || group == group2EnumId || group == disGroup3EnumId)
                                        {
                                            item2.gr3 = item2.gr3 != 0 ? (1 + (int)item2.gr3) : 1;
                                            if (gender == womanEnumId)
                                            {
                                                item2.gr4 = item2.gr4 != 0 ? (1 + (int)item2.gr4) : 1;
                                            }
                                            if (indef)
                                            {
                                                item2.gr5 = item2.gr5 != 0 ? (1 + (int)item2.gr5) : 1;
                                            }
                                            //I gr
                                            if (group == group1EnumId)
                                            {
                                                item2.gr6 = item2.gr6 != 0 ? (1 + (int)item2.gr6) : 1;
                                                if (bysy != null)
                                                {
                                                    item2.gr7 = item2.gr7 != 0 ? (1 + (int)item2.gr7) : 1;
                                                }
                                            }
                                            //II gr
                                            if (group == group2EnumId)
                                            {
                                                item2.gr8 = item2.gr8 != 0 ? (1 + (int)item2.gr8) : 1;
                                                if (bysy != null)
                                                {
                                                    item2.gr9 = item2.gr9 != 0 ? (1 + (int)item2.gr9) : 1;
                                                }
                                            }
                                            //III gr
                                            if (group == group3EnumId)
                                            {
                                                item2.gr10 = item2.gr10 != 0 ? (1 + (int)item2.gr10) : 1;
                                                if (bysy != null)
                                                {
                                                    item2.gr11 = item2.gr11 != 0 ? (1 + (int)item2.gr11) : 1;
                                                }
                                            }
                                        }
                                        //not set group
                                        if (group == notSetGrEnumId)
                                        {
                                            item2.gr12 = item2.gr12 != 0 ? (1 + (int)item2.gr12) : 1;
                                            if (bysy != null)
                                            {
                                                item2.gr13 = item2.gr13 != 0 ? (1 + (int)item2.gr13) : 1;
                                            }
                                        }
                                    }
                                    if (dinamicGroup == disGroup3EnumId)
                                    {
                                        item3.gr1 = item3.gr1 != 0 ? (1 + (int)item3.gr1) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.gr2 = item3.gr2 != 0 ? (1 + (int)item3.gr2) : 1;
                                        }
                                        //из них признаны инвалидами
                                        if (group == group1EnumId || group == group2EnumId || group == disGroup3EnumId)
                                        {
                                            item3.gr3 = item3.gr3 != 0 ? (1 + (int)item3.gr3) : 1;
                                            if (gender == womanEnumId)
                                            {
                                                item3.gr4 = item3.gr4 != 0 ? (1 + (int)item3.gr4) : 1;
                                            }
                                            if (indef)
                                            {
                                                item3.gr5 = item3.gr5 != 0 ? (1 + (int)item3.gr5) : 1;
                                            }
                                            //I gr
                                            if (group == group1EnumId)
                                            {
                                                item3.gr6 = item3.gr6 != 0 ? (1 + (int)item3.gr6) : 1;
                                                if (bysy != null)
                                                {
                                                    item3.gr7 = item3.gr7 != 0 ? (1 + (int)item3.gr7) : 1;
                                                }
                                            }
                                            //II gr
                                            if (group == group2EnumId)
                                            {
                                                item3.gr8 = item3.gr8 != 0 ? (1 + (int)item3.gr8) : 1;
                                                if (bysy != null)
                                                {
                                                    item3.gr9 = item3.gr9 != 0 ? (1 + (int)item3.gr9) : 1;
                                                }
                                            }
                                            //III gr
                                            if (group == group3EnumId)
                                            {
                                                item3.gr10 = item3.gr10 != 0 ? (1 + (int)item3.gr10) : 1;
                                                if (bysy != null)
                                                {
                                                    item3.gr11 = item3.gr11 != 0 ? (1 + (int)item3.gr11) : 1;
                                                }
                                            }
                                        }
                                        //not set group
                                        if (group == notSetGrEnumId)
                                        {
                                            item3.gr12 = item3.gr12 != 0 ? (1 + (int)item3.gr12) : 1;
                                            if (bysy != null)
                                            {
                                                item3.gr13 = item3.gr13 != 0 ? (1 + (int)item3.gr13) : 1;
                                            }
                                        }
                                    }
                                    if (dinamicGroup == disChildEnumId)
                                    {
                                        item4.gr1 = item4.gr1 != 0 ? (1 + (int)item4.gr1) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item4.gr2 = item4.gr2 != 0 ? (1 + (int)item4.gr2) : 1;
                                        }
                                        //из них признаны инвалидами
                                        if (group == group1EnumId || group == group2EnumId || group == disGroup3EnumId)
                                        {
                                            item4.gr3 = item4.gr3 != 0 ? (1 + (int)item4.gr3) : 1;
                                            if (gender == womanEnumId)
                                            {
                                                item4.gr4 = item4.gr4 != 0 ? (1 + (int)item4.gr4) : 1;
                                            }
                                            if (indef)
                                            {
                                                item4.gr5 = item4.gr5 != 0 ? (1 + (int)item4.gr5) : 1;
                                            }
                                            //I gr
                                            if (group == group1EnumId)
                                            {
                                                item4.gr6 = item4.gr6 != 0 ? (1 + (int)item4.gr6) : 1;
                                                if (bysy != null)
                                                {
                                                    item4.gr7 = item4.gr7 != 0 ? (1 + (int)item4.gr7) : 1;
                                                }
                                            }
                                            //II gr
                                            if (group == group2EnumId)
                                            {
                                                item4.gr8 = item4.gr8 != 0 ? (1 + (int)item4.gr8) : 1;
                                                if (bysy != null)
                                                {
                                                    item4.gr9 = item4.gr9 != 0 ? (1 + (int)item4.gr9) : 1;
                                                }
                                            }
                                            //III gr
                                            if (group == group3EnumId)
                                            {
                                                item4.gr10 = item4.gr10 != 0 ? (1 + (int)item4.gr10) : 1;
                                                if (bysy != null)
                                                {
                                                    item4.gr11 = item4.gr11 != 0 ? (1 + (int)item4.gr11) : 1;
                                                }
                                            }
                                        }
                                        //not set group
                                        if (group == notSetGrEnumId)
                                        {
                                            item4.gr12 = item4.gr12 != 0 ? (1 + (int)item4.gr12) : 1;
                                            if (bysy != null)
                                            {
                                                item4.gr13 = item4.gr13 != 0 ? (1 + (int)item4.gr13) : 1;
                                            }
                                        }
                                    }
                                }
                                if (goal11) c4++;
                                if (goal9 != Guid.Empty) c5++;
                                if (goal2) c6++;
                                if (goal17) c7++;
                                if (goal1) c8++;
                                if (goal12) c9++;
                                if (goal3 || goal4 || goal5 || goal6 || goal7 || goal8) c10++;
                                if (goal13) c11++;
                                if (goal16) c12++;
                                if (ageOf == pensionAge)
                                {
                                    if (group == group1EnumId || group == group2EnumId || group == group3EnumId)
                                    {
                                        c14++;
                                        if (group == group1EnumId) c15++;
                                        if (group == group2EnumId) c16++;
                                        if (group == group3EnumId) c17++;
                                    }
                                }
                            }
                        }
                    }
                    report.c0 = c0;
                    report.c1 = c1;
                    report.c3 = c4 + c5 + c6 + c7 + c8 + c9 + c10 + c11 + c12 + c14; 
                    report.c4 = c4;
                    report.c5 = c5;
                    report.c6 = c6;
                    report.c7 = c7;
                    report.c8 = c8;
                    report.c9 = c9;
                    report.c10 = c10;
                    report.c11 = c11;
                    report.c12 = c12;
                    report.c13 = c13;
                    report.c14 = c14;
                    report.c15 = c15;
                    report.c16 = c16;
                    report.c17 = c17;
                }
            }
            static object[] getDinamic(WorkflowContext context, Guid actId)
            {
                var qb = new QueryBuilder(dinamicDefId, context.UserId);
                qb.Where("AdultsMedicalCertificate").Eq(actId);
                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    query.AddAttribute(query.Source, "DisabilityGroup");
                    query.AddAttribute(query.Source, "Year");
                    query.AddOrderAttribute("Year", false);
                    using (var reader = context.CreateSqlReader(query))
                    {
                        if (reader.Read())
                        {
                            var dinamicInval = reader.IsDbNull(0) ? Guid.Empty : reader.GetGuid(0);
                            var dinamicGod = reader.IsDbNull(1) ? string.Empty : reader.GetString(1);
                            return new object[] { dinamicInval, dinamicGod };
                        }
                    }
                }
                return null;
            }
            static void RemoveRows(WorkflowContext context, Guid reportId)
            {
                var docRepo = context.Documents;
                var rows = new List<Guid>();
                var qb = new QueryBuilder(reportItemDefId, context.UserId);
                qb.Where("Report").Eq(reportId).Or("Report").IsNull();
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read()) rows.Add(reader.GetGuid(0));
                }
                foreach (var rowId in rows)
                {
                    docRepo.DeleteById(rowId);
                }
            }
            private static readonly Guid reportDefId = new Guid("{17789FEE-2908-4E01-8E16-2ECAF4A75C7A}"); //Отчет о распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности
            private static readonly Guid reportItemDefId = new Guid("{10AB1374-EA9C-493B-B5F6-CD6A40273B9B}"); //Распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности
            private static readonly Guid adultsStatCardDefId = new Guid("{C77A6FF6-EC0B-4562-81FE-BB3BC17F4FDB}"); //Статистический талон для взрослых
            private static readonly Guid adultsActDefId = new Guid("{12AE380B-39CE-4753-A556-4083BD4B0F92}"); //Медицинский акт для взрослых
            private static readonly Guid dinamicDefId = new Guid("{FFBD36FF-615E-49F7-AB5B-9C787C07B981}"); //Динамика инвалидности
            private static readonly Guid personDefId = new Guid("{D71CE61A-9B59-4B5E-8713-8131DBB5BA02}"); //Person 
            public static readonly Guid districtDefId = new Guid("{A3FCA356-82A9-4BBD-872A-8333BEC6E41A}"); //Район
            public static readonly Guid cityDefId = new Guid("{4BB6D32D-5181-4031-BA49-CF5910D6D883}"); //Города районного значения

            public static readonly Guid repetEnumId = new Guid("{A1F1D6CD-C1CD-4BF8-8F4A-DA124D47C250}"); //Повторные
            public static readonly Guid pensionAge = new Guid("{9B207DB0-8214-4BA7-A8C4-635EF87B583A}"); //Лицо пенсионного возраста

            //Группа инвалидности из динамики инвалидности
            public static readonly Guid disGroup1EnumId = new Guid("{8B2A4C4E-DBE7-4A49-AB2B-D788C22DC3D5}"); //I
            public static readonly Guid disGroup2EnumId = new Guid("{4E62F6B9-BDFA-4D92-97A0-1E0B3AEDB473}"); //II
            public static readonly Guid disGroup3EnumId = new Guid("{07F39539-FF02-4F5F-A4EA-D403AFB679CF}"); //III
            public static readonly Guid disChildEnumId = new Guid("{0643F3EA-94C5-4888-BCD3-2CCADE7A3AE4}"); //Ребенок инвалид

            public static readonly Guid group1EnumId = new Guid("{D145ABA1-EADA-442B-9D8D-AD10BCD126D2}"); //Первая
            public static readonly Guid group2EnumId = new Guid("{C161DA2D-2883-4211-B444-CBB04DBF33D5}"); //Вторая
            public static readonly Guid group3EnumId = new Guid("{CCD439CA-1500-4F7A-A1C8-BB474B5DE8AA}"); //Третья
            public static readonly Guid notSetGrEnumId = new Guid("{C52CCD68-96D8-4E0A-A8ED-30B482C1CF18}"); //Не установлена

            public static readonly Guid cityEnumId = new Guid("{DE3D24A1-64D3-4647-B711-31F334D24416}"); //Городская местность//DistrictType
            public static readonly Guid womanEnumId = new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"); //Женский пол
            public static readonly Guid primaryEnumId = new Guid("{34129BC5-5B31-4189-87FA-799402F7E99F}"); //Первичное
            
            public static readonly Guid ApprovedStateId = new Guid("{32062CB7-C31C-4AFB-ADF3-F9F9AEEFCE59}");  //Подписанные
        }
        //Результат переосвидетельствования инвалидов из числа проживающих (ГОРОДСКАЯ МЕСТНОСТЬ) 
        public static class ReExamInvalidsOfCity
        {
            public static Report_5 Execute(WorkflowContext context, int year, string distrSpr)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;

                var docs = new string[]
                {
                   "всего  02",
                    "в том числе: I группа  03",
                    "II группа  04",
                    "III группа  05",
                    "ребенок инвалид  06"
                };
                var items = new List<Report5Item>();
                var report = new Report_5();
                int i2 = 1;
                foreach (var i in docs)
                {
                    var item = new Report5Item();
                    item.RowType = i;
                    item.RowNo = i2;
                    i2++;
                    items.Add(item);
                }
                CalcItems(context, year, orgId, distrSpr,
                        items[4], items[3], items[2], items[1], items[0], report);
                report.Items = items.ToArray();
                return report;
            }
            public static void CalcItems(WorkflowContext context, int year, Guid orgId, string distrSpr,
                Report5Item item4, Report5Item item3, Report5Item item2, Report5Item item1, Report5Item item0, Report_5 report)
            {
                var qb = new QueryBuilder(adultsStatCardDefId, context.UserId);
                qb.Where("&State").Eq(ApprovedStateId).And("Examination1").Eq(repetEnumId);

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                    var actSrc = query.JoinSource(query.Source, adultsActDefId, SqlSourceJoinType.Inner, "AdultsMedicalCertificate");
                    var distrSrc = query.JoinSource(actSrc, districtDefId, SqlSourceJoinType.LeftOuter, "DistrictId");
                    var citySrc = query.JoinSource(actSrc, cityDefId, SqlSourceJoinType.LeftOuter, "CityId");
                    query.AddCondition(ExpressionOperation.And, adultsActDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    if (!string.IsNullOrEmpty(distrSpr))
                        query.AddCondition(ExpressionOperation.And, districtDefId, "NumberDis", ConditionOperation.Equal, distrSpr);

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(query.Source, "EndDateExamination");
                    query.AddAttribute(personSrc, "Gender");
                    query.AddAttribute(query.Source, "DisabilityGroup");
                    query.AddAttribute(query.Source, "Indefinitely");
                    query.AddAttribute(query.Source, "PlaceWork");
                    query.AddAttribute(distrSrc, "DistrictType");
                    query.AddAttribute(citySrc, "DistrictType");
                    query.AddAttribute(query.Source, "goal1");
                    query.AddAttribute(query.Source, "goal2");
                    query.AddAttribute(query.Source, "goal3");
                    query.AddAttribute(query.Source, "goal4");
                    query.AddAttribute(query.Source, "goal5");
                    query.AddAttribute(query.Source, "goal6");
                    query.AddAttribute(query.Source, "goal7");
                    query.AddAttribute(query.Source, "goal8");
                    query.AddAttribute(query.Source, "goal9");
                    query.AddAttribute(query.Source, "goal11");
                    query.AddAttribute(query.Source, "goal12");
                    query.AddAttribute(query.Source, "goal13");
                    query.AddAttribute(query.Source, "goal16");
                    query.AddAttribute(query.Source, "goal17");
                    query.AddAttribute(query.Source, "AgeOf");
                    query.AddAttribute(query.Source, "GoalSurvey");
                    query.AddAttribute(actSrc, "&Id");

                    int c0 = 0; int c1 = 0; int c3 = 0; int c4 = 0; int c5 = 0;
                    int c6 = 0; int c7 = 0; int c8 = 0; int c9 = 0; int c10 = 0;
                    int c11 = 0; int c12 = 0; int c13 = 0; int c14 = 0;
                    int c15 = 0; int c16 = 0; int c17 = 0; int c18 = 0;
                    int c19 = 0; int c20 = 0; int c21 = 0; int c22 = 0; int c23 = 0; int c24 = 0;

                    var table = new DataTable();
                    using (var reader = context.CreateSqlReader(query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var date = !(row[1] is DBNull) ? (DateTime)row[1] : DateTime.MinValue;
                        var gender = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                        var group = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                        var indef = row[4] is DBNull ? false : (bool)row[4];
                        var bysy = row[5] is DBNull ? "" : row[5].ToString();
                        var district = row[6] is DBNull ? Guid.Empty : (Guid)row[6];
                        var city = row[7] is DBNull ? Guid.Empty : (Guid)row[7];
                        var goal1 = row[8] is DBNull ? false : (bool)row[8];
                        var goal2 = row[9] is DBNull ? false : (bool)row[9];
                        var goal3 = row[10] is DBNull ? false : (bool)row[10];
                        var goal4 = row[11] is DBNull ? false : (bool)row[11];
                        var goal5 = row[12] is DBNull ? false : (bool)row[12];
                        var goal6 = row[13] is DBNull ? false : (bool)row[13];
                        var goal7 = row[14] is DBNull ? false : (bool)row[14];
                        var goal8 = row[15] is DBNull ? false : (bool)row[15];
                        var goal9 = row[16] is DBNull ? Guid.Empty : (Guid)row[16];
                        var goal11 = row[17] is DBNull ? false : (bool)row[17];
                        var goal12 = row[18] is DBNull ? false : (bool)row[18];
                        var goal13 = row[19] is DBNull ? false : (bool)row[19];
                        var goal16 = row[20] is DBNull ? false : (bool)row[20];
                        var goal17 = row[21] is DBNull ? false : (bool)row[21];
                        var ageOf = row[22] is DBNull ? Guid.Empty : (Guid)row[22];
                        var goalGroup = row[23] is DBNull ? Guid.Empty : (Guid)row[23];
                        var actId = row[24] is DBNull ? Guid.Empty : (Guid)row[24];

                        var dinamic = getDinamic(context, actId);
                        var dinamicGroup = Guid.Empty;
                        var dinamicGod = "";
                        if (dinamic != null)
                        {
                            dinamicGroup = (Guid)dinamic[0];
                            dinamicGod = (string)dinamic[1];
                        }

                        if (appId != Guid.Empty)
                        {
                            if (date.Year == year && district == cityEnumId ||
                                date.Year == year && city == cityEnumId)
                            {
                                c0++; //общее число переосв-х                                
                                if (goalGroup != Guid.Empty)
                                {
                                    c1++; //2 строка
                                }
                                if (dinamicGroup != Guid.Empty)
                                {
                                    item0.gr1 = item0.gr1 != 0 ? (1 + (int)item0.gr1) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item0.gr2 = item0.gr2 != 0 ? (1 + (int)item0.gr2) : 1;
                                    }
                                    //из них признаны инвалидами
                                    if (group == group1EnumId || group == group2EnumId || group == disGroup3EnumId)
                                    {
                                        item0.gr3 = item0.gr3 != 0 ? (1 + (int)item0.gr3) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item0.gr4 = item0.gr4 != 0 ? (1 + (int)item0.gr4) : 1;
                                        }
                                        if (indef)
                                        {
                                            item0.gr5 = item0.gr5 != 0 ? (1 + (int)item0.gr5) : 1;
                                        }
                                        //I gr
                                        if (group == group1EnumId)
                                        {
                                            item0.gr6 = item0.gr6 != 0 ? (1 + (int)item0.gr6) : 1;
                                            if (bysy != null)
                                            {
                                                item0.gr7 = item0.gr7 != 0 ? (1 + (int)item0.gr7) : 1;
                                            }
                                        }
                                        //II gr
                                        if (group == group2EnumId)
                                        {
                                            item0.gr8 = item0.gr8 != 0 ? (1 + (int)item0.gr8) : 1;
                                            if (bysy != null)
                                            {
                                                item0.gr9 = item0.gr9 != 0 ? (1 + (int)item0.gr9) : 1;
                                            }
                                        }
                                        //III gr
                                        if (group == group3EnumId)
                                        {
                                            item0.gr10 = item0.gr10 != 0 ? (1 + (int)item0.gr10) : 1;
                                            if (bysy != null)
                                            {
                                                item0.gr11 = item0.gr11 != 0 ? (1 + (int)item0.gr11) : 1;
                                            }
                                        }
                                    }
                                    //not set group
                                    if (group == notSetGrEnumId)
                                    {
                                        item0.gr12 = item0.gr12 != 0 ? (1 + (int)item0.gr12) : 1;
                                        if (bysy != null)
                                        {
                                            item0.gr13 = item0.gr13 != 0 ? (1 + (int)item0.gr13) : 1;
                                        }
                                    }
                                    if (dinamicGroup == disGroup1EnumId)
                                    {
                                        item1.gr1 = item1.gr1 != 0 ? (1 + (int)item1.gr1) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item1.gr2 = item1.gr2 != 0 ? (1 + (int)item1.gr2) : 1;
                                        }
                                        //из них признаны инвалидами
                                        if (group == group1EnumId || group == group2EnumId || group == disGroup3EnumId)
                                        {
                                            item1.gr3 = item1.gr3 != 0 ? (1 + (int)item1.gr3) : 1;
                                            if (gender == womanEnumId)
                                            {
                                                item1.gr4 = item1.gr4 != 0 ? (1 + (int)item1.gr4) : 1;
                                            }
                                            if (indef)
                                            {
                                                item1.gr5 = item1.gr5 != 0 ? (1 + (int)item1.gr5) : 1;
                                            }
                                            //I gr
                                            if (group == group1EnumId)
                                            {
                                                item1.gr6 = item1.gr6 != 0 ? (1 + (int)item1.gr6) : 1;
                                                if (bysy != null)
                                                {
                                                    item1.gr7 = item1.gr7 != 0 ? (1 + (int)item1.gr7) : 1;
                                                }
                                            }
                                            //II gr
                                            if (group == group2EnumId)
                                            {
                                                item1.gr8 = item1.gr8 != 0 ? (1 + (int)item1.gr8) : 1;
                                                if (bysy != null)
                                                {
                                                    item1.gr9 = item1.gr9 != 0 ? (1 + (int)item1.gr9) : 1;
                                                }
                                            }
                                            //III gr
                                            if (group == group3EnumId)
                                            {
                                                item1.gr10 = item1.gr10 != 0 ? (1 + (int)item1.gr10) : 1;
                                                if (bysy != null)
                                                {
                                                    item1.gr11 = item1.gr11 != 0 ? (1 + (int)item1.gr11) : 1;
                                                }
                                            }
                                        }
                                        //not set group
                                        if (group == notSetGrEnumId)
                                        {
                                            item1.gr12 = item1.gr12 != 0 ? (1 + (int)item1.gr12) : 1;
                                            if (bysy != null)
                                            {
                                                item1.gr13 = item1.gr13 != 0 ? (1 + (int)item1.gr13) : 1;
                                            }
                                        }
                                    }
                                    if (dinamicGroup == disGroup2EnumId)
                                    {
                                        item2.gr1 = item2.gr1 != 0 ? (1 + (int)item2.gr1) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.gr2 = item2.gr2 != 0 ? (1 + (int)item2.gr2) : 1;
                                        }
                                        //из них признаны инвалидами
                                        if (group == group1EnumId || group == group2EnumId || group == disGroup3EnumId)
                                        {
                                            item2.gr3 = item2.gr3 != 0 ? (1 + (int)item2.gr3) : 1;
                                            if (gender == womanEnumId)
                                            {
                                                item2.gr4 = item2.gr4 != 0 ? (1 + (int)item2.gr4) : 1;
                                            }
                                            if (indef)
                                            {
                                                item2.gr5 = item2.gr5 != 0 ? (1 + (int)item2.gr5) : 1;
                                            }
                                            //I gr
                                            if (group == group1EnumId)
                                            {
                                                item2.gr6 = item2.gr6 != 0 ? (1 + (int)item2.gr6) : 1;
                                                if (bysy != null)
                                                {
                                                    item2.gr7 = item2.gr7 != 0 ? (1 + (int)item2.gr7) : 1;
                                                }
                                            }
                                            //II gr
                                            if (group == group2EnumId)
                                            {
                                                item2.gr8 = item2.gr8 != 0 ? (1 + (int)item2.gr8) : 1;
                                                if (bysy != null)
                                                {
                                                    item2.gr9 = item2.gr9 != 0 ? (1 + (int)item2.gr9) : 1;
                                                }
                                            }
                                            //III gr
                                            if (group == group3EnumId)
                                            {
                                                item2.gr10 = item2.gr10 != 0 ? (1 + (int)item2.gr10) : 1;
                                                if (bysy != null)
                                                {
                                                    item2.gr11 = item2.gr11 != 0 ? (1 + (int)item2.gr11) : 1;
                                                }
                                            }
                                        }
                                        //not set group
                                        if (group == notSetGrEnumId)
                                        {
                                            item2.gr12 = item2.gr12 != 0 ? (1 + (int)item2.gr12) : 1;
                                            if (bysy != null)
                                            {
                                                item2.gr13 = item2.gr13 != 0 ? (1 + (int)item2.gr13) : 1;
                                            }
                                        }
                                    }
                                    if (dinamicGroup == disGroup3EnumId)
                                    {
                                        item3.gr1 = item3.gr1 != 0 ? (1 + (int)item3.gr1) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.gr2 = item3.gr2 != 0 ? (1 + (int)item3.gr2) : 1;
                                        }
                                        //из них признаны инвалидами
                                        if (group == group1EnumId || group == group2EnumId || group == disGroup3EnumId)
                                        {
                                            item3.gr3 = item3.gr3 != 0 ? (1 + (int)item3.gr3) : 1;
                                            if (gender == womanEnumId)
                                            {
                                                item3.gr4 = item3.gr4 != 0 ? (1 + (int)item3.gr4) : 1;
                                            }
                                            if (indef)
                                            {
                                                item3.gr5 = item3.gr5 != 0 ? (1 + (int)item3.gr5) : 1;
                                            }
                                            //I gr
                                            if (group == group1EnumId)
                                            {
                                                item3.gr6 = item3.gr6 != 0 ? (1 + (int)item3.gr6) : 1;
                                                if (bysy != null)
                                                {
                                                    item3.gr7 = item3.gr7 != 0 ? (1 + (int)item3.gr7) : 1;
                                                }
                                            }
                                            //II gr
                                            if (group == group2EnumId)
                                            {
                                                item3.gr8 = item3.gr8 != 0 ? (1 + (int)item3.gr8) : 1;
                                                if (bysy != null)
                                                {
                                                    item3.gr9 = item3.gr9 != 0 ? (1 + (int)item3.gr9) : 1;
                                                }
                                            }
                                            //III gr
                                            if (group == group3EnumId)
                                            {
                                                item3.gr10 = item3.gr10 != 0 ? (1 + (int)item3.gr10) : 1;
                                                if (bysy != null)
                                                {
                                                    item3.gr11 = item3.gr11 != 0 ? (1 + (int)item3.gr11) : 1;
                                                }
                                            }
                                        }
                                        //not set group
                                        if (group == notSetGrEnumId)
                                        {
                                            item3.gr12 = item3.gr12 != 0 ? (1 + (int)item3.gr12) : 1;
                                            if (bysy != null)
                                            {
                                                item3.gr13 = item3.gr13 != 0 ? (1 + (int)item3.gr13) : 1;
                                            }
                                        }
                                    }
                                    if (dinamicGroup == disChildEnumId)
                                    {
                                        item4.gr1 = item4.gr1 != 0 ? (1 + (int)item4.gr1) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item4.gr2 = item4.gr2 != 0 ? (1 + (int)item4.gr2) : 1;
                                        }
                                        //из них признаны инвалидами
                                        if (group == group1EnumId || group == group2EnumId || group == disGroup3EnumId)
                                        {
                                            item4.gr3 = item4.gr3 != 0 ? (1 + (int)item4.gr3) : 1;
                                            if (gender == womanEnumId)
                                            {
                                                item4.gr4 = item4.gr4 != 0 ? (1 + (int)item4.gr4) : 1;
                                            }
                                            if (indef)
                                            {
                                                item4.gr5 = item4.gr5 != 0 ? (1 + (int)item4.gr5) : 1;
                                            }
                                            //I gr
                                            if (group == group1EnumId)
                                            {
                                                item4.gr6 = item4.gr6 != 0 ? (1 + (int)item4.gr6) : 1;
                                                if (bysy != null)
                                                {
                                                    item4.gr7 = item4.gr7 != 0 ? (1 + (int)item4.gr7) : 1;
                                                }
                                            }
                                            //II gr
                                            if (group == group2EnumId)
                                            {
                                                item4.gr8 = item4.gr8 != 0 ? (1 + (int)item4.gr8) : 1;
                                                if (bysy != null)
                                                {
                                                    item4.gr9 = item4.gr9 != 0 ? (1 + (int)item4.gr9) : 1;
                                                }
                                            }
                                            //III gr
                                            if (group == group3EnumId)
                                            {
                                                item4.gr10 = item4.gr10 != 0 ? (1 + (int)item4.gr10) : 1;
                                                if (bysy != null)
                                                {
                                                    item4.gr11 = item4.gr11 != 0 ? (1 + (int)item4.gr11) : 1;
                                                }
                                            }
                                        }
                                        //not set group
                                        if (group == notSetGrEnumId)
                                        {
                                            item4.gr12 = item4.gr12 != 0 ? (1 + (int)item4.gr12) : 1;
                                            if (bysy != null)
                                            {
                                                item4.gr13 = item4.gr13 != 0 ? (1 + (int)item4.gr13) : 1;
                                            }
                                        }
                                    }
                                }
                                if (goal11) c4++;
                                if (goal9 != Guid.Empty) c5++;
                                if (goal2) c6++;
                                if (goal17) c7++;
                                if (goal1) c8++;
                                if (goal12) c9++;
                                if (goal3 || goal4 || goal5 || goal6 || goal7 || goal8) c10++;
                                if (goal13) c11++;
                                if (goal16) c12++;
                                if (ageOf == pensionAge)
                                {
                                    if (group == group1EnumId || group == group2EnumId || group == group3EnumId)
                                    {
                                        c14++;
                                        if (group == group1EnumId) c15++;
                                        if (group == group2EnumId) c16++;
                                        if (group == group3EnumId) c17++;
                                    }
                                }
                            }
                        }
                    }
                    report.c0 = c0;
                    report.c1 = c1;
                    report.c3 = c4 + c5 + c6 + c7 + c8 + c9 + c10 + c11 + c12 + c14;
                    report.c4 = c4;
                    report.c5 = c5;
                    report.c6 = c6;
                    report.c7 = c7;
                    report.c8 = c8;
                    report.c9 = c9;
                    report.c10 = c10;
                    report.c11 = c11;
                    report.c12 = c12;
                    report.c13 = c13;
                    report.c14 = c14;
                    report.c15 = c15;
                    report.c16 = c16;
                    report.c17 = c17;
                }
            }
            static object[] getDinamic(WorkflowContext context, Guid actId)
            {
                var qb = new QueryBuilder(dinamicDefId, context.UserId);
                qb.Where("AdultsMedicalCertificate").Eq(actId);
                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    query.AddAttribute(query.Source, "DisabilityGroup");
                    query.AddAttribute(query.Source, "Year");
                    query.AddOrderAttribute("Year", false);
                    using (var reader = context.CreateSqlReader(query))
                    {
                        if (reader.Read())
                        {
                            var dinamicInval = reader.IsDbNull(0) ? Guid.Empty : reader.GetGuid(0);
                            var dinamicGod = reader.IsDbNull(1) ? string.Empty : reader.GetString(1);
                            return new object[] { dinamicInval, dinamicGod };
                        }
                    }
                }
                return null;
            }
            static void RemoveRows(WorkflowContext context, Guid reportId)
            {
                var docRepo = context.Documents;
                var rows = new List<Guid>();
                var qb = new QueryBuilder(reportItemDefId, context.UserId);
                qb.Where("Report").Eq(reportId).Or("Report").IsNull();
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read()) rows.Add(reader.GetGuid(0));
                }
                foreach (var rowId in rows)
                {
                    docRepo.DeleteById(rowId);
                }
            }
            private static readonly Guid reportDefId = new Guid("{17789FEE-2908-4E01-8E16-2ECAF4A75C7A}"); //Отчет о распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности
            private static readonly Guid reportItemDefId = new Guid("{10AB1374-EA9C-493B-B5F6-CD6A40273B9B}"); //Распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности
            private static readonly Guid adultsStatCardDefId = new Guid("{C77A6FF6-EC0B-4562-81FE-BB3BC17F4FDB}"); //Статистический талон для взрослых
            private static readonly Guid adultsActDefId = new Guid("{12AE380B-39CE-4753-A556-4083BD4B0F92}"); //Медицинский акт для взрослых
            private static readonly Guid dinamicDefId = new Guid("{FFBD36FF-615E-49F7-AB5B-9C787C07B981}"); //Динамика инвалидности
            private static readonly Guid personDefId = new Guid("{D71CE61A-9B59-4B5E-8713-8131DBB5BA02}"); //Person 
            public static readonly Guid districtDefId = new Guid("{A3FCA356-82A9-4BBD-872A-8333BEC6E41A}"); //Район
            public static readonly Guid cityDefId = new Guid("{4BB6D32D-5181-4031-BA49-CF5910D6D883}"); //Города районного значения

            public static readonly Guid repetEnumId = new Guid("{A1F1D6CD-C1CD-4BF8-8F4A-DA124D47C250}"); //Повторные
            public static readonly Guid pensionAge = new Guid("{9B207DB0-8214-4BA7-A8C4-635EF87B583A}"); //Лицо пенсионного возраста

            //Группа инвалидности из динамики инвалидности
            public static readonly Guid disGroup1EnumId = new Guid("{8B2A4C4E-DBE7-4A49-AB2B-D788C22DC3D5}"); //I
            public static readonly Guid disGroup2EnumId = new Guid("{4E62F6B9-BDFA-4D92-97A0-1E0B3AEDB473}"); //II
            public static readonly Guid disGroup3EnumId = new Guid("{07F39539-FF02-4F5F-A4EA-D403AFB679CF}"); //III
            public static readonly Guid disChildEnumId = new Guid("{0643F3EA-94C5-4888-BCD3-2CCADE7A3AE4}"); //Ребенок инвалид

            public static readonly Guid group1EnumId = new Guid("{D145ABA1-EADA-442B-9D8D-AD10BCD126D2}"); //Первая
            public static readonly Guid group2EnumId = new Guid("{C161DA2D-2883-4211-B444-CBB04DBF33D5}"); //Вторая
            public static readonly Guid group3EnumId = new Guid("{CCD439CA-1500-4F7A-A1C8-BB474B5DE8AA}"); //Третья
            public static readonly Guid notSetGrEnumId = new Guid("{C52CCD68-96D8-4E0A-A8ED-30B482C1CF18}"); //Не установлена


            public static readonly Guid cityEnumId = new Guid("{DE3D24A1-64D3-4647-B711-31F334D24416}"); //Городская местность//DistrictType
            public static readonly Guid womanEnumId = new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"); //Женский пол
            public static readonly Guid primaryEnumId = new Guid("{34129BC5-5B31-4189-87FA-799402F7E99F}"); //Первичное

            public static readonly Guid ApprovedStateId = new Guid("{32062CB7-C31C-4AFB-ADF3-F9F9AEEFCE59}");  //Подписанные
        }
        //Результат переосвидетельствования инвалидов из числа проживающих (СЕЛЬСКАЯ МЕСТНОСТЬ) 
        public static class ReExamInvalidsOfVillage
        {
            public static Report_5 Execute(WorkflowContext context, int year, string distrSpr)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;

                var docs = new string[]
                {
                    "всего  02",
                    "в том числе: I группа  03",
                    "II группа  04",
                    "III группа  05",
                    "ребенок инвалид  06"
                };
                var items = new List<Report5Item>();
                var report = new Report_5();
                int i2 = 1;
                foreach (var i in docs)
                {
                    var item = new Report5Item();
                    item.RowType = i;
                    item.RowNo = i2;
                    i2++;
                    items.Add(item);
                }
                CalcItems(context, year, orgId, distrSpr,
                        items[4], items[3], items[2], items[1], items[0], report);
                report.Items = items.ToArray();
                return report;
            }
            public static void CalcItems(WorkflowContext context, int year, Guid orgId, string distrSpr,
                Report5Item item4, Report5Item item3, Report5Item item2, Report5Item item1, Report5Item item0, Report_5 report)
            {
                var qb = new QueryBuilder(adultsStatCardDefId, context.UserId);
                qb.Where("&State").Eq(ApprovedStateId).And("Examination1").Eq(repetEnumId);

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                    var actSrc = query.JoinSource(query.Source, adultsActDefId, SqlSourceJoinType.Inner, "AdultsMedicalCertificate");
                    var distrSrc = query.JoinSource(actSrc, districtDefId, SqlSourceJoinType.LeftOuter, "DistrictId");
                    var citySrc = query.JoinSource(actSrc, cityDefId, SqlSourceJoinType.LeftOuter, "CityId");
                    query.AddCondition(ExpressionOperation.And, adultsActDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    if (!string.IsNullOrEmpty(distrSpr))
                        query.AddCondition(ExpressionOperation.And, districtDefId, "NumberDis", ConditionOperation.Equal, distrSpr);

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(query.Source, "EndDateExamination");
                    query.AddAttribute(personSrc, "Gender");
                    query.AddAttribute(query.Source, "DisabilityGroup");
                    query.AddAttribute(query.Source, "Indefinitely");
                    query.AddAttribute(query.Source, "PlaceWork");
                    query.AddAttribute(distrSrc, "DistrictType");
                    query.AddAttribute(citySrc, "DistrictType");
                    query.AddAttribute(query.Source, "goal1");
                    query.AddAttribute(query.Source, "goal2");
                    query.AddAttribute(query.Source, "goal3");
                    query.AddAttribute(query.Source, "goal4");
                    query.AddAttribute(query.Source, "goal5");
                    query.AddAttribute(query.Source, "goal6");
                    query.AddAttribute(query.Source, "goal7");
                    query.AddAttribute(query.Source, "goal8");
                    query.AddAttribute(query.Source, "goal9");
                    query.AddAttribute(query.Source, "goal11");
                    query.AddAttribute(query.Source, "goal12");
                    query.AddAttribute(query.Source, "goal13");
                    query.AddAttribute(query.Source, "goal16");
                    query.AddAttribute(query.Source, "goal17");
                    query.AddAttribute(query.Source, "AgeOf");
                    query.AddAttribute(query.Source, "GoalSurvey");
                    query.AddAttribute(actSrc, "&Id");

                    int c0 = 0; int c1 = 0; int c3 = 0; int c4 = 0; int c5 = 0;
                    int c6 = 0; int c7 = 0; int c8 = 0; int c9 = 0; int c10 = 0;
                    int c11 = 0; int c12 = 0; int c13 = 0; int c14 = 0;
                    int c15 = 0; int c16 = 0; int c17 = 0; int c18 = 0;
                    int c19 = 0; int c20 = 0; int c21 = 0; int c22 = 0; int c23 = 0; int c24 = 0;

                    var table = new DataTable();
                    using (var reader = context.CreateSqlReader(query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var date = !(row[1] is DBNull) ? (DateTime)row[1] : DateTime.MinValue;
                        var gender = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                        var group = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                        var indef = row[4] is DBNull ? false : (bool)row[4];
                        var bysy = row[5] is DBNull ? "" : row[5].ToString();
                        var district = row[6] is DBNull ? Guid.Empty : (Guid)row[6];
                        var city = row[7] is DBNull ? Guid.Empty : (Guid)row[7];
                        var goal1 = row[8] is DBNull ? false : (bool)row[8];
                        var goal2 = row[9] is DBNull ? false : (bool)row[9];
                        var goal3 = row[10] is DBNull ? false : (bool)row[10];
                        var goal4 = row[11] is DBNull ? false : (bool)row[11];
                        var goal5 = row[12] is DBNull ? false : (bool)row[12];
                        var goal6 = row[13] is DBNull ? false : (bool)row[13];
                        var goal7 = row[14] is DBNull ? false : (bool)row[14];
                        var goal8 = row[15] is DBNull ? false : (bool)row[15];
                        var goal9 = row[16] is DBNull ? Guid.Empty : (Guid)row[16];
                        var goal11 = row[17] is DBNull ? false : (bool)row[17];
                        var goal12 = row[18] is DBNull ? false : (bool)row[18];
                        var goal13 = row[19] is DBNull ? false : (bool)row[19];
                        var goal16 = row[20] is DBNull ? false : (bool)row[20];
                        var goal17 = row[21] is DBNull ? false : (bool)row[21];
                        var ageOf = row[22] is DBNull ? Guid.Empty : (Guid)row[22];
                        var goalGroup = row[23] is DBNull ? Guid.Empty : (Guid)row[23];
                        var actId = row[24] is DBNull ? Guid.Empty : (Guid)row[24];

                        var dinamic = getDinamic(context, actId);
                        var dinamicGroup = Guid.Empty;
                        var dinamicGod = "";
                        if (dinamic != null)
                        {
                            dinamicGroup = (Guid)dinamic[0];
                            dinamicGod = (string)dinamic[1];
                        }

                        if (appId != Guid.Empty)
                        {
                            if (date.Year == year && district == villageEnumId ||
                                date.Year == year && city == villageEnumId)
                            {
                                c0++; //общее число переосв-х                                
                                if (goalGroup != Guid.Empty)
                                {
                                    c1++; //2 строка
                                }
                                if (dinamicGroup != Guid.Empty)
                                {
                                    item0.gr1 = item0.gr1 != 0 ? (1 + (int)item0.gr1) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item0.gr2 = item0.gr2 != 0 ? (1 + (int)item0.gr2) : 1;
                                    }
                                    //из них признаны инвалидами
                                    if (group == group1EnumId || group == group2EnumId || group == disGroup3EnumId)
                                    {
                                        item0.gr3 = item0.gr3 != 0 ? (1 + (int)item0.gr3) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item0.gr4 = item0.gr4 != 0 ? (1 + (int)item0.gr4) : 1;
                                        }
                                        if (indef)
                                        {
                                            item0.gr5 = item0.gr5 != 0 ? (1 + (int)item0.gr5) : 1;
                                        }
                                        //I gr
                                        if (group == group1EnumId)
                                        {
                                            item0.gr6 = item0.gr6 != 0 ? (1 + (int)item0.gr6) : 1;
                                            if (bysy != null)
                                            {
                                                item0.gr7 = item0.gr7 != 0 ? (1 + (int)item0.gr7) : 1;
                                            }
                                        }
                                        //II gr
                                        if (group == group2EnumId)
                                        {
                                            item0.gr8 = item0.gr8 != 0 ? (1 + (int)item0.gr8) : 1;
                                            if (bysy != null)
                                            {
                                                item0.gr9 = item0.gr9 != 0 ? (1 + (int)item0.gr9) : 1;
                                            }
                                        }
                                        //III gr
                                        if (group == group3EnumId)
                                        {
                                            item0.gr10 = item0.gr10 != 0 ? (1 + (int)item0.gr10) : 1;
                                            if (bysy != null)
                                            {
                                                item0.gr11 = item0.gr11 != 0 ? (1 + (int)item0.gr11) : 1;
                                            }
                                        }
                                    }
                                    //not set group
                                    if (group == notSetGrEnumId)
                                    {
                                        item0.gr12 = item0.gr12 != 0 ? (1 + (int)item0.gr12) : 1;
                                        if (bysy != null)
                                        {
                                            item0.gr13 = item0.gr13 != 0 ? (1 + (int)item0.gr13) : 1;
                                        }
                                    }
                                    if (dinamicGroup == disGroup1EnumId)
                                    {
                                        item1.gr1 = item1.gr1 != 0 ? (1 + (int)item1.gr1) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item1.gr2 = item1.gr2 != 0 ? (1 + (int)item1.gr2) : 1;
                                        }
                                        //из них признаны инвалидами
                                        if (group == group1EnumId || group == group2EnumId || group == disGroup3EnumId)
                                        {
                                            item1.gr3 = item1.gr3 != 0 ? (1 + (int)item1.gr3) : 1;
                                            if (gender == womanEnumId)
                                            {
                                                item1.gr4 = item1.gr4 != 0 ? (1 + (int)item1.gr4) : 1;
                                            }
                                            if (indef)
                                            {
                                                item1.gr5 = item1.gr5 != 0 ? (1 + (int)item1.gr5) : 1;
                                            }
                                            //I gr
                                            if (group == group1EnumId)
                                            {
                                                item1.gr6 = item1.gr6 != 0 ? (1 + (int)item1.gr6) : 1;
                                                if (bysy != null)
                                                {
                                                    item1.gr7 = item1.gr7 != 0 ? (1 + (int)item1.gr7) : 1;
                                                }
                                            }
                                            //II gr
                                            if (group == group2EnumId)
                                            {
                                                item1.gr8 = item1.gr8 != 0 ? (1 + (int)item1.gr8) : 1;
                                                if (bysy != null)
                                                {
                                                    item1.gr9 = item1.gr9 != 0 ? (1 + (int)item1.gr9) : 1;
                                                }
                                            }
                                            //III gr
                                            if (group == group3EnumId)
                                            {
                                                item1.gr10 = item1.gr10 != 0 ? (1 + (int)item1.gr10) : 1;
                                                if (bysy != null)
                                                {
                                                    item1.gr11 = item1.gr11 != 0 ? (1 + (int)item1.gr11) : 1;
                                                }
                                            }
                                        }
                                        //not set group
                                        if (group == notSetGrEnumId)
                                        {
                                            item1.gr12 = item1.gr12 != 0 ? (1 + (int)item1.gr12) : 1;
                                            if (bysy != null)
                                            {
                                                item1.gr13 = item1.gr13 != 0 ? (1 + (int)item1.gr13) : 1;
                                            }
                                        }
                                    }
                                    if (dinamicGroup == disGroup2EnumId)
                                    {
                                        item2.gr1 = item2.gr1 != 0 ? (1 + (int)item2.gr1) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.gr2 = item2.gr2 != 0 ? (1 + (int)item2.gr2) : 1;
                                        }
                                        //из них признаны инвалидами
                                        if (group == group1EnumId || group == group2EnumId || group == disGroup3EnumId)
                                        {
                                            item2.gr3 = item2.gr3 != 0 ? (1 + (int)item2.gr3) : 1;
                                            if (gender == womanEnumId)
                                            {
                                                item2.gr4 = item2.gr4 != 0 ? (1 + (int)item2.gr4) : 1;
                                            }
                                            if (indef)
                                            {
                                                item2.gr5 = item2.gr5 != 0 ? (1 + (int)item2.gr5) : 1;
                                            }
                                            //I gr
                                            if (group == group1EnumId)
                                            {
                                                item2.gr6 = item2.gr6 != 0 ? (1 + (int)item2.gr6) : 1;
                                                if (bysy != null)
                                                {
                                                    item2.gr7 = item2.gr7 != 0 ? (1 + (int)item2.gr7) : 1;
                                                }
                                            }
                                            //II gr
                                            if (group == group2EnumId)
                                            {
                                                item2.gr8 = item2.gr8 != 0 ? (1 + (int)item2.gr8) : 1;
                                                if (bysy != null)
                                                {
                                                    item2.gr9 = item2.gr9 != 0 ? (1 + (int)item2.gr9) : 1;
                                                }
                                            }
                                            //III gr
                                            if (group == group3EnumId)
                                            {
                                                item2.gr10 = item2.gr10 != 0 ? (1 + (int)item2.gr10) : 1;
                                                if (bysy != null)
                                                {
                                                    item2.gr11 = item2.gr11 != 0 ? (1 + (int)item2.gr11) : 1;
                                                }
                                            }
                                        }
                                        //not set group
                                        if (group == notSetGrEnumId)
                                        {
                                            item2.gr12 = item2.gr12 != 0 ? (1 + (int)item2.gr12) : 1;
                                            if (bysy != null)
                                            {
                                                item2.gr13 = item2.gr13 != 0 ? (1 + (int)item2.gr13) : 1;
                                            }
                                        }
                                    }
                                    if (dinamicGroup == disGroup3EnumId)
                                    {
                                        item3.gr1 = item3.gr1 != 0 ? (1 + (int)item3.gr1) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.gr2 = item3.gr2 != 0 ? (1 + (int)item3.gr2) : 1;
                                        }
                                        //из них признаны инвалидами
                                        if (group == group1EnumId || group == group2EnumId || group == disGroup3EnumId)
                                        {
                                            item3.gr3 = item3.gr3 != 0 ? (1 + (int)item3.gr3) : 1;
                                            if (gender == womanEnumId)
                                            {
                                                item3.gr4 = item3.gr4 != 0 ? (1 + (int)item3.gr4) : 1;
                                            }
                                            if (indef)
                                            {
                                                item3.gr5 = item3.gr5 != 0 ? (1 + (int)item3.gr5) : 1;
                                            }
                                            //I gr
                                            if (group == group1EnumId)
                                            {
                                                item3.gr6 = item3.gr6 != 0 ? (1 + (int)item3.gr6) : 1;
                                                if (bysy != null)
                                                {
                                                    item3.gr7 = item3.gr7 != 0 ? (1 + (int)item3.gr7) : 1;
                                                }
                                            }
                                            //II gr
                                            if (group == group2EnumId)
                                            {
                                                item3.gr8 = item3.gr8 != 0 ? (1 + (int)item3.gr8) : 1;
                                                if (bysy != null)
                                                {
                                                    item3.gr9 = item3.gr9 != 0 ? (1 + (int)item3.gr9) : 1;
                                                }
                                            }
                                            //III gr
                                            if (group == group3EnumId)
                                            {
                                                item3.gr10 = item3.gr10 != 0 ? (1 + (int)item3.gr10) : 1;
                                                if (bysy != null)
                                                {
                                                    item3.gr11 = item3.gr11 != 0 ? (1 + (int)item3.gr11) : 1;
                                                }
                                            }
                                        }
                                        //not set group
                                        if (group == notSetGrEnumId)
                                        {
                                            item3.gr12 = item3.gr12 != 0 ? (1 + (int)item3.gr12) : 1;
                                            if (bysy != null)
                                            {
                                                item3.gr13 = item3.gr13 != 0 ? (1 + (int)item3.gr13) : 1;
                                            }
                                        }
                                    }
                                    if (dinamicGroup == disChildEnumId)
                                    {
                                        item4.gr1 = item4.gr1 != 0 ? (1 + (int)item4.gr1) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item4.gr2 = item4.gr2 != 0 ? (1 + (int)item4.gr2) : 1;
                                        }
                                        //из них признаны инвалидами
                                        if (group == group1EnumId || group == group2EnumId || group == disGroup3EnumId)
                                        {
                                            item4.gr3 = item4.gr3 != 0 ? (1 + (int)item4.gr3) : 1;
                                            if (gender == womanEnumId)
                                            {
                                                item4.gr4 = item4.gr4 != 0 ? (1 + (int)item4.gr4) : 1;
                                            }
                                            if (indef)
                                            {
                                                item4.gr5 = item4.gr5 != 0 ? (1 + (int)item4.gr5) : 1;
                                            }
                                            //I gr
                                            if (group == group1EnumId)
                                            {
                                                item4.gr6 = item4.gr6 != 0 ? (1 + (int)item4.gr6) : 1;
                                                if (bysy != null)
                                                {
                                                    item4.gr7 = item4.gr7 != 0 ? (1 + (int)item4.gr7) : 1;
                                                }
                                            }
                                            //II gr
                                            if (group == group2EnumId)
                                            {
                                                item4.gr8 = item4.gr8 != 0 ? (1 + (int)item4.gr8) : 1;
                                                if (bysy != null)
                                                {
                                                    item4.gr9 = item4.gr9 != 0 ? (1 + (int)item4.gr9) : 1;
                                                }
                                            }
                                            //III gr
                                            if (group == group3EnumId)
                                            {
                                                item4.gr10 = item4.gr10 != 0 ? (1 + (int)item4.gr10) : 1;
                                                if (bysy != null)
                                                {
                                                    item4.gr11 = item4.gr11 != 0 ? (1 + (int)item4.gr11) : 1;
                                                }
                                            }
                                        }
                                        //not set group
                                        if (group == notSetGrEnumId)
                                        {
                                            item4.gr12 = item4.gr12 != 0 ? (1 + (int)item4.gr12) : 1;
                                            if (bysy != null)
                                            {
                                                item4.gr13 = item4.gr13 != 0 ? (1 + (int)item4.gr13) : 1;
                                            }
                                        }
                                    }
                                }
                                if (goal11) c4++;
                                if (goal9 != Guid.Empty) c5++;
                                if (goal2) c6++;
                                if (goal17) c7++;
                                if (goal1) c8++;
                                if (goal12) c9++;
                                if (goal3 || goal4 || goal5 || goal6 || goal7 || goal8) c10++;
                                if (goal13) c11++;
                                if (goal16) c12++;
                                if (ageOf == pensionAge)
                                {
                                    if (group == group1EnumId || group == group2EnumId || group == group3EnumId)
                                    {
                                        c14++;
                                        if (group == group1EnumId) c15++;
                                        if (group == group2EnumId) c16++;
                                        if (group == group3EnumId) c17++;
                                    }
                                }
                            }
                        }
                    }
                    report.c0 = c0;
                    report.c1 = c1;
                    report.c3 = c4 + c5 + c6 + c7 + c8 + c9 + c10 + c11 + c12 + c14;
                    report.c4 = c4;
                    report.c5 = c5;
                    report.c6 = c6;
                    report.c7 = c7;
                    report.c8 = c8;
                    report.c9 = c9;
                    report.c10 = c10;
                    report.c11 = c11;
                    report.c12 = c12;
                    report.c13 = c13;
                    report.c14 = c14;
                    report.c15 = c15;
                    report.c16 = c16;
                    report.c17 = c17;
                }
            }
            static object[] getDinamic(WorkflowContext context, Guid actId)
            {
                var qb = new QueryBuilder(dinamicDefId, context.UserId);
                qb.Where("AdultsMedicalCertificate").Eq(actId);
                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    query.AddAttribute(query.Source, "DisabilityGroup");
                    query.AddAttribute(query.Source, "Year");
                    query.AddOrderAttribute("Year", false);
                    using (var reader = context.CreateSqlReader(query))
                    {
                        if (reader.Read())
                        {
                            var dinamicInval = reader.IsDbNull(0) ? Guid.Empty : reader.GetGuid(0);
                            var dinamicGod = reader.IsDbNull(1) ? string.Empty : reader.GetString(1);
                            return new object[] { dinamicInval, dinamicGod };
                        }
                    }
                }
                return null;
            }
            static void RemoveRows(WorkflowContext context, Guid reportId)
            {
                var docRepo = context.Documents;
                var rows = new List<Guid>();
                var qb = new QueryBuilder(reportItemDefId, context.UserId);
                qb.Where("Report").Eq(reportId).Or("Report").IsNull();
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read()) rows.Add(reader.GetGuid(0));
                }
                foreach (var rowId in rows)
                {
                    docRepo.DeleteById(rowId);
                }
            }
            private static readonly Guid reportDefId = new Guid("{17789FEE-2908-4E01-8E16-2ECAF4A75C7A}"); //Отчет о распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности
            private static readonly Guid reportItemDefId = new Guid("{10AB1374-EA9C-493B-B5F6-CD6A40273B9B}"); //Распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности

            private static readonly Guid adultsStatCardDefId = new Guid("{C77A6FF6-EC0B-4562-81FE-BB3BC17F4FDB}"); //Статистический талон для взрослых
            private static readonly Guid adultsActDefId = new Guid("{12AE380B-39CE-4753-A556-4083BD4B0F92}"); //Медицинский акт для взрослых
            private static readonly Guid dinamicDefId = new Guid("{FFBD36FF-615E-49F7-AB5B-9C787C07B981}"); //Динамика инвалидности
            private static readonly Guid personDefId = new Guid("{D71CE61A-9B59-4B5E-8713-8131DBB5BA02}"); //Person 
            public static readonly Guid districtDefId = new Guid("{A3FCA356-82A9-4BBD-872A-8333BEC6E41A}"); //Район
            public static readonly Guid cityDefId = new Guid("{4BB6D32D-5181-4031-BA49-CF5910D6D883}"); //Города районного значения

            public static readonly Guid repetEnumId = new Guid("{A1F1D6CD-C1CD-4BF8-8F4A-DA124D47C250}"); //Повторные
            public static readonly Guid pensionAge = new Guid("{9B207DB0-8214-4BA7-A8C4-635EF87B583A}"); //Лицо пенсионного возраста

            //Группа инвалидности из динамики инвалидности
            public static readonly Guid disGroup1EnumId = new Guid("{8B2A4C4E-DBE7-4A49-AB2B-D788C22DC3D5}"); //I
            public static readonly Guid disGroup2EnumId = new Guid("{4E62F6B9-BDFA-4D92-97A0-1E0B3AEDB473}"); //II
            public static readonly Guid disGroup3EnumId = new Guid("{07F39539-FF02-4F5F-A4EA-D403AFB679CF}"); //III
            public static readonly Guid disChildEnumId = new Guid("{0643F3EA-94C5-4888-BCD3-2CCADE7A3AE4}"); //Ребенок инвалид

            public static readonly Guid group1EnumId = new Guid("{D145ABA1-EADA-442B-9D8D-AD10BCD126D2}"); //Первая
            public static readonly Guid group2EnumId = new Guid("{C161DA2D-2883-4211-B444-CBB04DBF33D5}"); //Вторая
            public static readonly Guid group3EnumId = new Guid("{CCD439CA-1500-4F7A-A1C8-BB474B5DE8AA}"); //Третья
            public static readonly Guid notSetGrEnumId = new Guid("{C52CCD68-96D8-4E0A-A8ED-30B482C1CF18}"); //Не установлена


            public static readonly Guid villageEnumId = new Guid("{65DF9C4D-A18B-4080-855F-4800E2A19C35}"); //Cельская местность//DistrictType
            public static readonly Guid womanEnumId = new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"); //Женский пол
            public static readonly Guid primaryEnumId = new Guid("{34129BC5-5B31-4189-87FA-799402F7E99F}"); //Первичное

            public static readonly Guid ApprovedStateId = new Guid("{32062CB7-C31C-4AFB-ADF3-F9F9AEEFCE59}");  //Подписанные
        }

        //Результаты повторных освидетельствований граждан (раздел. 7.1)
        public static class RepetExamInvalids
        {
            public static List<Report7_1_Item> Execute(WorkflowContext context, int year, string distrSpr)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;

                /******************************************************************************************************************/
                var docs = new string[]
                {
                    "Переосвидетельствовано всего  01    ",
                    "В том числе для определения инвалидности  02    ",
                    "Из них: -  ЛОВЗ  не признано  03     ",
                    "- признано ЛОВЗ  04     ",
                    "В т.ч. женщин  05     ",
                    "Из общего числа признанных ЛОВЗ, ЛОВЗ вследствие трудового увечья  06    ",
                    "1 группы  06.1  ",
                    "2 группы  06.2  ",
                    "3 группы  06.3  ",
                    "- ЛОВЗ вследствие профзаболевания  07    ",
                    "1 группы  07.1  ",
                    "2 группы  07.2  ",
                    "3 группы  07.3  ",
                    "- ЛОВЗ  вследствие ликвидации аварии на ЧАЭС  08    ",
                    "1 группы  08.1  ",
                    "2 группы  08.2  ",
                    "3 группы  08.3  ",
                    "- их них: при выполнении обязанностей военной службы  08.1  ",
                    "1 группы  08.1.1",
                    "2 группы  08.1.2",
                    "3 группы  08.1.3",
                    "- ЛОВЗ из числа военнослужащих  09    ",
                    "1 группы  09.1  ",
                    "2 группы  09.2  ",
                    "3 группы  09.3  ",
                    "- из них: при выполнении обязанностей военной службы  09.1  ",
                    "1 группы  09.1.1",
                    "2 группы  09.1.2",
                    "3 группы  09.1.3",
                    "- в период похождения военной службы  09.2  ",
                    "1 группы  09.2.1",
                    "2 группы  09.2.2",
                    "3 группы  09.2.3",
                    "- ЛОВЗ  вследствие общего заболевания  10    ",
                    "1 группы  10.1  ",
                    "2 группы  10.2  ",
                    "3 группы  10.3  ",
                    "- ЛОВЗ   с детства из них:  11    ",
                    "после 18 лет  установлена группа  11.1  ",
                    "1 группы  11.11 ",
                    "2 группы  11.12 ",
                    "3 группы  11.13 ",
                    "- из стр 11 ребенок с ОВЗ   в текущем году впервые установлена группа  11.2  ",
                    "1 группы  11.21 ",
                    "2 группы  11.22 ",
                    "3 группы  11.23 ",
                    "- ЛОВЗ, пострадавшие в событиях 2010 г.  12    ",
                    "пострадавшие в событиях 2010 г. года г. Бишкек, Талас  12.1  ",
                    "1 группы  12.1.1",
                    "2 группы  12.1.2",
                    "3 группы  12.1.3",
                    "- ЛОВЗ, пострадавшие в событиях 2010 года г. Ош, Жалал-Абад  12.2  ",
                    "1 группы  12.2.1",
                    "2 группы  12.2.2",
                    "3 группы  12.2.3"
                };
                var items = new List<Report7_1_Item>();
                int i2 = 1;
                foreach (var i in docs)
                {
                    var item = new Report7_1_Item();
                    item.rowName = i;
                    item.rowNo = i2;
                    i2++;
                    items.Add(item);
                }
                CalcItems(context, /*report, */year, orgId, distrSpr, items[54], items[53],
                    items[52], items[51], items[50], items[49], items[48], items[47], items[46],
                    items[45], items[44], items[43], items[42], items[41], items[40], items[39],
                    items[38], items[37], items[36], items[35], items[34], items[33], items[32],
                    items[31], items[30], items[29], items[28], items[27], items[26], items[25],
                    items[24], items[23], items[22], items[21], items[20], items[19], items[18],
                    items[17], items[16], items[15], items[14], items[13], items[12], items[11],
                    items[10], items[9], items[8], items[7], items[6], items[5], items[4],
                    items[3], items[2], items[1], items[0]);
                return items;
            }
            public static void CalcItems(WorkflowContext context, int year, Guid orgId, string distrSpr,
                Report7_1_Item item55, Report7_1_Item item54, Report7_1_Item item53, Report7_1_Item item52,
                Report7_1_Item item51, Report7_1_Item item50, Report7_1_Item item49, Report7_1_Item item48,
                Report7_1_Item item47, Report7_1_Item item46, Report7_1_Item item45, Report7_1_Item item44,
                Report7_1_Item item43, Report7_1_Item item42, Report7_1_Item item41, Report7_1_Item item40,
                Report7_1_Item item39, Report7_1_Item item38, Report7_1_Item item37, Report7_1_Item item36,
                Report7_1_Item item35, Report7_1_Item item34, Report7_1_Item item33, Report7_1_Item item32,
                Report7_1_Item item31, Report7_1_Item item30, Report7_1_Item item29, Report7_1_Item item28,
                Report7_1_Item item27, Report7_1_Item item26, Report7_1_Item item25, Report7_1_Item item24,
                Report7_1_Item item23, Report7_1_Item item22, Report7_1_Item item21, Report7_1_Item item20,
                Report7_1_Item item19, Report7_1_Item item18, Report7_1_Item item17, Report7_1_Item item16,
                Report7_1_Item item15, Report7_1_Item item14, Report7_1_Item item13, Report7_1_Item item12,
                Report7_1_Item item11, Report7_1_Item item10, Report7_1_Item item9, Report7_1_Item item8,
                Report7_1_Item item7, Report7_1_Item item6, Report7_1_Item item5, Report7_1_Item item4,
                Report7_1_Item item3, Report7_1_Item item2, Report7_1_Item item1)
            {
                var qb = new QueryBuilder(adultsStatCardDefId, context.UserId);
                qb.Where("&State").Eq(ApprovedStateId).And("Examination1").Eq(primaryEnumId);

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                    var actSrc = query.JoinSource(query.Source, adultsActDefId, SqlSourceJoinType.Inner, "AdultsMedicalCertificate");
                    var distrSrc = query.JoinSource(actSrc, districtDefId, SqlSourceJoinType.LeftOuter, "DistrictId");
                    var citySrc = query.JoinSource(actSrc, cityDefId, SqlSourceJoinType.LeftOuter, "CityId");
                    query.AddCondition(ExpressionOperation.And, adultsStatCardDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    if (!string.IsNullOrEmpty(distrSpr))
                        query.AddCondition(ExpressionOperation.And, districtDefId, "NumberDis", ConditionOperation.Equal, distrSpr);

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(query.Source, "EndDateExamination");
                    query.AddAttribute(query.Source, "GoalSurvey");
                    query.AddAttribute(query.Source, "AgeOf");
                    query.AddAttribute(distrSrc, "DistrictType");
                    query.AddAttribute(citySrc, "DistrictType");
                    query.AddAttribute(query.Source, "DisabilityGroup");
                    query.AddAttribute(query.Source, "CauseOfDisability");
                    query.AddAttribute(personSrc, "Gender");
                    
                    var table = new DataTable();
                    using (var reader = context.CreateSqlReader(query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var date = !(row[1] is DBNull) ? (DateTime)row[1] : DateTime.MinValue;
                        var goalSurvey = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                        var ageOf = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                        var district = row[4] is DBNull ? Guid.Empty : (Guid)row[4];
                        var city = row[5] is DBNull ? Guid.Empty : (Guid)row[5];
                        var group = row[6] is DBNull ? Guid.Empty : (Guid)row[6];
                        var reasonDis = row[7] is DBNull ? Guid.Empty : (Guid)row[7];
                        var gender = row[8] is DBNull ? Guid.Empty : (Guid)row[8];
                        
                        if (appId != Guid.Empty)
                        {
                            if (date.Year == year)
                            {
                                //переосви-о всего
                                item1.gr3 = item1.gr3 != 0 ? (1 + (int)item1.gr3) : 1;
                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                {
                                    item1.gr4 = item1.gr4 != 0 ? (1 + (int)item1.gr4) : 1;
                                    if (district == cityEnumId || city == cityEnumId)
                                    {
                                        item1.gr5 = item1.gr5 != 0 ? (1 + (int)item1.gr5) : 1;
                                    }
                                    else
                                        item1.gr6 = item1.gr6 != 0 ? (1 + (int)item1.gr6) : 1; 
                                }
                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                {
                                    item1.gr7 = item1.gr7 != 0 ? (1 + (int)item1.gr7) : 1;
                                    if (district == cityEnumId || city == cityEnumId)
                                    {
                                        item1.gr8 = item1.gr8 != 0 ? (1 + (int)item1.gr8) : 1;
                                    }
                                    else
                                        item1.gr9 = item1.gr9 != 0 ? (1 + (int)item1.gr9) : 1;
                                }
                                if (goalSurvey == goalForGroup)
                                {
                                    item2.gr3 = item2.gr3 != 0 ? (1 + (int)item2.gr3) : 1;
                                    if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                    {
                                        item2.gr4 = item2.gr4 != 0 ? (1 + (int)item2.gr4) : 1;
                                        if (district == cityEnumId || city == cityEnumId)
                                        {
                                            item2.gr5 = item2.gr5 != 0 ? (1 + (int)item2.gr5) : 1;
                                        }
                                        else
                                            item2.gr6 = item2.gr6 != 0 ? (1 + (int)item2.gr6) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId) //пенсионный возраст
                                    {
                                        item2.gr7 = item2.gr7 != 0 ? (1 + (int)item2.gr7) : 1;
                                        if (district == cityEnumId || city == cityEnumId)
                                        {
                                            item2.gr8 = item2.gr8 != 0 ? (1 + (int)item2.gr8) : 1;
                                        }
                                        else
                                            item2.gr9 = item2.gr9 != 0 ? (1 + (int)item2.gr9) : 1;
                                    }
                                    if (group == notInstalled) //инвалидами не признано 
                                    {
                                        item3.gr3 = item3.gr3 != 0 ? (1 + (int)item3.gr3) : 1;
                                        if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                        {
                                            item3.gr4 = item3.gr4 != 0 ? (1 + (int)item3.gr4) : 1;
                                            if (district == cityEnumId || city == cityEnumId)
                                            {
                                                item3.gr5 = item3.gr5 != 0 ? (1 + (int)item3.gr5) : 1;
                                            }
                                            else
                                                item3.gr6 = item3.gr6 != 0 ? (1 + (int)item3.gr6) : 1;
                                        }
                                        if (ageOf == ageOf4EnumId) //пенсионный возраст
                                        {
                                            item3.gr7 = item3.gr7 != 0 ? (1 + (int)item3.gr7) : 1;
                                            if (district == cityEnumId || city == cityEnumId)
                                            {
                                                item3.gr8 = item3.gr8 != 0 ? (1 + (int)item3.gr8) : 1;
                                            }
                                            else
                                                item3.gr9 = item3.gr9 != 0 ? (1 + (int)item3.gr9) : 1;
                                        }
                                    }
                                    if (group == group1EnumId || group == group2EnumId || group == group3EnumId)
                                    {
                                        item4.gr3 = item4.gr3 != 0 ? (1 + (int)item4.gr3) : 1;
                                        if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                        {
                                            item4.gr4 = item4.gr4 != 0 ? (1 + (int)item4.gr4) : 1;
                                            if (district == cityEnumId || city == cityEnumId)
                                            {
                                                item4.gr5 = item4.gr5 != 0 ? (1 + (int)item4.gr5) : 1;
                                            }
                                            else
                                                item4.gr6 = item4.gr6 != 0 ? (1 + (int)item4.gr6) : 1;
                                        }
                                        if (ageOf == ageOf4EnumId) //пенсионный возраст
                                        {
                                            item4.gr7 = item4.gr7 != 0 ? (1 + (int)item4.gr7) : 1;
                                            if (district == cityEnumId || city == cityEnumId)
                                            {
                                                item4.gr8 = item4.gr8 != 0 ? (1 + (int)item4.gr8) : 1;
                                            }
                                            else
                                                item4.gr9 = item4.gr9 != 0 ? (1 + (int)item4.gr9) : 1;
                                        }
                                        if (gender == womanEnumId)
                                        {
                                            item5.gr3 = item5.gr3 != 0 ? (1 + (int)item5.gr3) : 1;
                                            if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                            {
                                                item5.gr4 = item5.gr4 != 0 ? (1 + (int)item5.gr4) : 1;
                                                if (district == cityEnumId || city == cityEnumId)
                                                {
                                                    item5.gr5 = item5.gr5 != 0 ? (1 + (int)item5.gr5) : 1;
                                                }
                                                else
                                                    item5.gr6 = item5.gr6 != 0 ? (1 + (int)item5.gr6) : 1;
                                            }
                                            if (ageOf == ageOf4EnumId) //пенсионный возраст
                                            {
                                                item5.gr7 = item5.gr7 != 0 ? (1 + (int)item5.gr7) : 1;
                                                if (district == cityEnumId || city == cityEnumId)
                                                {
                                                    item5.gr8 = item5.gr8 != 0 ? (1 + (int)item5.gr8) : 1;
                                                }
                                                else
                                                    item5.gr9 = item5.gr9 != 0 ? (1 + (int)item5.gr9) : 1;
                                            }
                                        }
                                        //инвалиды вследствие труд. увечья
                                        if (reasonDis == reasonDisEnumdId3) 
                                        {
                                            item6.gr3 = item6.gr3 != 0 ? (1 + (int)item6.gr3) : 1;
                                            if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                            {
                                                item6.gr4 = item6.gr4 != 0 ? (1 + (int)item6.gr4) : 1;
                                                if (district == cityEnumId || city == cityEnumId)
                                                {
                                                    item6.gr5 = item6.gr5 != 0 ? (1 + (int)item6.gr5) : 1;
                                                }
                                                else
                                                    item6.gr6 = item6.gr6 != 0 ? (1 + (int)item6.gr6) : 1;
                                            }
                                            if (ageOf == ageOf4EnumId) //пенсионный возраст
                                            {
                                                item6.gr7 = item6.gr7 != 0 ? (1 + (int)item6.gr7) : 1;
                                                if (district == cityEnumId || city == cityEnumId)
                                                {
                                                    item6.gr8 = item6.gr8 != 0 ? (1 + (int)item6.gr8) : 1;
                                                }
                                                else
                                                    item6.gr9 = item6.gr9 != 0 ? (1 + (int)item6.gr9) : 1;
                                            }
                                            if (group == group1EnumId)
                                            {
                                                item7.gr3 = item7.gr3 != 0 ? (1 + (int)item7.gr3) : 1;
                                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                {
                                                    item7.gr4 = item7.gr4 != 0 ? (1 + (int)item7.gr4) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item7.gr5 = item7.gr5 != 0 ? (1 + (int)item7.gr5) : 1;
                                                    }
                                                    else
                                                        item7.gr6 = item7.gr6 != 0 ? (1 + (int)item7.gr6) : 1;
                                                }
                                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                {
                                                    item7.gr7 = item7.gr7 != 0 ? (1 + (int)item7.gr7) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item7.gr8 = item7.gr8 != 0 ? (1 + (int)item7.gr8) : 1;
                                                    }
                                                    else
                                                        item7.gr9 = item7.gr9 != 0 ? (1 + (int)item7.gr9) : 1;
                                                }
                                            }
                                            if (group == group2EnumId)
                                            {
                                                item8.gr3 = item8.gr3 != 0 ? (1 + (int)item8.gr3) : 1;
                                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                {
                                                    item8.gr4 = item8.gr4 != 0 ? (1 + (int)item8.gr4) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item8.gr5 = item8.gr5 != 0 ? (1 + (int)item8.gr5) : 1;
                                                    }
                                                    else
                                                        item8.gr6 = item8.gr6 != 0 ? (1 + (int)item8.gr6) : 1;
                                                }
                                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                {
                                                    item8.gr7 = item8.gr7 != 0 ? (1 + (int)item8.gr7) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item8.gr8 = item8.gr8 != 0 ? (1 + (int)item8.gr8) : 1;
                                                    }
                                                    else
                                                        item8.gr9 = item8.gr9 != 0 ? (1 + (int)item8.gr9) : 1;
                                                }
                                            }
                                            if (group == group3EnumId)
                                            {
                                                item9.gr3 = item9.gr3 != 0 ? (1 + (int)item9.gr3) : 1;
                                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                {
                                                    item9.gr4 = item9.gr4 != 0 ? (1 + (int)item9.gr4) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item9.gr5 = item9.gr5 != 0 ? (1 + (int)item9.gr5) : 1;
                                                    }
                                                    else
                                                        item9.gr6 = item9.gr6 != 0 ? (1 + (int)item9.gr6) : 1;
                                                }
                                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                {
                                                    item9.gr7 = item9.gr7 != 0 ? (1 + (int)item9.gr7) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item9.gr8 = item9.gr8 != 0 ? (1 + (int)item9.gr8) : 1;
                                                    }
                                                    else
                                                        item9.gr9 = item9.gr9 != 0 ? (1 + (int)item9.gr9) : 1;
                                                }
                                            }
                                        }
                                        //инвалиды вследствие профзаболевания
                                        if (reasonDis == reasonDisEnumdId4)
                                        {
                                            item10.gr3 = item10.gr3 != 0 ? (1 + (int)item10.gr3) : 1;
                                            if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                            {
                                                item10.gr4 = item10.gr4 != 0 ? (1 + (int)item10.gr4) : 1;
                                                if (district == cityEnumId || city == cityEnumId)
                                                {
                                                    item10.gr5 = item10.gr5 != 0 ? (1 + (int)item10.gr5) : 1;
                                                }
                                                else
                                                    item10.gr6 = item10.gr6 != 0 ? (1 + (int)item10.gr6) : 1;
                                            }
                                            if (ageOf == ageOf4EnumId) //пенсионный возраст
                                            {
                                                item10.gr7 = item10.gr7 != 0 ? (1 + (int)item10.gr7) : 1;
                                                if (district == cityEnumId || city == cityEnumId)
                                                {
                                                    item10.gr8 = item10.gr8 != 0 ? (1 + (int)item10.gr8) : 1;
                                                }
                                                else
                                                    item10.gr9 = item10.gr9 != 0 ? (1 + (int)item10.gr9) : 1;
                                            }
                                            if (group == group1EnumId)
                                            {
                                                item11.gr3 = item11.gr3 != 0 ? (1 + (int)item11.gr3) : 1;
                                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                {
                                                    item11.gr4 = item11.gr4 != 0 ? (1 + (int)item11.gr4) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item11.gr5 = item11.gr5 != 0 ? (1 + (int)item11.gr5) : 1;
                                                    }
                                                    else
                                                        item11.gr6 = item11.gr6 != 0 ? (1 + (int)item11.gr6) : 1;
                                                }
                                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                {
                                                    item11.gr7 = item11.gr7 != 0 ? (1 + (int)item11.gr7) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item11.gr8 = item11.gr8 != 0 ? (1 + (int)item11.gr8) : 1;
                                                    }
                                                    else
                                                        item11.gr9 = item11.gr9 != 0 ? (1 + (int)item11.gr9) : 1;
                                                }
                                            }
                                            if (group == group2EnumId)
                                            {
                                                item12.gr3 = item12.gr3 != 0 ? (1 + (int)item12.gr3) : 1;
                                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                {
                                                    item12.gr4 = item12.gr4 != 0 ? (1 + (int)item12.gr4) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item12.gr5 = item12.gr5 != 0 ? (1 + (int)item12.gr5) : 1;
                                                    }
                                                    else
                                                        item12.gr6 = item12.gr6 != 0 ? (1 + (int)item12.gr6) : 1;
                                                }
                                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                {
                                                    item12.gr7 = item12.gr7 != 0 ? (1 + (int)item12.gr7) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item12.gr8 = item12.gr8 != 0 ? (1 + (int)item12.gr8) : 1;
                                                    }
                                                    else
                                                        item12.gr9 = item12.gr9 != 0 ? (1 + (int)item12.gr9) : 1;
                                                }
                                            }
                                            if (group == group3EnumId)
                                            {
                                                item13.gr3 = item13.gr3 != 0 ? (1 + (int)item13.gr3) : 1;
                                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                {
                                                    item13.gr4 = item13.gr4 != 0 ? (1 + (int)item13.gr4) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item13.gr5 = item13.gr5 != 0 ? (1 + (int)item13.gr5) : 1;
                                                    }
                                                    else
                                                        item13.gr6 = item13.gr6 != 0 ? (1 + (int)item13.gr6) : 1;
                                                }
                                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                {
                                                    item13.gr7 = item13.gr7 != 0 ? (1 + (int)item13.gr7) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item13.gr8 = item13.gr8 != 0 ? (1 + (int)item13.gr8) : 1;
                                                    }
                                                    else
                                                        item13.gr9 = item13.gr9 != 0 ? (1 + (int)item13.gr9) : 1;
                                                }
                                            }
                                        }
                                        // Заболевание связано с катастрофой на ЧАЭС
                                        if (reasonDis == reasonDisEnumdId13)
                                        {
                                            item14.gr3 = item14.gr3 != 0 ? (1 + (int)item14.gr3) : 1;
                                            if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                            {
                                                item14.gr4 = item14.gr4 != 0 ? (1 + (int)item14.gr4) : 1;
                                                if (district == cityEnumId || city == cityEnumId)
                                                {
                                                    item14.gr5 = item14.gr5 != 0 ? (1 + (int)item14.gr5) : 1;
                                                }
                                                else
                                                    item14.gr6 = item14.gr6 != 0 ? (1 + (int)item14.gr6) : 1;
                                            }
                                            if (ageOf == ageOf4EnumId) //пенсионный возраст
                                            {
                                                item14.gr7 = item14.gr7 != 0 ? (1 + (int)item14.gr7) : 1;
                                                if (district == cityEnumId || city == cityEnumId)
                                                {
                                                    item14.gr8 = item14.gr8 != 0 ? (1 + (int)item14.gr8) : 1;
                                                }
                                                else
                                                    item14.gr9 = item14.gr9 != 0 ? (1 + (int)item14.gr9) : 1;
                                            }
                                            if (group == group1EnumId)
                                            {
                                                item15.gr3 = item15.gr3 != 0 ? (1 + (int)item15.gr3) : 1;
                                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                {
                                                    item15.gr4 = item15.gr4 != 0 ? (1 + (int)item15.gr4) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item15.gr5 = item15.gr5 != 0 ? (1 + (int)item15.gr5) : 1;
                                                    }
                                                    else
                                                        item15.gr6 = item15.gr6 != 0 ? (1 + (int)item15.gr6) : 1;
                                                }
                                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                {
                                                    item15.gr7 = item15.gr7 != 0 ? (1 + (int)item15.gr7) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item15.gr8 = item15.gr8 != 0 ? (1 + (int)item15.gr8) : 1;
                                                    }
                                                    else
                                                        item15.gr9 = item15.gr9 != 0 ? (1 + (int)item15.gr9) : 1;
                                                }
                                            }
                                            if (group == group2EnumId)
                                            {
                                                item16.gr3 = item16.gr3 != 0 ? (1 + (int)item16.gr3) : 1;
                                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                {
                                                    item16.gr4 = item16.gr4 != 0 ? (1 + (int)item16.gr4) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item16.gr5 = item16.gr5 != 0 ? (1 + (int)item16.gr5) : 1;
                                                    }
                                                    else
                                                        item16.gr6 = item16.gr6 != 0 ? (1 + (int)item16.gr6) : 1;
                                                }
                                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                {
                                                    item16.gr7 = item16.gr7 != 0 ? (1 + (int)item16.gr7) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item16.gr8 = item16.gr8 != 0 ? (1 + (int)item16.gr8) : 1;
                                                    }
                                                    else
                                                        item16.gr9 = item16.gr9 != 0 ? (1 + (int)item16.gr9) : 1;
                                                }
                                            }
                                            if (group == group3EnumId)
                                            {
                                                item17.gr3 = item17.gr3 != 0 ? (1 + (int)item17.gr3) : 1;
                                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                {
                                                    item17.gr4 = item17.gr4 != 0 ? (1 + (int)item17.gr4) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item17.gr5 = item17.gr5 != 0 ? (1 + (int)item17.gr5) : 1;
                                                    }
                                                    else
                                                        item17.gr6 = item17.gr6 != 0 ? (1 + (int)item17.gr6) : 1;
                                                }
                                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                {
                                                    item17.gr7 = item17.gr7 != 0 ? (1 + (int)item17.gr7) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item17.gr8 = item17.gr8 != 0 ? (1 + (int)item17.gr8) : 1;
                                                    }
                                                    else
                                                        item17.gr9 = item17.gr9 != 0 ? (1 + (int)item17.gr9) : 1;
                                                }
                                            }
                                        }
                                        // ЧАЭС - из них: - при выполнении обязанностей военной службы
                                        if (reasonDis == reasonDisEnumdId13)
                                        {
                                            item18.gr3 = item18.gr3 != 0 ? (1 + (int)item18.gr3) : 1;
                                            if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                            {
                                                item18.gr4 = item18.gr4 != 0 ? (1 + (int)item18.gr4) : 1;
                                                if (district == cityEnumId || city == cityEnumId)
                                                {
                                                    item18.gr5 = item18.gr5 != 0 ? (1 + (int)item18.gr5) : 1;
                                                }
                                                else
                                                    item18.gr6 = item18.gr6 != 0 ? (1 + (int)item18.gr6) : 1;
                                            }
                                            if (ageOf == ageOf4EnumId) //пенсионный возраст
                                            {
                                                item18.gr7 = item18.gr7 != 0 ? (1 + (int)item18.gr7) : 1;
                                                if (district == cityEnumId || city == cityEnumId)
                                                {
                                                    item18.gr8 = item18.gr8 != 0 ? (1 + (int)item18.gr8) : 1;
                                                }
                                                else
                                                    item18.gr9 = item18.gr9 != 0 ? (1 + (int)item18.gr9) : 1;
                                            }
                                            if (group == group1EnumId)
                                            {
                                                item19.gr3 = item19.gr3 != 0 ? (1 + (int)item19.gr3) : 1;
                                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                {
                                                    item19.gr4 = item19.gr4 != 0 ? (1 + (int)item19.gr4) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item19.gr5 = item19.gr5 != 0 ? (1 + (int)item19.gr5) : 1;
                                                    }
                                                    else
                                                        item19.gr6 = item19.gr6 != 0 ? (1 + (int)item19.gr6) : 1;
                                                }
                                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                {
                                                    item19.gr7 = item19.gr7 != 0 ? (1 + (int)item19.gr7) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item19.gr8 = item19.gr8 != 0 ? (1 + (int)item19.gr8) : 1;
                                                    }
                                                    else
                                                        item19.gr9 = item19.gr9 != 0 ? (1 + (int)item19.gr9) : 1;
                                                }
                                            }
                                            if (group == group2EnumId)
                                            {
                                                item20.gr3 = item20.gr3 != 0 ? (1 + (int)item20.gr3) : 1;
                                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                {
                                                    item20.gr4 = item20.gr4 != 0 ? (1 + (int)item20.gr4) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item20.gr5 = item20.gr5 != 0 ? (1 + (int)item20.gr5) : 1;
                                                    }
                                                    else
                                                        item20.gr6 = item20.gr6 != 0 ? (1 + (int)item20.gr6) : 1;
                                                }
                                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                {
                                                    item20.gr7 = item20.gr7 != 0 ? (1 + (int)item20.gr7) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item20.gr8 = item20.gr8 != 0 ? (1 + (int)item20.gr8) : 1;
                                                    }
                                                    else
                                                        item20.gr9 = item20.gr9 != 0 ? (1 + (int)item20.gr9) : 1;
                                                }
                                            }
                                            if (group == group3EnumId)
                                            {
                                                item21.gr3 = item21.gr3 != 0 ? (1 + (int)item21.gr3) : 1;
                                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                {
                                                    item21.gr4 = item21.gr4 != 0 ? (1 + (int)item21.gr4) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item21.gr5 = item21.gr5 != 0 ? (1 + (int)item21.gr5) : 1;
                                                    }
                                                    else
                                                        item21.gr6 = item21.gr6 != 0 ? (1 + (int)item21.gr6) : 1;
                                                }
                                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                {
                                                    item21.gr7 = item21.gr7 != 0 ? (1 + (int)item21.gr7) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item21.gr8 = item21.gr8 != 0 ? (1 + (int)item21.gr8) : 1;
                                                    }
                                                    else
                                                        item21.gr9 = item21.gr9 != 0 ? (1 + (int)item21.gr9) : 1;
                                                }
                                            }
                                        }
                                        //инвалиды из числа военнослужащих
                                        if (reasonDis == reasonDisEnumdId5 || reasonDis == reasonDisEnumdId6)
                                        {
                                            item22.gr3 = item22.gr3 != 0 ? (1 + (int)item22.gr3) : 1;
                                            if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                            {
                                                item22.gr4 = item22.gr4 != 0 ? (1 + (int)item22.gr4) : 1;
                                                if (district == cityEnumId || city == cityEnumId)
                                                {
                                                    item22.gr5 = item22.gr5 != 0 ? (1 + (int)item22.gr5) : 1;
                                                }
                                                else
                                                    item22.gr6 = item22.gr6 != 0 ? (1 + (int)item22.gr6) : 1;
                                            }
                                            if (ageOf == ageOf4EnumId) //пенсионный возраст
                                            {
                                                item22.gr7 = item22.gr7 != 0 ? (1 + (int)item22.gr7) : 1;
                                                if (district == cityEnumId || city == cityEnumId)
                                                {
                                                    item22.gr8 = item22.gr8 != 0 ? (1 + (int)item22.gr8) : 1;
                                                }
                                                else
                                                    item22.gr9 = item22.gr9 != 0 ? (1 + (int)item22.gr9) : 1;
                                            }
                                            if (group == group1EnumId)
                                            {
                                                item23.gr3 = item23.gr3 != 0 ? (1 + (int)item23.gr3) : 1;
                                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                {
                                                    item23.gr4 = item23.gr4 != 0 ? (1 + (int)item23.gr4) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item23.gr5 = item23.gr5 != 0 ? (1 + (int)item23.gr5) : 1;
                                                    }
                                                    else
                                                        item23.gr6 = item23.gr6 != 0 ? (1 + (int)item23.gr6) : 1;
                                                }
                                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                {
                                                    item23.gr7 = item23.gr7 != 0 ? (1 + (int)item23.gr7) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item23.gr8 = item23.gr8 != 0 ? (1 + (int)item23.gr8) : 1;
                                                    }
                                                    else
                                                        item23.gr9 = item23.gr9 != 0 ? (1 + (int)item23.gr9) : 1;
                                                }
                                            }
                                            if (group == group2EnumId)
                                            {
                                                item24.gr3 = item24.gr3 != 0 ? (1 + (int)item24.gr3) : 1;
                                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                {
                                                    item24.gr4 = item24.gr4 != 0 ? (1 + (int)item24.gr4) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item24.gr5 = item24.gr5 != 0 ? (1 + (int)item24.gr5) : 1;
                                                    }
                                                    else
                                                        item24.gr6 = item24.gr6 != 0 ? (1 + (int)item24.gr6) : 1;
                                                }
                                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                {
                                                    item24.gr7 = item24.gr7 != 0 ? (1 + (int)item24.gr7) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item24.gr8 = item24.gr8 != 0 ? (1 + (int)item24.gr8) : 1;
                                                    }
                                                    else
                                                        item24.gr9 = item24.gr9 != 0 ? (1 + (int)item24.gr9) : 1;
                                                }
                                            }
                                            if (group == group3EnumId)
                                            {
                                                item25.gr3 = item25.gr3 != 0 ? (1 + (int)item25.gr3) : 1;
                                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                {
                                                    item25.gr4 = item25.gr4 != 0 ? (1 + (int)item25.gr4) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item25.gr5 = item25.gr5 != 0 ? (1 + (int)item25.gr5) : 1;
                                                    }
                                                    else
                                                        item25.gr6 = item25.gr6 != 0 ? (1 + (int)item25.gr6) : 1;
                                                }
                                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                {
                                                    item25.gr7 = item25.gr7 != 0 ? (1 + (int)item25.gr7) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item25.gr8 = item25.gr8 != 0 ? (1 + (int)item25.gr8) : 1;
                                                    }
                                                    else
                                                        item25.gr9 = item25.gr9 != 0 ? (1 + (int)item25.gr9) : 1;
                                                }
                                            }
                                            //из них при выполнении обязанностей военной службы
                                            if (reasonDis == reasonDisEnumdId6)
                                            {
                                                item26.gr3 = item26.gr3 != 0 ? (1 + (int)item26.gr3) : 1;
                                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                {
                                                    item26.gr4 = item26.gr4 != 0 ? (1 + (int)item26.gr4) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item26.gr5 = item26.gr5 != 0 ? (1 + (int)item26.gr5) : 1;
                                                    }
                                                    else
                                                        item26.gr6 = item26.gr6 != 0 ? (1 + (int)item26.gr6) : 1;
                                                }
                                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                {
                                                    item26.gr7 = item26.gr7 != 0 ? (1 + (int)item26.gr7) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item26.gr8 = item26.gr8 != 0 ? (1 + (int)item26.gr8) : 1;
                                                    }
                                                    else
                                                        item26.gr9 = item26.gr9 != 0 ? (1 + (int)item26.gr9) : 1;
                                                }
                                                if (group == group1EnumId)
                                                {
                                                    item27.gr3 = item27.gr3 != 0 ? (1 + (int)item27.gr3) : 1;
                                                    if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                    {
                                                        item27.gr4 = item27.gr4 != 0 ? (1 + (int)item27.gr4) : 1;
                                                        if (district == cityEnumId || city == cityEnumId)
                                                        {
                                                            item27.gr5 = item27.gr5 != 0 ? (1 + (int)item27.gr5) : 1;
                                                        }
                                                        else
                                                            item27.gr6 = item27.gr6 != 0 ? (1 + (int)item27.gr6) : 1;
                                                    }
                                                    if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                    {
                                                        item27.gr7 = item27.gr7 != 0 ? (1 + (int)item27.gr7) : 1;
                                                        if (district == cityEnumId || city == cityEnumId)
                                                        {
                                                            item27.gr8 = item27.gr8 != 0 ? (1 + (int)item27.gr8) : 1;
                                                        }
                                                        else
                                                            item27.gr9 = item27.gr9 != 0 ? (1 + (int)item27.gr9) : 1;
                                                    }
                                                }
                                                if (group == group2EnumId)
                                                {
                                                    item28.gr3 = item28.gr3 != 0 ? (1 + (int)item28.gr3) : 1;
                                                    if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                    {
                                                        item28.gr4 = item28.gr4 != 0 ? (1 + (int)item28.gr4) : 1;
                                                        if (district == cityEnumId || city == cityEnumId)
                                                        {
                                                            item28.gr5 = item28.gr5 != 0 ? (1 + (int)item28.gr5) : 1;
                                                        }
                                                        else
                                                            item28.gr6 = item28.gr6 != 0 ? (1 + (int)item28.gr6) : 1;
                                                    }
                                                    if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                    {
                                                        item28.gr7 = item28.gr7 != 0 ? (1 + (int)item28.gr7) : 1;
                                                        if (district == cityEnumId || city == cityEnumId)
                                                        {
                                                            item28.gr8 = item28.gr8 != 0 ? (1 + (int)item28.gr8) : 1;
                                                        }
                                                        else
                                                            item28.gr9 = item28.gr9 != 0 ? (1 + (int)item28.gr9) : 1;
                                                    }
                                                }
                                                if (group == group3EnumId)
                                                {
                                                    item29.gr3 = item29.gr3 != 0 ? (1 + (int)item29.gr3) : 1;
                                                    if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                    {
                                                        item29.gr4 = item29.gr4 != 0 ? (1 + (int)item29.gr4) : 1;
                                                        if (district == cityEnumId || city == cityEnumId)
                                                        {
                                                            item29.gr5 = item29.gr5 != 0 ? (1 + (int)item29.gr5) : 1;
                                                        }
                                                        else
                                                            item29.gr6 = item29.gr6 != 0 ? (1 + (int)item29.gr6) : 1;
                                                    }
                                                    if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                    {
                                                        item29.gr7 = item29.gr7 != 0 ? (1 + (int)item29.gr7) : 1;
                                                        if (district == cityEnumId || city == cityEnumId)
                                                        {
                                                            item29.gr8 = item29.gr8 != 0 ? (1 + (int)item29.gr8) : 1;
                                                        }
                                                        else
                                                            item29.gr9 = item29.gr9 != 0 ? (1 + (int)item29.gr9) : 1;
                                                    }
                                                }
                                            }
                                            //в период прохождения военной службы
                                            if (reasonDis == reasonDisEnumdId5)
                                            {
                                                item30.gr3 = item30.gr3 != 0 ? (1 + (int)item30.gr3) : 1;
                                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                {
                                                    item30.gr4 = item30.gr4 != 0 ? (1 + (int)item30.gr4) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item30.gr5 = item30.gr5 != 0 ? (1 + (int)item30.gr5) : 1;
                                                    }
                                                    else
                                                        item30.gr6 = item30.gr6 != 0 ? (1 + (int)item30.gr6) : 1;
                                                }
                                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                {
                                                    item30.gr7 = item30.gr7 != 0 ? (1 + (int)item30.gr7) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item30.gr8 = item30.gr8 != 0 ? (1 + (int)item30.gr8) : 1;
                                                    }
                                                    else
                                                        item30.gr9 = item30.gr9 != 0 ? (1 + (int)item30.gr9) : 1;
                                                }
                                                if (group == group1EnumId)
                                                {
                                                    item31.gr3 = item31.gr3 != 0 ? (1 + (int)item31.gr3) : 1;
                                                    if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                    {
                                                        item31.gr4 = item31.gr4 != 0 ? (1 + (int)item31.gr4) : 1;
                                                        if (district == cityEnumId || city == cityEnumId)
                                                        {
                                                            item31.gr5 = item31.gr5 != 0 ? (1 + (int)item31.gr5) : 1;
                                                        }
                                                        else
                                                            item31.gr6 = item31.gr6 != 0 ? (1 + (int)item31.gr6) : 1;
                                                    }
                                                    if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                    {
                                                        item31.gr7 = item31.gr7 != 0 ? (1 + (int)item31.gr7) : 1;
                                                        if (district == cityEnumId || city == cityEnumId)
                                                        {
                                                            item31.gr8 = item31.gr8 != 0 ? (1 + (int)item31.gr8) : 1;
                                                        }
                                                        else
                                                            item31.gr9 = item31.gr9 != 0 ? (1 + (int)item31.gr9) : 1;
                                                    }
                                                }
                                                if (group == group2EnumId)
                                                {
                                                    item32.gr3 = item32.gr3 != 0 ? (1 + (int)item32.gr3) : 1;
                                                    if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                    {
                                                        item32.gr4 = item32.gr4 != 0 ? (1 + (int)item32.gr4) : 1;
                                                        if (district == cityEnumId || city == cityEnumId)
                                                        {
                                                            item32.gr5 = item32.gr5 != 0 ? (1 + (int)item32.gr5) : 1;
                                                        }
                                                        else
                                                            item32.gr6 = item32.gr6 != 0 ? (1 + (int)item32.gr6) : 1;
                                                    }
                                                    if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                    {
                                                        item32.gr7 = item32.gr7 != 0 ? (1 + (int)item32.gr7) : 1;
                                                        if (district == cityEnumId || city == cityEnumId)
                                                        {
                                                            item32.gr8 = item32.gr8 != 0 ? (1 + (int)item32.gr8) : 1;
                                                        }
                                                        else
                                                            item32.gr9 = item32.gr9 != 0 ? (1 + (int)item32.gr9) : 1;
                                                    }
                                                }
                                                if (group == group3EnumId)
                                                {
                                                    item33.gr3 = item33.gr3 != 0 ? (1 + (int)item33.gr3) : 1;
                                                    if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                    {
                                                        item33.gr4 = item33.gr4 != 0 ? (1 + (int)item33.gr4) : 1;
                                                        if (district == cityEnumId || city == cityEnumId)
                                                        {
                                                            item33.gr5 = item33.gr5 != 0 ? (1 + (int)item33.gr5) : 1;
                                                        }
                                                        else
                                                            item33.gr6 = item33.gr6 != 0 ? (1 + (int)item33.gr6) : 1;
                                                    }
                                                    if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                    {
                                                        item33.gr7 = item33.gr7 != 0 ? (1 + (int)item33.gr7) : 1;
                                                        if (district == cityEnumId || city == cityEnumId)
                                                        {
                                                            item33.gr8 = item33.gr8 != 0 ? (1 + (int)item33.gr8) : 1;
                                                        }
                                                        else
                                                            item33.gr9 = item33.gr9 != 0 ? (1 + (int)item33.gr9) : 1;
                                                    }
                                                }
                                            }
                                        }
                                        // Общее заболевание
                                        if (reasonDis == reasonDisEnumdId1)
                                        {
                                            item34.gr3 = item34.gr3 != 0 ? (1 + (int)item34.gr3) : 1;
                                            if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                            {
                                                item34.gr4 = item34.gr4 != 0 ? (1 + (int)item34.gr4) : 1;
                                                if (district == cityEnumId || city == cityEnumId)
                                                {
                                                    item34.gr5 = item34.gr5 != 0 ? (1 + (int)item34.gr5) : 1;
                                                }
                                                else
                                                    item34.gr6 = item34.gr6 != 0 ? (1 + (int)item34.gr6) : 1;
                                            }
                                            if (ageOf == ageOf4EnumId) //пенсионный возраст
                                            {
                                                item34.gr7 = item34.gr7 != 0 ? (1 + (int)item34.gr7) : 1;
                                                if (district == cityEnumId || city == cityEnumId)
                                                {
                                                    item34.gr8 = item34.gr8 != 0 ? (1 + (int)item34.gr8) : 1;
                                                }
                                                else
                                                    item34.gr9 = item34.gr9 != 0 ? (1 + (int)item34.gr9) : 1;
                                            }
                                            if (group == group1EnumId)
                                            {
                                                item35.gr3 = item35.gr3 != 0 ? (1 + (int)item35.gr3) : 1;
                                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                {
                                                    item35.gr4 = item35.gr4 != 0 ? (1 + (int)item35.gr4) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item35.gr5 = item35.gr5 != 0 ? (1 + (int)item35.gr5) : 1;
                                                    }
                                                    else
                                                        item35.gr6 = item35.gr6 != 0 ? (1 + (int)item35.gr6) : 1;
                                                }
                                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                {
                                                    item35.gr7 = item35.gr7 != 0 ? (1 + (int)item35.gr7) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item35.gr8 = item35.gr8 != 0 ? (1 + (int)item35.gr8) : 1;
                                                    }
                                                    else
                                                        item35.gr9 = item35.gr9 != 0 ? (1 + (int)item35.gr9) : 1;
                                                }
                                            }
                                            if (group == group2EnumId)
                                            {
                                                item36.gr3 = item36.gr3 != 0 ? (1 + (int)item36.gr3) : 1;
                                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                {
                                                    item36.gr4 = item36.gr4 != 0 ? (1 + (int)item36.gr4) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item36.gr5 = item36.gr5 != 0 ? (1 + (int)item36.gr5) : 1;
                                                    }
                                                    else
                                                        item36.gr6 = item36.gr6 != 0 ? (1 + (int)item36.gr6) : 1;
                                                }
                                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                {
                                                    item36.gr7 = item36.gr7 != 0 ? (1 + (int)item36.gr7) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item36.gr8 = item36.gr8 != 0 ? (1 + (int)item36.gr8) : 1;
                                                    }
                                                    else
                                                        item36.gr9 = item36.gr9 != 0 ? (1 + (int)item36.gr9) : 1;
                                                }
                                            }
                                            if (group == group3EnumId)
                                            {
                                                item37.gr3 = item37.gr3 != 0 ? (1 + (int)item37.gr3) : 1;
                                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                {
                                                    item37.gr4 = item37.gr4 != 0 ? (1 + (int)item37.gr4) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item37.gr5 = item37.gr5 != 0 ? (1 + (int)item37.gr5) : 1;
                                                    }
                                                    else
                                                        item37.gr6 = item37.gr6 != 0 ? (1 + (int)item37.gr6) : 1;
                                                }
                                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                {
                                                    item37.gr7 = item37.gr7 != 0 ? (1 + (int)item37.gr7) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item37.gr8 = item37.gr8 != 0 ? (1 + (int)item37.gr8) : 1;
                                                    }
                                                    else
                                                        item37.gr9 = item37.gr9 != 0 ? (1 + (int)item37.gr9) : 1;
                                                }
                                            }
                                        }
                                        // ЛОВЗ с детства
                                        if (reasonDis == reasonDisEnumdId2)
                                        {
                                            item38.gr3 = item38.gr3 != 0 ? (1 + (int)item38.gr3) : 1;
                                            if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                            {
                                                item38.gr4 = item38.gr4 != 0 ? (1 + (int)item38.gr4) : 1;
                                                if (district == cityEnumId || city == cityEnumId)
                                                {
                                                    item38.gr5 = item38.gr5 != 0 ? (1 + (int)item38.gr5) : 1;
                                                }
                                                else
                                                    item38.gr6 = item38.gr6 != 0 ? (1 + (int)item38.gr6) : 1;
                                            }
                                            if (ageOf == ageOf4EnumId) //пенсионный возраст
                                            {
                                                item38.gr7 = item38.gr7 != 0 ? (1 + (int)item38.gr7) : 1;
                                                if (district == cityEnumId || city == cityEnumId)
                                                {
                                                    item38.gr8 = item38.gr8 != 0 ? (1 + (int)item38.gr8) : 1;
                                                }
                                                else
                                                    item38.gr9 = item38.gr9 != 0 ? (1 + (int)item38.gr9) : 1;
                                            }
                                            /*item 39 ????????*/
                                            //*****************************************//
                                            if (group == group1EnumId)
                                            {
                                                item40.gr3 = item40.gr3 != 0 ? (1 + (int)item40.gr3) : 1;
                                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                {
                                                    item40.gr4 = item40.gr4 != 0 ? (1 + (int)item40.gr4) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item40.gr5 = item40.gr5 != 0 ? (1 + (int)item40.gr5) : 1;
                                                    }
                                                    else
                                                        item40.gr6 = item40.gr6 != 0 ? (1 + (int)item40.gr6) : 1;
                                                }
                                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                {
                                                    item40.gr7 = item40.gr7 != 0 ? (1 + (int)item40.gr7) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item40.gr8 = item40.gr8 != 0 ? (1 + (int)item40.gr8) : 1;
                                                    }
                                                    else
                                                        item40.gr9 = item40.gr9 != 0 ? (1 + (int)item40.gr9) : 1;
                                                }
                                            }
                                            if (group == group2EnumId)
                                            {
                                                item41.gr3 = item41.gr3 != 0 ? (1 + (int)item41.gr3) : 1;
                                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                {
                                                    item41.gr4 = item41.gr4 != 0 ? (1 + (int)item41.gr4) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item41.gr5 = item41.gr5 != 0 ? (1 + (int)item41.gr5) : 1;
                                                    }
                                                    else
                                                        item41.gr6 = item41.gr6 != 0 ? (1 + (int)item41.gr6) : 1;
                                                }
                                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                {
                                                    item41.gr7 = item41.gr7 != 0 ? (1 + (int)item41.gr7) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item41.gr8 = item41.gr8 != 0 ? (1 + (int)item41.gr8) : 1;
                                                    }
                                                    else
                                                        item41.gr9 = item41.gr9 != 0 ? (1 + (int)item41.gr9) : 1;
                                                }
                                            }
                                            if (group == group3EnumId)
                                            {
                                                item42.gr3 = item42.gr3 != 0 ? (1 + (int)item42.gr3) : 1;
                                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                {
                                                    item42.gr4 = item42.gr4 != 0 ? (1 + (int)item42.gr4) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item42.gr5 = item42.gr5 != 0 ? (1 + (int)item42.gr5) : 1;
                                                    }
                                                    else
                                                        item42.gr6 = item42.gr6 != 0 ? (1 + (int)item42.gr6) : 1;
                                                }
                                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                {
                                                    item42.gr7 = item42.gr7 != 0 ? (1 + (int)item42.gr7) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item42.gr8 = item42.gr8 != 0 ? (1 + (int)item42.gr8) : 1;
                                                    }
                                                    else
                                                        item42.gr9 = item42.gr9 != 0 ? (1 + (int)item42.gr9) : 1;
                                                }
                                            }
                                        }
                                        // инвалиды пострадавшие в событиях 2010г
                                        if (reasonDis == reasonDisEnumdId15 || reasonDis == reasonDisEnumdId16 ||
                                            reasonDis == reasonDisEnumdId17 || reasonDis == reasonDisEnumdId18)
                                        {
                                            item47.gr3 = item47.gr3 != 0 ? (1 + (int)item47.gr3) : 1;
                                            if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                            {
                                                item47.gr4 = item47.gr4 != 0 ? (1 + (int)item47.gr4) : 1;
                                                if (district == cityEnumId || city == cityEnumId)
                                                {
                                                    item47.gr5 = item47.gr5 != 0 ? (1 + (int)item47.gr5) : 1;
                                                }
                                                else
                                                    item47.gr6 = item47.gr6 != 0 ? (1 + (int)item47.gr6) : 1;
                                            }
                                            if (ageOf == ageOf4EnumId) //пенсионный возраст
                                            {
                                                item47.gr7 = item47.gr7 != 0 ? (1 + (int)item47.gr7) : 1;
                                                if (district == cityEnumId || city == cityEnumId)
                                                {
                                                    item47.gr8 = item47.gr8 != 0 ? (1 + (int)item47.gr8) : 1;
                                                }
                                                else
                                                    item47.gr9 = item47.gr9 != 0 ? (1 + (int)item47.gr9) : 1;
                                            }
                                            if (reasonDis == reasonDisEnumdId15 || reasonDis == reasonDisEnumdId16) //Бишкек/Талас 2010г
                                            {
                                                item48.gr3 = item48.gr3 != 0 ? (1 + (int)item48.gr3) : 1;
                                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                {
                                                    item48.gr4 = item48.gr4 != 0 ? (1 + (int)item48.gr4) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item48.gr5 = item48.gr5 != 0 ? (1 + (int)item48.gr5) : 1;
                                                    }
                                                    else
                                                        item48.gr6 = item48.gr6 != 0 ? (1 + (int)item48.gr6) : 1;
                                                }
                                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                {
                                                    item48.gr7 = item48.gr7 != 0 ? (1 + (int)item48.gr7) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item48.gr8 = item48.gr8 != 0 ? (1 + (int)item48.gr8) : 1;
                                                    }
                                                    else
                                                        item48.gr9 = item48.gr9 != 0 ? (1 + (int)item48.gr9) : 1;
                                                }
                                                if (group == group1EnumId)
                                                {
                                                    item49.gr3 = item49.gr3 != 0 ? (1 + (int)item49.gr3) : 1;
                                                    if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                    {
                                                        item49.gr4 = item49.gr4 != 0 ? (1 + (int)item49.gr4) : 1;
                                                        if (district == cityEnumId || city == cityEnumId)
                                                        {
                                                            item49.gr5 = item49.gr5 != 0 ? (1 + (int)item49.gr5) : 1;
                                                        }
                                                        else
                                                            item49.gr6 = item49.gr6 != 0 ? (1 + (int)item49.gr6) : 1;
                                                    }
                                                    if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                    {
                                                        item49.gr7 = item49.gr7 != 0 ? (1 + (int)item49.gr7) : 1;
                                                        if (district == cityEnumId || city == cityEnumId)
                                                        {
                                                            item49.gr8 = item49.gr8 != 0 ? (1 + (int)item49.gr8) : 1;
                                                        }
                                                        else
                                                            item49.gr9 = item49.gr9 != 0 ? (1 + (int)item49.gr9) : 1;
                                                    }
                                                }
                                                if (group == group2EnumId)
                                                {
                                                    item50.gr3 = item50.gr3 != 0 ? (1 + (int)item50.gr3) : 1;
                                                    if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                    {
                                                        item50.gr4 = item50.gr4 != 0 ? (1 + (int)item50.gr4) : 1;
                                                        if (district == cityEnumId || city == cityEnumId)
                                                        {
                                                            item50.gr5 = item50.gr5 != 0 ? (1 + (int)item50.gr5) : 1;
                                                        }
                                                        else
                                                            item50.gr6 = item50.gr6 != 0 ? (1 + (int)item50.gr6) : 1;
                                                    }
                                                    if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                    {
                                                        item50.gr7 = item50.gr7 != 0 ? (1 + (int)item50.gr7) : 1;
                                                        if (district == cityEnumId || city == cityEnumId)
                                                        {
                                                            item50.gr8 = item50.gr8 != 0 ? (1 + (int)item50.gr8) : 1;
                                                        }
                                                        else
                                                            item50.gr9 = item50.gr9 != 0 ? (1 + (int)item50.gr9) : 1;
                                                    }
                                                }
                                                if (group == group3EnumId)
                                                {
                                                    item51.gr3 = item51.gr3 != 0 ? (1 + (int)item51.gr3) : 1;
                                                    if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                    {
                                                        item51.gr4 = item51.gr4 != 0 ? (1 + (int)item51.gr4) : 1;
                                                        if (district == cityEnumId || city == cityEnumId)
                                                        {
                                                            item51.gr5 = item51.gr5 != 0 ? (1 + (int)item51.gr5) : 1;
                                                        }
                                                        else
                                                            item51.gr6 = item51.gr6 != 0 ? (1 + (int)item51.gr6) : 1;
                                                    }
                                                    if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                    {
                                                        item51.gr7 = item51.gr7 != 0 ? (1 + (int)item51.gr7) : 1;
                                                        if (district == cityEnumId || city == cityEnumId)
                                                        {
                                                            item51.gr8 = item51.gr8 != 0 ? (1 + (int)item51.gr8) : 1;
                                                        }
                                                        else
                                                            item51.gr9 = item51.gr9 != 0 ? (1 + (int)item51.gr9) : 1;
                                                    }
                                                }
                                            }
                                            if (reasonDis == reasonDisEnumdId17 || reasonDis == reasonDisEnumdId18) //Ош/Жалал-Абад 2010г
                                            {
                                                item52.gr3 = item52.gr3 != 0 ? (1 + (int)item52.gr3) : 1;
                                                if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                {
                                                    item52.gr4 = item52.gr4 != 0 ? (1 + (int)item52.gr4) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item52.gr5 = item52.gr5 != 0 ? (1 + (int)item52.gr5) : 1;
                                                    }
                                                    else
                                                        item52.gr6 = item52.gr6 != 0 ? (1 + (int)item52.gr6) : 1;
                                                }
                                                if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                {
                                                    item52.gr7 = item52.gr7 != 0 ? (1 + (int)item52.gr7) : 1;
                                                    if (district == cityEnumId || city == cityEnumId)
                                                    {
                                                        item52.gr8 = item52.gr8 != 0 ? (1 + (int)item52.gr8) : 1;
                                                    }
                                                    else
                                                        item52.gr9 = item52.gr9 != 0 ? (1 + (int)item52.gr9) : 1;
                                                }
                                                if (group == group1EnumId)
                                                {
                                                    item53.gr3 = item53.gr3 != 0 ? (1 + (int)item53.gr3) : 1;
                                                    if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                    {
                                                        item53.gr4 = item53.gr4 != 0 ? (1 + (int)item53.gr4) : 1;
                                                        if (district == cityEnumId || city == cityEnumId)
                                                        {
                                                            item53.gr5 = item53.gr5 != 0 ? (1 + (int)item53.gr5) : 1;
                                                        }
                                                        else
                                                            item53.gr6 = item53.gr6 != 0 ? (1 + (int)item53.gr6) : 1;
                                                    }
                                                    if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                    {
                                                        item53.gr7 = item53.gr7 != 0 ? (1 + (int)item53.gr7) : 1;
                                                        if (district == cityEnumId || city == cityEnumId)
                                                        {
                                                            item53.gr8 = item53.gr8 != 0 ? (1 + (int)item53.gr8) : 1;
                                                        }
                                                        else
                                                            item53.gr9 = item53.gr9 != 0 ? (1 + (int)item53.gr9) : 1;
                                                    }
                                                }
                                                if (group == group2EnumId)
                                                {
                                                    item54.gr3 = item54.gr3 != 0 ? (1 + (int)item54.gr3) : 1;
                                                    if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                    {
                                                        item54.gr4 = item54.gr4 != 0 ? (1 + (int)item54.gr4) : 1;
                                                        if (district == cityEnumId || city == cityEnumId)
                                                        {
                                                            item54.gr5 = item54.gr5 != 0 ? (1 + (int)item54.gr5) : 1;
                                                        }
                                                        else
                                                            item54.gr6 = item54.gr6 != 0 ? (1 + (int)item54.gr6) : 1;
                                                    }
                                                    if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                    {
                                                        item54.gr7 = item54.gr7 != 0 ? (1 + (int)item54.gr7) : 1;
                                                        if (district == cityEnumId || city == cityEnumId)
                                                        {
                                                            item54.gr8 = item54.gr8 != 0 ? (1 + (int)item54.gr8) : 1;
                                                        }
                                                        else
                                                            item54.gr9 = item54.gr9 != 0 ? (1 + (int)item54.gr9) : 1;
                                                    }
                                                }
                                                if (group == group3EnumId)
                                                {
                                                    item55.gr3 = item55.gr3 != 0 ? (1 + (int)item55.gr3) : 1;
                                                    if (ageOf != Guid.Empty && ageOf != ageOf4EnumId) //трудоспособный возраст
                                                    {
                                                        item55.gr4 = item55.gr4 != 0 ? (1 + (int)item55.gr4) : 1;
                                                        if (district == cityEnumId || city == cityEnumId)
                                                        {
                                                            item55.gr5 = item55.gr5 != 0 ? (1 + (int)item55.gr5) : 1;
                                                        }
                                                        else
                                                            item55.gr6 = item55.gr6 != 0 ? (1 + (int)item55.gr6) : 1;
                                                    }
                                                    if (ageOf == ageOf4EnumId) //пенсионный возраст
                                                    {
                                                        item55.gr7 = item55.gr7 != 0 ? (1 + (int)item55.gr7) : 1;
                                                        if (district == cityEnumId || city == cityEnumId)
                                                        {
                                                            item55.gr8 = item55.gr8 != 0 ? (1 + (int)item55.gr8) : 1;
                                                        }
                                                        else
                                                            item55.gr9 = item55.gr9 != 0 ? (1 + (int)item55.gr9) : 1;
                                                    }
                                                }
                                            }

                                        }


                                    }
                                }
                            }
                        }
                    }
                }
            }
            static void RemoveRows(WorkflowContext context, Guid reportId)
            {
                var docRepo = context.Documents;
                var rows = new List<Guid>();
                var qb = new QueryBuilder(reportItemDefId, context.UserId);
                qb.Where("Report").Eq(reportId).Or("Report").IsNull();
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read()) rows.Add(reader.GetGuid(0));
                }
                foreach (var rowId in rows)
                {
                    docRepo.DeleteById(rowId);
                }
            }
            private static readonly Guid reportDefId = new Guid("{17789FEE-2908-4E01-8E16-2ECAF4A75C7A}"); //Отчет о распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности
            private static readonly Guid reportItemDefId = new Guid("{10AB1374-EA9C-493B-B5F6-CD6A40273B9B}"); //Распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности

            private static readonly Guid adultsStatCardDefId = new Guid("{C77A6FF6-EC0B-4562-81FE-BB3BC17F4FDB}"); //Статистический талон для взрослых
            private static readonly Guid adultsActDefId = new Guid("{12AE380B-39CE-4753-A556-4083BD4B0F92}"); //Медицинский акт для взрослых
            private static readonly Guid personDefId = new Guid("{D71CE61A-9B59-4B5E-8713-8131DBB5BA02}"); //Person 
            public static readonly Guid districtDefId = new Guid("{A3FCA356-82A9-4BBD-872A-8333BEC6E41A}"); //Район
            public static readonly Guid cityDefId = new Guid("{4BB6D32D-5181-4031-BA49-CF5910D6D883}"); //Города районного значения

            public static readonly Guid goalForGroup = new Guid("{8FD84B27-FF2A-40A4-A87A-BC254DC9D853}"); //Цель -> Для установления группы

            public static readonly Guid ageOf1EnumId = new Guid("{027AEA0C-3C1D-4354-BEFF-4C89E06AF8B5}"); //От 18-29 лет
            public static readonly Guid ageOf2EnumId = new Guid("{6FC02932-97DD-48B9-93C8-FBD017C86707}"); //От 30-44 лет
            public static readonly Guid ageOf3EnumId = new Guid("{336A7447-4E55-44B8-8BA0-D7A156B7444A}"); //От 45-до пенсионного возраста
            public static readonly Guid ageOf4EnumId = new Guid("{9B207DB0-8214-4BA7-A8C4-635EF87B583A}"); //лицо пенсионного возраста

            public static readonly Guid group1EnumId = new Guid("{D145ABA1-EADA-442B-9D8D-AD10BCD126D2}"); //Первая
            public static readonly Guid group2EnumId = new Guid("{C161DA2D-2883-4211-B444-CBB04DBF33D5}"); //Вторая
            public static readonly Guid group3EnumId = new Guid("{CCD439CA-1500-4F7A-A1C8-BB474B5DE8AA}"); //Третья
            public static readonly Guid notInstalled = new Guid("{C52CCD68-96D8-4E0A-A8ED-30B482C1CF18}"); //Не установлена

            public static readonly Guid cityEnumId = new Guid("{DE3D24A1-64D3-4647-B711-31F334D24416}"); //Городская местность//DistrictType
            public static readonly Guid villageEnumId = new Guid("{65DF9C4D-A18B-4080-855F-4800E2A19C35}"); //Cская местность//DistrictType
            public static readonly Guid womanEnumId = new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"); //Женский пол
            public static readonly Guid primaryEnumId = new Guid("{34129BC5-5B31-4189-87FA-799402F7E99F}"); //Первичное
            public static readonly Guid ApprovedStateId = new Guid("{32062CB7-C31C-4AFB-ADF3-F9F9AEEFCE59}");  //Подписанные

            //причины инвалидности
            private static readonly Guid reasonDisEnumdId1 = new Guid("{3A8053A5-CD06-49D3-A551-2247655B13C3}"); //	Общее заболевание
            private static readonly Guid reasonDisEnumdId2 = new Guid("{9AF55221-0264-4349-9B36-A8E1313250B6}"); //	ЛОВЗ с детства
            private static readonly Guid reasonDisEnumdId3 = new Guid("{2E3209F0-0002-4DA2-9E63-6FAEDDF1983D}"); //	Трудовое увечье
            private static readonly Guid reasonDisEnumdId4 = new Guid("{383E70E5-E9BE-4AE5-B5DF-323D4463DD51}"); //	Профессиональное заболевание
            private static readonly Guid reasonDisEnumdId5 = new Guid("{0CD8E76E-CF20-41CF-B7EE-4FE85EA39435}"); //	Военная травма (если увечье, заболевание получено лицом, проходящим освидетельствование, при "исполнении обязанностей военной службы")
            private static readonly Guid reasonDisEnumdId6 = new Guid("{4A8BC253-701C-44FB-B840-10F6BD8E97BD}"); //	Заболевание "получено в период прохождения военной службы"
            private static readonly Guid reasonDisEnumdId7 = new Guid("{1A607F61-EDDD-4A7B-9FBF-55483127D986}"); //	Заболевание "нет, не связано с военной службой"
            private static readonly Guid reasonDisEnumdId8 = new Guid("{41313E17-2275-4027-9563-5323FF096E3F}"); //	Заболевание "да, получено в период прохождения службы" в органах внутренних дел
            private static readonly Guid reasonDisEnumdId9 = new Guid("{68E6804C-046A-45AD-9AD8-1C50C4026530}"); //	Заболевание "нет, не связано со службой в органах внутренних дел"
            private static readonly Guid reasonDisEnumdId10 = new Guid("{8AA8807E-A40A-44D2-839C-5270E9F2C52C}"); // Ранение (контузия, травма, увечье) "нет, не связано с военной службой"
            private static readonly Guid reasonDisEnumdId11= new Guid("{04F87DB6-EBB7-4B09-8856-F7DFF538479E}"); //	Ранение (контузия, травма, увечье) "да, получено при защите СССР"
            private static readonly Guid reasonDisEnumdId12 = new Guid("{119DC79B-42D0-4102-AE42-A902A4EF806B}"); // Ранение (контузия, травма, увечье) "да, получено при исполнении обязанностей службы в органах внутренних дел"
            private static readonly Guid reasonDisEnumdId13 = new Guid("{A6EABF70-F864-4A97-B528-839DE6607B07}"); // Заболевание связано с катастрофой на ЧАЭС
            private static readonly Guid reasonDisEnumdId14 = new Guid("{9FB37C19-2251-41FD-ABAA-7E3CD243CCDF}"); // Заболевание связано с испытанием ядерного оружия на Семипалатинском полигоне
            private static readonly Guid reasonDisEnumdId15 = new Guid("{1A2B628F-CC8C-49C9-8774-561EB1812AE5}"); // Травма, полученная в событиях, произошедших 6 апреля 2010 года в Таласской области КР
            private static readonly Guid reasonDisEnumdId16 = new Guid("{6FF1C743-3767-4D73-A035-1F8647C88F5F}"); // Травма, полученная в событиях, произошедших 7 апреля 2010 года в городе Бишкек КР
            private static readonly Guid reasonDisEnumdId17 = new Guid("{9289772B-C917-4EC0-BC60-45D69BA8D855}"); // Травма, полученная в событиях, произошедших 13-14, а также 19 мая 2010 года в городе Джалал-Абад КР
            private static readonly Guid reasonDisEnumdId18 = new Guid("{99159F4A-BB7C-4A5C-AD48-B71E7592DF08}"); // Травма, полученная в июньских событиях 2010 года в городе Ош и Ошской, Джалал-Абадской областях КР
        }

        //Результаты переосвидетельствования ЛОВЗ из числа ЛОВЗ от ТРУДОВОЕ УВЕЧЬЕ, имеющих группу инвалидности
        public static class RepetExamInvalidsLaborInjury
        {
            public static List<Report7_2Item> Execute(WorkflowContext context, int year, string distrSpr)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;

                var docs = new string[]
                {
                    "всего  с группой   ",
                    "в том числе: I группа  03",
                    "II группа  04",
                    "III группа  05"
                };
                var items = new List<Report7_2Item>();
                int i2 = 1;
                foreach (var i in docs)
                {
                    var item = new Report7_2Item();
                    item.RowName = i;
                    item.RowNo = i2;
                    i2++;
                    items.Add(item);
                }
                CalcItems(context, /*report*/ year, orgId, distrSpr,  items[3], items[2], items[1], items[0]);
                return items;
            }
            public static void CalcItems(WorkflowContext context, int year, Guid orgId, string distrSpr, Report7_2Item item3, Report7_2Item item2, Report7_2Item item1, Report7_2Item item0)
            {
                var qb = new QueryBuilder(adultsActDefId, context.UserId);
                qb.Where("&State").Eq(ApprovedStateId).And("Examination1").Eq(repetEnumId);

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                    query.AddCondition(ExpressionOperation.And, adultsActDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    if (!string.IsNullOrEmpty(distrSpr))
                        query.AddCondition(ExpressionOperation.And, districtDefId, "NumberDis", ConditionOperation.Equal, distrSpr);

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(query.Source, "EndDateExamination");
                    query.AddAttribute(personSrc, "Gender");
                    query.AddAttribute(query.Source, "DisabilityGroup");
                    query.AddAttribute(query.Source, "Indefinitely");
                    query.AddAttribute(query.Source, "CauseOfDisability");

                    var table = new DataTable();
                    using (var reader = context.CreateSqlReader(query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var date = !(row[1] is DBNull) ? (DateTime)row[1] : DateTime.MinValue;
                        var gender = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                        var group = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                        var indef = row[4] is DBNull ? false : (bool)row[4];
                        var reasonDis = row[5] is DBNull ? Guid.Empty : (Guid)row[5];
                        var dinamic = getDinamic(context, appId);
                        var dinamicGroup = Guid.Empty;
                        var dinamicGod = "";
                        if (dinamic != null)
                        {
                            dinamicGroup = (Guid)dinamic[0];
                            dinamicGod = (string)dinamic[1];
                        }

                        if (appId != Guid.Empty)
                        {
                            if (date.Year == year && reasonDis == reasonDisEnumdId)
                            {
                                if (dinamicGroup != Guid.Empty)
                                {
                                    item0.gr1 = item0.gr1 != 0 ? (1 + (int)item0.gr1) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item0.gr2 = item0.gr2 != 0 ? (1 + (int)item0.gr2) : 1;
                                    }
                                    //из них признаны инвалидами
                                    if (group == group1EnumId || group == group2EnumId || group == disGroup3EnumId)
                                    {
                                        item0.gr3 = item0.gr3 != 0 ? (1 + (int)item0.gr3) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item0.gr4 = item0.gr4 != 0 ? (1 + (int)item0.gr4) : 1;
                                        }
                                        if (indef)
                                        {
                                            item0.gr5 = item0.gr5 != 0 ? (1 + (int)item0.gr5) : 1;
                                        }
                                        if (group == group1EnumId) item0.gr6 = item0.gr6 != 0 ? (1 + (int)item0.gr6) : 1;
                                        if (group == group2EnumId) item0.gr8 = item0.gr8 != 0 ? (1 + (int)item0.gr8) : 1;
                                        if (group == group3EnumId) item0.gr10 = item0.gr10 != 0 ? (1 + (int)item0.gr10) : 1;
                                    }
                                    if (group == notSetGrEnumId) item0.gr12 = item0.gr12 != 0 ? (1 + (int)item0.gr12) : 1;
                                    //if (group == notSetGrEnumId) item0.gr13 = item0.gr13 != 0 ? (1 + (int)item0.gr13) : 1;                                 
                                }
                                //I гр.
                                if (dinamicGroup == disGroup1EnumId)
                                {
                                    item1.gr1 = item1.gr1 != 0 ? (1 + (int)item1.gr1) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item1.gr2 = item1.gr2 != 0 ? (1 + (int)item1.gr2) : 1;
                                    }
                                    //из них признаны инвалидами
                                    if (group == group1EnumId || group == group2EnumId || group == disGroup3EnumId)
                                    {
                                        item1.gr3 = item1.gr3 != 0 ? (1 + (int)item1.gr3) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item1.gr4 = item1.gr4 != 0 ? (1 + (int)item1.gr4) : 1;
                                        }
                                        if (indef)
                                        {
                                            item1.gr5 = item1.gr5 != 0 ? (1 + (int)item1.gr5) : 1;
                                        }
                                        if (group == group1EnumId) item1.gr6 = item1.gr6 != 0 ? (1 + (int)item1.gr6) : 1;
                                        if (group == group2EnumId) item1.gr8 = item1.gr8 != 0 ? (1 + (int)item1.gr8) : 1;
                                        if (group == group3EnumId) item1.gr10 = item1.gr10 != 0 ? (1 + (int)item1.gr10) : 1;
                                    }
                                    if (group == notSetGrEnumId) item1.gr12 = item1.gr12 != 0 ? (1 + (int)item1.gr12) : 1;
                                    //if (group == notSetGrEnumId) item1.gr13 = item1.gr13 != 0 ? (1 + (int)item1.gr13) : 1;                                 
                                }
                                //II гр.
                                if (dinamicGroup == disGroup2EnumId)
                                {
                                    item2.gr1 = item2.gr1 != 0 ? (1 + (int)item2.gr1) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item2.gr2 = item2.gr2 != 0 ? (1 + (int)item2.gr2) : 1;
                                    }
                                    //из них признаны инвалидами
                                    if (group == group1EnumId || group == group2EnumId || group == disGroup3EnumId)
                                    {
                                        item2.gr3 = item2.gr3 != 0 ? (1 + (int)item2.gr3) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.gr4 = item2.gr4 != 0 ? (1 + (int)item2.gr4) : 1;
                                        }
                                        if (indef)
                                        {
                                            item2.gr5 = item2.gr5 != 0 ? (1 + (int)item2.gr5) : 1;
                                        }
                                        if (group == group1EnumId) item2.gr6 = item2.gr6 != 0 ? (1 + (int)item2.gr6) : 1;
                                        if (group == group2EnumId) item2.gr8 = item2.gr8 != 0 ? (1 + (int)item2.gr8) : 1;
                                        if (group == group3EnumId) item2.gr10 = item2.gr10 != 0 ? (1 + (int)item2.gr10) : 1;
                                    }
                                    //not set group
                                    if (group == notSetGrEnumId) item2.gr12 = item2.gr12 != 0 ? (1 + (int)item2.gr12) : 1;
                                    //if (group == notSetGrEnumId) item2.gr13 = item2.gr13 != 0 ? (1 + (int)item2.gr13) : 1;                                 
                                }
                                //III гр.
                                if (dinamicGroup == disGroup3EnumId)
                                {
                                    item3.gr1 = item3.gr1 != 0 ? (1 + (int)item3.gr1) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item3.gr2 = item3.gr2 != 0 ? (1 + (int)item3.gr2) : 1;
                                    }
                                    //из них признаны инвалидами
                                    if (group == group1EnumId || group == group2EnumId || group == disGroup3EnumId)
                                    {
                                        item3.gr3 = item3.gr3 != 0 ? (1 + (int)item3.gr3) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.gr4 = item3.gr4 != 0 ? (1 + (int)item3.gr4) : 1;
                                        }
                                        if (indef)
                                        {
                                            item3.gr5 = item3.gr5 != 0 ? (1 + (int)item3.gr5) : 1;
                                        }
                                        if (group == group1EnumId) item3.gr6 = item3.gr6 != 0 ? (1 + (int)item3.gr6) : 1;
                                        if (group == group2EnumId) item3.gr8 = item3.gr8 != 0 ? (1 + (int)item3.gr8) : 1;
                                        if (group == group3EnumId) item3.gr10 = item3.gr10 != 0 ? (1 + (int)item3.gr10) : 1;
                                    }
                                    if (group == notSetGrEnumId) item3.gr12 = item3.gr12 != 0 ? (1 + (int)item3.gr12) : 1;
                                    //if (group == notSetGrEnumId) item3.gr13 = item3.gr13 != 0 ? (1 + (int)item3.gr13) : 1;                                 
                                }
                            }
                        }
                    }
                }
            }
            static object[] getDinamic(WorkflowContext context, Guid appId)
            {
                var qb = new QueryBuilder(dinamicDefId, context.UserId);
                qb.Where("AdultsMedicalCertificate").Eq(appId);
                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    query.AddAttribute(query.Source, "DisabilityGroup");
                    query.AddAttribute(query.Source, "Year");
                    query.AddOrderAttribute("Year", false);
                    using (var reader = context.CreateSqlReader(query))
                    {
                        if (reader.Read())
                        {
                            var dinamicGroup = reader.IsDbNull(0) ? Guid.Empty : reader.GetGuid(0);
                            var dinamicGod = reader.IsDbNull(1) ? string.Empty : reader.GetString(1);
                            return new object[] { dinamicGroup, dinamicGod };
                        }
                    }
                }
                return null;
            }
            static void RemoveRows(WorkflowContext context, Guid reportId)
            {
                var docRepo = context.Documents;
                var rows = new List<Guid>();
                var qb = new QueryBuilder(reportItemDefId, context.UserId);
                qb.Where("Report").Eq(reportId).Or("Report").IsNull();
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read()) rows.Add(reader.GetGuid(0));
                }
                foreach (var rowId in rows)
                {
                    docRepo.DeleteById(rowId);
                }
            }
            private static readonly Guid reportDefId = new Guid("{17789FEE-2908-4E01-8E16-2ECAF4A75C7A}"); //Отчет о распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности
            private static readonly Guid reportItemDefId = new Guid("{10AB1374-EA9C-493B-B5F6-CD6A40273B9B}"); //Распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности

            private static readonly Guid adultsActDefId = new Guid("{12AE380B-39CE-4753-A556-4083BD4B0F92}"); //Медицинский акт для взрослых
            private static readonly Guid dinamicDefId = new Guid("{FFBD36FF-615E-49F7-AB5B-9C787C07B981}"); //Динамика инвалидности
            private static readonly Guid personDefId = new Guid("{D71CE61A-9B59-4B5E-8713-8131DBB5BA02}"); //Person 
            public static readonly Guid districtDefId = new Guid("{A3FCA356-82A9-4BBD-872A-8333BEC6E41A}"); //Район
            public static readonly Guid cityDefId = new Guid("{4BB6D32D-5181-4031-BA49-CF5910D6D883}"); //Города районного значения

            public static readonly Guid repetEnumId = new Guid("{A1F1D6CD-C1CD-4BF8-8F4A-DA124D47C250}"); //Повторные
            public static readonly Guid pensionAge = new Guid("{9B207DB0-8214-4BA7-A8C4-635EF87B583A}"); //Лицо пенсионного возраста
            private static readonly Guid reasonDisEnumdId = new Guid("{2E3209F0-0002-4DA2-9E63-6FAEDDF1983D}"); //	Трудовое увечье

            //Группа инвалидности из динамики инвалидности
            public static readonly Guid disGroup1EnumId = new Guid("{8B2A4C4E-DBE7-4A49-AB2B-D788C22DC3D5}"); //I
            public static readonly Guid disGroup2EnumId = new Guid("{4E62F6B9-BDFA-4D92-97A0-1E0B3AEDB473}"); //II
            public static readonly Guid disGroup3EnumId = new Guid("{07F39539-FF02-4F5F-A4EA-D403AFB679CF}"); //III
            public static readonly Guid disChildEnumId = new Guid("{0643F3EA-94C5-4888-BCD3-2CCADE7A3AE4}"); //Ребенок инвалид

            public static readonly Guid group1EnumId = new Guid("{D145ABA1-EADA-442B-9D8D-AD10BCD126D2}"); //Первая
            public static readonly Guid group2EnumId = new Guid("{C161DA2D-2883-4211-B444-CBB04DBF33D5}"); //Вторая
            public static readonly Guid group3EnumId = new Guid("{CCD439CA-1500-4F7A-A1C8-BB474B5DE8AA}"); //Третья
            public static readonly Guid notSetGrEnumId = new Guid("{C52CCD68-96D8-4E0A-A8ED-30B482C1CF18}"); //Не установлена


            public static readonly Guid cityEnumId = new Guid("{DE3D24A1-64D3-4647-B711-31F334D24416}"); //Городская местность//DistrictType
            public static readonly Guid womanEnumId = new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"); //Женский пол
            public static readonly Guid primaryEnumId = new Guid("{34129BC5-5B31-4189-87FA-799402F7E99F}"); //Первичное

            public static readonly Guid ApprovedStateId = new Guid("{32062CB7-C31C-4AFB-ADF3-F9F9AEEFCE59}");  //Подписанные
        }

        //Результаты переосвидетельствования ЛОВЗ из числа ЛОВЗ от ТРУДОВОЕ УВЕЧЬЕ, имеющих УПТ в % без ГИ
        public static class RepetExamInvalidsUPT
        {
            public static List<Report7_3Item> Execute(WorkflowContext context, int year, string distrSpr)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;
                var items = new List<Report7_3Item>();                
                CalcItems(context, year, orgId, distrSpr, items);
                return items;
            }
            public static void CalcItems(WorkflowContext context, int year, Guid orgId, string distrSpr, List<Report7_3Item> items)
            {
                var qb = new QueryBuilder(adultsActDefId, context.UserId);
                qb.Where("&State").Eq(ApprovedStateId).And("Examination1").Eq(repetEnumId);

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                    query.AddCondition(ExpressionOperation.And, adultsActDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    if (!string.IsNullOrEmpty(distrSpr))
                        query.AddCondition(ExpressionOperation.And, districtDefId, "NumberDis", ConditionOperation.Equal, distrSpr);

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(query.Source, "EndDateExamination");
                    query.AddAttribute(personSrc, "Gender");
                    query.AddAttribute(query.Source, "DisabilityGroup");
                    query.AddAttribute(query.Source, "Indefinitely");
                    query.AddAttribute(query.Source, "CauseOfDisability");
                    query.AddAttribute(query.Source, "LossProfessionalActivities");
                    query.AddAttribute(query.Source, "goal2");
                    query.AddAttribute(query.Source, "ForTheLastTime");

                    var table = new DataTable();
                    using (var reader = context.CreateSqlReader(query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var date = !(row[1] is DBNull) ? (DateTime)row[1] : DateTime.MinValue;
                        var gender = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                        var group = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                        var indef = row[4] is DBNull ? false : (bool)row[4];
                        var reasonDis = row[5] is DBNull ? Guid.Empty : (Guid)row[5];
                        var upt = row[6] is DBNull ? Guid.Empty : (Guid)row[6];
                        var goalUpt = row[7] is DBNull ? false : (bool)row[7];
                        var uptLast = row[8] is DBNull ? Guid.Empty : (Guid)row[8];

                        var lastYear = year - 1;
                        var item = new Report7_3Item();
                        if (appId != Guid.Empty && goalUpt && reasonDis == reasonDisEnumdId)
                        {
                            item.gr1 += 1;
                            if (gender == womanEnumId) item.gr2 += 1;

                            if (upt != Guid.Empty)
                            {
                                item.gr3 += 1;
                                if (gender == womanEnumId) item.gr4 += 1;
                                if (indef) item.gr5 += 1;
                                if (group == group1EnumId) item.gr6 += 1;
                                if (group == group2EnumId) item.gr7 += 1;
                                if (group == group3EnumId) item.gr9 += 1;
                            }
                            items.Add(item);
                        }
                    }
                }
            }
            static object[] getDinamic(WorkflowContext context, Guid appId)
            {
                var qb = new QueryBuilder(dinamicDefId, context.UserId);
                qb.Where("AdultsMedicalCertificate").Eq(appId);
                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    query.AddAttribute(query.Source, "DisabilityGroup");
                    query.AddAttribute(query.Source, "Year");
                    query.AddOrderAttribute("Year", false);
                    using (var reader = context.CreateSqlReader(query))
                    {
                        if (reader.Read())
                        {
                            var dinamicGroup = reader.IsDbNull(0) ? Guid.Empty : reader.GetGuid(0);
                            var dinamicGod = reader.IsDbNull(1) ? string.Empty : reader.GetString(1);
                            return new object[] { dinamicGroup, dinamicGod };
                        }
                    }
                }
                return null;
            }
            static void RemoveRows(WorkflowContext context, Guid reportId)
            {
                var docRepo = context.Documents;
                var rows = new List<Guid>();
                var qb = new QueryBuilder(reportItemDefId, context.UserId);
                qb.Where("Report").Eq(reportId).Or("Report").IsNull();
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read()) rows.Add(reader.GetGuid(0));
                }
                foreach (var rowId in rows)
                {
                    docRepo.DeleteById(rowId);
                }
            }

            private static readonly Guid reportDefId = new Guid("{17789FEE-2908-4E01-8E16-2ECAF4A75C7A}"); //Отчет о распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности
            private static readonly Guid reportItemDefId = new Guid("{10AB1374-EA9C-493B-B5F6-CD6A40273B9B}"); //Распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности

            private static readonly Guid adultsActDefId = new Guid("{12AE380B-39CE-4753-A556-4083BD4B0F92}"); //Медицинский акт для взрослых
            private static readonly Guid dinamicDefId = new Guid("{FFBD36FF-615E-49F7-AB5B-9C787C07B981}"); //Динамика инвалидности
            private static readonly Guid personDefId = new Guid("{D71CE61A-9B59-4B5E-8713-8131DBB5BA02}"); //Person 
            public static readonly Guid districtDefId = new Guid("{A3FCA356-82A9-4BBD-872A-8333BEC6E41A}"); //Район
            public static readonly Guid cityDefId = new Guid("{4BB6D32D-5181-4031-BA49-CF5910D6D883}"); //Города районного значения

            public static readonly Guid repetEnumId = new Guid("{A1F1D6CD-C1CD-4BF8-8F4A-DA124D47C250}"); //Повторные
            public static readonly Guid pensionAge = new Guid("{9B207DB0-8214-4BA7-A8C4-635EF87B583A}"); //Лицо пенсионного возраста
            private static readonly Guid reasonDisEnumdId = new Guid("{2E3209F0-0002-4DA2-9E63-6FAEDDF1983D}"); //	Трудовое увечье

            //Группа инвалидности из динамики инвалидности
            public static readonly Guid disGroup1EnumId = new Guid("{8B2A4C4E-DBE7-4A49-AB2B-D788C22DC3D5}"); //I
            public static readonly Guid disGroup2EnumId = new Guid("{4E62F6B9-BDFA-4D92-97A0-1E0B3AEDB473}"); //II
            public static readonly Guid disGroup3EnumId = new Guid("{07F39539-FF02-4F5F-A4EA-D403AFB679CF}"); //III
            public static readonly Guid disChildEnumId = new Guid("{0643F3EA-94C5-4888-BCD3-2CCADE7A3AE4}"); //Ребенок инвалид

            public static readonly Guid group1EnumId = new Guid("{D145ABA1-EADA-442B-9D8D-AD10BCD126D2}"); //Первая
            public static readonly Guid group2EnumId = new Guid("{C161DA2D-2883-4211-B444-CBB04DBF33D5}"); //Вторая
            public static readonly Guid group3EnumId = new Guid("{CCD439CA-1500-4F7A-A1C8-BB474B5DE8AA}"); //Третья
            public static readonly Guid notSetGrEnumId = new Guid("{C52CCD68-96D8-4E0A-A8ED-30B482C1CF18}"); //Не установлена


            public static readonly Guid cityEnumId = new Guid("{DE3D24A1-64D3-4647-B711-31F334D24416}"); //Городская местность//DistrictType
            public static readonly Guid womanEnumId = new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"); //Женский пол
            public static readonly Guid primaryEnumId = new Guid("{34129BC5-5B31-4189-87FA-799402F7E99F}"); //Первичное

            public static readonly Guid ApprovedStateId = new Guid("{32062CB7-C31C-4AFB-ADF3-F9F9AEEFCE59}");  //Подписанные
        }
        //Результаты переосвидетельствования ЛОВЗ из числа ЛОВЗ от ПРОФ. ЗАБОЛЕВАНИЯ, имеющих группу инвалидности
        public static class RepetExamInvalidsProfDis
        {
            public static List<Report7_2Item> Execute(WorkflowContext context, int year, string distrSpr)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;

                var docs = new string[]
                {
                    "всего  с группой   ",
                    "в том числе: I группа  03",
                    "II группа  04",
                    "III группа  05"
                };
                var items = new List<Report7_2Item>();
                int i2 = 1;
                foreach (var i in docs)
                {
                    var item = new Report7_2Item();
                    item.RowName = i;
                    item.RowNo = i2;
                    i2++;
                    items.Add(item);
                }
                CalcItems(context, /*report*/ year, orgId, distrSpr, items[3], items[2], items[1], items[0]);
                return items;
            }
            public static void CalcItems(WorkflowContext context, int year, Guid orgId, string distrSpr, Report7_2Item item3, Report7_2Item item2, Report7_2Item item1, Report7_2Item item0)
            {
                var qb = new QueryBuilder(adultsActDefId, context.UserId);
                qb.Where("&State").Eq(ApprovedStateId).And("Examination1").Eq(repetEnumId);

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                    query.AddCondition(ExpressionOperation.And, adultsActDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    if (!string.IsNullOrEmpty(distrSpr))
                        query.AddCondition(ExpressionOperation.And, districtDefId, "NumberDis", ConditionOperation.Equal, distrSpr);

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(query.Source, "EndDateExamination");
                    query.AddAttribute(personSrc, "Gender");
                    query.AddAttribute(query.Source, "DisabilityGroup");
                    query.AddAttribute(query.Source, "Indefinitely");
                    query.AddAttribute(query.Source, "CauseOfDisability");

                    var table = new DataTable();
                    using (var reader = context.CreateSqlReader(query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var date = !(row[1] is DBNull) ? (DateTime)row[1] : DateTime.MinValue;
                        var gender = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                        var group = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                        var indef = row[4] is DBNull ? false : (bool)row[4];
                        var reasonDis = row[5] is DBNull ? Guid.Empty : (Guid)row[5];
                        var dinamic = getDinamic(context, appId);
                        var dinamicGroup = Guid.Empty;
                        var dinamicGod = "";
                        if (dinamic != null)
                        {
                            dinamicGroup = (Guid)dinamic[0];
                            dinamicGod = (string)dinamic[1];
                        }

                        if (appId != Guid.Empty)
                        {
                            if (date.Year == year && reasonDis == reasonDisEnumdId)
                            {
                                if (dinamicGroup != Guid.Empty)
                                {
                                    item0.gr1 = item0.gr1 != 0 ? (1 + (int)item0.gr1) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item0.gr2 = item0.gr2 != 0 ? (1 + (int)item0.gr2) : 1;
                                    }
                                    //из них признаны инвалидами
                                    if (group == group1EnumId || group == group2EnumId || group == disGroup3EnumId)
                                    {
                                        item0.gr3 = item0.gr3 != 0 ? (1 + (int)item0.gr3) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item0.gr4 = item0.gr4 != 0 ? (1 + (int)item0.gr4) : 1;
                                        }
                                        if (indef)
                                        {
                                            item0.gr5 = item0.gr5 != 0 ? (1 + (int)item0.gr5) : 1;
                                        }
                                        if (group == group1EnumId) item0.gr6 = item0.gr6 != 0 ? (1 + (int)item0.gr6) : 1;
                                        if (group == group2EnumId) item0.gr8 = item0.gr8 != 0 ? (1 + (int)item0.gr8) : 1;
                                        if (group == group3EnumId) item0.gr10 = item0.gr10 != 0 ? (1 + (int)item0.gr10) : 1;
                                    }
                                    if (group == notSetGrEnumId) item0.gr12 = item0.gr12 != 0 ? (1 + (int)item0.gr12) : 1;
                                    //if (group == notSetGrEnumId) item0.gr13 = item0.gr13 != 0 ? (1 + (int)item0.gr13) : 1;                                 
                                }
                                //I гр.
                                if (dinamicGroup == disGroup1EnumId)
                                {
                                    item1.gr1 = item1.gr1 != 0 ? (1 + (int)item1.gr1) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item1.gr2 = item1.gr2 != 0 ? (1 + (int)item1.gr2) : 1;
                                    }
                                    //из них признаны инвалидами
                                    if (group == group1EnumId || group == group2EnumId || group == disGroup3EnumId)
                                    {
                                        item1.gr3 = item1.gr3 != 0 ? (1 + (int)item1.gr3) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item1.gr4 = item1.gr4 != 0 ? (1 + (int)item1.gr4) : 1;
                                        }
                                        if (indef)
                                        {
                                            item1.gr5 = item1.gr5 != 0 ? (1 + (int)item1.gr5) : 1;
                                        }
                                        if (group == group1EnumId) item1.gr6 = item1.gr6 != 0 ? (1 + (int)item1.gr6) : 1;
                                        if (group == group2EnumId) item1.gr8 = item1.gr8 != 0 ? (1 + (int)item1.gr8) : 1;
                                        if (group == group3EnumId) item1.gr10 = item1.gr10 != 0 ? (1 + (int)item1.gr10) : 1;
                                    }
                                    if (group == notSetGrEnumId) item1.gr12 = item1.gr12 != 0 ? (1 + (int)item1.gr12) : 1;
                                    //if (group == notSetGrEnumId) item1.gr13 = item1.gr13 != 0 ? (1 + (int)item1.gr13) : 1;                                 
                                }
                                //II гр.
                                if (dinamicGroup == disGroup2EnumId)
                                {
                                    item2.gr1 = item2.gr1 != 0 ? (1 + (int)item2.gr1) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item2.gr2 = item2.gr2 != 0 ? (1 + (int)item2.gr2) : 1;
                                    }
                                    //из них признаны инвалидами
                                    if (group == group1EnumId || group == group2EnumId || group == disGroup3EnumId)
                                    {
                                        item2.gr3 = item2.gr3 != 0 ? (1 + (int)item2.gr3) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item2.gr4 = item2.gr4 != 0 ? (1 + (int)item2.gr4) : 1;
                                        }
                                        if (indef)
                                        {
                                            item2.gr5 = item2.gr5 != 0 ? (1 + (int)item2.gr5) : 1;
                                        }
                                        if (group == group1EnumId) item2.gr6 = item2.gr6 != 0 ? (1 + (int)item2.gr6) : 1;
                                        if (group == group2EnumId) item2.gr8 = item2.gr8 != 0 ? (1 + (int)item2.gr8) : 1;
                                        if (group == group3EnumId) item2.gr10 = item2.gr10 != 0 ? (1 + (int)item2.gr10) : 1;
                                    }
                                    //not set group
                                    if (group == notSetGrEnumId) item2.gr12 = item2.gr12 != 0 ? (1 + (int)item2.gr12) : 1;
                                    //if (group == notSetGrEnumId) item2.gr13 = item2.gr13 != 0 ? (1 + (int)item2.gr13) : 1;                                 
                                }
                                //III гр.
                                if (dinamicGroup == disGroup3EnumId)
                                {
                                    item3.gr1 = item3.gr1 != 0 ? (1 + (int)item3.gr1) : 1;
                                    if (gender == womanEnumId)
                                    {
                                        item3.gr2 = item3.gr2 != 0 ? (1 + (int)item3.gr2) : 1;
                                    }
                                    //из них признаны инвалидами
                                    if (group == group1EnumId || group == group2EnumId || group == disGroup3EnumId)
                                    {
                                        item3.gr3 = item3.gr3 != 0 ? (1 + (int)item3.gr3) : 1;
                                        if (gender == womanEnumId)
                                        {
                                            item3.gr4 = item3.gr4 != 0 ? (1 + (int)item3.gr4) : 1;
                                        }
                                        if (indef)
                                        {
                                            item3.gr5 = item3.gr5 != 0 ? (1 + (int)item3.gr5) : 1;
                                        }
                                        if (group == group1EnumId) item3.gr6 = item3.gr6 != 0 ? (1 + (int)item3.gr6) : 1;
                                        if (group == group2EnumId) item3.gr8 = item3.gr8 != 0 ? (1 + (int)item3.gr8) : 1;
                                        if (group == group3EnumId) item3.gr10 = item3.gr10 != 0 ? (1 + (int)item3.gr10) : 1;
                                    }
                                    if (group == notSetGrEnumId) item3.gr12 = item3.gr12 != 0 ? (1 + (int)item3.gr12) : 1;
                                    //if (group == notSetGrEnumId) item3.gr13 = item3.gr13 != 0 ? (1 + (int)item3.gr13) : 1;                                 
                                }
                            }
                        }
                    }
                }
            }
            static object[] getDinamic(WorkflowContext context, Guid appId)
            {
                var qb = new QueryBuilder(dinamicDefId, context.UserId);
                qb.Where("AdultsMedicalCertificate").Eq(appId);
                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    query.AddAttribute(query.Source, "DisabilityGroup");
                    query.AddAttribute(query.Source, "Year");
                    query.AddOrderAttribute("Year", false);
                    using (var reader = context.CreateSqlReader(query))
                    {
                        if (reader.Read())
                        {
                            var dinamicGroup = reader.IsDbNull(0) ? Guid.Empty : reader.GetGuid(0);
                            var dinamicGod = reader.IsDbNull(1) ? string.Empty : reader.GetString(1);
                            return new object[] { dinamicGroup, dinamicGod };
                        }
                    }
                }
                return null;
            }
            static void RemoveRows(WorkflowContext context, Guid reportId)
            {
                var docRepo = context.Documents;
                var rows = new List<Guid>();
                var qb = new QueryBuilder(reportItemDefId, context.UserId);
                qb.Where("Report").Eq(reportId).Or("Report").IsNull();
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read()) rows.Add(reader.GetGuid(0));
                }
                foreach (var rowId in rows)
                {
                    docRepo.DeleteById(rowId);
                }
            }
            private static readonly Guid reportDefId = new Guid("{17789FEE-2908-4E01-8E16-2ECAF4A75C7A}"); //Отчет о распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности
            private static readonly Guid reportItemDefId = new Guid("{10AB1374-EA9C-493B-B5F6-CD6A40273B9B}"); //Распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности

            private static readonly Guid adultsActDefId = new Guid("{12AE380B-39CE-4753-A556-4083BD4B0F92}"); //Медицинский акт для взрослых
            private static readonly Guid dinamicDefId = new Guid("{FFBD36FF-615E-49F7-AB5B-9C787C07B981}"); //Динамика инвалидности
            private static readonly Guid personDefId = new Guid("{D71CE61A-9B59-4B5E-8713-8131DBB5BA02}"); //Person 
            public static readonly Guid districtDefId = new Guid("{A3FCA356-82A9-4BBD-872A-8333BEC6E41A}"); //Район
            public static readonly Guid cityDefId = new Guid("{4BB6D32D-5181-4031-BA49-CF5910D6D883}"); //Города районного значения

            public static readonly Guid repetEnumId = new Guid("{A1F1D6CD-C1CD-4BF8-8F4A-DA124D47C250}"); //Повторные
            public static readonly Guid pensionAge = new Guid("{9B207DB0-8214-4BA7-A8C4-635EF87B583A}"); //Лицо пенсионного возраста
            private static readonly Guid reasonDisEnumdId = new Guid("{383E70E5-E9BE-4AE5-B5DF-323D4463DD51}"); //Профессиональное заболевание

            //Группа инвалидности из динамики инвалидности
            public static readonly Guid disGroup1EnumId = new Guid("{8B2A4C4E-DBE7-4A49-AB2B-D788C22DC3D5}"); //I
            public static readonly Guid disGroup2EnumId = new Guid("{4E62F6B9-BDFA-4D92-97A0-1E0B3AEDB473}"); //II
            public static readonly Guid disGroup3EnumId = new Guid("{07F39539-FF02-4F5F-A4EA-D403AFB679CF}"); //III
            public static readonly Guid disChildEnumId = new Guid("{0643F3EA-94C5-4888-BCD3-2CCADE7A3AE4}"); //Ребенок инвалид

            public static readonly Guid group1EnumId = new Guid("{D145ABA1-EADA-442B-9D8D-AD10BCD126D2}"); //Первая
            public static readonly Guid group2EnumId = new Guid("{C161DA2D-2883-4211-B444-CBB04DBF33D5}"); //Вторая
            public static readonly Guid group3EnumId = new Guid("{CCD439CA-1500-4F7A-A1C8-BB474B5DE8AA}"); //Третья
            public static readonly Guid notSetGrEnumId = new Guid("{C52CCD68-96D8-4E0A-A8ED-30B482C1CF18}"); //Не установлена


            public static readonly Guid cityEnumId = new Guid("{DE3D24A1-64D3-4647-B711-31F334D24416}"); //Городская местность//DistrictType
            public static readonly Guid womanEnumId = new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"); //Женский пол
            public static readonly Guid primaryEnumId = new Guid("{34129BC5-5B31-4189-87FA-799402F7E99F}"); //Первичное

            public static readonly Guid ApprovedStateId = new Guid("{32062CB7-C31C-4AFB-ADF3-F9F9AEEFCE59}");  //Подписанные
        }

        //Результаты переосвидетельствования ЛОВЗ из числа ЛОВЗ от ПРОФ. ЗАБОЛЕВАНИЯ, имеющих УПТ в % без ГИ
        public static class RepetExamInvalidsPF
        {
            public static List<Report7_3Item> Execute(WorkflowContext context, int year, string distrSpr)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;
                var items = new List<Report7_3Item>();
                CalcItems(context, year, orgId, distrSpr, items);
                return items;
            }
            public static void CalcItems(WorkflowContext context, int year, Guid orgId, string distrSpr, List<Report7_3Item> items)
            {
                var qb = new QueryBuilder(adultsActDefId, context.UserId);
                qb.Where("&State").Eq(ApprovedStateId).And("Examination1").Eq(repetEnumId);

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                    query.AddCondition(ExpressionOperation.And, adultsActDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    if (!string.IsNullOrEmpty(distrSpr))
                        query.AddCondition(ExpressionOperation.And, districtDefId, "NumberDis", ConditionOperation.Equal, distrSpr);

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(query.Source, "EndDateExamination");
                    query.AddAttribute(personSrc, "Gender");
                    query.AddAttribute(query.Source, "DisabilityGroup");
                    query.AddAttribute(query.Source, "Indefinitely");
                    query.AddAttribute(query.Source, "CauseOfDisability");
                    query.AddAttribute(query.Source, "LossProfessionalActivities");
                    query.AddAttribute(query.Source, "goal2");
                    query.AddAttribute(query.Source, "ForTheLastTime");

                    var table = new DataTable();
                    using (var reader = context.CreateSqlReader(query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var date = !(row[1] is DBNull) ? (DateTime)row[1] : DateTime.MinValue;
                        var gender = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                        var group = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                        var indef = row[4] is DBNull ? false : (bool)row[4];
                        var reasonDis = row[5] is DBNull ? Guid.Empty : (Guid)row[5];
                        var upt = row[6] is DBNull ? Guid.Empty : (Guid)row[6];
                        var goalUpt = row[7] is DBNull ? false : (bool)row[7];
                        var uptLast = row[8] is DBNull ? Guid.Empty : (Guid)row[8];

                        var lastYear = year - 1;
                        var item = new Report7_3Item();
                        if (appId != Guid.Empty && goalUpt && reasonDis == reasonDisEnumdId)
                        {
                            item.gr1 += 1;
                            if (gender == womanEnumId) item.gr2 += 1;

                            if (upt != Guid.Empty)
                            {
                                item.gr3 += 1;
                                if (gender == womanEnumId) item.gr4 += 1;
                                if (indef) item.gr5 += 1;
                                if (group == group1EnumId) item.gr6 += 1;
                                if (group == group2EnumId) item.gr7 += 1;
                                if (group == group3EnumId) item.gr9 += 1;
                            }
                            items.Add(item);
                        }
                    }
                }
            }
            static object[] getDinamic(WorkflowContext context, Guid appId)
            {
                var qb = new QueryBuilder(dinamicDefId, context.UserId);
                qb.Where("AdultsMedicalCertificate").Eq(appId);
                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    query.AddAttribute(query.Source, "DisabilityGroup");
                    query.AddAttribute(query.Source, "Year");
                    query.AddOrderAttribute("Year", false);
                    using (var reader = context.CreateSqlReader(query))
                    {
                        if (reader.Read())
                        {
                            var dinamicGroup = reader.IsDbNull(0) ? Guid.Empty : reader.GetGuid(0);
                            var dinamicGod = reader.IsDbNull(1) ? string.Empty : reader.GetString(1);
                            return new object[] { dinamicGroup, dinamicGod };
                        }
                    }
                }
                return null;
            }
            static void RemoveRows(WorkflowContext context, Guid reportId)
            {
                var docRepo = context.Documents;
                var rows = new List<Guid>();
                var qb = new QueryBuilder(reportItemDefId, context.UserId);
                qb.Where("Report").Eq(reportId).Or("Report").IsNull();
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read()) rows.Add(reader.GetGuid(0));
                }
                foreach (var rowId in rows)
                {
                    docRepo.DeleteById(rowId);
                }
            }

            private static readonly Guid reportDefId = new Guid("{17789FEE-2908-4E01-8E16-2ECAF4A75C7A}"); //Отчет о распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности
            private static readonly Guid reportItemDefId = new Guid("{10AB1374-EA9C-493B-B5F6-CD6A40273B9B}"); //Распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности

            private static readonly Guid adultsActDefId = new Guid("{12AE380B-39CE-4753-A556-4083BD4B0F92}"); //Медицинский акт для взрослых
            private static readonly Guid dinamicDefId = new Guid("{FFBD36FF-615E-49F7-AB5B-9C787C07B981}"); //Динамика инвалидности
            private static readonly Guid personDefId = new Guid("{D71CE61A-9B59-4B5E-8713-8131DBB5BA02}"); //Person 
            public static readonly Guid districtDefId = new Guid("{A3FCA356-82A9-4BBD-872A-8333BEC6E41A}"); //Район
            public static readonly Guid cityDefId = new Guid("{4BB6D32D-5181-4031-BA49-CF5910D6D883}"); //Города районного значения

            public static readonly Guid repetEnumId = new Guid("{A1F1D6CD-C1CD-4BF8-8F4A-DA124D47C250}"); //Повторные
            public static readonly Guid pensionAge = new Guid("{9B207DB0-8214-4BA7-A8C4-635EF87B583A}"); //Лицо пенсионного возраста
            private static readonly Guid reasonDisEnumdId = new Guid("{383E70E5-E9BE-4AE5-B5DF-323D4463DD51}"); //Профессиональное заболевание

            //Группа инвалидности из динамики инвалидности
            public static readonly Guid disGroup1EnumId = new Guid("{8B2A4C4E-DBE7-4A49-AB2B-D788C22DC3D5}"); //I
            public static readonly Guid disGroup2EnumId = new Guid("{4E62F6B9-BDFA-4D92-97A0-1E0B3AEDB473}"); //II
            public static readonly Guid disGroup3EnumId = new Guid("{07F39539-FF02-4F5F-A4EA-D403AFB679CF}"); //III
            public static readonly Guid disChildEnumId = new Guid("{0643F3EA-94C5-4888-BCD3-2CCADE7A3AE4}"); //Ребенок инвалид

            public static readonly Guid group1EnumId = new Guid("{D145ABA1-EADA-442B-9D8D-AD10BCD126D2}"); //Первая
            public static readonly Guid group2EnumId = new Guid("{C161DA2D-2883-4211-B444-CBB04DBF33D5}"); //Вторая
            public static readonly Guid group3EnumId = new Guid("{CCD439CA-1500-4F7A-A1C8-BB474B5DE8AA}"); //Третья
            public static readonly Guid notSetGrEnumId = new Guid("{C52CCD68-96D8-4E0A-A8ED-30B482C1CF18}"); //Не установлена


            public static readonly Guid cityEnumId = new Guid("{DE3D24A1-64D3-4647-B711-31F334D24416}"); //Городская местность//DistrictType
            public static readonly Guid womanEnumId = new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"); //Женский пол
            public static readonly Guid primaryEnumId = new Guid("{34129BC5-5B31-4189-87FA-799402F7E99F}"); //Первичное

            public static readonly Guid ApprovedStateId = new Guid("{32062CB7-C31C-4AFB-ADF3-F9F9AEEFCE59}");  //Подписанные
        }

        //Рекомендации по реабилитации инвалидов 8 отчет
        public static class RecomRehabDisabilities
        {
            public static List<Report8Item> Execute(WorkflowContext context, int year, string distrSpr)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;

                /******************************************************************************************************************/
                var docs = new string[]
                {
                  "Разработано индивидуальных программ реабилитации ЛОВЗ -всего  01   ",
                    "Даны рекомендации 02   ",
                    "Из них с заключением о нуждаемости:- в восстановительной терапии (включая лекарственное обеспечение)  03   ",
                    "-в реконструктивной хирургии (включая лекарственное обеспечение)  04   ",
                    "- в санаторно-курортном обеспечении 05   ",
                    "-в обеспечении профессиональной ориентации инвалидов (включая проф.обучение, переобучение, повышение квалификации – всего  06   ",
                    "Из них - в условиях производства  06.1 ",
                    "- в профессионально-технических учреждениях системы органов социальной защиты  06.2 ",
                    "- в профессионально-технических учреждениях системы образования  06.3 ",
                    "- в высших учебных заведениях  06.4 ",
                    "- в трудоустройстве всего  07   ",
                    "Из них: - в обычных условиях производства с предоставлением соответствующих условий труда  07.1 ",
                    "- в специально созданных условиях труда  07.2 ",
                    "- на дому  07.3 ",
                    "- в технических средствах реабилитации – всего  08   ",
                    "В том числе на получение кресла-коляски  08.1 ",
                    "Кресла-коляски  08.1 ",
                    "Протезирование  08.2 ",
                    "Протезы рук  08.21",
                    "Протезы ног  08.22",
                    "Эндопротезы  08.23",
                    "Косметические протезы  08.24",
                    "Ортезы  08.3 ",
                    "Ортопедическая обувь  08.4 ",
                    "Слуховые аппараты  08.5 ",
                    "Технические средства при нарушении зрения  08.6 ",
                    "Голосообразующие аппараты  08.8 ",
                    "Бытовые средства  09   ",
                    "Кресел-стульев с санитарным оснащением  09.1 ",
                    "Специальных средств при нарушении функции выделения  09.2 ",
                    "Абсорбирующего белья, памперсов  09.3 ",
                    "Бытовые приспособления  09.4 ",
                    "И другие  09.5 "
                };
                var items = new List<Report8Item>();
                int i2 = 1;
                foreach (var i in docs)
                {
                    var item = new Report8Item();
                    item.rowName = i;
                    item.rowNo = i2;
                    i2++;
                    items.Add(item);
                }
                CalcItems(context, /*report, */year, orgId, distrSpr, items[32],
                    items[31], items[30], items[29], items[28], items[27], items[26], items[25],
                    items[24], items[23], items[22], items[21], items[20], items[19], items[18],
                    items[17], items[16], items[15], items[14], items[13], items[12], items[11],
                    items[10], items[9], items[8], items[7], items[6], items[5], items[4],
                    items[3], items[2], items[1], items[0]);
                return items;
            }
            public static void CalcItems(WorkflowContext context, int year, Guid orgId, string distrSpr, Report8Item item32,
                Report8Item item31, Report8Item item30, Report8Item item29, Report8Item item28,
                Report8Item item27, Report8Item item26, Report8Item item25, Report8Item item24,
                Report8Item item23, Report8Item item22, Report8Item item21, Report8Item item20,
                Report8Item item19, Report8Item item18, Report8Item item17, Report8Item item16,
                Report8Item item15, Report8Item item14, Report8Item item13, Report8Item item12,
                Report8Item item11, Report8Item item10, Report8Item item9, Report8Item item8,
                Report8Item item7, Report8Item item6, Report8Item item5, Report8Item item4,
                Report8Item item3, Report8Item item2, Report8Item item1, Report8Item item0)
            {
                var qb = new QueryBuilder(adultsStatCardDefId, context.UserId);
                qb.Where("&State").Eq(ApprovedStateId);

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                    var actSrc = query.JoinSource(query.Source, adultsActDefId, SqlSourceJoinType.Inner, "AdultsMedicalCertificate");
                    query.AddCondition(ExpressionOperation.And, adultsStatCardDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    if (!string.IsNullOrEmpty(distrSpr))
                        query.AddCondition(ExpressionOperation.And, districtDefId, "NumberDis", ConditionOperation.Equal, distrSpr);

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(query.Source, "EndDateExamination");
                    query.AddAttribute(query.Source, "Examination1");
                    query.AddAttribute(actSrc, "IPR");
                    query.AddAttribute(query.Source, "RestorativeTherapy");
                    query.AddAttribute(query.Source, "ReconstructiveSurgery");
                    query.AddAttribute(query.Source, "SpaProvision");
                    query.AddAttribute(query.Source, "RehabilitationCenter");
                    query.AddAttribute(query.Source, "HospitalTreatment");
                    query.AddAttribute(query.Source, "Hospitalization");
                    query.AddAttribute(query.Source, "j1");
                    query.AddAttribute(query.Source, "j2");
                    query.AddAttribute(query.Source, "j3");
                    query.AddAttribute(query.Source, "j4");
                    query.AddAttribute(query.Source, "j5");
                    query.AddAttribute(query.Source, "j6");
                    query.AddAttribute(query.Source, "j7");
                    query.AddAttribute(query.Source, "j8");
                    query.AddAttribute(query.Source, "j9");
                    query.AddAttribute(query.Source, "j10");  
                    query.AddAttribute(query.Source, "01");
                    query.AddAttribute(query.Source, "02");
                    query.AddAttribute(query.Source, "03");
                    query.AddAttribute(query.Source, "04");
                    query.AddAttribute(query.Source, "05");
                    query.AddAttribute(query.Source, "06");
                    query.AddAttribute(query.Source, "07");
                    query.AddAttribute(query.Source, "08");
                    query.AddAttribute(query.Source, "09");
                    query.AddAttribute(query.Source, "10");
                    query.AddAttribute(query.Source, "11");
                    query.AddAttribute(query.Source, "12");
                    query.AddAttribute(query.Source, "13");
                    query.AddAttribute(query.Source, "14");
                    query.AddAttribute(query.Source, "15");
                    query.AddAttribute(query.Source, "16");
                    query.AddAttribute(query.Source, "17");
                    query.AddAttribute(query.Source, "18");
                    query.AddAttribute(query.Source, "19");
                    query.AddAttribute(query.Source, "20");
                    query.AddAttribute(query.Source, "FollowUpRecommendations");
                    query.AddAttribute(query.Source, "CauseOfDisability");
                    query.AddAttribute(query.Source, "DisabilityGroup");

                    var table = new DataTable();
                    using (var reader = context.CreateSqlReader(query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var date = !(row[1] is DBNull) ? (DateTime)row[1] : DateTime.MinValue;
                        var prReExam = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                        var ipr = row[3] is DBNull ? false : (bool)row[3];
                        var recom1 = row[4] is DBNull ? false : (bool)row[4];
                        var recom2 = row[5] is DBNull ? false : (bool)row[5];
                        var recom3 = row[6] is DBNull ? false : (bool)row[6];
                        var recom4 = row[7] is DBNull ? false : (bool)row[7];
                        var recom5 = row[8] is DBNull ? false : (bool)row[8];
                        var recom6 = row[9] is DBNull ? false : (bool)row[9];
                        var j1 = row[10] is DBNull ? false : (bool)row[10];
                        var j2 = row[11] is DBNull ? false : (bool)row[11];
                        var j3 = row[12] is DBNull ? false : (bool)row[12];
                        var j4 = row[13] is DBNull ? false : (bool)row[13];
                        var j5 = row[14] is DBNull ? Guid.Empty : (Guid)row[14];
                        var j6 = row[15] is DBNull ? Guid.Empty : (Guid)row[15];
                        var j7 = row[16] is DBNull ? "" : row[16].ToString();
                        var j8 = row[17] is DBNull ? "" : row[17].ToString();
                        var j9 = row[18] is DBNull ? "" : row[18].ToString();
                        var j10 = row[19] is DBNull ? "" : row[19].ToString();
                        var plant1 = row[20] is DBNull ? false : (bool)row[20];
                        var plant2 = row[21] is DBNull ? false : (bool)row[21];
                        var plant3 = row[22] is DBNull ? false : (bool)row[22];
                        var plant4 = row[23] is DBNull ? false : (bool)row[23];
                        var plant5 = row[24] is DBNull ? false : (bool)row[24];
                        var plant6 = row[25] is DBNull ? false : (bool)row[25];
                        var plant7 = row[26] is DBNull ? false : (bool)row[26];
                        var plant8 = row[27] is DBNull ? false : (bool)row[27];
                        var plant9 = row[28] is DBNull ? false : (bool)row[28];
                        var plant10 = row[29] is DBNull ? false : (bool)row[29];
                        var plant11 = row[30] is DBNull ? false : (bool)row[30];
                        var plant12 = row[31] is DBNull ? false : (bool)row[31];
                        var plant13 = row[32] is DBNull ? false : (bool)row[32];
                        var plant14 = row[33] is DBNull ? false : (bool)row[33];
                        var plant15 = row[34] is DBNull ? false : (bool)row[34];
                        var plant16 = row[35] is DBNull ? false : (bool)row[35];
                        var plant17 = row[36] is DBNull ? false : (bool)row[36];
                        var plant18 = row[37] is DBNull ? false : (bool)row[37];
                        var plant19 = row[38] is DBNull ? false : (bool)row[38];
                        var plant20 = row[39] is DBNull ? false : (bool)row[39];
                        var implement = row[40] is DBNull ? Guid.Empty : (Guid)row[40];
                        var reasonDis = row[41] is DBNull ? Guid.Empty : (Guid)row[41];
                        var group = row[42] is DBNull ? Guid.Empty : (Guid)row[42];

                        if (appId != Guid.Empty)
                        {
                            if (date.Year == year)
                            {
                                if (ipr)
                                {
                                    item0.gr1 = item0.gr1 != 0 ? (1 + (int)item0.gr1) : 1;
                                    if (prReExam == primaryEnumId) item0.gr2 = item0.gr2 != 0 ? (1 + (int)item0.gr2) : 1;
                                    //if () item0.gr3 = item0.gr3 != 0 ? (1 + (int)item0.gr3) : 1;
                                    if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                    {
                                        item0.gr4 = item0.gr4 != 0 ? (1 + (int)item0.gr4) : 1;
                                    }
                                    if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item0.gr5 = item0.gr5 != 0 ? (1 + (int)item0.gr5) : 1;
                                    if (prReExam != primaryEnumId && group == notInstalled) item0.gr6 = item0.gr6 != 0 ? (1 + (int)item0.gr6) : 1;
                                }
                                if (recom1 || recom2 || recom3 || recom4 || recom5 || recom6 ||
                                    j1 || j2 || j3 || j4 || j5 != Guid.Empty || j6 != Guid.Empty ||
                                    j6 != null || j7 != null || j8 != null || j9 != null || j10 != null)
                                {
                                    item1.gr1 = item1.gr1 != 0 ? (1 + (int)item1.gr1) : 1;
                                    if (prReExam == primaryEnumId) item1.gr2 = item1.gr2 != 0 ? (1 + (int)item1.gr2) : 1;
                                    //if () item1.gr3 = item1.gr3 != 0 ? (1 + (int)item1.gr3) : 1;
                                    if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                    {
                                        item1.gr4 = item1.gr4 != 0 ? (1 + (int)item1.gr4) : 1;
                                    }
                                    if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item1.gr5 = item1.gr5 != 0 ? (1 + (int)item1.gr5) : 1;
                                    if (prReExam != primaryEnumId && group == notInstalled) item1.gr6 = item1.gr6 != 0 ? (1 + (int)item1.gr6) : 1;

                                    //восстановительная терапия
                                    if (recom1)
                                    {
                                        item2.gr1 = item2.gr1 != 0 ? (1 + (int)item2.gr1) : 1;
                                        if (prReExam == primaryEnumId) item2.gr2 = item2.gr2 != 0 ? (1 + (int)item2.gr2) : 1;
                                        //if () item2.gr3 = item2.gr3 != 0 ? (1 + (int)item2.gr3) : 1;
                                        if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        {
                                            item2.gr4 = item2.gr4 != 0 ? (1 + (int)item2.gr4) : 1;
                                        }
                                        if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item2.gr5 = item2.gr5 != 0 ? (1 + (int)item2.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalled) item2.gr6 = item2.gr6 != 0 ? (1 + (int)item2.gr6) : 1;
                                    }
                                    //реконструктивная хирургия
                                    if (recom2)
                                    {
                                        item3.gr1 = item3.gr1 != 0 ? (1 + (int)item3.gr1) : 1;
                                        if (prReExam == primaryEnumId) item3.gr2 = item3.gr2 != 0 ? (1 + (int)item3.gr2) : 1;
                                        //if () item3.gr3 = item3.gr3 != 0 ? (1 + (int)item3.gr3) : 1;
                                        if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        {
                                            item3.gr4 = item3.gr4 != 0 ? (1 + (int)item3.gr4) : 1;
                                        }
                                        if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item3.gr5 = item3.gr5 != 0 ? (1 + (int)item3.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalled) item3.gr6 = item3.gr6 != 0 ? (1 + (int)item3.gr6) : 1;
                                    }
                                    //санаторно курортное лечения
                                    if (recom3)
                                    {
                                        item4.gr1 = item4.gr1 != 0 ? (1 + (int)item4.gr1) : 1;
                                        if (prReExam == primaryEnumId) item4.gr2 = item4.gr2 != 0 ? (1 + (int)item4.gr2) : 1;
                                        //if () item4.gr3 = item4.gr3 != 0 ? (1 + (int)item4.gr3) : 1;
                                        if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        {
                                            item4.gr4 = item4.gr4 != 0 ? (1 + (int)item4.gr4) : 1;
                                        }
                                        if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item4.gr5 = item4.gr5 != 0 ? (1 + (int)item4.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalled) item4.gr6 = item4.gr6 != 0 ? (1 + (int)item4.gr6) : 1;
                                    }
                                    //проф. ориентация
                                    if (j5 != Guid.Empty || j6 != Guid.Empty)
                                    {
                                        item5.gr1 = item5.gr1 != 0 ? (1 + (int)item5.gr1) : 1;
                                        if (prReExam == primaryEnumId) item5.gr2 = item5.gr2 != 0 ? (1 + (int)item5.gr2) : 1;
                                        //if () item5.gr3 = item5.gr3 != 0 ? (1 + (int)item5.gr3) : 1;
                                        if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        {
                                            item5.gr4 = item5.gr4 != 0 ? (1 + (int)item5.gr4) : 1;
                                        }
                                        if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item5.gr5 = item5.gr5 != 0 ? (1 + (int)item5.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalled) item5.gr6 = item5.gr6 != 0 ? (1 + (int)item5.gr6) : 1;

                                        //в условиях производства
                                        if (j6 == j6EnumId1)
                                        {
                                            item6.gr1 = item6.gr1 != 0 ? (1 + (int)item6.gr1) : 1;
                                            if (prReExam == primaryEnumId) item6.gr2 = item6.gr2 != 0 ? (1 + (int)item6.gr2) : 1;
                                            //if () item6.gr3 = item6.gr3 != 0 ? (1 + (int)item6.gr3) : 1;
                                            if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                            {
                                                item6.gr4 = item6.gr4 != 0 ? (1 + (int)item6.gr4) : 1;
                                            }
                                            if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item6.gr5 = item6.gr5 != 0 ? (1 + (int)item6.gr5) : 1;
                                            if (prReExam != primaryEnumId && group == notInstalled) item6.gr6 = item6.gr6 != 0 ? (1 + (int)item6.gr6) : 1;
                                        }
                                        //В профессионально-технических учреждениях системы органов социальной защиты
                                        if (j6 == j6EnumId2)
                                        {
                                            item7.gr1 = item7.gr1 != 0 ? (1 + (int)item7.gr1) : 1;
                                            if (prReExam == primaryEnumId) item7.gr2 = item7.gr2 != 0 ? (1 + (int)item7.gr2) : 1;
                                            //if () item7.gr3 = item7.gr3 != 0 ? (1 + (int)item7.gr3) : 1;
                                            if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                            {
                                                item7.gr4 = item7.gr4 != 0 ? (1 + (int)item7.gr4) : 1;
                                            }
                                            if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item7.gr5 = item7.gr5 != 0 ? (1 + (int)item7.gr5) : 1;
                                            if (prReExam != primaryEnumId && group == notInstalled) item7.gr6 = item7.gr6 != 0 ? (1 + (int)item7.gr6) : 1;
                                        }
                                        //В профессионально-технических учреждениях системы образования
                                        if (j6 == j6EnumId3)
                                        {
                                            item8.gr1 = item8.gr1 != 0 ? (1 + (int)item8.gr1) : 1;
                                            if (prReExam == primaryEnumId) item8.gr2 = item8.gr2 != 0 ? (1 + (int)item8.gr2) : 1;
                                            //if () item8.gr3 = item8.gr3 != 0 ? (1 + (int)item8.gr3) : 1;
                                            if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                            {
                                                item8.gr4 = item8.gr4 != 0 ? (1 + (int)item8.gr4) : 1;
                                            }
                                            if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item8.gr5 = item8.gr5 != 0 ? (1 + (int)item8.gr5) : 1;
                                            if (prReExam != primaryEnumId && group == notInstalled) item8.gr6 = item8.gr6 != 0 ? (1 + (int)item8.gr6) : 1;
                                        }
                                        //В высших учебных заведениях
                                        if (j6 == j6EnumId4)
                                        {
                                            item9.gr1 = item9.gr1 != 0 ? (1 + (int)item9.gr1) : 1;
                                            if (prReExam == primaryEnumId) item9.gr2 = item9.gr2 != 0 ? (1 + (int)item9.gr2) : 1;
                                            //if () item9.gr3 = item9.gr3 != 0 ? (1 + (int)item9.gr3) : 1;
                                            if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                            {
                                                item9.gr4 = item9.gr4 != 0 ? (1 + (int)item9.gr4) : 1;
                                            }
                                            if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item9.gr5 = item9.gr5 != 0 ? (1 + (int)item9.gr5) : 1;
                                            if (prReExam != primaryEnumId && group == notInstalled) item9.gr6 = item9.gr6 != 0 ? (1 + (int)item9.gr6) : 1;
                                        }
                                        //в трудоустройстве всего
                                        if (j1 || j2 || j3)
                                        {
                                            item10.gr1 = item10.gr1 != 0 ? (1 + (int)item10.gr1) : 1;
                                            if (prReExam == primaryEnumId) item10.gr2 = item10.gr2 != 0 ? (1 + (int)item10.gr2) : 1;
                                            //if () item10.gr3 = item10.gr3 != 0 ? (1 + (int)item10.gr3) : 1;
                                            if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                            {
                                                item10.gr4 = item10.gr4 != 0 ? (1 + (int)item10.gr4) : 1;
                                            }
                                            if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item10.gr5 = item10.gr5 != 0 ? (1 + (int)item10.gr5) : 1;
                                            if (prReExam != primaryEnumId && group == notInstalled) item10.gr6 = item10.gr6 != 0 ? (1 + (int)item10.gr6) : 1;

                                            //item11
                                            if (j3)
                                            {
                                                item11.gr1 = item11.gr1 != 0 ? (1 + (int)item11.gr1) : 1;
                                                if (prReExam == primaryEnumId) item11.gr2 = item11.gr2 != 0 ? (1 + (int)item11.gr2) : 1;
                                                //if () item11.gr3 = item11.gr3 != 0 ? (1 + (int)item11.gr3) : 1;
                                                if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                                {
                                                    item11.gr4 = item11.gr4 != 0 ? (1 + (int)item11.gr4) : 1;
                                                }
                                                if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item11.gr5 = item11.gr5 != 0 ? (1 + (int)item11.gr5) : 1;
                                                if (prReExam != primaryEnumId && group == notInstalled) item11.gr6 = item11.gr6 != 0 ? (1 + (int)item11.gr6) : 1;
                                            }
                                            if (j2)
                                            {
                                                item12.gr1 = item12.gr1 != 0 ? (1 + (int)item12.gr1) : 1;
                                                if (prReExam == primaryEnumId) item12.gr2 = item12.gr2 != 0 ? (1 + (int)item12.gr2) : 1;
                                                //if () item12.gr3 = item12.gr3 != 0 ? (1 + (int)item12.gr3) : 1;
                                                if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                                {
                                                    item12.gr4 = item12.gr4 != 0 ? (1 + (int)item12.gr4) : 1;
                                                }
                                                if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item12.gr5 = item12.gr5 != 0 ? (1 + (int)item12.gr5) : 1;
                                                if (prReExam != primaryEnumId && group == notInstalled) item12.gr6 = item12.gr6 != 0 ? (1 + (int)item12.gr6) : 1;
                                            }
                                            if (j1)
                                            {
                                                item13.gr1 = item13.gr1 != 0 ? (1 + (int)item13.gr1) : 1;
                                                if (prReExam == primaryEnumId) item13.gr2 = item13.gr2 != 0 ? (1 + (int)item13.gr2) : 1;
                                                //if () item13.gr3 = item13.gr3 != 0 ? (1 + (int)item13.gr3) : 1;
                                                if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                                {
                                                    item13.gr4 = item13.gr4 != 0 ? (1 + (int)item13.gr4) : 1;
                                                }
                                                if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item13.gr5 = item13.gr5 != 0 ? (1 + (int)item13.gr5) : 1;
                                                if (prReExam != primaryEnumId && group == notInstalled) item13.gr6 = item13.gr6 != 0 ? (1 + (int)item13.gr6) : 1;
                                            }
                                        }
                                    }
                                }
                                //средства реабилитации
                                if (plant1 || plant2 || plant3 || plant4 || plant5 || plant6 || plant7 ||
                                    plant8 || plant9 || plant10 || plant11 || plant12 || plant13 || plant14 ||
                                    plant15 || plant16 || plant17 || plant18 || plant19 || plant20)
                                {
                                    item14.gr1 = item14.gr1 != 0 ? (1 + (int)item14.gr1) : 1;
                                    if (prReExam == primaryEnumId) item14.gr2 = item14.gr2 != 0 ? (1 + (int)item14.gr2) : 1;
                                    //if () item14.gr3 = item14.gr3 != 0 ? (1 + (int)item14.gr3) : 1;
                                    if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                    {
                                        item14.gr4 = item14.gr4 != 0 ? (1 + (int)item14.gr4) : 1;
                                    }
                                    if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item14.gr5 = item14.gr5 != 0 ? (1 + (int)item14.gr5) : 1;
                                    if (prReExam != primaryEnumId && group == notInstalled) item14.gr6 = item14.gr6 != 0 ? (1 + (int)item14.gr6) : 1;

                                    //item15??????

                                    if (plant1)
                                    {
                                        item16.gr1 = item16.gr1 != 0 ? (1 + (int)item16.gr1) : 1;
                                        if (prReExam == primaryEnumId) item16.gr2 = item16.gr2 != 0 ? (1 + (int)item16.gr2) : 1;
                                        //if () item16.gr3 = item16.gr3 != 0 ? (1 + (int)item16.gr3) : 1;
                                        if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        {
                                            item16.gr4 = item16.gr4 != 0 ? (1 + (int)item16.gr4) : 1;
                                        }
                                        if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item16.gr5 = item16.gr5 != 0 ? (1 + (int)item16.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalled) item16.gr6 = item16.gr6 != 0 ? (1 + (int)item16.gr6) : 1;
                                    }
                                    if (plant3)
                                    {
                                        item17.gr1 = item17.gr1 != 0 ? (1 + (int)item17.gr1) : 1;
                                        if (prReExam == primaryEnumId) item17.gr2 = item17.gr2 != 0 ? (1 + (int)item17.gr2) : 1;
                                        //if () item17.gr3 = item17.gr3 != 0 ? (1 + (int)item17.gr3) : 1;
                                        if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        {
                                            item17.gr4 = item17.gr4 != 0 ? (1 + (int)item17.gr4) : 1;
                                        }
                                        if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item17.gr5 = item17.gr5 != 0 ? (1 + (int)item17.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalled) item17.gr6 = item17.gr6 != 0 ? (1 + (int)item17.gr6) : 1;
                                    }
                                    if (plant4)
                                    {
                                        item18.gr1 = item18.gr1 != 0 ? (1 + (int)item18.gr1) : 1;
                                        if (prReExam == primaryEnumId) item18.gr2 = item18.gr2 != 0 ? (1 + (int)item18.gr2) : 1;
                                        //if () item18.gr3 = item18.gr3 != 0 ? (1 + (int)item18.gr3) : 1;
                                        if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        {
                                            item18.gr4 = item18.gr4 != 0 ? (1 + (int)item18.gr4) : 1;
                                        }
                                        if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item18.gr5 = item18.gr5 != 0 ? (1 + (int)item18.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalled) item18.gr6 = item18.gr6 != 0 ? (1 + (int)item18.gr6) : 1;
                                    }
                                    if (plant5)
                                    {
                                        item19.gr1 = item19.gr1 != 0 ? (1 + (int)item19.gr1) : 1;
                                        if (prReExam == primaryEnumId) item19.gr2 = item19.gr2 != 0 ? (1 + (int)item19.gr2) : 1;
                                        //if () item19.gr3 = item19.gr3 != 0 ? (1 + (int)item19.gr3) : 1;
                                        if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        {
                                            item19.gr4 = item19.gr4 != 0 ? (1 + (int)item19.gr4) : 1;
                                        }
                                        if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item19.gr5 = item19.gr5 != 0 ? (1 + (int)item19.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalled) item19.gr6 = item19.gr6 != 0 ? (1 + (int)item19.gr6) : 1;
                                    }
                                    if (plant7)
                                    {
                                        item20.gr1 = item20.gr1 != 0 ? (1 + (int)item20.gr1) : 1;
                                        if (prReExam == primaryEnumId) item20.gr2 = item20.gr2 != 0 ? (1 + (int)item20.gr2) : 1;
                                        //if () item20.gr3 = item20.gr3 != 0 ? (1 + (int)item20.gr3) : 1;
                                        if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        {
                                            item20.gr4 = item20.gr4 != 0 ? (1 + (int)item20.gr4) : 1;
                                        }
                                        if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item20.gr5 = item20.gr5 != 0 ? (1 + (int)item20.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalled) item20.gr6 = item20.gr6 != 0 ? (1 + (int)item20.gr6) : 1;
                                    }
                                    if (plant8)
                                    {
                                        item21.gr1 = item21.gr1 != 0 ? (1 + (int)item21.gr1) : 1;
                                        if (prReExam == primaryEnumId) item21.gr2 = item21.gr2 != 0 ? (1 + (int)item21.gr2) : 1;
                                        //if () item21.gr3 = item21.gr3 != 0 ? (1 + (int)item21.gr3) : 1;
                                        if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        {
                                            item21.gr4 = item21.gr4 != 0 ? (1 + (int)item21.gr4) : 1;
                                        }
                                        if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item21.gr5 = item21.gr5 != 0 ? (1 + (int)item21.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalled) item21.gr6 = item21.gr6 != 0 ? (1 + (int)item21.gr6) : 1;
                                    }
                                    if (plant9)
                                    {
                                        item22.gr1 = item22.gr1 != 0 ? (1 + (int)item22.gr1) : 1;
                                        if (prReExam == primaryEnumId) item22.gr2 = item22.gr2 != 0 ? (1 + (int)item22.gr2) : 1;
                                        //if () item22.gr3 = item22.gr3 != 0 ? (1 + (int)item22.gr3) : 1;
                                        if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        {
                                            item22.gr4 = item22.gr4 != 0 ? (1 + (int)item22.gr4) : 1;
                                        }
                                        if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item22.gr5 = item22.gr5 != 0 ? (1 + (int)item22.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalled) item22.gr6 = item22.gr6 != 0 ? (1 + (int)item22.gr6) : 1;
                                    }
                                    if (plant10)
                                    {
                                        item23.gr1 = item23.gr1 != 0 ? (1 + (int)item23.gr1) : 1;
                                        if (prReExam == primaryEnumId) item23.gr2 = item23.gr2 != 0 ? (1 + (int)item23.gr2) : 1;
                                        //if () item23.gr3 = item23.gr3 != 0 ? (1 + (int)item23.gr3) : 1;
                                        if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        {
                                            item23.gr4 = item23.gr4 != 0 ? (1 + (int)item23.gr4) : 1;
                                        }
                                        if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item23.gr5 = item23.gr5 != 0 ? (1 + (int)item23.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalled) item23.gr6 = item23.gr6 != 0 ? (1 + (int)item23.gr6) : 1;
                                    }
                                    if (plant11)
                                    {
                                        item24.gr1 = item24.gr1 != 0 ? (1 + (int)item24.gr1) : 1;
                                        if (prReExam == primaryEnumId) item24.gr2 = item24.gr2 != 0 ? (1 + (int)item24.gr2) : 1;
                                        //if () item24.gr3 = item24.gr3 != 0 ? (1 + (int)item24.gr3) : 1;
                                        if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        {
                                            item24.gr4 = item24.gr4 != 0 ? (1 + (int)item24.gr4) : 1;
                                        }
                                        if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item24.gr5 = item24.gr5 != 0 ? (1 + (int)item24.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalled) item24.gr6 = item24.gr6 != 0 ? (1 + (int)item24.gr6) : 1;
                                    }
                                    if (plant6)
                                    {
                                        item25.gr1 = item25.gr1 != 0 ? (1 + (int)item25.gr1) : 1;
                                        if (prReExam == primaryEnumId) item25.gr2 = item25.gr2 != 0 ? (1 + (int)item25.gr2) : 1;
                                        //if () item25.gr3 = item25.gr3 != 0 ? (1 + (int)item25.gr3) : 1;
                                        if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        {
                                            item25.gr4 = item25.gr4 != 0 ? (1 + (int)item25.gr4) : 1;
                                        }
                                        if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item25.gr5 = item25.gr5 != 0 ? (1 + (int)item25.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalled) item25.gr6 = item25.gr6 != 0 ? (1 + (int)item25.gr6) : 1;
                                    }
                                    //item26 ?????
                                    /***/
                                    if (plant13 || plant14 || plant16 || plant17 || plant2 || plant12 || plant15)
                                    {
                                        item27.gr1 = item27.gr1 != 0 ? (1 + (int)item27.gr1) : 1;
                                        if (prReExam == primaryEnumId) item27.gr2 = item27.gr2 != 0 ? (1 + (int)item27.gr2) : 1;
                                        //if () item27.gr3 = item27.gr3 != 0 ? (1 + (int)item27.gr3) : 1;
                                        if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        {
                                            item27.gr4 = item27.gr4 != 0 ? (1 + (int)item27.gr4) : 1;
                                        }
                                        if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item27.gr5 = item27.gr5 != 0 ? (1 + (int)item27.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalled) item27.gr6 = item27.gr6 != 0 ? (1 + (int)item27.gr6) : 1;

                                        if (plant13)
                                        {
                                            item28.gr1 = item28.gr1 != 0 ? (1 + (int)item28.gr1) : 1;
                                            if (prReExam == primaryEnumId) item28.gr2 = item28.gr2 != 0 ? (1 + (int)item28.gr2) : 1;
                                            //if () item28.gr3 = item28.gr3 != 0 ? (1 + (int)item28.gr3) : 1;
                                            if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                            {
                                                item28.gr4 = item28.gr4 != 0 ? (1 + (int)item28.gr4) : 1;
                                            }
                                            if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item28.gr5 = item28.gr5 != 0 ? (1 + (int)item28.gr5) : 1;
                                            if (prReExam != primaryEnumId && group == notInstalled) item28.gr6 = item28.gr6 != 0 ? (1 + (int)item28.gr6) : 1;
                                        }
                                        if (plant14)
                                        {
                                            item29.gr1 = item29.gr1 != 0 ? (1 + (int)item29.gr1) : 1;
                                            if (prReExam == primaryEnumId) item29.gr2 = item29.gr2 != 0 ? (1 + (int)item29.gr2) : 1;
                                            //if () item29.gr3 = item29.gr3 != 0 ? (1 + (int)item29.gr3) : 1;
                                            if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                            {
                                                item29.gr4 = item29.gr4 != 0 ? (1 + (int)item29.gr4) : 1;
                                            }
                                            if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item29.gr5 = item29.gr5 != 0 ? (1 + (int)item29.gr5) : 1;
                                            if (prReExam != primaryEnumId && group == notInstalled) item29.gr6 = item29.gr6 != 0 ? (1 + (int)item29.gr6) : 1;
                                        }
                                        if (plant16)
                                        {
                                            item30.gr1 = item30.gr1 != 0 ? (1 + (int)item30.gr1) : 1;
                                            if (prReExam == primaryEnumId) item30.gr2 = item30.gr2 != 0 ? (1 + (int)item30.gr2) : 1;
                                            //if () item30.gr3 = item30.gr3 != 0 ? (1 + (int)item30.gr3) : 1;
                                            if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                            {
                                                item30.gr4 = item30.gr4 != 0 ? (1 + (int)item30.gr4) : 1;
                                            }
                                            if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item30.gr5 = item30.gr5 != 0 ? (1 + (int)item30.gr5) : 1;
                                            if (prReExam != primaryEnumId && group == notInstalled) item30.gr6 = item30.gr6 != 0 ? (1 + (int)item30.gr6) : 1;
                                        }
                                        if (plant17)
                                        {
                                            item31.gr1 = item31.gr1 != 0 ? (1 + (int)item31.gr1) : 1;
                                            if (prReExam == primaryEnumId) item31.gr2 = item31.gr2 != 0 ? (1 + (int)item31.gr2) : 1;
                                            //if () item31.gr3 = item31.gr3 != 0 ? (1 + (int)item31.gr3) : 1;
                                            if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                            {
                                                item31.gr4 = item31.gr4 != 0 ? (1 + (int)item31.gr4) : 1;
                                            }
                                            if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item31.gr5 = item31.gr5 != 0 ? (1 + (int)item31.gr5) : 1;
                                            if (prReExam != primaryEnumId && group == notInstalled) item31.gr6 = item31.gr6 != 0 ? (1 + (int)item31.gr6) : 1;
                                        }
                                        if (plant2 || plant12 || plant15)
                                        {
                                            item32.gr1 = item32.gr1 != 0 ? (1 + (int)item32.gr1) : 1;
                                            if (prReExam == primaryEnumId) item32.gr2 = item32.gr2 != 0 ? (1 + (int)item32.gr2) : 1;
                                            //if () item32.gr3 = item32.gr3 != 0 ? (1 + (int)item32.gr3) : 1;
                                            if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                            {
                                                item32.gr4 = item32.gr4 != 0 ? (1 + (int)item32.gr4) : 1;
                                            }
                                            if (reasonDis == reasonDisEnumdId2 && group == notInstalled) item32.gr5 = item32.gr5 != 0 ? (1 + (int)item32.gr5) : 1;
                                            if (prReExam != primaryEnumId && group == notInstalled) item32.gr6 = item32.gr6 != 0 ? (1 + (int)item32.gr6) : 1;
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            static void RemoveRows(WorkflowContext context, Guid reportId)
            {
                var docRepo = context.Documents;
                var rows = new List<Guid>();
                var qb = new QueryBuilder(reportItemDefId, context.UserId);
                qb.Where("Report").Eq(reportId).Or("Report").IsNull();
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read()) rows.Add(reader.GetGuid(0));
                }
                foreach (var rowId in rows)
                {
                    docRepo.DeleteById(rowId);
                }
            }
            private static readonly Guid reportDefId = new Guid("{17789FEE-2908-4E01-8E16-2ECAF4A75C7A}"); //Отчет о распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности
            private static readonly Guid reportItemDefId = new Guid("{10AB1374-EA9C-493B-B5F6-CD6A40273B9B}"); //Распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности

            private static readonly Guid adultsStatCardDefId = new Guid("{C77A6FF6-EC0B-4562-81FE-BB3BC17F4FDB}"); //Статистический талон для взрослых
            private static readonly Guid adultsActDefId = new Guid("{12AE380B-39CE-4753-A556-4083BD4B0F92}"); //Медицинский акт для взрослых
            private static readonly Guid personDefId = new Guid("{D71CE61A-9B59-4B5E-8713-8131DBB5BA02}"); //Person 
            public static readonly Guid districtDefId = new Guid("{A3FCA356-82A9-4BBD-872A-8333BEC6E41A}"); //Район
            public static readonly Guid cityDefId = new Guid("{4BB6D32D-5181-4031-BA49-CF5910D6D883}"); //Города районного значения

            public static readonly Guid goalForGroup = new Guid("{8FD84B27-FF2A-40A4-A87A-BC254DC9D853}"); //Цель -> Для установления группы

            public static readonly Guid ageOf1EnumId = new Guid("{027AEA0C-3C1D-4354-BEFF-4C89E06AF8B5}"); //От 18-29 лет
            public static readonly Guid ageOf2EnumId = new Guid("{6FC02932-97DD-48B9-93C8-FBD017C86707}"); //От 30-44 лет
            public static readonly Guid ageOf3EnumId = new Guid("{336A7447-4E55-44B8-8BA0-D7A156B7444A}"); //От 45-до пенсионного возраста
            public static readonly Guid ageOf4EnumId = new Guid("{9B207DB0-8214-4BA7-A8C4-635EF87B583A}"); //лицо пенсионного возраста

            public static readonly Guid group1EnumId = new Guid("{D145ABA1-EADA-442B-9D8D-AD10BCD126D2}"); //Первая
            public static readonly Guid group2EnumId = new Guid("{C161DA2D-2883-4211-B444-CBB04DBF33D5}"); //Вторая
            public static readonly Guid group3EnumId = new Guid("{CCD439CA-1500-4F7A-A1C8-BB474B5DE8AA}"); //Третья
            public static readonly Guid notInstalled = new Guid("{C52CCD68-96D8-4E0A-A8ED-30B482C1CF18}"); //Не установлена

            public static readonly Guid cityEnumId = new Guid("{DE3D24A1-64D3-4647-B711-31F334D24416}"); //Городская местность//DistrictType
            public static readonly Guid villageEnumId = new Guid("{65DF9C4D-A18B-4080-855F-4800E2A19C35}"); //Cская местность//DistrictType
            public static readonly Guid womanEnumId = new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"); //Женский пол
            public static readonly Guid primaryEnumId = new Guid("{34129BC5-5B31-4189-87FA-799402F7E99F}"); //Первичное
            public static readonly Guid ApprovedStateId = new Guid("{32062CB7-C31C-4AFB-ADF3-F9F9AEEFCE59}");  //Подписанные

            //фактическое исполнение
            public static readonly Guid implementedId1 = new Guid("{49162394-ABE3-496A-A1B5-823566283AE4}"); //Выполнено
            public static readonly Guid implementedId2 = new Guid("{B7CE10F4-F53E-4465-A954-2B89BFF77F74}"); //Не выполнено
            public static readonly Guid implementedId3 = new Guid("{CD12709D-6AFC-491A-9D70-D298246476D3}"); //Частично

            //Обеспечение профессиональной ориентации
            public static readonly Guid j6EnumId1 = new Guid("{E61F2E04-0097-4609-98E1-3B3D95A25A8F}"); //В условиях производства
            public static readonly Guid j6EnumId2 = new Guid("{E2F8330E-D94F-4C5A-B6B9-56C42213BCE1}"); //В профессионально-технических учреждениях системы органов социальной защиты
            public static readonly Guid j6EnumId3 = new Guid("{1E5508BA-AF0C-4B12-BA06-B3F98FAB9F82}"); //В профессионально-технических учреждениях системы образования            
            public static readonly Guid j6EnumId4 = new Guid("{8F188272-E396-4146-BDFE-8247D364AE56}"); //В высших учебных заведениях

            //причины инвалидности
            private static readonly Guid reasonDisEnumdId1 = new Guid("{3A8053A5-CD06-49D3-A551-2247655B13C3}"); //	Общее заболевание
            private static readonly Guid reasonDisEnumdId2 = new Guid("{9AF55221-0264-4349-9B36-A8E1313250B6}"); //	ЛОВЗ с детства
            private static readonly Guid reasonDisEnumdId3 = new Guid("{2E3209F0-0002-4DA2-9E63-6FAEDDF1983D}"); //	Трудовое увечье
            private static readonly Guid reasonDisEnumdId4 = new Guid("{383E70E5-E9BE-4AE5-B5DF-323D4463DD51}"); //	Профессиональное заболевание
            private static readonly Guid reasonDisEnumdId5 = new Guid("{0CD8E76E-CF20-41CF-B7EE-4FE85EA39435}"); //	Военная травма (если увечье, заболевание получено лицом, проходящим освидетельствование, при "исполнении обязанностей военной службы")
            private static readonly Guid reasonDisEnumdId6 = new Guid("{4A8BC253-701C-44FB-B840-10F6BD8E97BD}"); //	Заболевание "получено в период прохождения военной службы"
            private static readonly Guid reasonDisEnumdId7 = new Guid("{1A607F61-EDDD-4A7B-9FBF-55483127D986}"); //	Заболевание "нет, не связано с военной службой"
            private static readonly Guid reasonDisEnumdId8 = new Guid("{41313E17-2275-4027-9563-5323FF096E3F}"); //	Заболевание "да, получено в период прохождения службы" в органах внутренних дел
            private static readonly Guid reasonDisEnumdId9 = new Guid("{68E6804C-046A-45AD-9AD8-1C50C4026530}"); //	Заболевание "нет, не связано со службой в органах внутренних дел"
            private static readonly Guid reasonDisEnumdId10 = new Guid("{8AA8807E-A40A-44D2-839C-5270E9F2C52C}"); // Ранение (контузия, травма, увечье) "нет, не связано с военной службой"
            private static readonly Guid reasonDisEnumdId11 = new Guid("{04F87DB6-EBB7-4B09-8856-F7DFF538479E}"); //	Ранение (контузия, травма, увечье) "да, получено при защите СССР"
            private static readonly Guid reasonDisEnumdId12 = new Guid("{119DC79B-42D0-4102-AE42-A902A4EF806B}"); // Ранение (контузия, травма, увечье) "да, получено при исполнении обязанностей службы в органах внутренних дел"
            private static readonly Guid reasonDisEnumdId13 = new Guid("{A6EABF70-F864-4A97-B528-839DE6607B07}"); // Заболевание связано с катастрофой на ЧАЭС
            private static readonly Guid reasonDisEnumdId14 = new Guid("{9FB37C19-2251-41FD-ABAA-7E3CD243CCDF}"); // Заболевание связано с испытанием ядерного оружия на Семипалатинском полигоне
            private static readonly Guid reasonDisEnumdId15 = new Guid("{1A2B628F-CC8C-49C9-8774-561EB1812AE5}"); // Травма, полученная в событиях, произошедших 6 апреля 2010 года в Таласской области КР
            private static readonly Guid reasonDisEnumdId16 = new Guid("{6FF1C743-3767-4D73-A035-1F8647C88F5F}"); // Травма, полученная в событиях, произошедших 7 апреля 2010 года в городе Бишкек КР
            private static readonly Guid reasonDisEnumdId17 = new Guid("{9289772B-C917-4EC0-BC60-45D69BA8D855}"); // Травма, полученная в событиях, произошедших 13-14, а также 19 мая 2010 года в городе Джалал-Абад КР
            private static readonly Guid reasonDisEnumdId18 = new Guid("{99159F4A-BB7C-4A5C-AD48-B71E7592DF08}"); // Травма, полученная в июньских событиях 2010 года в городе Ош и Ошской, Джалал-Абадской областях КР
        }

        /***********************************************************************************************************************/
        /*Форма 7Д*/
        //Отчет о результатах первичных освидетельствований всех социальных категорий населения (ГОРОДСКАЯ МЕСТНОСТЬ) 
        public static class PrimaryInvalids18Age
        {
            public static List<Report7D1Item> Execute(WorkflowContext context, int year, string distrSpr)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;

                /******************************************************************************************************************/
                var docs = new string[]
                {
                    "Освидетельствовано всего  01  ",
                    "В том числе для определения статуса «ребенок-инвалид»  02  ",
                    "Не признаны инвалидами  03  ",
                    "Из них признаны инвалидами по категории «ребенок-инвалид»  04  ",
                    "Из них вследствие аварии на ЧАЭС  04.1",
                    "Освидетельствованы для других целей  05  ",
                    "В том числе представление кресла-коляски  05.1",
                    "Определение в дом инвалидов, дом интернат  05.2",
                    "Для сложных консультаций  05.3",
                    "прочие  05.4",
                    "Инвалидность установлена на 1 год",
                    "Инвалидность установлена на 2 года",
                    "Инвалидность установлена на 5 лет",
                    "Инвалидность установлена до 18 лет"
                };
                var items = new List<Report7D1Item>();
                int i2 = 1;
                foreach (var i in docs)
                {
                    var item = new Report7D1Item();
                    item.rowName = i;
                    item.rowNo = i2;
                    i2++;
                    items.Add(item);
                }
                CalcItems(context, /*report, */year, orgId, distrSpr,
                    items[13], items[12], items[11], items[10], items[9], items[8], items[7],
                    items[6], items[5], items[4], items[3], items[2], items[1], items[0]);
                return items;
            }
            public static void CalcItems(WorkflowContext context, int year, Guid orgId, string distrSpr,
                Report7D1Item item13, Report7D1Item item12, Report7D1Item item11, Report7D1Item item10,
                Report7D1Item item9, Report7D1Item item8, Report7D1Item item7, Report7D1Item item6,
                Report7D1Item item5, Report7D1Item item4, Report7D1Item item3, Report7D1Item item2,
                Report7D1Item item1, Report7D1Item item0)
            {
                var qb = new QueryBuilder(childStatCardDefId, context.UserId);
                qb.Where("&State").Eq(ApprovedStateId).And("Examination1").Eq(primaryEnumId);

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Person");                   
                    var actSrc = query.JoinSource(query.Source, childActDefId, SqlSourceJoinType.Inner, "ChildrensMedicalCertificate");
                    var distrSrc = query.JoinSource(actSrc, districtDefId, SqlSourceJoinType.LeftOuter, "DistrictId");
                    var citySrc = query.JoinSource(actSrc, cityDefId, SqlSourceJoinType.LeftOuter, "CityId");
                    query.AddCondition(ExpressionOperation.And, childStatCardDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    if (!string.IsNullOrEmpty(distrSpr))
                        query.AddCondition(ExpressionOperation.And, districtDefId, "NumberDis", ConditionOperation.Equal, distrSpr);

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(query.Source, "EndDateExamination");
                    query.AddAttribute(personSrc, "Gender");
                    query.AddAttribute(query.Source, "AgeOf1");
                    query.AddAttribute(query.Source, "goal");
                    query.AddAttribute(query.Source, "DisabilityGroup");
                    query.AddAttribute(query.Source, "goal1");
                    query.AddAttribute(query.Source, "goal2");
                    query.AddAttribute(query.Source, "goal3");
                    query.AddAttribute(query.Source, "goal4");
                    query.AddAttribute(query.Source, "goal5");
                    query.AddAttribute(query.Source, "goal6");
                    query.AddAttribute(query.Source, "goal7");
                    query.AddAttribute(query.Source, "goal8");
                    query.AddAttribute(query.Source, "goal9");
                    query.AddAttribute(query.Source, "goal11");
                    query.AddAttribute(query.Source, "goal12");
                    query.AddAttribute(query.Source, "goal13");
                    query.AddAttribute(query.Source, "goal14");
                    query.AddAttribute(query.Source, "goal15");
                    query.AddAttribute(query.Source, "goal16");
                    query.AddAttribute(query.Source, "goal17");
                    query.AddAttribute(query.Source, "goal18");
                    query.AddAttribute(query.Source, "term");
                    query.AddAttribute(distrSrc, "DistrictType");
                    query.AddAttribute(citySrc, "DistrictType");

                    var table = new DataTable();
                    using (var reader = context.CreateSqlReader(query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var date = !(row[1] is DBNull) ? (DateTime)row[1] : DateTime.MinValue;
                        var gender = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                        var ageOf = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                        var goal = row[4] is DBNull ? false : (bool)row[4];
                        var group = row[5] is DBNull ? Guid.Empty : (Guid)row[5];
                        var goal1 = row[6] is DBNull ? false : (bool)row[6];
                        var goal2 = row[7] is DBNull ? false : (bool)row[7];
                        var goal3 = row[8] is DBNull ? false : (bool)row[8];
                        var goal4 = row[9] is DBNull ? false : (bool)row[9];
                        var goal5 = row[10] is DBNull ? false : (bool)row[10];
                        var goal6 = row[11] is DBNull ? false : (bool)row[11];
                        var goal7 = row[12] is DBNull ? false : (bool)row[12];
                        var goal8 = row[13] is DBNull ? false : (bool)row[13];
                        var goal9 = row[14] is DBNull ? Guid.Empty : (Guid)row[14];
                        var goal11 = row[15] is DBNull ? false : (bool)row[15];
                        var goal12 = row[16] is DBNull ? false : (bool)row[16];
                        var goal13 = row[17] is DBNull ? false : (bool)row[17];
                        var goal14 = row[18] is DBNull ? false : (bool)row[18];
                        var goal15 = row[19] is DBNull ? false : (bool)row[19];
                        var goal16 = row[20] is DBNull ? false : (bool)row[20];
                        var goal17 = row[21] is DBNull ? false : (bool)row[21];
                        var goal18 = row[22] is DBNull ? false : (bool)row[22];                        
                        var term = row[23] is DBNull ? Guid.Empty : (Guid)row[23];                        
                        var district = row[24] is DBNull ? Guid.Empty : (Guid)row[24];
                        var city = row[25] is DBNull ? Guid.Empty : (Guid)row[25];

                        if (appId != Guid.Empty)
                        {
                            if (date.Year == year)
                            {
                                item0.gr1 = item0.gr1 != 0 ? (1 + (int)item0.gr1) : 1;
                                if (gender == womanEnumId) item0.gr2 = item0.gr2 != 0 ? (1 + (int)item0.gr2) : 1;
                                if (ageOf == ageOf1EnumId) item0.gr3 = item0.gr3 != 0 ? (1 + (int)item0.gr3) : 1;
                                if (ageOf == ageOf2EnumId) item0.gr4 = item0.gr4 != 0 ? (1 + (int)item0.gr4) : 1;
                                if (ageOf == ageOf3EnumId) item0.gr5 = item0.gr5 != 0 ? (1 + (int)item0.gr5) : 1;
                                if (ageOf == ageOf4EnumId) item0.gr6 = item0.gr6 != 0 ? (1 + (int)item0.gr6) : 1;
                                if (district == cityEnumId || city == cityEnumId)
                                {
                                    item0.gr7 = item0.gr7 != 0 ? (1 + (int)item0.gr7) : 1;
                                    if (gender == womanEnumId) item0.gr8 = item0.gr8 != 0 ? (1 + (int)item0.gr8) : 1;
                                }
                                if (district == villageEnumId || city == villageEnumId)
                                {
                                    item0.gr9 = item0.gr9 != 0 ? (1 + (int)item0.gr9) : 1;
                                    if (gender == womanEnumId) item0.gr10 = item0.gr10 != 0 ? (1 + (int)item0.gr10) : 1;
                                }
                                /***********/
                                if (goal)
                                {
                                    item1.gr1 = item1.gr1 != 0 ? (1 + (int)item1.gr1) : 1;
                                    if (gender == womanEnumId) item1.gr2 = item1.gr2 != 0 ? (1 + (int)item1.gr2) : 1;
                                    if (ageOf == ageOf1EnumId) item1.gr3 = item1.gr3 != 0 ? (1 + (int)item1.gr3) : 1;
                                    if (ageOf == ageOf2EnumId) item1.gr4 = item1.gr4 != 0 ? (1 + (int)item1.gr4) : 1;
                                    if (ageOf == ageOf3EnumId) item1.gr5 = item1.gr5 != 0 ? (1 + (int)item1.gr5) : 1;
                                    if (ageOf == ageOf4EnumId) item1.gr6 = item1.gr6 != 0 ? (1 + (int)item1.gr6) : 1;
                                    if (district == cityEnumId || city == cityEnumId)
                                    {
                                        item1.gr7 = item1.gr7 != 0 ? (1 + (int)item1.gr7) : 1;
                                        if (gender == womanEnumId) item1.gr8 = item1.gr8 != 0 ? (1 + (int)item1.gr8) : 1;
                                    }
                                    if (district == villageEnumId || city == villageEnumId)
                                    {
                                        item1.gr9 = item1.gr9 != 0 ? (1 + (int)item1.gr9) : 1;
                                        if (gender == womanEnumId) item1.gr10 = item1.gr10 != 0 ? (1 + (int)item1.gr10) : 1;
                                    }

                                    if (group == notInstalledEnId)
                                    {
                                        item2.gr1 = item2.gr1 != 0 ? (1 + (int)item2.gr1) : 1;
                                        if (gender == womanEnumId) item2.gr2 = item2.gr2 != 0 ? (1 + (int)item2.gr2) : 1;
                                        if (ageOf == ageOf1EnumId) item2.gr3 = item2.gr3 != 0 ? (1 + (int)item2.gr3) : 1;
                                        if (ageOf == ageOf2EnumId) item2.gr4 = item2.gr4 != 0 ? (1 + (int)item2.gr4) : 1;
                                        if (ageOf == ageOf3EnumId) item2.gr5 = item2.gr5 != 0 ? (1 + (int)item2.gr5) : 1;
                                        if (ageOf == ageOf4EnumId) item2.gr6 = item2.gr6 != 0 ? (1 + (int)item2.gr6) : 1;
                                        if (district == cityEnumId || city == cityEnumId)
                                        {
                                            item2.gr7 = item2.gr7 != 0 ? (1 + (int)item2.gr7) : 1;
                                            if (gender == womanEnumId) item2.gr8 = item2.gr8 != 0 ? (1 + (int)item2.gr8) : 1;
                                        }
                                        if (district == villageEnumId || city == villageEnumId)
                                        {
                                            item2.gr9 = item2.gr9 != 0 ? (1 + (int)item2.gr9) : 1;
                                            if (gender == womanEnumId) item2.gr10 = item2.gr10 != 0 ? (1 + (int)item2.gr10) : 1;
                                        }
                                    }
                                    if (group == childGroupEnId)
                                    {
                                        item3.gr1 = item3.gr1 != 0 ? (1 + (int)item3.gr1) : 1;
                                        if (gender == womanEnumId) item3.gr2 = item3.gr2 != 0 ? (1 + (int)item3.gr2) : 1;
                                        if (ageOf == ageOf1EnumId) item3.gr3 = item3.gr3 != 0 ? (1 + (int)item3.gr3) : 1;
                                        if (ageOf == ageOf2EnumId) item3.gr4 = item3.gr4 != 0 ? (1 + (int)item3.gr4) : 1;
                                        if (ageOf == ageOf3EnumId) item3.gr5 = item3.gr5 != 0 ? (1 + (int)item3.gr5) : 1;
                                        if (ageOf == ageOf4EnumId) item3.gr6 = item3.gr6 != 0 ? (1 + (int)item3.gr6) : 1;
                                        if (district == cityEnumId || city == cityEnumId)
                                        {
                                            item3.gr7 = item3.gr7 != 0 ? (1 + (int)item3.gr7) : 1;
                                            if (gender == womanEnumId) item3.gr8 = item3.gr8 != 0 ? (1 + (int)item3.gr8) : 1;
                                        }
                                        if (district == villageEnumId || city == villageEnumId)
                                        {
                                            item3.gr9 = item3.gr9 != 0 ? (1 + (int)item3.gr9) : 1;
                                            if (gender == womanEnumId) item3.gr10 = item3.gr10 != 0 ? (1 + (int)item3.gr10) : 1;
                                        }
                                    }
                                    //item4 ?????

                                    if (goal1 || goal2 || goal3 || goal4 || goal5 || goal6 || goal7 || goal8 || goal9 != Guid.Empty ||
                                        goal11 || goal12 || goal13 || goal14 || goal15 || goal16 || goal17 || goal18)
                                    {
                                        item5.gr1 = item5.gr1 != 0 ? (1 + (int)item5.gr1) : 1;
                                        if (gender == womanEnumId) item5.gr2 = item5.gr2 != 0 ? (1 + (int)item5.gr2) : 1;
                                        if (ageOf == ageOf1EnumId) item5.gr3 = item5.gr3 != 0 ? (1 + (int)item5.gr3) : 1;
                                        if (ageOf == ageOf2EnumId) item5.gr4 = item5.gr4 != 0 ? (1 + (int)item5.gr4) : 1;
                                        if (ageOf == ageOf3EnumId) item5.gr5 = item5.gr5 != 0 ? (1 + (int)item5.gr5) : 1;
                                        if (ageOf == ageOf4EnumId) item5.gr6 = item5.gr6 != 0 ? (1 + (int)item5.gr6) : 1;
                                        if (district == cityEnumId || city == cityEnumId)
                                        {
                                            item5.gr7 = item5.gr7 != 0 ? (1 + (int)item5.gr7) : 1;
                                            if (gender == womanEnumId) item5.gr8 = item5.gr8 != 0 ? (1 + (int)item5.gr8) : 1;
                                        }
                                        if (district == villageEnumId || city == villageEnumId)
                                        {
                                            item5.gr9 = item5.gr9 != 0 ? (1 + (int)item5.gr9) : 1;
                                            if (gender == womanEnumId) item5.gr10 = item5.gr10 != 0 ? (1 + (int)item5.gr10) : 1;
                                        }

                                        if (goal11)
                                        {
                                            item6.gr1 = item6.gr1 != 0 ? (1 + (int)item6.gr1) : 1;
                                            if (gender == womanEnumId) item6.gr2 = item6.gr2 != 0 ? (1 + (int)item6.gr2) : 1;
                                            if (ageOf == ageOf1EnumId) item6.gr3 = item6.gr3 != 0 ? (1 + (int)item6.gr3) : 1;
                                            if (ageOf == ageOf2EnumId) item6.gr4 = item6.gr4 != 0 ? (1 + (int)item6.gr4) : 1;
                                            if (ageOf == ageOf3EnumId) item6.gr5 = item6.gr5 != 0 ? (1 + (int)item6.gr5) : 1;
                                            if (ageOf == ageOf4EnumId) item6.gr6 = item6.gr6 != 0 ? (1 + (int)item6.gr6) : 1;
                                            if (district == cityEnumId || city == cityEnumId)
                                            {
                                                item6.gr7 = item6.gr7 != 0 ? (1 + (int)item6.gr7) : 1;
                                                if (gender == womanEnumId) item6.gr8 = item6.gr8 != 0 ? (1 + (int)item6.gr8) : 1;
                                            }
                                            if (district == villageEnumId || city == villageEnumId)
                                            {
                                                item6.gr9 = item6.gr9 != 0 ? (1 + (int)item6.gr9) : 1;
                                                if (gender == womanEnumId) item6.gr10 = item6.gr10 != 0 ? (1 + (int)item6.gr10) : 1;
                                            }
                                        }

                                        if (goal9 != Guid.Empty)
                                        {
                                            item7.gr1 = item7.gr1 != 0 ? (1 + (int)item7.gr1) : 1;
                                            if (gender == womanEnumId) item7.gr2 = item7.gr2 != 0 ? (1 + (int)item7.gr2) : 1;
                                            if (ageOf == ageOf1EnumId) item7.gr3 = item7.gr3 != 0 ? (1 + (int)item7.gr3) : 1;
                                            if (ageOf == ageOf2EnumId) item7.gr4 = item7.gr4 != 0 ? (1 + (int)item7.gr4) : 1;
                                            if (ageOf == ageOf3EnumId) item7.gr5 = item7.gr5 != 0 ? (1 + (int)item7.gr5) : 1;
                                            if (ageOf == ageOf4EnumId) item7.gr6 = item7.gr6 != 0 ? (1 + (int)item7.gr6) : 1;
                                            if (district == cityEnumId || city == cityEnumId)
                                            {
                                                item7.gr7 = item7.gr7 != 0 ? (1 + (int)item7.gr7) : 1;
                                                if (gender == womanEnumId) item7.gr8 = item7.gr8 != 0 ? (1 + (int)item7.gr8) : 1;
                                            }
                                            if (district == villageEnumId || city == villageEnumId)
                                            {
                                                item7.gr9 = item7.gr9 != 0 ? (1 + (int)item7.gr9) : 1;
                                                if (gender == womanEnumId) item7.gr10 = item7.gr10 != 0 ? (1 + (int)item7.gr10) : 1;
                                            }
                                        }
                                        if (goal17)
                                        {
                                            item8.gr1 = item8.gr1 != 0 ? (1 + (int)item8.gr1) : 1;
                                            if (gender == womanEnumId) item8.gr2 = item8.gr2 != 0 ? (1 + (int)item8.gr2) : 1;
                                            if (ageOf == ageOf1EnumId) item8.gr3 = item8.gr3 != 0 ? (1 + (int)item8.gr3) : 1;
                                            if (ageOf == ageOf2EnumId) item8.gr4 = item8.gr4 != 0 ? (1 + (int)item8.gr4) : 1;
                                            if (ageOf == ageOf3EnumId) item8.gr5 = item8.gr5 != 0 ? (1 + (int)item8.gr5) : 1;
                                            if (ageOf == ageOf4EnumId) item8.gr6 = item8.gr6 != 0 ? (1 + (int)item8.gr6) : 1;
                                            if (district == cityEnumId || city == cityEnumId)
                                            {
                                                item8.gr7 = item8.gr7 != 0 ? (1 + (int)item8.gr7) : 1;
                                                if (gender == womanEnumId) item8.gr8 = item8.gr8 != 0 ? (1 + (int)item8.gr8) : 1;
                                            }
                                            if (district == villageEnumId || city == villageEnumId)
                                            {
                                                item8.gr9 = item8.gr9 != 0 ? (1 + (int)item8.gr9) : 1;
                                                if (gender == womanEnumId) item8.gr10 = item8.gr10 != 0 ? (1 + (int)item8.gr10) : 1;
                                            }
                                        }
                                        if (goal1 || goal2 || goal3 || goal4 || goal5 || goal6 || goal8 ||
                                            goal12 || goal13 || goal14 || goal15 || goal16 || goal18)
                                        {
                                            item9.gr1 = item9.gr1 != 0 ? (1 + (int)item9.gr1) : 1;
                                            if (gender == womanEnumId) item9.gr2 = item9.gr2 != 0 ? (1 + (int)item9.gr2) : 1;
                                            if (ageOf == ageOf1EnumId) item9.gr3 = item9.gr3 != 0 ? (1 + (int)item9.gr3) : 1;
                                            if (ageOf == ageOf2EnumId) item9.gr4 = item9.gr4 != 0 ? (1 + (int)item9.gr4) : 1;
                                            if (ageOf == ageOf3EnumId) item9.gr5 = item9.gr5 != 0 ? (1 + (int)item9.gr5) : 1;
                                            if (ageOf == ageOf4EnumId) item9.gr6 = item9.gr6 != 0 ? (1 + (int)item9.gr6) : 1;
                                            if (district == cityEnumId || city == cityEnumId)
                                            {
                                                item9.gr7 = item9.gr7 != 0 ? (1 + (int)item9.gr7) : 1;
                                                if (gender == womanEnumId) item9.gr8 = item9.gr8 != 0 ? (1 + (int)item9.gr8) : 1;
                                            }
                                            if (district == villageEnumId || city == villageEnumId)
                                            {
                                                item9.gr9 = item9.gr9 != 0 ? (1 + (int)item9.gr9) : 1;
                                                if (gender == womanEnumId) item9.gr10 = item9.gr10 != 0 ? (1 + (int)item9.gr10) : 1;
                                            }
                                        }
                                    }
                                    if (term == termEnumId1) item10.gr1 = item10.gr1 != 0 ? (1 + (int)item10.gr1) : 1;
                                    if (term == termEnumId2) item11.gr1 = item11.gr1 != 0 ? (1 + (int)item11.gr1) : 1;
                                    if (term == termEnumId3) item12.gr1 = item12.gr1 != 0 ? (1 + (int)item12.gr1) : 1;
                                    if (term == termEnumId4) item13.gr1 = item13.gr1 != 0 ? (1 + (int)item13.gr1) : 1;
                                }
                            }
                        }
                    }
                }
            }
            static void RemoveRows(WorkflowContext context, Guid reportId)
            {
                var docRepo = context.Documents;
                var rows = new List<Guid>();
                var qb = new QueryBuilder(reportItemDefId, context.UserId);
                qb.Where("Report").Eq(reportId).Or("Report").IsNull();
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read()) rows.Add(reader.GetGuid(0));
                }
                foreach (var rowId in rows)
                {
                    docRepo.DeleteById(rowId);
                }
            }
            private static readonly Guid reportDefId = new Guid("{17789FEE-2908-4E01-8E16-2ECAF4A75C7A}"); //Отчет о распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности
            private static readonly Guid reportItemDefId = new Guid("{10AB1374-EA9C-493B-B5F6-CD6A40273B9B}"); //Распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности

            private static readonly Guid childStatCardDefId = new Guid("{363E89D0-5E31-45B5-82B7-42E83DF96E1F}"); //Статистический талон ребенка с ОВЗ
            private static readonly Guid childActDefId = new Guid("{0ECF44B6-2B2D-4687-B7B0-07BA5F942AC6}"); //Медицинский акт ребенка с ОВЗ
            private static readonly Guid personDefId = new Guid("{D71CE61A-9B59-4B5E-8713-8131DBB5BA02}"); //Person 
            public static readonly Guid districtDefId = new Guid("{A3FCA356-82A9-4BBD-872A-8333BEC6E41A}"); //Район
            public static readonly Guid cityDefId = new Guid("{4BB6D32D-5181-4031-BA49-CF5910D6D883}"); //Города районного значения

            public static readonly Guid goalForGroup = new Guid("{8FD84B27-FF2A-40A4-A87A-BC254DC9D853}"); //Цель -> Для установления группы

            public static readonly Guid ageOf1EnumId = new Guid("{484C1AF3-3203-478D-97B4-B7977738A194}"); //От 0-3 лет
            public static readonly Guid ageOf2EnumId = new Guid("{124DA030-994C-4F2D-AD5F-750986CCDC96}"); //От 4-7 лет
            public static readonly Guid ageOf3EnumId = new Guid("{CFDA5599-9767-430E-AC90-632D3FBDBF1F}"); //От 8-14 лет
            public static readonly Guid ageOf4EnumId = new Guid("{30DA048C-85C4-4078-9A63-0CDB40A7747A}"); //От 15-17 лет

            //Инвалидность установлена на срок
            public static readonly Guid termEnumId1 = new Guid("{C0C639C1-4069-42BD-B9C5-0C4C0EAD41CE}"); //1 год
            public static readonly Guid termEnumId2 = new Guid("{CAB664A9-513D-4939-AB17-31ACF97C7592}"); //2 года
            public static readonly Guid termEnumId3 = new Guid("{4C270330-A4A0-40B7-9E2C-6726AE4BAD6C}"); //5 лет
            public static readonly Guid termEnumId4 = new Guid("{B1F91F0F-EA5C-4DA4-9DE6-C3FC0142E66F}"); //до 18 лет

            public static readonly Guid childGroupEnId = new Guid("{D145ABA1-EADA-442B-9D8D-AD10BCD126D2}"); //Ребенок с ОВЗ
            public static readonly Guid notInstalledEnId = new Guid("{BEB4542B-0C03-494A-BD60-AA6BA8E8BF4C}"); //Не установлена

            public static readonly Guid cityEnumId = new Guid("{DE3D24A1-64D3-4647-B711-31F334D24416}"); //Городская местность//DistrictType
            public static readonly Guid villageEnumId = new Guid("{65DF9C4D-A18B-4080-855F-4800E2A19C35}"); //Cская местность//DistrictType
            public static readonly Guid womanEnumId = new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"); //Женский пол
            public static readonly Guid primaryEnumId = new Guid("{34129BC5-5B31-4189-87FA-799402F7E99F}"); //Первичное
            public static readonly Guid ApprovedStateId = new Guid("{32062CB7-C31C-4AFB-ADF3-F9F9AEEFCE59}");  //Подписанные
        }

        //Результаты первичных освидетельствований  детей в возрасте до 18 лет (человек), проживающих в (ГОРОДСКАЯ МЕСТНОСТЬ)
        public static class PrimaryInvalidsOfCity18Age
        {
            public static List<Report7D2Item> Execute(WorkflowContext context, int year, string distrSpr)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;

                /******************************************************************************************************************/
                var docs = new string[]
                {
                     "всего в том числе:  01          ",
                    "туберкулез  02    А15-19",
                    "новообразования  03    С00-97",
                    "б-ни эндокринной системы, расст-ва питания и нарушения обмена веществ  04    Е00-90",
                    "из них сахарный диабет  04.1  Е10-14",
                    "заболевания щитовидной железы  04.2  Е00-07",
                    "психические расстройства и расстройства поведения  05    F00-99",
                    "из них умственная отсталость  05.2  F70-79",
                    "из числа с умст.отсталостью, вследствие ДЦП  05.21 F70-79",
                    "расстройства психологического развития  05.3  F80-89",
                    "болезни нервной системы  06    G00-99",
                    "из них восп-ые болезни ЦНС  06.1  G00-09",
                    "другие дегенеративные болезни ЦНС  06.2  G30-47",
                    "Детский церебральный паралич  06.3  G80-83",
                    "Др.нарушения нервной системы  06.4  G90-99",
                    "Последствия инфекц.болезней ЦНС  07    B90-94",
                    "Болезни органов чувств  08    H00-95",
                    "Болезни глаз  08.1  H00-59",
                    "Болезни уха и сосцевидного отростка  08.2  H60-95",
                    "Болезни системы кровообращения  09    I00-99",
                    "Ревматические болезни сердца  09.1  I05-09",
                    "Болезни органов дыхания  10    J00-99",
                    "Из них астма  10.1  J45",
                    "Болезни органов пищеварения  11  K00-93",
                    "Костно-мышечной системы и соединительной ткани  12    M00-99",
                    "Из них дорсопатии  12.1  M40-54",
                    "Остеопатии, хондропатии  12.2  M80-94",
                    "Б-ни мочеполовой системы  13    N00-99",
                    "Врожденные аномалии(пороки развития), деформация и хромосомные нарушения  14    Q00-99",
                    "Из них аномалии ЦНС  14.1  Q00-07",
                    "Органов чувств  14.2  Q10-18",
                    "Зрения  14.21 Q10-15",
                    "Слуха  14.22 Q16-18",
                    "Аномалии системы кровообращения  14.3  Q20-28",
                    "Врожденные аномалии костно-мышечной системы  14.4  Q65-79",
                    "Хромосомные аномалии  14.5  Q90-99",
                    "Состояния, возникающие в перинатальном периоде  15    P00-96",
                    "Травмы, отравления, др.воздействия внешних причин  16    S00-T98",
                    "Б-нь, вызванная ВИЧ  17    B20-24",
                    "Б-ни, вызванные облучением (ЧАЭС)  18    W-88  ",
                    "Доброкачественные новообразования  19    D10-36",
                    "Болезни крови  20    D50-89",
                    "Эхинококкоз  21    B-67",
                    "Бруцеллез  22    A-23",
                    "Прочие болезни  23          "
                };
                var items = new List<Report7D2Item>();
                int i2 = 1;
                foreach (var i in docs)
                {
                    var item = new Report7D2Item();
                    item.rowName = i;
                    item.rowNo = i2;
                    i2++;
                    items.Add(item);
                }
                CalcItems(context, /*report, */year, orgId, distrSpr,
                    items[44], items[43], items[42], items[41], items[40], items[39],
                    items[38], items[37], items[36], items[35], items[34], items[33], items[32],
                    items[31], items[30], items[29], items[28], items[27], items[26], items[25],
                    items[24], items[23], items[22], items[21], items[20], items[19], items[18],
                    items[17], items[16], items[15], items[14], items[13], items[12], items[11],
                    items[10], items[9], items[8], items[7], items[6], items[5], items[4],
                    items[3], items[2], items[1], items[0]);
                return items;
            }
            public static void CalcItems(WorkflowContext context, int year, Guid orgId, string distrSpr,
                    Report7D2Item item44, Report7D2Item item43, Report7D2Item item42,
                    Report7D2Item item41, Report7D2Item item40, Report7D2Item item39, Report7D2Item item38,
                    Report7D2Item item37, Report7D2Item item36, Report7D2Item item35, Report7D2Item item34,
                    Report7D2Item item33, Report7D2Item item32, Report7D2Item item31, Report7D2Item item30,
                    Report7D2Item item29, Report7D2Item item28, Report7D2Item item27, Report7D2Item item26,
                    Report7D2Item item25, Report7D2Item item24, Report7D2Item item23, Report7D2Item item22,
                    Report7D2Item item21, Report7D2Item item20, Report7D2Item item19, Report7D2Item item18,
                    Report7D2Item item17, Report7D2Item item16, Report7D2Item item15, Report7D2Item item14,
                    Report7D2Item item13, Report7D2Item item12, Report7D2Item item11, Report7D2Item item10,
                    Report7D2Item item9, Report7D2Item item8, Report7D2Item item7, Report7D2Item item6,
                    Report7D2Item item5, Report7D2Item item4, Report7D2Item item3, Report7D2Item item2,
                    Report7D2Item item1, Report7D2Item item0)
            {
                var qb = new QueryBuilder(childStatCardDefId, context.UserId);
                qb.Where("&State").Eq(ApprovedStateId).And("Examination1").Eq(primaryEnumId);

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                    var actSrc = query.JoinSource(query.Source, childActDefId, SqlSourceJoinType.Inner, "ChildrensMedicalCertificate");
                    var distrSrc = query.JoinSource(actSrc, districtDefId, SqlSourceJoinType.LeftOuter, "DistrictId");
                    var citySrc = query.JoinSource(actSrc, cityDefId, SqlSourceJoinType.LeftOuter, "CityId");
                    query.AddCondition(ExpressionOperation.And, childStatCardDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    if (!string.IsNullOrEmpty(distrSpr))
                        query.AddCondition(ExpressionOperation.And, districtDefId, "NumberDis", ConditionOperation.Equal, distrSpr);

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(query.Source, "EndDateExamination");
                    query.AddAttribute(query.Source, "AgeOf1");
                    query.AddAttribute(query.Source, "Diagnosis");
                    query.AddAttribute(distrSrc, "DistrictType");
                    query.AddAttribute(citySrc, "DistrictType");
                    query.AddAttribute(personSrc, "Gender");

                    var table = new DataTable();
                    using (var reader = context.CreateSqlReader(query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var date = !(row[1] is DBNull) ? (DateTime)row[1] : DateTime.MinValue;
                        var ageOf = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                        var diagnos = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                        var district = row[4] is DBNull ? Guid.Empty : (Guid)row[4];
                        var city = row[5] is DBNull ? Guid.Empty : (Guid)row[5];
                        var gender = row[6] is DBNull ? Guid.Empty : (Guid)row[6];

                        if (appId != Guid.Empty)
                        {
                            if (date.Year == year && (district == cityEnumId) ||
                                date.Year == year && (city == cityEnumId))
                            {
                                item0.gr1 = item0.gr1 != 0 ? (1 + (int)item0.gr1) : 1;

                                if (gender == womanEnumId) item0.gr2 = item0.gr2 != 0 ? (1 + (int)item0.gr2) : 1;
                                //в том числе в возрасте
                                /*****************************************************************************************************************************/
                                if (ageOf == ageOf1EnumId)
                                {
                                    item0.gr3 = item0.gr3 != 0 ? (1 + (int)item0.gr3) : 1;
                                    if (gender == womanEnumId) item0.gr4 = item0.gr4 != 0 ? (1 + (int)item0.gr4) : 1;
                                }
                                if (ageOf == ageOf2EnumId)
                                {
                                    item0.gr5 = item0.gr5 != 0 ? (1 + (int)item0.gr5) : 1;
                                    if (gender == womanEnumId) item0.gr6 = item0.gr6 != 0 ? (1 + (int)item0.gr6) : 1;
                                }
                                if (ageOf == ageOf3EnumId)
                                {
                                    item0.gr7 = item0.gr7 != 0 ? (1 + (int)item0.gr7) : 1;
                                    if (gender == womanEnumId) item0.gr8 = item0.gr8 != 0 ? (1 + (int)item0.gr8) : 1;
                                }
                                if (ageOf == ageOf4EnumId)
                                {
                                    item0.gr9 = item0.gr9 != 0 ? (1 + (int)item0.gr9) : 1;
                                    if (gender == womanEnumId) item0.gr10 = item0.gr10 != 0 ? (1 + (int)item0.gr10) : 1;
                                }
                                //A15-19
                                if (diagnos == strDiagId1)
                                {
                                    item1.gr1 = item1.gr1 != 0 ? (1 + (int)item1.gr1) : 1;

                                    if (gender == womanEnumId) item1.gr2 = item1.gr2 != 0 ? (1 + (int)item1.gr2) : 1;
                                    //в том числе в возрасте
                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item1.gr3 = item1.gr3 != 0 ? (1 + (int)item1.gr3) : 1;
                                        if (gender == womanEnumId) item1.gr4 = item1.gr4 != 0 ? (1 + (int)item1.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item1.gr5 = item1.gr5 != 0 ? (1 + (int)item1.gr5) : 1;
                                        if (gender == womanEnumId) item1.gr6 = item1.gr6 != 0 ? (1 + (int)item1.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item1.gr7 = item1.gr7 != 0 ? (1 + (int)item1.gr7) : 1;
                                        if (gender == womanEnumId) item1.gr8 = item1.gr8 != 0 ? (1 + (int)item1.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item1.gr9 = item1.gr9 != 0 ? (1 + (int)item1.gr9) : 1;
                                        if (gender == womanEnumId) item1.gr10 = item1.gr10 != 0 ? (1 + (int)item1.gr10) : 1;
                                    }
                                }
                                /***********************/
                                if (diagnos == strDiagId3)
                                {
                                    item2.gr1 = item2.gr1 != 0 ? (1 + (int)item2.gr1) : 1;

                                    if (gender == womanEnumId) item2.gr2 = item2.gr2 != 0 ? (1 + (int)item2.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item2.gr3 = item2.gr3 != 0 ? (1 + (int)item2.gr3) : 1;
                                        if (gender == womanEnumId) item2.gr4 = item2.gr4 != 0 ? (1 + (int)item2.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item2.gr5 = item2.gr5 != 0 ? (1 + (int)item2.gr5) : 1;
                                        if (gender == womanEnumId) item2.gr6 = item2.gr6 != 0 ? (1 + (int)item2.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item2.gr7 = item2.gr7 != 0 ? (1 + (int)item2.gr7) : 1;
                                        if (gender == womanEnumId) item2.gr8 = item2.gr8 != 0 ? (1 + (int)item2.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item2.gr9 = item2.gr9 != 0 ? (1 + (int)item2.gr9) : 1;
                                        if (gender == womanEnumId) item2.gr10 = item2.gr10 != 0 ? (1 + (int)item2.gr10) : 1;
                                    }
                                }
                                /************************************************/
                                if (diagnos == strDiagId4)
                                {
                                    item3.gr1 = item3.gr1 != 0 ? (1 + (int)item3.gr1) : 1;

                                    if (gender == womanEnumId) item3.gr2 = item3.gr2 != 0 ? (1 + (int)item3.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item3.gr3 = item3.gr3 != 0 ? (1 + (int)item3.gr3) : 1;
                                        if (gender == womanEnumId) item3.gr4 = item3.gr4 != 0 ? (1 + (int)item3.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item3.gr5 = item3.gr5 != 0 ? (1 + (int)item3.gr5) : 1;
                                        if (gender == womanEnumId) item3.gr6 = item3.gr6 != 0 ? (1 + (int)item3.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item3.gr7 = item3.gr7 != 0 ? (1 + (int)item3.gr7) : 1;
                                        if (gender == womanEnumId) item3.gr8 = item3.gr8 != 0 ? (1 + (int)item3.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item3.gr9 = item3.gr9 != 0 ? (1 + (int)item3.gr9) : 1;
                                        if (gender == womanEnumId) item3.gr10 = item3.gr10 != 0 ? (1 + (int)item3.gr10) : 1;
                                    }
                                }
                                /***********************************************/
                                if (diagnos == strDiagId6)
                                {
                                    item4.gr1 = item4.gr1 != 0 ? (1 + (int)item4.gr1) : 1;

                                    if (gender == womanEnumId) item4.gr2 = item4.gr2 != 0 ? (1 + (int)item4.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item4.gr3 = item4.gr3 != 0 ? (1 + (int)item4.gr3) : 1;
                                        if (gender == womanEnumId) item4.gr4 = item4.gr4 != 0 ? (1 + (int)item4.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item4.gr5 = item4.gr5 != 0 ? (1 + (int)item4.gr5) : 1;
                                        if (gender == womanEnumId) item4.gr6 = item4.gr6 != 0 ? (1 + (int)item4.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item4.gr7 = item4.gr7 != 0 ? (1 + (int)item4.gr7) : 1;
                                        if (gender == womanEnumId) item4.gr8 = item4.gr8 != 0 ? (1 + (int)item4.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item4.gr9 = item4.gr9 != 0 ? (1 + (int)item4.gr9) : 1;
                                        if (gender == womanEnumId) item4.gr10 = item4.gr10 != 0 ? (1 + (int)item4.gr10) : 1;
                                    }
                                }
                                /*********************************************/
                                if (diagnos == strDiagId5)
                                {
                                    item5.gr1 = item5.gr1 != 0 ? (1 + (int)item5.gr1) : 1;

                                    if (gender == womanEnumId) item5.gr2 = item5.gr2 != 0 ? (1 + (int)item5.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item5.gr3 = item5.gr3 != 0 ? (1 + (int)item5.gr3) : 1;
                                        if (gender == womanEnumId) item5.gr4 = item5.gr4 != 0 ? (1 + (int)item5.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item5.gr5 = item5.gr5 != 0 ? (1 + (int)item5.gr5) : 1;
                                        if (gender == womanEnumId) item5.gr6 = item5.gr6 != 0 ? (1 + (int)item5.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item5.gr7 = item5.gr7 != 0 ? (1 + (int)item5.gr7) : 1;
                                        if (gender == womanEnumId) item5.gr8 = item5.gr8 != 0 ? (1 + (int)item5.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item5.gr9 = item5.gr9 != 0 ? (1 + (int)item5.gr9) : 1;
                                        if (gender == womanEnumId) item5.gr10 = item5.gr10 != 0 ? (1 + (int)item5.gr10) : 1;
                                    }
                                }
                                /*************************************/
                                if (diagnos == strDiagId7)
                                {
                                    item6.gr1 = item6.gr1 != 0 ? (1 + (int)item6.gr1) : 1;

                                    if (gender == womanEnumId) item6.gr2 = item6.gr2 != 0 ? (1 + (int)item6.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item6.gr3 = item6.gr3 != 0 ? (1 + (int)item6.gr3) : 1;
                                        if (gender == womanEnumId) item6.gr4 = item6.gr4 != 0 ? (1 + (int)item6.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item6.gr5 = item6.gr5 != 0 ? (1 + (int)item6.gr5) : 1;
                                        if (gender == womanEnumId) item6.gr6 = item6.gr6 != 0 ? (1 + (int)item6.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item6.gr7 = item6.gr7 != 0 ? (1 + (int)item6.gr7) : 1;
                                        if (gender == womanEnumId) item6.gr8 = item6.gr8 != 0 ? (1 + (int)item6.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item6.gr9 = item6.gr9 != 0 ? (1 + (int)item6.gr9) : 1;
                                        if (gender == womanEnumId) item6.gr10 = item6.gr10 != 0 ? (1 + (int)item6.gr10) : 1;
                                    }
                                }
                                /********************************************************/
                                if (diagnos == strDiagId9)
                                {
                                    item7.gr1 = item7.gr1 != 0 ? (1 + (int)item7.gr1) : 1;

                                    if (gender == womanEnumId) item7.gr2 = item7.gr2 != 0 ? (1 + (int)item7.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item7.gr3 = item7.gr3 != 0 ? (1 + (int)item7.gr3) : 1;
                                        if (gender == womanEnumId) item7.gr4 = item7.gr4 != 0 ? (1 + (int)item7.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item7.gr5 = item7.gr5 != 0 ? (1 + (int)item7.gr5) : 1;
                                        if (gender == womanEnumId) item7.gr6 = item7.gr6 != 0 ? (1 + (int)item7.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item7.gr7 = item7.gr7 != 0 ? (1 + (int)item7.gr7) : 1;
                                        if (gender == womanEnumId) item7.gr8 = item7.gr8 != 0 ? (1 + (int)item7.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item7.gr9 = item7.gr9 != 0 ? (1 + (int)item7.gr9) : 1;
                                        if (gender == womanEnumId) item7.gr10 = item7.gr10 != 0 ? (1 + (int)item7.gr10) : 1;
                                    }
                                }
                                /****************************************/
                                if (diagnos == strDiagId10)
                                {
                                    item8.gr1 = item8.gr1 != 0 ? (1 + (int)item8.gr1) : 1;

                                    if (gender == womanEnumId) item8.gr2 = item8.gr2 != 0 ? (1 + (int)item8.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item8.gr3 = item8.gr3 != 0 ? (1 + (int)item8.gr3) : 1;
                                        if (gender == womanEnumId) item8.gr4 = item8.gr4 != 0 ? (1 + (int)item8.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item8.gr5 = item8.gr5 != 0 ? (1 + (int)item8.gr5) : 1;
                                        if (gender == womanEnumId) item8.gr6 = item8.gr6 != 0 ? (1 + (int)item8.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item8.gr7 = item8.gr7 != 0 ? (1 + (int)item8.gr7) : 1;
                                        if (gender == womanEnumId) item8.gr8 = item8.gr8 != 0 ? (1 + (int)item8.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item8.gr9 = item8.gr9 != 0 ? (1 + (int)item8.gr9) : 1;
                                        if (gender == womanEnumId) item8.gr10 = item8.gr10 != 0 ? (1 + (int)item8.gr10) : 1;
                                    }
                                }
                                /*******************************************/
                                if (diagnos == strDiagId13)
                                {
                                    item9.gr1 = item9.gr1 != 0 ? (1 + (int)item9.gr1) : 1;

                                    if (gender == womanEnumId) item9.gr2 = item9.gr2 != 0 ? (1 + (int)item9.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item9.gr3 = item9.gr3 != 0 ? (1 + (int)item9.gr3) : 1;
                                        if (gender == womanEnumId) item9.gr4 = item9.gr4 != 0 ? (1 + (int)item9.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item9.gr5 = item9.gr5 != 0 ? (1 + (int)item9.gr5) : 1;
                                        if (gender == womanEnumId) item9.gr6 = item9.gr6 != 0 ? (1 + (int)item9.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item9.gr7 = item9.gr7 != 0 ? (1 + (int)item9.gr7) : 1;
                                        if (gender == womanEnumId) item9.gr8 = item9.gr8 != 0 ? (1 + (int)item9.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item9.gr9 = item9.gr9 != 0 ? (1 + (int)item9.gr9) : 1;
                                        if (gender == womanEnumId) item9.gr10 = item9.gr10 != 0 ? (1 + (int)item9.gr10) : 1;
                                    }
                                }
                                /***************************************/
                                if (diagnos == strDiagId16)
                                {
                                    item10.gr1 = item10.gr1 != 0 ? (1 + (int)item10.gr1) : 1;

                                    if (gender == womanEnumId) item10.gr2 = item10.gr2 != 0 ? (1 + (int)item10.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item10.gr3 = item10.gr3 != 0 ? (1 + (int)item10.gr3) : 1;
                                        if (gender == womanEnumId) item10.gr4 = item10.gr4 != 0 ? (1 + (int)item10.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item10.gr5 = item10.gr5 != 0 ? (1 + (int)item10.gr5) : 1;
                                        if (gender == womanEnumId) item10.gr6 = item10.gr6 != 0 ? (1 + (int)item10.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item10.gr7 = item10.gr7 != 0 ? (1 + (int)item10.gr7) : 1;
                                        if (gender == womanEnumId) item10.gr8 = item10.gr8 != 0 ? (1 + (int)item10.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item10.gr9 = item10.gr9 != 0 ? (1 + (int)item10.gr9) : 1;
                                        if (gender == womanEnumId) item10.gr10 = item10.gr10 != 0 ? (1 + (int)item10.gr10) : 1;
                                    }
                                }
                                /*********************************************/
                                if (diagnos == strDiagId17)
                                {
                                    item11.gr1 = item11.gr1 != 0 ? (1 + (int)item11.gr1) : 1;

                                    if (gender == womanEnumId) item11.gr2 = item11.gr2 != 0 ? (1 + (int)item11.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item11.gr3 = item11.gr3 != 0 ? (1 + (int)item11.gr3) : 1;
                                        if (gender == womanEnumId) item11.gr4 = item11.gr4 != 0 ? (1 + (int)item11.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item11.gr5 = item11.gr5 != 0 ? (1 + (int)item11.gr5) : 1;
                                        if (gender == womanEnumId) item11.gr6 = item11.gr6 != 0 ? (1 + (int)item11.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item11.gr7 = item11.gr7 != 0 ? (1 + (int)item11.gr7) : 1;
                                        if (gender == womanEnumId) item11.gr8 = item11.gr8 != 0 ? (1 + (int)item11.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item11.gr9 = item11.gr9 != 0 ? (1 + (int)item11.gr9) : 1;
                                        if (gender == womanEnumId) item11.gr10 = item11.gr10 != 0 ? (1 + (int)item11.gr10) : 1;
                                    }
                                }
                                //if (diagnos == strDiagId)
                                /************************************************/
                                if (diagnos == strDiagId20)
                                {
                                    item13.gr1 = item13.gr1 != 0 ? (1 + (int)item13.gr1) : 1;

                                    if (gender == womanEnumId) item13.gr2 = item13.gr2 != 0 ? (1 + (int)item13.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item13.gr3 = item13.gr3 != 0 ? (1 + (int)item13.gr3) : 1;
                                        if (gender == womanEnumId) item13.gr4 = item13.gr4 != 0 ? (1 + (int)item13.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item13.gr5 = item13.gr5 != 0 ? (1 + (int)item13.gr5) : 1;
                                        if (gender == womanEnumId) item13.gr6 = item13.gr6 != 0 ? (1 + (int)item13.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item13.gr7 = item13.gr7 != 0 ? (1 + (int)item13.gr7) : 1;
                                        if (gender == womanEnumId) item13.gr8 = item13.gr8 != 0 ? (1 + (int)item13.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item13.gr9 = item13.gr9 != 0 ? (1 + (int)item13.gr9) : 1;
                                        if (gender == womanEnumId) item13.gr10 = item13.gr10 != 0 ? (1 + (int)item13.gr10) : 1;
                                    }
                                }
                                //if (diagnos == strDiagId)
                                //if (diagnos == strDiagId)
                                /***********************************************/
                                if (diagnos == strDiagId23)
                                {
                                    item16.gr1 = item16.gr1 != 0 ? (1 + (int)item16.gr1) : 1;

                                    if (gender == womanEnumId) item16.gr2 = item16.gr2 != 0 ? (1 + (int)item16.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item16.gr3 = item16.gr3 != 0 ? (1 + (int)item16.gr3) : 1;
                                        if (gender == womanEnumId) item16.gr4 = item16.gr4 != 0 ? (1 + (int)item16.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item16.gr5 = item16.gr5 != 0 ? (1 + (int)item16.gr5) : 1;
                                        if (gender == womanEnumId) item16.gr6 = item16.gr6 != 0 ? (1 + (int)item16.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item16.gr7 = item16.gr7 != 0 ? (1 + (int)item16.gr7) : 1;
                                        if (gender == womanEnumId) item16.gr8 = item16.gr8 != 0 ? (1 + (int)item16.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item16.gr9 = item16.gr9 != 0 ? (1 + (int)item16.gr9) : 1;
                                        if (gender == womanEnumId) item16.gr10 = item16.gr10 != 0 ? (1 + (int)item16.gr10) : 1;
                                    }
                                }
                                /********************************************/
                                if (diagnos == strDiagId24)
                                {
                                    item17.gr1 = item17.gr1 != 0 ? (1 + (int)item17.gr1) : 1;

                                    if (gender == womanEnumId) item17.gr2 = item17.gr2 != 0 ? (1 + (int)item17.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item17.gr3 = item17.gr3 != 0 ? (1 + (int)item17.gr3) : 1;
                                        if (gender == womanEnumId) item17.gr4 = item17.gr4 != 0 ? (1 + (int)item17.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item17.gr5 = item17.gr5 != 0 ? (1 + (int)item17.gr5) : 1;
                                        if (gender == womanEnumId) item17.gr6 = item17.gr6 != 0 ? (1 + (int)item17.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item17.gr7 = item17.gr7 != 0 ? (1 + (int)item17.gr7) : 1;
                                        if (gender == womanEnumId) item17.gr8 = item17.gr8 != 0 ? (1 + (int)item17.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item17.gr9 = item17.gr9 != 0 ? (1 + (int)item17.gr9) : 1;
                                        if (gender == womanEnumId) item17.gr10 = item17.gr10 != 0 ? (1 + (int)item17.gr10) : 1;
                                    }
                                }
                                /***************************************************/
                                if (diagnos == strDiagId25)
                                {
                                    item18.gr1 = item18.gr1 != 0 ? (1 + (int)item18.gr1) : 1;

                                    if (gender == womanEnumId) item18.gr2 = item18.gr2 != 0 ? (1 + (int)item18.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item18.gr3 = item18.gr3 != 0 ? (1 + (int)item18.gr3) : 1;
                                        if (gender == womanEnumId) item18.gr4 = item18.gr4 != 0 ? (1 + (int)item18.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item18.gr5 = item18.gr5 != 0 ? (1 + (int)item18.gr5) : 1;
                                        if (gender == womanEnumId) item18.gr6 = item18.gr6 != 0 ? (1 + (int)item18.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item18.gr7 = item18.gr7 != 0 ? (1 + (int)item18.gr7) : 1;
                                        if (gender == womanEnumId) item18.gr8 = item18.gr8 != 0 ? (1 + (int)item18.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item18.gr9 = item18.gr9 != 0 ? (1 + (int)item18.gr9) : 1;
                                        if (gender == womanEnumId) item18.gr10 = item18.gr10 != 0 ? (1 + (int)item18.gr10) : 1;
                                    }
                                }
                                /******************************************/
                                if (diagnos == strDiagId26)
                                {
                                    item19.gr1 = item19.gr1 != 0 ? (1 + (int)item19.gr1) : 1;

                                    if (gender == womanEnumId) item19.gr2 = item19.gr2 != 0 ? (1 + (int)item19.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item19.gr3 = item19.gr3 != 0 ? (1 + (int)item19.gr3) : 1;
                                        if (gender == womanEnumId) item19.gr4 = item19.gr4 != 0 ? (1 + (int)item19.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item19.gr5 = item19.gr5 != 0 ? (1 + (int)item19.gr5) : 1;
                                        if (gender == womanEnumId) item19.gr6 = item19.gr6 != 0 ? (1 + (int)item19.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item19.gr7 = item19.gr7 != 0 ? (1 + (int)item19.gr7) : 1;
                                        if (gender == womanEnumId) item19.gr8 = item19.gr8 != 0 ? (1 + (int)item19.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item19.gr9 = item19.gr9 != 0 ? (1 + (int)item19.gr9) : 1;
                                        if (gender == womanEnumId) item19.gr10 = item19.gr10 != 0 ? (1 + (int)item19.gr10) : 1;
                                    }
                                }
                                /**************************************/
                                if (diagnos == strDiagId27)
                                {
                                    item20.gr1 = item20.gr1 != 0 ? (1 + (int)item20.gr1) : 1;

                                    if (gender == womanEnumId) item20.gr2 = item20.gr2 != 0 ? (1 + (int)item20.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item20.gr3 = item20.gr3 != 0 ? (1 + (int)item20.gr3) : 1;
                                        if (gender == womanEnumId) item20.gr4 = item20.gr4 != 0 ? (1 + (int)item20.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item20.gr5 = item20.gr5 != 0 ? (1 + (int)item20.gr5) : 1;
                                        if (gender == womanEnumId) item20.gr6 = item20.gr6 != 0 ? (1 + (int)item20.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item20.gr7 = item20.gr7 != 0 ? (1 + (int)item20.gr7) : 1;
                                        if (gender == womanEnumId) item20.gr8 = item20.gr8 != 0 ? (1 + (int)item20.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item20.gr9 = item20.gr9 != 0 ? (1 + (int)item20.gr9) : 1;
                                        if (gender == womanEnumId) item20.gr10 = item20.gr10 != 0 ? (1 + (int)item20.gr10) : 1;
                                    }
                                }
                                /****************************************/
                                if (diagnos == strDiagId31)
                                {
                                    item21.gr1 = item21.gr1 != 0 ? (1 + (int)item21.gr1) : 1;

                                    if (gender == womanEnumId) item21.gr2 = item21.gr2 != 0 ? (1 + (int)item21.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item21.gr3 = item21.gr3 != 0 ? (1 + (int)item21.gr3) : 1;
                                        if (gender == womanEnumId) item21.gr4 = item21.gr4 != 0 ? (1 + (int)item21.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item21.gr5 = item21.gr5 != 0 ? (1 + (int)item21.gr5) : 1;
                                        if (gender == womanEnumId) item21.gr6 = item21.gr6 != 0 ? (1 + (int)item21.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item21.gr7 = item21.gr7 != 0 ? (1 + (int)item21.gr7) : 1;
                                        if (gender == womanEnumId) item21.gr8 = item21.gr8 != 0 ? (1 + (int)item21.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item21.gr9 = item21.gr9 != 0 ? (1 + (int)item21.gr9) : 1;
                                        if (gender == womanEnumId) item21.gr10 = item21.gr10 != 0 ? (1 + (int)item21.gr10) : 1;
                                    }
                                }
                                /********************************************/
                                if (diagnos == strDiagId32)
                                {
                                    item22.gr1 = item22.gr1 != 0 ? (1 + (int)item22.gr1) : 1;

                                    if (gender == womanEnumId) item22.gr2 = item22.gr2 != 0 ? (1 + (int)item22.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item22.gr3 = item22.gr3 != 0 ? (1 + (int)item22.gr3) : 1;
                                        if (gender == womanEnumId) item22.gr4 = item22.gr4 != 0 ? (1 + (int)item22.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item22.gr5 = item22.gr5 != 0 ? (1 + (int)item22.gr5) : 1;
                                        if (gender == womanEnumId) item22.gr6 = item22.gr6 != 0 ? (1 + (int)item22.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item22.gr7 = item22.gr7 != 0 ? (1 + (int)item22.gr7) : 1;
                                        if (gender == womanEnumId) item22.gr8 = item22.gr8 != 0 ? (1 + (int)item22.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item22.gr9 = item22.gr9 != 0 ? (1 + (int)item22.gr9) : 1;
                                        if (gender == womanEnumId) item22.gr10 = item22.gr10 != 0 ? (1 + (int)item22.gr10) : 1;
                                    }
                                }
                                /*****************************************/
                                if (diagnos == strDiagId33)
                                {
                                    item23.gr1 = item23.gr1 != 0 ? (1 + (int)item23.gr1) : 1;

                                    if (gender == womanEnumId) item23.gr2 = item23.gr2 != 0 ? (1 + (int)item23.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item23.gr3 = item23.gr3 != 0 ? (1 + (int)item23.gr3) : 1;
                                        if (gender == womanEnumId) item23.gr4 = item23.gr4 != 0 ? (1 + (int)item23.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item23.gr5 = item23.gr5 != 0 ? (1 + (int)item23.gr5) : 1;
                                        if (gender == womanEnumId) item23.gr6 = item23.gr6 != 0 ? (1 + (int)item23.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item23.gr7 = item23.gr7 != 0 ? (1 + (int)item23.gr7) : 1;
                                        if (gender == womanEnumId) item23.gr8 = item23.gr8 != 0 ? (1 + (int)item23.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item23.gr9 = item23.gr9 != 0 ? (1 + (int)item23.gr9) : 1;
                                        if (gender == womanEnumId) item23.gr10 = item23.gr10 != 0 ? (1 + (int)item23.gr10) : 1;
                                    }
                                }
                                /********************************************/
                                if (diagnos == strDiagId36)
                                {
                                    item24.gr1 = item24.gr1 != 0 ? (1 + (int)item24.gr1) : 1;

                                    if (gender == womanEnumId) item24.gr2 = item24.gr2 != 0 ? (1 + (int)item24.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item24.gr3 = item24.gr3 != 0 ? (1 + (int)item24.gr3) : 1;
                                        if (gender == womanEnumId) item24.gr4 = item24.gr4 != 0 ? (1 + (int)item24.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item24.gr5 = item24.gr5 != 0 ? (1 + (int)item24.gr5) : 1;
                                        if (gender == womanEnumId) item24.gr6 = item24.gr6 != 0 ? (1 + (int)item24.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item24.gr7 = item24.gr7 != 0 ? (1 + (int)item24.gr7) : 1;
                                        if (gender == womanEnumId) item24.gr8 = item24.gr8 != 0 ? (1 + (int)item24.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item24.gr9 = item24.gr9 != 0 ? (1 + (int)item24.gr9) : 1;
                                        if (gender == womanEnumId) item24.gr10 = item24.gr10 != 0 ? (1 + (int)item24.gr10) : 1;
                                    }
                                }
                                /**************************************************/
                                if (diagnos == strDiagId38)
                                {
                                    item25.gr1 = item25.gr1 != 0 ? (1 + (int)item25.gr1) : 1;

                                    if (gender == womanEnumId) item25.gr2 = item25.gr2 != 0 ? (1 + (int)item25.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item25.gr3 = item25.gr3 != 0 ? (1 + (int)item25.gr3) : 1;
                                        if (gender == womanEnumId) item25.gr4 = item25.gr4 != 0 ? (1 + (int)item25.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item25.gr5 = item25.gr5 != 0 ? (1 + (int)item25.gr5) : 1;
                                        if (gender == womanEnumId) item25.gr6 = item25.gr6 != 0 ? (1 + (int)item25.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item25.gr7 = item25.gr7 != 0 ? (1 + (int)item25.gr7) : 1;
                                        if (gender == womanEnumId) item25.gr8 = item25.gr8 != 0 ? (1 + (int)item25.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item25.gr9 = item25.gr9 != 0 ? (1 + (int)item25.gr9) : 1;
                                        if (gender == womanEnumId) item25.gr10 = item25.gr10 != 0 ? (1 + (int)item25.gr10) : 1;
                                    }
                                }
                                //if (diagnos == strDiagId)
                                /*************************************/
                                if (diagnos == strDiagId41)
                                {
                                    item27.gr1 = item27.gr1 != 0 ? (1 + (int)item27.gr1) : 1;

                                    if (gender == womanEnumId) item27.gr2 = item27.gr2 != 0 ? (1 + (int)item27.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item27.gr3 = item27.gr3 != 0 ? (1 + (int)item27.gr3) : 1;
                                        if (gender == womanEnumId) item27.gr4 = item27.gr4 != 0 ? (1 + (int)item27.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item27.gr5 = item27.gr5 != 0 ? (1 + (int)item27.gr5) : 1;
                                        if (gender == womanEnumId) item27.gr6 = item27.gr6 != 0 ? (1 + (int)item27.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item27.gr7 = item27.gr7 != 0 ? (1 + (int)item27.gr7) : 1;
                                        if (gender == womanEnumId) item27.gr8 = item27.gr8 != 0 ? (1 + (int)item27.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item27.gr9 = item27.gr9 != 0 ? (1 + (int)item27.gr9) : 1;
                                        if (gender == womanEnumId) item27.gr10 = item27.gr10 != 0 ? (1 + (int)item27.gr10) : 1;
                                    }
                                }
                                if (diagnos == strDiagId57)
                                {
                                    item28.gr1 = item28.gr1 != 0 ? (1 + (int)item28.gr1) : 1;

                                    if (gender == womanEnumId) item28.gr2 = item28.gr2 != 0 ? (1 + (int)item28.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item28.gr3 = item28.gr3 != 0 ? (1 + (int)item28.gr3) : 1;
                                        if (gender == womanEnumId) item28.gr4 = item28.gr4 != 0 ? (1 + (int)item28.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item28.gr5 = item28.gr5 != 0 ? (1 + (int)item28.gr5) : 1;
                                        if (gender == womanEnumId) item28.gr6 = item28.gr6 != 0 ? (1 + (int)item28.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item28.gr7 = item28.gr7 != 0 ? (1 + (int)item28.gr7) : 1;
                                        if (gender == womanEnumId) item28.gr8 = item28.gr8 != 0 ? (1 + (int)item28.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item28.gr9 = item28.gr9 != 0 ? (1 + (int)item28.gr9) : 1;
                                        if (gender == womanEnumId) item28.gr10 = item28.gr10 != 0 ? (1 + (int)item28.gr10) : 1;
                                    }
                                }
                                /***************************************/
                                if (diagnos == strDiagId58)
                                {
                                    item29.gr1 = item29.gr1 != 0 ? (1 + (int)item29.gr1) : 1;

                                    if (gender == womanEnumId) item29.gr2 = item29.gr2 != 0 ? (1 + (int)item29.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item29.gr3 = item29.gr3 != 0 ? (1 + (int)item29.gr3) : 1;
                                        if (gender == womanEnumId) item29.gr4 = item29.gr4 != 0 ? (1 + (int)item29.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item29.gr5 = item29.gr5 != 0 ? (1 + (int)item29.gr5) : 1;
                                        if (gender == womanEnumId) item29.gr6 = item29.gr6 != 0 ? (1 + (int)item29.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item29.gr7 = item29.gr7 != 0 ? (1 + (int)item29.gr7) : 1;
                                        if (gender == womanEnumId) item29.gr8 = item29.gr8 != 0 ? (1 + (int)item29.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item29.gr9 = item29.gr9 != 0 ? (1 + (int)item29.gr9) : 1;
                                        if (gender == womanEnumId) item29.gr10 = item29.gr10 != 0 ? (1 + (int)item29.gr10) : 1;
                                    }
                                }
                                /*************************************************/
                                if (diagnos == strDiagId59)
                                {
                                    item30.gr1 = item30.gr1 != 0 ? (1 + (int)item30.gr1) : 1;

                                    if (gender == womanEnumId) item30.gr2 = item30.gr2 != 0 ? (1 + (int)item30.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item30.gr3 = item30.gr3 != 0 ? (1 + (int)item30.gr3) : 1;
                                        if (gender == womanEnumId) item30.gr4 = item30.gr4 != 0 ? (1 + (int)item30.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item30.gr5 = item30.gr5 != 0 ? (1 + (int)item30.gr5) : 1;
                                        if (gender == womanEnumId) item30.gr6 = item30.gr6 != 0 ? (1 + (int)item30.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item30.gr7 = item30.gr7 != 0 ? (1 + (int)item30.gr7) : 1;
                                        if (gender == womanEnumId) item30.gr8 = item30.gr8 != 0 ? (1 + (int)item30.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item30.gr9 = item30.gr9 != 0 ? (1 + (int)item30.gr9) : 1;
                                        if (gender == womanEnumId) item30.gr10 = item30.gr10 != 0 ? (1 + (int)item30.gr10) : 1;
                                    }
                                }
                                /**************************************/
                                if (diagnos == strDiagId60)
                                {
                                    item31.gr1 = item31.gr1 != 0 ? (1 + (int)item31.gr1) : 1;

                                    if (gender == womanEnumId) item31.gr2 = item31.gr2 != 0 ? (1 + (int)item31.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item31.gr3 = item31.gr3 != 0 ? (1 + (int)item31.gr3) : 1;
                                        if (gender == womanEnumId) item31.gr4 = item31.gr4 != 0 ? (1 + (int)item31.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item31.gr5 = item31.gr5 != 0 ? (1 + (int)item31.gr5) : 1;
                                        if (gender == womanEnumId) item31.gr6 = item31.gr6 != 0 ? (1 + (int)item31.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item31.gr7 = item31.gr7 != 0 ? (1 + (int)item31.gr7) : 1;
                                        if (gender == womanEnumId) item31.gr8 = item31.gr8 != 0 ? (1 + (int)item31.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item31.gr9 = item31.gr9 != 0 ? (1 + (int)item31.gr9) : 1;
                                        if (gender == womanEnumId) item31.gr10 = item31.gr10 != 0 ? (1 + (int)item31.gr10) : 1;
                                    }
                                }
                                /****************************************/
                                if (diagnos == strDiagId61)
                                {
                                    item32.gr1 = item32.gr1 != 0 ? (1 + (int)item32.gr1) : 1;

                                    if (gender == womanEnumId) item32.gr2 = item32.gr2 != 0 ? (1 + (int)item32.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item32.gr3 = item32.gr3 != 0 ? (1 + (int)item32.gr3) : 1;
                                        if (gender == womanEnumId) item32.gr4 = item32.gr4 != 0 ? (1 + (int)item32.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item32.gr5 = item32.gr5 != 0 ? (1 + (int)item32.gr5) : 1;
                                        if (gender == womanEnumId) item32.gr6 = item32.gr6 != 0 ? (1 + (int)item32.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item32.gr7 = item32.gr7 != 0 ? (1 + (int)item32.gr7) : 1;
                                        if (gender == womanEnumId) item32.gr8 = item32.gr8 != 0 ? (1 + (int)item32.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item32.gr9 = item32.gr9 != 0 ? (1 + (int)item32.gr9) : 1;
                                        if (gender == womanEnumId) item32.gr10 = item32.gr10 != 0 ? (1 + (int)item32.gr10) : 1;
                                    }
                                }
                                /***************************************/
                                if (diagnos == strDiagId62)
                                {
                                    item33.gr1 = item33.gr1 != 0 ? (1 + (int)item33.gr1) : 1;

                                    if (gender == womanEnumId) item33.gr2 = item33.gr2 != 0 ? (1 + (int)item33.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item33.gr3 = item33.gr3 != 0 ? (1 + (int)item33.gr3) : 1;
                                        if (gender == womanEnumId) item33.gr4 = item33.gr4 != 0 ? (1 + (int)item33.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item33.gr5 = item33.gr5 != 0 ? (1 + (int)item33.gr5) : 1;
                                        if (gender == womanEnumId) item33.gr6 = item33.gr6 != 0 ? (1 + (int)item33.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item33.gr7 = item33.gr7 != 0 ? (1 + (int)item33.gr7) : 1;
                                        if (gender == womanEnumId) item33.gr8 = item33.gr8 != 0 ? (1 + (int)item33.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item33.gr9 = item33.gr9 != 0 ? (1 + (int)item33.gr9) : 1;
                                        if (gender == womanEnumId) item33.gr10 = item33.gr10 != 0 ? (1 + (int)item33.gr10) : 1;
                                    }
                                }
                                /**************************************/
                                if (diagnos == strDiagId65)
                                {
                                    item34.gr1 = item34.gr1 != 0 ? (1 + (int)item34.gr1) : 1;

                                    if (gender == womanEnumId) item34.gr2 = item34.gr2 != 0 ? (1 + (int)item34.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item34.gr3 = item34.gr3 != 0 ? (1 + (int)item34.gr3) : 1;
                                        if (gender == womanEnumId) item34.gr4 = item34.gr4 != 0 ? (1 + (int)item34.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item34.gr5 = item34.gr5 != 0 ? (1 + (int)item34.gr5) : 1;
                                        if (gender == womanEnumId) item34.gr6 = item34.gr6 != 0 ? (1 + (int)item34.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item34.gr7 = item34.gr7 != 0 ? (1 + (int)item34.gr7) : 1;
                                        if (gender == womanEnumId) item34.gr8 = item34.gr8 != 0 ? (1 + (int)item34.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item34.gr9 = item34.gr9 != 0 ? (1 + (int)item34.gr9) : 1;
                                        if (gender == womanEnumId) item34.gr10 = item34.gr10 != 0 ? (1 + (int)item34.gr10) : 1;
                                    }
                                }
                                /*************************************/
                                if (diagnos == strDiagId66)
                                {
                                    item35.gr1 = item35.gr1 != 0 ? (1 + (int)item35.gr1) : 1;

                                    if (gender == womanEnumId) item35.gr2 = item35.gr2 != 0 ? (1 + (int)item35.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item35.gr3 = item35.gr3 != 0 ? (1 + (int)item35.gr3) : 1;
                                        if (gender == womanEnumId) item35.gr4 = item35.gr4 != 0 ? (1 + (int)item35.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item35.gr5 = item35.gr5 != 0 ? (1 + (int)item35.gr5) : 1;
                                        if (gender == womanEnumId) item35.gr6 = item35.gr6 != 0 ? (1 + (int)item35.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item35.gr7 = item35.gr7 != 0 ? (1 + (int)item35.gr7) : 1;
                                        if (gender == womanEnumId) item35.gr8 = item35.gr8 != 0 ? (1 + (int)item35.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item35.gr9 = item35.gr9 != 0 ? (1 + (int)item35.gr9) : 1;
                                        if (gender == womanEnumId) item35.gr10 = item35.gr10 != 0 ? (1 + (int)item35.gr10) : 1;
                                    }
                                }
                                /************************************/
                                if (diagnos == strDiagId68)
                                {
                                    item36.gr1 = item36.gr1 != 0 ? (1 + (int)item36.gr1) : 1;

                                    if (gender == womanEnumId) item36.gr2 = item36.gr2 != 0 ? (1 + (int)item36.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item36.gr3 = item36.gr3 != 0 ? (1 + (int)item36.gr3) : 1;
                                        if (gender == womanEnumId) item36.gr4 = item36.gr4 != 0 ? (1 + (int)item36.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item36.gr5 = item36.gr5 != 0 ? (1 + (int)item36.gr5) : 1;
                                        if (gender == womanEnumId) item36.gr6 = item36.gr6 != 0 ? (1 + (int)item36.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item36.gr7 = item36.gr7 != 0 ? (1 + (int)item36.gr7) : 1;
                                        if (gender == womanEnumId) item36.gr8 = item36.gr8 != 0 ? (1 + (int)item36.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item36.gr9 = item36.gr9 != 0 ? (1 + (int)item36.gr9) : 1;
                                        if (gender == womanEnumId) item36.gr10 = item36.gr10 != 0 ? (1 + (int)item36.gr10) : 1;
                                    }
                                }
                                /**************************************/
                                if (diagnos == strDiagId49)
                                {
                                    item37.gr1 = item37.gr1 != 0 ? (1 + (int)item37.gr1) : 1;

                                    if (gender == womanEnumId) item37.gr2 = item37.gr2 != 0 ? (1 + (int)item37.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item37.gr3 = item37.gr3 != 0 ? (1 + (int)item37.gr3) : 1;
                                        if (gender == womanEnumId) item37.gr4 = item37.gr4 != 0 ? (1 + (int)item37.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item37.gr5 = item37.gr5 != 0 ? (1 + (int)item37.gr5) : 1;
                                        if (gender == womanEnumId) item37.gr6 = item37.gr6 != 0 ? (1 + (int)item37.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item37.gr7 = item37.gr7 != 0 ? (1 + (int)item37.gr7) : 1;
                                        if (gender == womanEnumId) item37.gr8 = item37.gr8 != 0 ? (1 + (int)item37.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item37.gr9 = item37.gr9 != 0 ? (1 + (int)item37.gr9) : 1;
                                        if (gender == womanEnumId) item37.gr10 = item37.gr10 != 0 ? (1 + (int)item37.gr10) : 1;
                                    }
                                }
                                /***********************************/
                                if (diagnos == strDiagId70)
                                {
                                    item38.gr1 = item38.gr1 != 0 ? (1 + (int)item38.gr1) : 1;

                                    if (gender == womanEnumId) item38.gr2 = item38.gr2 != 0 ? (1 + (int)item38.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item38.gr3 = item38.gr3 != 0 ? (1 + (int)item38.gr3) : 1;
                                        if (gender == womanEnumId) item38.gr4 = item38.gr4 != 0 ? (1 + (int)item38.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item38.gr5 = item38.gr5 != 0 ? (1 + (int)item38.gr5) : 1;
                                        if (gender == womanEnumId) item38.gr6 = item38.gr6 != 0 ? (1 + (int)item38.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item38.gr7 = item38.gr7 != 0 ? (1 + (int)item38.gr7) : 1;
                                        if (gender == womanEnumId) item38.gr8 = item38.gr8 != 0 ? (1 + (int)item38.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item38.gr9 = item38.gr9 != 0 ? (1 + (int)item38.gr9) : 1;
                                        if (gender == womanEnumId) item38.gr10 = item38.gr10 != 0 ? (1 + (int)item38.gr10) : 1;
                                    }
                                }
                                /*********************************/
                                if (diagnos == strDiagId74)
                                {
                                    item39.gr1 = item39.gr1 != 0 ? (1 + (int)item39.gr1) : 1;

                                    if (gender == womanEnumId) item39.gr2 = item39.gr2 != 0 ? (1 + (int)item39.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item39.gr3 = item39.gr3 != 0 ? (1 + (int)item39.gr3) : 1;
                                        if (gender == womanEnumId) item39.gr4 = item39.gr4 != 0 ? (1 + (int)item39.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item39.gr5 = item39.gr5 != 0 ? (1 + (int)item39.gr5) : 1;
                                        if (gender == womanEnumId) item39.gr6 = item39.gr6 != 0 ? (1 + (int)item39.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item39.gr7 = item39.gr7 != 0 ? (1 + (int)item39.gr7) : 1;
                                        if (gender == womanEnumId) item39.gr8 = item39.gr8 != 0 ? (1 + (int)item39.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item39.gr9 = item39.gr9 != 0 ? (1 + (int)item39.gr9) : 1;
                                        if (gender == womanEnumId) item39.gr10 = item39.gr10 != 0 ? (1 + (int)item39.gr10) : 1;
                                    }
                                }
                                /**********************************/
                                if (diagnos == strDiagId53)
                                {
                                    item40.gr1 = item40.gr1 != 0 ? (1 + (int)item40.gr1) : 1;

                                    if (gender == womanEnumId) item40.gr2 = item40.gr2 != 0 ? (1 + (int)item40.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item40.gr3 = item40.gr3 != 0 ? (1 + (int)item40.gr3) : 1;
                                        if (gender == womanEnumId) item40.gr4 = item40.gr4 != 0 ? (1 + (int)item40.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item40.gr5 = item40.gr5 != 0 ? (1 + (int)item40.gr5) : 1;
                                        if (gender == womanEnumId) item40.gr6 = item40.gr6 != 0 ? (1 + (int)item40.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item40.gr7 = item40.gr7 != 0 ? (1 + (int)item40.gr7) : 1;
                                        if (gender == womanEnumId) item40.gr8 = item40.gr8 != 0 ? (1 + (int)item40.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item40.gr9 = item40.gr9 != 0 ? (1 + (int)item40.gr9) : 1;
                                        if (gender == womanEnumId) item40.gr10 = item40.gr10 != 0 ? (1 + (int)item40.gr10) : 1;
                                    }
                                }
                                /*******************************************/
                                if (diagnos == strDiagId52)
                                {
                                    item41.gr1 = item41.gr1 != 0 ? (1 + (int)item41.gr1) : 1;

                                    if (gender == womanEnumId) item41.gr2 = item41.gr2 != 0 ? (1 + (int)item41.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item41.gr3 = item41.gr3 != 0 ? (1 + (int)item41.gr3) : 1;
                                        if (gender == womanEnumId) item41.gr4 = item41.gr4 != 0 ? (1 + (int)item41.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item41.gr5 = item41.gr5 != 0 ? (1 + (int)item41.gr5) : 1;
                                        if (gender == womanEnumId) item41.gr6 = item41.gr6 != 0 ? (1 + (int)item41.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item41.gr7 = item41.gr7 != 0 ? (1 + (int)item41.gr7) : 1;
                                        if (gender == womanEnumId) item41.gr8 = item41.gr8 != 0 ? (1 + (int)item41.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item41.gr9 = item41.gr9 != 0 ? (1 + (int)item41.gr9) : 1;
                                        if (gender == womanEnumId) item41.gr10 = item41.gr10 != 0 ? (1 + (int)item41.gr10) : 1;
                                    }
                                }
                                /***********************************/
                                if (diagnos == strDiagId56)
                                {
                                    item42.gr1 = item42.gr1 != 0 ? (1 + (int)item42.gr1) : 1;

                                    if (gender == womanEnumId) item42.gr2 = item42.gr2 != 0 ? (1 + (int)item42.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item42.gr3 = item42.gr3 != 0 ? (1 + (int)item42.gr3) : 1;
                                        if (gender == womanEnumId) item42.gr4 = item42.gr4 != 0 ? (1 + (int)item42.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item42.gr5 = item42.gr5 != 0 ? (1 + (int)item42.gr5) : 1;
                                        if (gender == womanEnumId) item42.gr6 = item42.gr6 != 0 ? (1 + (int)item42.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item42.gr7 = item42.gr7 != 0 ? (1 + (int)item42.gr7) : 1;
                                        if (gender == womanEnumId) item42.gr8 = item42.gr8 != 0 ? (1 + (int)item42.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item42.gr9 = item42.gr9 != 0 ? (1 + (int)item42.gr9) : 1;
                                        if (gender == womanEnumId) item42.gr10 = item42.gr10 != 0 ? (1 + (int)item42.gr10) : 1;
                                    }
                                }
                                /**********************************************/
                                if (diagnos == strDiagId54)
                                {
                                    item43.gr1 = item43.gr1 != 0 ? (1 + (int)item43.gr1) : 1;

                                    if (gender == womanEnumId) item43.gr2 = item43.gr2 != 0 ? (1 + (int)item43.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item43.gr3 = item43.gr3 != 0 ? (1 + (int)item43.gr3) : 1;
                                        if (gender == womanEnumId) item43.gr4 = item43.gr4 != 0 ? (1 + (int)item43.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item43.gr5 = item43.gr5 != 0 ? (1 + (int)item43.gr5) : 1;
                                        if (gender == womanEnumId) item43.gr6 = item43.gr6 != 0 ? (1 + (int)item43.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item43.gr7 = item43.gr7 != 0 ? (1 + (int)item43.gr7) : 1;
                                        if (gender == womanEnumId) item43.gr8 = item43.gr8 != 0 ? (1 + (int)item43.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item43.gr9 = item43.gr9 != 0 ? (1 + (int)item43.gr9) : 1;
                                        if (gender == womanEnumId) item43.gr10 = item43.gr10 != 0 ? (1 + (int)item43.gr10) : 1;
                                    }
                                }
                                /***********************************/
                                if (diagnos == strDiagId71)
                                {
                                    item44.gr1 = item44.gr1 != 0 ? (1 + (int)item44.gr1) : 1;

                                    if (gender == womanEnumId) item44.gr2 = item44.gr2 != 0 ? (1 + (int)item44.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item44.gr3 = item44.gr3 != 0 ? (1 + (int)item44.gr3) : 1;
                                        if (gender == womanEnumId) item44.gr4 = item44.gr4 != 0 ? (1 + (int)item44.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item44.gr5 = item44.gr5 != 0 ? (1 + (int)item44.gr5) : 1;
                                        if (gender == womanEnumId) item44.gr6 = item44.gr6 != 0 ? (1 + (int)item44.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item44.gr7 = item44.gr7 != 0 ? (1 + (int)item44.gr7) : 1;
                                        if (gender == womanEnumId) item44.gr8 = item44.gr8 != 0 ? (1 + (int)item44.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item44.gr9 = item44.gr9 != 0 ? (1 + (int)item44.gr9) : 1;
                                        if (gender == womanEnumId) item44.gr10 = item44.gr10 != 0 ? (1 + (int)item44.gr10) : 1;
                                    }
                                }
                            }
                        }
                    }
                }
            }
            static void RemoveRows(WorkflowContext context, Guid reportId)
            {
                var docRepo = context.Documents;
                var rows = new List<Guid>();
                var qb = new QueryBuilder(reportItemDefId, context.UserId);
                qb.Where("Report").Eq(reportId).Or("Report").IsNull();
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read()) rows.Add(reader.GetGuid(0));
                }
                foreach (var rowId in rows)
                {
                    docRepo.DeleteById(rowId);
                }
            }
            private static readonly Guid reportDefId = new Guid("{17789FEE-2908-4E01-8E16-2ECAF4A75C7A}"); //Отчет о распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности
            private static readonly Guid reportItemDefId = new Guid("{10AB1374-EA9C-493B-B5F6-CD6A40273B9B}"); //Распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности

            private static readonly Guid childStatCardDefId = new Guid("{363E89D0-5E31-45B5-82B7-42E83DF96E1F}"); //Статистический талон ребенка с ОВЗ
            private static readonly Guid childActDefId = new Guid("{0ECF44B6-2B2D-4687-B7B0-07BA5F942AC6}"); //Медицинский акт ребенка с ОВЗ
            private static readonly Guid personDefId = new Guid("{D71CE61A-9B59-4B5E-8713-8131DBB5BA02}"); //Person 
            public static readonly Guid districtDefId = new Guid("{A3FCA356-82A9-4BBD-872A-8333BEC6E41A}"); //Район
            public static readonly Guid cityDefId = new Guid("{4BB6D32D-5181-4031-BA49-CF5910D6D883}"); //Города районного значения

            public static readonly Guid goalForGroup = new Guid("{8FD84B27-FF2A-40A4-A87A-BC254DC9D853}"); //Цель -> Для установления группы

            public static readonly Guid ageOf1EnumId = new Guid("{484C1AF3-3203-478D-97B4-B7977738A194}"); //От 0-3 лет
            public static readonly Guid ageOf2EnumId = new Guid("{124DA030-994C-4F2D-AD5F-750986CCDC96}"); //От 4-7 лет
            public static readonly Guid ageOf3EnumId = new Guid("{CFDA5599-9767-430E-AC90-632D3FBDBF1F}"); //От 8-14 лет
            public static readonly Guid ageOf4EnumId = new Guid("{30DA048C-85C4-4078-9A63-0CDB40A7747A}"); //От 15-17 лет

            //Инвалидность установлена на срок
            public static readonly Guid termEnumId1 = new Guid("{C0C639C1-4069-42BD-B9C5-0C4C0EAD41CE}"); //1 год
            public static readonly Guid termEnumId2 = new Guid("{CAB664A9-513D-4939-AB17-31ACF97C7592}"); //2 года
            public static readonly Guid termEnumId3 = new Guid("{4C270330-A4A0-40B7-9E2C-6726AE4BAD6C}"); //5 лет
            public static readonly Guid termEnumId4 = new Guid("{B1F91F0F-EA5C-4DA4-9DE6-C3FC0142E66F}"); //до 18 лет

            public static readonly Guid childGroupEnId = new Guid("{D145ABA1-EADA-442B-9D8D-AD10BCD126D2}"); //Ребенок с ОВЗ
            public static readonly Guid notInstalledEnId = new Guid("{BEB4542B-0C03-494A-BD60-AA6BA8E8BF4C}"); //Не установлена

            public static readonly Guid cityEnumId = new Guid("{DE3D24A1-64D3-4647-B711-31F334D24416}"); //Городская местность//DistrictType
            public static readonly Guid womanEnumId = new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"); //Женский пол
            public static readonly Guid primaryEnumId = new Guid("{34129BC5-5B31-4189-87FA-799402F7E99F}"); //Первичное
            public static readonly Guid ApprovedStateId = new Guid("{32062CB7-C31C-4AFB-ADF3-F9F9AEEFCE59}");  //Подписанные

            //диагнозы
            private static readonly Guid strDiagId1 = new Guid("{9FF329FE-F547-42BE-817F-ED989FFB6573}"); //Туберкулез/ А 15-19
            private static readonly Guid strDiagId2 = new Guid("{99BC4A06-B78C-4A88-9F5C-AD4835563758}"); //Туберкулез  легких/ А 15-16
            private static readonly Guid strDiagId3 = new Guid("{2F9950BC-62B8-4B2B-865A-1C9C080CCC4E}"); //Злокачественные новообразования/ С 00-97
            private static readonly Guid strDiagId4 = new Guid("{C9CDD032-DC56-4027-A7D8-DBFE2F29BDE2}"); //Болезни эндокринной системы, нарушения обмена веществ/ Е 00-90
            private static readonly Guid strDiagId5 = new Guid("{C22D27F2-89F8-4355-A962-8EDE8294D052}"); //Заболeвания щитовидной железы/ E 00-07
            private static readonly Guid strDiagId6 = new Guid("{81E09427-D877-4C77-8609-E813D1BAF5FF}"); //Сахарный диабет/ E 10-14
            private static readonly Guid strDiagId7 = new Guid("{7ACAB39A-5CEE-4EF0-AAAB-10764F111DC0}"); //Психические расстройства/ F 00-99
            private static readonly Guid strDiagId8 = new Guid("{1F2922AB-423A-4997-BAB8-5D18538B5A15}"); //Шизофрения/ F 20
            private static readonly Guid strDiagId9 = new Guid("{22E82EC9-8BAA-48FD-AFD8-17619B0AD476}"); //Умственная отсталость/ F 70-79
            private static readonly Guid strDiagId10 = new Guid("{070AADAE-4453-4753-B939-44FD21544953}"); //Умственная отсталость, в сочетании ДЦП/ F 70-79
            private static readonly Guid strDiagId11 = new Guid("{BA1B55AC-F4C2-4112-BABD-7E986B3E2B07}"); //Органическое слабоумие/ F 00-03
            private static readonly Guid strDiagId12 = new Guid("{970AE4FA-9B31-447E-AF8B-9567A8F62F3F}"); //Органическое слабоумие в сочетании ДЦП/ F 00-03
            private static readonly Guid strDiagId13 = new Guid("{A9D88506-1CF4-437A-8B8C-40AB1AF88C12}"); //Расстройство психологического развития/ F 80-89
            private static readonly Guid strDiagId14 = new Guid("{B1E87505-BE6E-46AA-BDE7-FC556CD53D2B}"); //Огранические расстройство личности/ F 06-07
            private static readonly Guid strDiagId15 = new Guid("{1452F4DA-2382-4CAD-A621-3A758F4A430B}"); //Аутизм
            private static readonly Guid strDiagId16 = new Guid("{4BB66F12-B96C-4917-BFB3-0947D41AFA52}"); //Болезни нервной системы/ G 00-99
            private static readonly Guid strDiagId17 = new Guid("{9E0B999D-9AB4-4667-88F9-35DC37C1D743}"); //Воспалительные болезни нервной системы/ G 00-09
            private static readonly Guid strDiagId18 = new Guid("{471214D9-9EB8-4A00-B4ED-A05E77C5876A}"); //Дегенеративные, демилиенизирующие болезни/ G 10-37
            private static readonly Guid strDiagId19 = new Guid("{E2E0C9F8-F413-41F3-A8A6-8674EDEEAC64}"); //Эпилепсия/ G 40-41
            private static readonly Guid strDiagId20 = new Guid("{F6BAE9AD-DDBA-4C71-9A36-E1106E9BCBD9}"); //Детский церебральный паралич/ G 80-83
            private static readonly Guid strDiagId21 = new Guid("{B811E7CB-8ED9-4BFF-A1C7-BA1FE20C8C81}"); //Последствия воспалительных болезней ЦНС/ G 09
            private static readonly Guid strDiagId22 = new Guid("{DFE168E8-7E30-4D8A-9AEF-54382B0A3932}"); //Болезни периферической нервной системы/ G 50-64
            private static readonly Guid strDiagId23 = new Guid("{40012DC1-53A1-4EE7-8F93-85547C827DB5}"); //Болезни органов чувств/ H 00-95
            private static readonly Guid strDiagId24 = new Guid("{24483E18-28AC-4981-9C29-B94075BE9725}"); //Болезни глаз/ H 00-59
            private static readonly Guid strDiagId25 = new Guid("{558D6E2E-E1E0-4D37-B200-A94D9953099F}"); //Болезни уха и сосцевидного отростка/ H 60-95
            private static readonly Guid strDiagId26 = new Guid("{E3D6EF80-B5E4-4DAE-9832-19FAD50A80F3}"); //Болезни системы кровообращения/ I 00-99
            private static readonly Guid strDiagId27 = new Guid("{D71970B1-0562-4905-AC26-77DE739CAF5C}"); //Хронические ревматические болезни сердца/  I 05-09
            private static readonly Guid strDiagId28 = new Guid("{E6D6A67F-ED33-4879-B1C2-9BC173BB457B}"); //Повышенное кровеносное давление/ I 10-15
            private static readonly Guid strDiagId29 = new Guid("{10712C7B-4FDC-4B6F-A50B-B7858FDD1211}"); //Ишемическая болезнь сердца/ I 20-25
            private static readonly Guid strDiagId30 = new Guid("{9549B0FD-2F0D-488A-8228-E990B01288D8}"); //Цереброваскулярные болезни/ I 60-69
            private static readonly Guid strDiagId31 = new Guid("{3363DE1E-864C-4063-BED7-4526F673AFF6}"); //Болезни органов дыхания / J 00-99
            private static readonly Guid strDiagId32 = new Guid("{866F3B61-AFCF-45F5-97BE-E0C23B87393C}"); //Бронхиальная астма/ J 45
            private static readonly Guid strDiagId33 = new Guid("{05479FEC-BC19-42B8-A0EC-37C63CE91205}"); //Болезни органов пищеварения/ K 00-93
            private static readonly Guid strDiagId34 = new Guid("{5E6F7098-6633-4B55-A920-82DD9538032A}"); //Болезни печени/ K 70-77
            private static readonly Guid strDiagId35 = new Guid("{225F29AD-6E5D-4DC5-B487-144D386D8DE8}"); //Болезни кожи, подкожной клетчатки/ L 00-99
            private static readonly Guid strDiagId36 = new Guid("{ECC9E612-FB40-4344-8298-5CD8BA40635F}"); //Болезни костно-мешечной системы и соединительной ткани/ M 00-99
            private static readonly Guid strDiagId37 = new Guid("{B3000363-8258-4F07-8234-0DE79E053660}"); //Ревматоидные/ M 05-14
            private static readonly Guid strDiagId38 = new Guid("{FD1C5BBA-0EA5-4929-8EB9-E6C957C2ADA4}"); //Дорсопатии, остеохондроз/ M 40-54
            private static readonly Guid strDiagId39 = new Guid("{1D4E81CB-2315-44C9-BDF3-B0FA874B8E61}"); //Остеохондроз позвоночника/ M 42
            private static readonly Guid strDiagId40 = new Guid("{87378F65-16F1-4B5D-83FB-53DD98628A75}"); //Оперированные дорсопатии, остеохондроз/  M 40-54
            private static readonly Guid strDiagId41 = new Guid("{3E0E50B5-9A3A-4DA2-A098-7147CB19833D}"); //Болезни мочевыводящих органов/ N 00-99
            private static readonly Guid strDiagId42 = new Guid("{82D1F915-CADF-4E7F-91A9-36B84CAB5A85}"); //Травмы, отравления и другие воздействия внешних причин/ S00 T98
            private static readonly Guid strDiagId43 = new Guid("{FC38C0AE-2C54-4609-B728-517D5BC481CF}"); //Травма глаз/ T 90.4
            private static readonly Guid strDiagId44 = new Guid("{3B607D89-91FB-4A90-9C77-61B71658950C}"); //Травма головы/ T-90
            private static readonly Guid strDiagId45 = new Guid("{F636A14B-B2F4-4EC9-9EBA-0A6A0F6CEA9C}"); //Травмы позвоночника/  T 91.1
            private static readonly Guid strDiagId46 = new Guid("{51EDADEE-1AD8-4E72-AC33-B41F057CD61B}"); //Травмы позвоночника с повреждением спинного мозга/  T 91.3
            private static readonly Guid strDiagId47 = new Guid("{0D31A297-B2C2-42A6-9406-81E258D93114}"); //Травмы нижних конечностей /  T 93
            private static readonly Guid strDiagId48 = new Guid("{961024D8-FF80-414E-9A3E-C669D167E996}"); //Термические, химические ожоги, отморожения/ T 95
            private static readonly Guid strDiagId49 = new Guid("{6E4156F7-3DEE-4191-9CFB-B44B8E6088E8}"); //Автодорожная травма/ S 00 T 98
            private static readonly Guid strDiagId50 = new Guid("{961BB1B1-2C65-4833-86FA-2FC02CBCDDA8}"); //Болезни вследствие воздействия ионизирующего облучения/ W 88
            private static readonly Guid strDiagId51 = new Guid("{F702AAD3-523D-4914-8B97-5D2B9905D231}"); //Болезни вследствие воздействия вибрации/ W 43
            private static readonly Guid strDiagId52 = new Guid("{E7271846-9AAA-4C52-AA19-CB01C3B765A2}"); //Болезни крови, кроветворных органов/ D 50-89
            private static readonly Guid strDiagId53 = new Guid("{41F09403-B4B7-46CA-92BF-B716523AFDE9}"); //Доброкачественные новообразования/ D 10-36
            private static readonly Guid strDiagId54 = new Guid("{D4050056-32C3-48FD-9718-EA7FE3294E82}"); //Бруцеллез/ A 23
            private static readonly Guid strDiagId55 = new Guid("{1DEDD889-4336-4622-85C0-9DDD1FF432D9}"); //Бруцеллез бытовой/ A 23
            private static readonly Guid strDiagId56 = new Guid("{F3B64F5D-6A6C-4343-B5B5-7B5E3CB92474}"); //Эхинококкоз/ B 67
            private static readonly Guid strDiagId57 = new Guid("{0CEAC906-B3D2-4AD8-9DE6-D3FA384F2CDF}"); //Врожденные пороки развития, хромосомные развития/ Q 00-99
            private static readonly Guid strDiagId58 = new Guid("{19309EF8-3706-45DE-8A74-E2652AEF8368}"); //Аномалии ЦНС/ Q 00-07
            private static readonly Guid strDiagId59 = new Guid("{C172D276-4C76-48F6-911F-D552D3A533D8}"); //Аномалии органов чувств/ Q 10 - 18
            private static readonly Guid strDiagId60 = new Guid("{018CC67A-9281-438B-9808-222AEFC31AE7}"); //Аномалии зрения/ Q 10 - 15
            private static readonly Guid strDiagId61 = new Guid("{7BAAF5C9-D1F4-4FC7-B270-DFBE6FE335B3}"); //Аномалии слуха/ Q 16 - 18
            private static readonly Guid strDiagId62 = new Guid("{52A085F0-7B28-4F13-BB33-BDD34AD94F3C}"); //Аномалии системы кровообращения/ Q 20-28
            private static readonly Guid strDiagId63 = new Guid("{62EA3A46-6964-4791-BF68-7DBD2DB70B3B}"); //Расщелина губы и неба/ Q35-37
            private static readonly Guid strDiagId64 = new Guid("{20F214CB-1B5B-4E69-A0CA-982096503776}"); //Врожденные деформации бедра, т\бедренного сустава/ Q 65
            private static readonly Guid strDiagId65 = new Guid("{44804C12-8795-4938-8585-40BA2C82BB8E}"); //Врожденные аномалии костно-мышечной системы/ Q 66-79
            private static readonly Guid strDiagId66 = new Guid("{E0459C10-17FF-4210-A4DF-53081F6E177B}"); //Хромосомные аномалии/ Q 91-99
            private static readonly Guid strDiagId67 = new Guid("{A4D44A12-8DC0-4B14-BF67-3E5D4C560871}"); //Болезни/ Q 90
            private static readonly Guid strDiagId68 = new Guid("{BC059B01-6570-41B3-B1C8-75E3CBAD60DA}"); //Состояния, возникающие в периетальном периоде/ P 00-96
            private static readonly Guid strDiagId69 = new Guid("{07C6C658-D589-48A1-803B-DBCA6603B543}"); //Болезни вызванные вирусом ВИЧ (СПИД)/ B 20-24
            private static readonly Guid strDiagId70 = new Guid("{EC422C17-E8E4-42A3-AD96-EBCBC07B7C7E}"); //Дети рожденные от матерей инфицированных ВИЧ/ ЦВ 20-24
            private static readonly Guid strDiagId71 = new Guid("{0ADE4B55-DF1D-46EA-954B-F3F9FB7CAE08}"); //Прочие болезни / Прочие
            private static readonly Guid strDiagId72 = new Guid("{25029E6F-916F-44DE-86B0-C018A8055D4F}"); //Трудовое увечье
            private static readonly Guid strDiagId73 = new Guid("{8F30CA1F-9187-463E-9D26-1BD525BF45F6}"); //Профессиональные болезни
            private static readonly Guid strDiagId74 = new Guid("{CBEBAF9D-B67D-4BB3-B715-DB252DC2C018}"); //Ликвидаторы последствий аварии на ЧАЭС
            private static readonly Guid strDiagId75 = new Guid("{C0B08AFD-85BB-4DB1-8D9D-6ED3CA43438E}"); //Пострадавшие в событиях 2010г. Бишкек, Талас
            private static readonly Guid strDiagId76 = new Guid("{6A2CF4F5-E0FC-4D70-9DD3-DA23F3049CD2}"); //Пострадавшие в событиях 2010г. Ош, Жалал-Абад
        }

        //Результаты первичных освидетельствований  детей в возрасте до 18 лет (человек), проживающих в (СЕЛЬСКАЯ МЕСТНОСТЬ)
        public static class PrimaryInvalidsOfVillage18Age
        {
            public static List<Report7D2Item> Execute(WorkflowContext context, int year, string distrSpr)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;

                /******************************************************************************************************************/
                var docs = new string[]
                {
                    "всего в том числе:  01         ",
                    "туберкулез  02    А15-19",
                    "новообразования  03    С00-97",
                    "б-ни эндокринной системы, расст-ва питания и нарушения обмена веществ  04    Е00-90",
                    "из них сахарный диабет  04.1  Е10-14",
                    "заболевания щитовидной железы  04.2  Е00-07",
                    "психические расстройства и расстройства поведения  05    F00-99",
                    "из них умственная отсталость  05.2  F70-79",
                    "из числа с умст.отсталостью, вследствие ДЦП  05.21 F70-79",
                    "расстройства психологического развития  05.3 F80-89",
                    "болезни нервной системы  06    G00-99",
                    "из них восп-ые болезни ЦНС  06.1  G00-09",
                    "другие дегенеративные болезни ЦНС  06.2  G30-47",
                    "Детский церебральный паралич  06.3  G80-83",
                    "Др.нарушения нервной системы  06.4  G90-99",
                    "Последствия инфекц.болезней ЦНС  07    B90-94",
                    "Болезни органов чувств  08    H00-95",
                    "Болезни глаз  08.1  H00-59",
                    "Болезни уха и сосцевидного отростка  08.2  H60-95",
                    "Болезни системы кровообращения  09    I00-99",
                    "Ревматические болезни сердца  09.1  I05-09",
                    "Болезни органов дыхания  10    J00-99",
                    "Из них астма  10.1  J45",
                    "Болезни органов пищеварения  11    K00-93",
                    "Костно-мышечной системы и соединительной ткани  12    M00-99",
                    "Из них дорсопатии  12.1  M40-54",
                    "Остеопатии, хондропатии  12.2  M80-94",
                    "Б-ни мочеполовой системы  13    N00-99",
                    "Врожденные аномалии(пороки развития), деформация и хромосомные нарушения  14    Q00-99",
                    "Из них аномалии ЦНС  14.1  Q00-07",
                    "Органов чувств  14.2  Q10-18",
                    "Зрения  14.21 Q10-15",
                    "Слуха  14.22 Q16-18",
                    "Аномалии системы кровообращения  14.3  Q20-28",
                    "Врожденные аномалии костно-мышечной системы  14.4  Q65-79",
                    "Хромосомные аномалии  14.5  Q90-99",
                    "Состояния, возникающие в перинатальном периоде  15    P00-96",
                    "Травмы, отравления, др.воздействия внешних причин  16    S00-T98",
                    "Б-нь, вызванная ВИЧ  17    B20-24",
                    "Б-ни, вызванные облучением (ЧАЭС)  18    W-88  ",
                    "Доброкачественные новообразования  19    D10-36",
                    "Болезни крови  20    D50-89",
                    "Эхинококкоз  21    B-67",
                    "Бруцеллез  22    A-23",
                    "Прочие болезни  23          "
                };
                var items = new List<Report7D2Item>();
                int i2 = 1;
                foreach (var i in docs)
                {
                    var item = new Report7D2Item();
                    item.rowName = i;
                    item.rowNo = i2;
                    i2++;
                    items.Add(item);
                }
                CalcItems(context, /*report, */year, orgId, distrSpr,
                    items[44], items[43], items[42], items[41], items[40], items[39],
                    items[38], items[37], items[36], items[35], items[34], items[33], items[32],
                    items[31], items[30], items[29], items[28], items[27], items[26], items[25],
                    items[24], items[23], items[22], items[21], items[20], items[19], items[18],
                    items[17], items[16], items[15], items[14], items[13], items[12], items[11],
                    items[10], items[9], items[8], items[7], items[6], items[5], items[4],
                    items[3], items[2], items[1], items[0]);
                return items;
            }
            public static void CalcItems(WorkflowContext context, int year, Guid orgId, string distrSpr,
                    Report7D2Item item44, Report7D2Item item43, Report7D2Item item42,
                    Report7D2Item item41, Report7D2Item item40, Report7D2Item item39, Report7D2Item item38,
                    Report7D2Item item37, Report7D2Item item36, Report7D2Item item35, Report7D2Item item34,
                    Report7D2Item item33, Report7D2Item item32, Report7D2Item item31, Report7D2Item item30,
                    Report7D2Item item29, Report7D2Item item28, Report7D2Item item27, Report7D2Item item26,
                    Report7D2Item item25, Report7D2Item item24, Report7D2Item item23, Report7D2Item item22,
                    Report7D2Item item21, Report7D2Item item20, Report7D2Item item19, Report7D2Item item18,
                    Report7D2Item item17, Report7D2Item item16, Report7D2Item item15, Report7D2Item item14,
                    Report7D2Item item13, Report7D2Item item12, Report7D2Item item11, Report7D2Item item10,
                    Report7D2Item item9, Report7D2Item item8, Report7D2Item item7, Report7D2Item item6,
                    Report7D2Item item5, Report7D2Item item4, Report7D2Item item3, Report7D2Item item2,
                    Report7D2Item item1, Report7D2Item item0)
            {
                var qb = new QueryBuilder(childStatCardDefId, context.UserId);
                qb.Where("&State").Eq(ApprovedStateId).And("Examination1").Eq(primaryEnumId);

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                    var actSrc = query.JoinSource(query.Source, childActDefId, SqlSourceJoinType.Inner, "ChildrensMedicalCertificate");
                    var distrSrc = query.JoinSource(actSrc, districtDefId, SqlSourceJoinType.LeftOuter, "DistrictId");
                    var citySrc = query.JoinSource(actSrc, cityDefId, SqlSourceJoinType.LeftOuter, "CityId");
                    query.AddCondition(ExpressionOperation.And, childStatCardDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    if (!string.IsNullOrEmpty(distrSpr))
                        query.AddCondition(ExpressionOperation.And, districtDefId, "NumberDis", ConditionOperation.Equal, distrSpr);

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(query.Source, "EndDateExamination");
                    query.AddAttribute(query.Source, "AgeOf1");
                    query.AddAttribute(query.Source, "Diagnosis");
                    query.AddAttribute(distrSrc, "DistrictType");
                    query.AddAttribute(citySrc, "DistrictType");
                    query.AddAttribute(personSrc, "Gender");

                    var table = new DataTable();
                    using (var reader = context.CreateSqlReader(query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var date = !(row[1] is DBNull) ? (DateTime)row[1] : DateTime.MinValue;
                        var ageOf = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                        var diagnos = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                        var district = row[4] is DBNull ? Guid.Empty : (Guid)row[4];
                        var city = row[5] is DBNull ? Guid.Empty : (Guid)row[5];
                        var gender = row[6] is DBNull ? Guid.Empty : (Guid)row[6];

                        if (appId != Guid.Empty)
                        {
                            if (date.Year == year && (district == villageEnumId) ||
                                date.Year == year && (city == villageEnumId))
                            {
                                item0.gr1 = item0.gr1 != 0 ? (1 + (int)item0.gr1) : 1;

                                if (gender == womanEnumId) item0.gr2 = item0.gr2 != 0 ? (1 + (int)item0.gr2) : 1;
                                //в том числе в возрасте
                                /*****************************************************************************************************************************/
                                if (ageOf == ageOf1EnumId)
                                {
                                    item0.gr3 = item0.gr3 != 0 ? (1 + (int)item0.gr3) : 1;
                                    if (gender == womanEnumId) item0.gr4 = item0.gr4 != 0 ? (1 + (int)item0.gr4) : 1;
                                }
                                if (ageOf == ageOf2EnumId)
                                {
                                    item0.gr5 = item0.gr5 != 0 ? (1 + (int)item0.gr5) : 1;
                                    if (gender == womanEnumId) item0.gr6 = item0.gr6 != 0 ? (1 + (int)item0.gr6) : 1;
                                }
                                if (ageOf == ageOf3EnumId)
                                {
                                    item0.gr7 = item0.gr7 != 0 ? (1 + (int)item0.gr7) : 1;
                                    if (gender == womanEnumId) item0.gr8 = item0.gr8 != 0 ? (1 + (int)item0.gr8) : 1;
                                }
                                if (ageOf == ageOf4EnumId)
                                {
                                    item0.gr9 = item0.gr9 != 0 ? (1 + (int)item0.gr9) : 1;
                                    if (gender == womanEnumId) item0.gr10 = item0.gr10 != 0 ? (1 + (int)item0.gr10) : 1;
                                }
                                //A15-19
                                if (diagnos == strDiagId1)
                                {
                                    item1.gr1 = item1.gr1 != 0 ? (1 + (int)item1.gr1) : 1;

                                    if (gender == womanEnumId) item1.gr2 = item1.gr2 != 0 ? (1 + (int)item1.gr2) : 1;
                                    //в том числе в возрасте
                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item1.gr3 = item1.gr3 != 0 ? (1 + (int)item1.gr3) : 1;
                                        if (gender == womanEnumId) item1.gr4 = item1.gr4 != 0 ? (1 + (int)item1.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item1.gr5 = item1.gr5 != 0 ? (1 + (int)item1.gr5) : 1;
                                        if (gender == womanEnumId) item1.gr6 = item1.gr6 != 0 ? (1 + (int)item1.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item1.gr7 = item1.gr7 != 0 ? (1 + (int)item1.gr7) : 1;
                                        if (gender == womanEnumId) item1.gr8 = item1.gr8 != 0 ? (1 + (int)item1.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item1.gr9 = item1.gr9 != 0 ? (1 + (int)item1.gr9) : 1;
                                        if (gender == womanEnumId) item1.gr10 = item1.gr10 != 0 ? (1 + (int)item1.gr10) : 1;
                                    }
                                }
                                /***********************/
                                if (diagnos == strDiagId3)
                                {
                                    item2.gr1 = item2.gr1 != 0 ? (1 + (int)item2.gr1) : 1;

                                    if (gender == womanEnumId) item2.gr2 = item2.gr2 != 0 ? (1 + (int)item2.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item2.gr3 = item2.gr3 != 0 ? (1 + (int)item2.gr3) : 1;
                                        if (gender == womanEnumId) item2.gr4 = item2.gr4 != 0 ? (1 + (int)item2.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item2.gr5 = item2.gr5 != 0 ? (1 + (int)item2.gr5) : 1;
                                        if (gender == womanEnumId) item2.gr6 = item2.gr6 != 0 ? (1 + (int)item2.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item2.gr7 = item2.gr7 != 0 ? (1 + (int)item2.gr7) : 1;
                                        if (gender == womanEnumId) item2.gr8 = item2.gr8 != 0 ? (1 + (int)item2.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item2.gr9 = item2.gr9 != 0 ? (1 + (int)item2.gr9) : 1;
                                        if (gender == womanEnumId) item2.gr10 = item2.gr10 != 0 ? (1 + (int)item2.gr10) : 1;
                                    }
                                }
                                /************************************************/
                                if (diagnos == strDiagId4)
                                {
                                    item3.gr1 = item3.gr1 != 0 ? (1 + (int)item3.gr1) : 1;

                                    if (gender == womanEnumId) item3.gr2 = item3.gr2 != 0 ? (1 + (int)item3.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item3.gr3 = item3.gr3 != 0 ? (1 + (int)item3.gr3) : 1;
                                        if (gender == womanEnumId) item3.gr4 = item3.gr4 != 0 ? (1 + (int)item3.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item3.gr5 = item3.gr5 != 0 ? (1 + (int)item3.gr5) : 1;
                                        if (gender == womanEnumId) item3.gr6 = item3.gr6 != 0 ? (1 + (int)item3.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item3.gr7 = item3.gr7 != 0 ? (1 + (int)item3.gr7) : 1;
                                        if (gender == womanEnumId) item3.gr8 = item3.gr8 != 0 ? (1 + (int)item3.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item3.gr9 = item3.gr9 != 0 ? (1 + (int)item3.gr9) : 1;
                                        if (gender == womanEnumId) item3.gr10 = item3.gr10 != 0 ? (1 + (int)item3.gr10) : 1;
                                    }
                                }
                                /***********************************************/
                                if (diagnos == strDiagId6)
                                {
                                    item4.gr1 = item4.gr1 != 0 ? (1 + (int)item4.gr1) : 1;

                                    if (gender == womanEnumId) item4.gr2 = item4.gr2 != 0 ? (1 + (int)item4.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item4.gr3 = item4.gr3 != 0 ? (1 + (int)item4.gr3) : 1;
                                        if (gender == womanEnumId) item4.gr4 = item4.gr4 != 0 ? (1 + (int)item4.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item4.gr5 = item4.gr5 != 0 ? (1 + (int)item4.gr5) : 1;
                                        if (gender == womanEnumId) item4.gr6 = item4.gr6 != 0 ? (1 + (int)item4.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item4.gr7 = item4.gr7 != 0 ? (1 + (int)item4.gr7) : 1;
                                        if (gender == womanEnumId) item4.gr8 = item4.gr8 != 0 ? (1 + (int)item4.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item4.gr9 = item4.gr9 != 0 ? (1 + (int)item4.gr9) : 1;
                                        if (gender == womanEnumId) item4.gr10 = item4.gr10 != 0 ? (1 + (int)item4.gr10) : 1;
                                    }
                                }
                                /*********************************************/
                                if (diagnos == strDiagId5)
                                {
                                    item5.gr1 = item5.gr1 != 0 ? (1 + (int)item5.gr1) : 1;

                                    if (gender == womanEnumId) item5.gr2 = item5.gr2 != 0 ? (1 + (int)item5.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item5.gr3 = item5.gr3 != 0 ? (1 + (int)item5.gr3) : 1;
                                        if (gender == womanEnumId) item5.gr4 = item5.gr4 != 0 ? (1 + (int)item5.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item5.gr5 = item5.gr5 != 0 ? (1 + (int)item5.gr5) : 1;
                                        if (gender == womanEnumId) item5.gr6 = item5.gr6 != 0 ? (1 + (int)item5.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item5.gr7 = item5.gr7 != 0 ? (1 + (int)item5.gr7) : 1;
                                        if (gender == womanEnumId) item5.gr8 = item5.gr8 != 0 ? (1 + (int)item5.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item5.gr9 = item5.gr9 != 0 ? (1 + (int)item5.gr9) : 1;
                                        if (gender == womanEnumId) item5.gr10 = item5.gr10 != 0 ? (1 + (int)item5.gr10) : 1;
                                    }
                                }
                                /*************************************/
                                if (diagnos == strDiagId7)
                                {
                                    item6.gr1 = item6.gr1 != 0 ? (1 + (int)item6.gr1) : 1;

                                    if (gender == womanEnumId) item6.gr2 = item6.gr2 != 0 ? (1 + (int)item6.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item6.gr3 = item6.gr3 != 0 ? (1 + (int)item6.gr3) : 1;
                                        if (gender == womanEnumId) item6.gr4 = item6.gr4 != 0 ? (1 + (int)item6.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item6.gr5 = item6.gr5 != 0 ? (1 + (int)item6.gr5) : 1;
                                        if (gender == womanEnumId) item6.gr6 = item6.gr6 != 0 ? (1 + (int)item6.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item6.gr7 = item6.gr7 != 0 ? (1 + (int)item6.gr7) : 1;
                                        if (gender == womanEnumId) item6.gr8 = item6.gr8 != 0 ? (1 + (int)item6.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item6.gr9 = item6.gr9 != 0 ? (1 + (int)item6.gr9) : 1;
                                        if (gender == womanEnumId) item6.gr10 = item6.gr10 != 0 ? (1 + (int)item6.gr10) : 1;
                                    }
                                }
                                /********************************************************/
                                if (diagnos == strDiagId9)
                                {
                                    item7.gr1 = item7.gr1 != 0 ? (1 + (int)item7.gr1) : 1;

                                    if (gender == womanEnumId) item7.gr2 = item7.gr2 != 0 ? (1 + (int)item7.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item7.gr3 = item7.gr3 != 0 ? (1 + (int)item7.gr3) : 1;
                                        if (gender == womanEnumId) item7.gr4 = item7.gr4 != 0 ? (1 + (int)item7.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item7.gr5 = item7.gr5 != 0 ? (1 + (int)item7.gr5) : 1;
                                        if (gender == womanEnumId) item7.gr6 = item7.gr6 != 0 ? (1 + (int)item7.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item7.gr7 = item7.gr7 != 0 ? (1 + (int)item7.gr7) : 1;
                                        if (gender == womanEnumId) item7.gr8 = item7.gr8 != 0 ? (1 + (int)item7.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item7.gr9 = item7.gr9 != 0 ? (1 + (int)item7.gr9) : 1;
                                        if (gender == womanEnumId) item7.gr10 = item7.gr10 != 0 ? (1 + (int)item7.gr10) : 1;
                                    }
                                }
                                /****************************************/
                                if (diagnos == strDiagId10)
                                {
                                    item8.gr1 = item8.gr1 != 0 ? (1 + (int)item8.gr1) : 1;

                                    if (gender == womanEnumId) item8.gr2 = item8.gr2 != 0 ? (1 + (int)item8.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item8.gr3 = item8.gr3 != 0 ? (1 + (int)item8.gr3) : 1;
                                        if (gender == womanEnumId) item8.gr4 = item8.gr4 != 0 ? (1 + (int)item8.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item8.gr5 = item8.gr5 != 0 ? (1 + (int)item8.gr5) : 1;
                                        if (gender == womanEnumId) item8.gr6 = item8.gr6 != 0 ? (1 + (int)item8.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item8.gr7 = item8.gr7 != 0 ? (1 + (int)item8.gr7) : 1;
                                        if (gender == womanEnumId) item8.gr8 = item8.gr8 != 0 ? (1 + (int)item8.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item8.gr9 = item8.gr9 != 0 ? (1 + (int)item8.gr9) : 1;
                                        if (gender == womanEnumId) item8.gr10 = item8.gr10 != 0 ? (1 + (int)item8.gr10) : 1;
                                    }
                                }
                                /*******************************************/
                                if (diagnos == strDiagId13)
                                {
                                    item9.gr1 = item9.gr1 != 0 ? (1 + (int)item9.gr1) : 1;

                                    if (gender == womanEnumId) item9.gr2 = item9.gr2 != 0 ? (1 + (int)item9.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item9.gr3 = item9.gr3 != 0 ? (1 + (int)item9.gr3) : 1;
                                        if (gender == womanEnumId) item9.gr4 = item9.gr4 != 0 ? (1 + (int)item9.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item9.gr5 = item9.gr5 != 0 ? (1 + (int)item9.gr5) : 1;
                                        if (gender == womanEnumId) item9.gr6 = item9.gr6 != 0 ? (1 + (int)item9.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item9.gr7 = item9.gr7 != 0 ? (1 + (int)item9.gr7) : 1;
                                        if (gender == womanEnumId) item9.gr8 = item9.gr8 != 0 ? (1 + (int)item9.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item9.gr9 = item9.gr9 != 0 ? (1 + (int)item9.gr9) : 1;
                                        if (gender == womanEnumId) item9.gr10 = item9.gr10 != 0 ? (1 + (int)item9.gr10) : 1;
                                    }
                                }
                                /***************************************/
                                if (diagnos == strDiagId16)
                                {
                                    item10.gr1 = item10.gr1 != 0 ? (1 + (int)item10.gr1) : 1;

                                    if (gender == womanEnumId) item10.gr2 = item10.gr2 != 0 ? (1 + (int)item10.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item10.gr3 = item10.gr3 != 0 ? (1 + (int)item10.gr3) : 1;
                                        if (gender == womanEnumId) item10.gr4 = item10.gr4 != 0 ? (1 + (int)item10.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item10.gr5 = item10.gr5 != 0 ? (1 + (int)item10.gr5) : 1;
                                        if (gender == womanEnumId) item10.gr6 = item10.gr6 != 0 ? (1 + (int)item10.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item10.gr7 = item10.gr7 != 0 ? (1 + (int)item10.gr7) : 1;
                                        if (gender == womanEnumId) item10.gr8 = item10.gr8 != 0 ? (1 + (int)item10.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item10.gr9 = item10.gr9 != 0 ? (1 + (int)item10.gr9) : 1;
                                        if (gender == womanEnumId) item10.gr10 = item10.gr10 != 0 ? (1 + (int)item10.gr10) : 1;
                                    }
                                }
                                /*********************************************/
                                if (diagnos == strDiagId17)
                                {
                                    item11.gr1 = item11.gr1 != 0 ? (1 + (int)item11.gr1) : 1;

                                    if (gender == womanEnumId) item11.gr2 = item11.gr2 != 0 ? (1 + (int)item11.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item11.gr3 = item11.gr3 != 0 ? (1 + (int)item11.gr3) : 1;
                                        if (gender == womanEnumId) item11.gr4 = item11.gr4 != 0 ? (1 + (int)item11.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item11.gr5 = item11.gr5 != 0 ? (1 + (int)item11.gr5) : 1;
                                        if (gender == womanEnumId) item11.gr6 = item11.gr6 != 0 ? (1 + (int)item11.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item11.gr7 = item11.gr7 != 0 ? (1 + (int)item11.gr7) : 1;
                                        if (gender == womanEnumId) item11.gr8 = item11.gr8 != 0 ? (1 + (int)item11.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item11.gr9 = item11.gr9 != 0 ? (1 + (int)item11.gr9) : 1;
                                        if (gender == womanEnumId) item11.gr10 = item11.gr10 != 0 ? (1 + (int)item11.gr10) : 1;
                                    }
                                }
                                //if (diagnos == strDiagId)
                                /************************************************/
                                if (diagnos == strDiagId20)
                                {
                                    item13.gr1 = item13.gr1 != 0 ? (1 + (int)item13.gr1) : 1;

                                    if (gender == womanEnumId) item13.gr2 = item13.gr2 != 0 ? (1 + (int)item13.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item13.gr3 = item13.gr3 != 0 ? (1 + (int)item13.gr3) : 1;
                                        if (gender == womanEnumId) item13.gr4 = item13.gr4 != 0 ? (1 + (int)item13.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item13.gr5 = item13.gr5 != 0 ? (1 + (int)item13.gr5) : 1;
                                        if (gender == womanEnumId) item13.gr6 = item13.gr6 != 0 ? (1 + (int)item13.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item13.gr7 = item13.gr7 != 0 ? (1 + (int)item13.gr7) : 1;
                                        if (gender == womanEnumId) item13.gr8 = item13.gr8 != 0 ? (1 + (int)item13.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item13.gr9 = item13.gr9 != 0 ? (1 + (int)item13.gr9) : 1;
                                        if (gender == womanEnumId) item13.gr10 = item13.gr10 != 0 ? (1 + (int)item13.gr10) : 1;
                                    }
                                }
                                //if (diagnos == strDiagId)
                                //if (diagnos == strDiagId)
                                /***********************************************/
                                if (diagnos == strDiagId23)
                                {
                                    item16.gr1 = item16.gr1 != 0 ? (1 + (int)item16.gr1) : 1;

                                    if (gender == womanEnumId) item16.gr2 = item16.gr2 != 0 ? (1 + (int)item16.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item16.gr3 = item16.gr3 != 0 ? (1 + (int)item16.gr3) : 1;
                                        if (gender == womanEnumId) item16.gr4 = item16.gr4 != 0 ? (1 + (int)item16.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item16.gr5 = item16.gr5 != 0 ? (1 + (int)item16.gr5) : 1;
                                        if (gender == womanEnumId) item16.gr6 = item16.gr6 != 0 ? (1 + (int)item16.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item16.gr7 = item16.gr7 != 0 ? (1 + (int)item16.gr7) : 1;
                                        if (gender == womanEnumId) item16.gr8 = item16.gr8 != 0 ? (1 + (int)item16.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item16.gr9 = item16.gr9 != 0 ? (1 + (int)item16.gr9) : 1;
                                        if (gender == womanEnumId) item16.gr10 = item16.gr10 != 0 ? (1 + (int)item16.gr10) : 1;
                                    }
                                }
                                /********************************************/
                                if (diagnos == strDiagId24)
                                {
                                    item17.gr1 = item17.gr1 != 0 ? (1 + (int)item17.gr1) : 1;

                                    if (gender == womanEnumId) item17.gr2 = item17.gr2 != 0 ? (1 + (int)item17.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item17.gr3 = item17.gr3 != 0 ? (1 + (int)item17.gr3) : 1;
                                        if (gender == womanEnumId) item17.gr4 = item17.gr4 != 0 ? (1 + (int)item17.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item17.gr5 = item17.gr5 != 0 ? (1 + (int)item17.gr5) : 1;
                                        if (gender == womanEnumId) item17.gr6 = item17.gr6 != 0 ? (1 + (int)item17.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item17.gr7 = item17.gr7 != 0 ? (1 + (int)item17.gr7) : 1;
                                        if (gender == womanEnumId) item17.gr8 = item17.gr8 != 0 ? (1 + (int)item17.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item17.gr9 = item17.gr9 != 0 ? (1 + (int)item17.gr9) : 1;
                                        if (gender == womanEnumId) item17.gr10 = item17.gr10 != 0 ? (1 + (int)item17.gr10) : 1;
                                    }
                                }
                                /***************************************************/
                                if (diagnos == strDiagId25)
                                {
                                    item18.gr1 = item18.gr1 != 0 ? (1 + (int)item18.gr1) : 1;

                                    if (gender == womanEnumId) item18.gr2 = item18.gr2 != 0 ? (1 + (int)item18.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item18.gr3 = item18.gr3 != 0 ? (1 + (int)item18.gr3) : 1;
                                        if (gender == womanEnumId) item18.gr4 = item18.gr4 != 0 ? (1 + (int)item18.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item18.gr5 = item18.gr5 != 0 ? (1 + (int)item18.gr5) : 1;
                                        if (gender == womanEnumId) item18.gr6 = item18.gr6 != 0 ? (1 + (int)item18.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item18.gr7 = item18.gr7 != 0 ? (1 + (int)item18.gr7) : 1;
                                        if (gender == womanEnumId) item18.gr8 = item18.gr8 != 0 ? (1 + (int)item18.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item18.gr9 = item18.gr9 != 0 ? (1 + (int)item18.gr9) : 1;
                                        if (gender == womanEnumId) item18.gr10 = item18.gr10 != 0 ? (1 + (int)item18.gr10) : 1;
                                    }
                                }
                                /******************************************/
                                if (diagnos == strDiagId26)
                                {
                                    item19.gr1 = item19.gr1 != 0 ? (1 + (int)item19.gr1) : 1;

                                    if (gender == womanEnumId) item19.gr2 = item19.gr2 != 0 ? (1 + (int)item19.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item19.gr3 = item19.gr3 != 0 ? (1 + (int)item19.gr3) : 1;
                                        if (gender == womanEnumId) item19.gr4 = item19.gr4 != 0 ? (1 + (int)item19.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item19.gr5 = item19.gr5 != 0 ? (1 + (int)item19.gr5) : 1;
                                        if (gender == womanEnumId) item19.gr6 = item19.gr6 != 0 ? (1 + (int)item19.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item19.gr7 = item19.gr7 != 0 ? (1 + (int)item19.gr7) : 1;
                                        if (gender == womanEnumId) item19.gr8 = item19.gr8 != 0 ? (1 + (int)item19.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item19.gr9 = item19.gr9 != 0 ? (1 + (int)item19.gr9) : 1;
                                        if (gender == womanEnumId) item19.gr10 = item19.gr10 != 0 ? (1 + (int)item19.gr10) : 1;
                                    }
                                }
                                /**************************************/
                                if (diagnos == strDiagId27)
                                {
                                    item20.gr1 = item20.gr1 != 0 ? (1 + (int)item20.gr1) : 1;

                                    if (gender == womanEnumId) item20.gr2 = item20.gr2 != 0 ? (1 + (int)item20.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item20.gr3 = item20.gr3 != 0 ? (1 + (int)item20.gr3) : 1;
                                        if (gender == womanEnumId) item20.gr4 = item20.gr4 != 0 ? (1 + (int)item20.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item20.gr5 = item20.gr5 != 0 ? (1 + (int)item20.gr5) : 1;
                                        if (gender == womanEnumId) item20.gr6 = item20.gr6 != 0 ? (1 + (int)item20.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item20.gr7 = item20.gr7 != 0 ? (1 + (int)item20.gr7) : 1;
                                        if (gender == womanEnumId) item20.gr8 = item20.gr8 != 0 ? (1 + (int)item20.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item20.gr9 = item20.gr9 != 0 ? (1 + (int)item20.gr9) : 1;
                                        if (gender == womanEnumId) item20.gr10 = item20.gr10 != 0 ? (1 + (int)item20.gr10) : 1;
                                    }
                                }
                                /****************************************/
                                if (diagnos == strDiagId31)
                                {
                                    item21.gr1 = item21.gr1 != 0 ? (1 + (int)item21.gr1) : 1;

                                    if (gender == womanEnumId) item21.gr2 = item21.gr2 != 0 ? (1 + (int)item21.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item21.gr3 = item21.gr3 != 0 ? (1 + (int)item21.gr3) : 1;
                                        if (gender == womanEnumId) item21.gr4 = item21.gr4 != 0 ? (1 + (int)item21.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item21.gr5 = item21.gr5 != 0 ? (1 + (int)item21.gr5) : 1;
                                        if (gender == womanEnumId) item21.gr6 = item21.gr6 != 0 ? (1 + (int)item21.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item21.gr7 = item21.gr7 != 0 ? (1 + (int)item21.gr7) : 1;
                                        if (gender == womanEnumId) item21.gr8 = item21.gr8 != 0 ? (1 + (int)item21.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item21.gr9 = item21.gr9 != 0 ? (1 + (int)item21.gr9) : 1;
                                        if (gender == womanEnumId) item21.gr10 = item21.gr10 != 0 ? (1 + (int)item21.gr10) : 1;
                                    }
                                }
                                /********************************************/
                                if (diagnos == strDiagId32)
                                {
                                    item22.gr1 = item22.gr1 != 0 ? (1 + (int)item22.gr1) : 1;

                                    if (gender == womanEnumId) item22.gr2 = item22.gr2 != 0 ? (1 + (int)item22.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item22.gr3 = item22.gr3 != 0 ? (1 + (int)item22.gr3) : 1;
                                        if (gender == womanEnumId) item22.gr4 = item22.gr4 != 0 ? (1 + (int)item22.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item22.gr5 = item22.gr5 != 0 ? (1 + (int)item22.gr5) : 1;
                                        if (gender == womanEnumId) item22.gr6 = item22.gr6 != 0 ? (1 + (int)item22.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item22.gr7 = item22.gr7 != 0 ? (1 + (int)item22.gr7) : 1;
                                        if (gender == womanEnumId) item22.gr8 = item22.gr8 != 0 ? (1 + (int)item22.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item22.gr9 = item22.gr9 != 0 ? (1 + (int)item22.gr9) : 1;
                                        if (gender == womanEnumId) item22.gr10 = item22.gr10 != 0 ? (1 + (int)item22.gr10) : 1;
                                    }
                                }
                                /*****************************************/
                                if (diagnos == strDiagId33)
                                {
                                    item23.gr1 = item23.gr1 != 0 ? (1 + (int)item23.gr1) : 1;

                                    if (gender == womanEnumId) item23.gr2 = item23.gr2 != 0 ? (1 + (int)item23.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item23.gr3 = item23.gr3 != 0 ? (1 + (int)item23.gr3) : 1;
                                        if (gender == womanEnumId) item23.gr4 = item23.gr4 != 0 ? (1 + (int)item23.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item23.gr5 = item23.gr5 != 0 ? (1 + (int)item23.gr5) : 1;
                                        if (gender == womanEnumId) item23.gr6 = item23.gr6 != 0 ? (1 + (int)item23.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item23.gr7 = item23.gr7 != 0 ? (1 + (int)item23.gr7) : 1;
                                        if (gender == womanEnumId) item23.gr8 = item23.gr8 != 0 ? (1 + (int)item23.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item23.gr9 = item23.gr9 != 0 ? (1 + (int)item23.gr9) : 1;
                                        if (gender == womanEnumId) item23.gr10 = item23.gr10 != 0 ? (1 + (int)item23.gr10) : 1;
                                    }
                                }
                                /********************************************/
                                if (diagnos == strDiagId36)
                                {
                                    item24.gr1 = item24.gr1 != 0 ? (1 + (int)item24.gr1) : 1;

                                    if (gender == womanEnumId) item24.gr2 = item24.gr2 != 0 ? (1 + (int)item24.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item24.gr3 = item24.gr3 != 0 ? (1 + (int)item24.gr3) : 1;
                                        if (gender == womanEnumId) item24.gr4 = item24.gr4 != 0 ? (1 + (int)item24.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item24.gr5 = item24.gr5 != 0 ? (1 + (int)item24.gr5) : 1;
                                        if (gender == womanEnumId) item24.gr6 = item24.gr6 != 0 ? (1 + (int)item24.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item24.gr7 = item24.gr7 != 0 ? (1 + (int)item24.gr7) : 1;
                                        if (gender == womanEnumId) item24.gr8 = item24.gr8 != 0 ? (1 + (int)item24.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item24.gr9 = item24.gr9 != 0 ? (1 + (int)item24.gr9) : 1;
                                        if (gender == womanEnumId) item24.gr10 = item24.gr10 != 0 ? (1 + (int)item24.gr10) : 1;
                                    }
                                }
                                /**************************************************/
                                if (diagnos == strDiagId38)
                                {
                                    item25.gr1 = item25.gr1 != 0 ? (1 + (int)item25.gr1) : 1;

                                    if (gender == womanEnumId) item25.gr2 = item25.gr2 != 0 ? (1 + (int)item25.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item25.gr3 = item25.gr3 != 0 ? (1 + (int)item25.gr3) : 1;
                                        if (gender == womanEnumId) item25.gr4 = item25.gr4 != 0 ? (1 + (int)item25.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item25.gr5 = item25.gr5 != 0 ? (1 + (int)item25.gr5) : 1;
                                        if (gender == womanEnumId) item25.gr6 = item25.gr6 != 0 ? (1 + (int)item25.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item25.gr7 = item25.gr7 != 0 ? (1 + (int)item25.gr7) : 1;
                                        if (gender == womanEnumId) item25.gr8 = item25.gr8 != 0 ? (1 + (int)item25.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item25.gr9 = item25.gr9 != 0 ? (1 + (int)item25.gr9) : 1;
                                        if (gender == womanEnumId) item25.gr10 = item25.gr10 != 0 ? (1 + (int)item25.gr10) : 1;
                                    }
                                }
                                //if (diagnos == strDiagId)
                                /*************************************/
                                if (diagnos == strDiagId41)
                                {
                                    item27.gr1 = item27.gr1 != 0 ? (1 + (int)item27.gr1) : 1;

                                    if (gender == womanEnumId) item27.gr2 = item27.gr2 != 0 ? (1 + (int)item27.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item27.gr3 = item27.gr3 != 0 ? (1 + (int)item27.gr3) : 1;
                                        if (gender == womanEnumId) item27.gr4 = item27.gr4 != 0 ? (1 + (int)item27.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item27.gr5 = item27.gr5 != 0 ? (1 + (int)item27.gr5) : 1;
                                        if (gender == womanEnumId) item27.gr6 = item27.gr6 != 0 ? (1 + (int)item27.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item27.gr7 = item27.gr7 != 0 ? (1 + (int)item27.gr7) : 1;
                                        if (gender == womanEnumId) item27.gr8 = item27.gr8 != 0 ? (1 + (int)item27.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item27.gr9 = item27.gr9 != 0 ? (1 + (int)item27.gr9) : 1;
                                        if (gender == womanEnumId) item27.gr10 = item27.gr10 != 0 ? (1 + (int)item27.gr10) : 1;
                                    }
                                }
                                if (diagnos == strDiagId57)
                                {
                                    item28.gr1 = item28.gr1 != 0 ? (1 + (int)item28.gr1) : 1;

                                    if (gender == womanEnumId) item28.gr2 = item28.gr2 != 0 ? (1 + (int)item28.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item28.gr3 = item28.gr3 != 0 ? (1 + (int)item28.gr3) : 1;
                                        if (gender == womanEnumId) item28.gr4 = item28.gr4 != 0 ? (1 + (int)item28.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item28.gr5 = item28.gr5 != 0 ? (1 + (int)item28.gr5) : 1;
                                        if (gender == womanEnumId) item28.gr6 = item28.gr6 != 0 ? (1 + (int)item28.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item28.gr7 = item28.gr7 != 0 ? (1 + (int)item28.gr7) : 1;
                                        if (gender == womanEnumId) item28.gr8 = item28.gr8 != 0 ? (1 + (int)item28.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item28.gr9 = item28.gr9 != 0 ? (1 + (int)item28.gr9) : 1;
                                        if (gender == womanEnumId) item28.gr10 = item28.gr10 != 0 ? (1 + (int)item28.gr10) : 1;
                                    }
                                }
                                /***************************************/
                                if (diagnos == strDiagId58)
                                {
                                    item29.gr1 = item29.gr1 != 0 ? (1 + (int)item29.gr1) : 1;

                                    if (gender == womanEnumId) item29.gr2 = item29.gr2 != 0 ? (1 + (int)item29.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item29.gr3 = item29.gr3 != 0 ? (1 + (int)item29.gr3) : 1;
                                        if (gender == womanEnumId) item29.gr4 = item29.gr4 != 0 ? (1 + (int)item29.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item29.gr5 = item29.gr5 != 0 ? (1 + (int)item29.gr5) : 1;
                                        if (gender == womanEnumId) item29.gr6 = item29.gr6 != 0 ? (1 + (int)item29.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item29.gr7 = item29.gr7 != 0 ? (1 + (int)item29.gr7) : 1;
                                        if (gender == womanEnumId) item29.gr8 = item29.gr8 != 0 ? (1 + (int)item29.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item29.gr9 = item29.gr9 != 0 ? (1 + (int)item29.gr9) : 1;
                                        if (gender == womanEnumId) item29.gr10 = item29.gr10 != 0 ? (1 + (int)item29.gr10) : 1;
                                    }
                                }
                                /*************************************************/
                                if (diagnos == strDiagId59)
                                {
                                    item30.gr1 = item30.gr1 != 0 ? (1 + (int)item30.gr1) : 1;

                                    if (gender == womanEnumId) item30.gr2 = item30.gr2 != 0 ? (1 + (int)item30.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item30.gr3 = item30.gr3 != 0 ? (1 + (int)item30.gr3) : 1;
                                        if (gender == womanEnumId) item30.gr4 = item30.gr4 != 0 ? (1 + (int)item30.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item30.gr5 = item30.gr5 != 0 ? (1 + (int)item30.gr5) : 1;
                                        if (gender == womanEnumId) item30.gr6 = item30.gr6 != 0 ? (1 + (int)item30.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item30.gr7 = item30.gr7 != 0 ? (1 + (int)item30.gr7) : 1;
                                        if (gender == womanEnumId) item30.gr8 = item30.gr8 != 0 ? (1 + (int)item30.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item30.gr9 = item30.gr9 != 0 ? (1 + (int)item30.gr9) : 1;
                                        if (gender == womanEnumId) item30.gr10 = item30.gr10 != 0 ? (1 + (int)item30.gr10) : 1;
                                    }
                                }
                                /**************************************/
                                if (diagnos == strDiagId60)
                                {
                                    item31.gr1 = item31.gr1 != 0 ? (1 + (int)item31.gr1) : 1;

                                    if (gender == womanEnumId) item31.gr2 = item31.gr2 != 0 ? (1 + (int)item31.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item31.gr3 = item31.gr3 != 0 ? (1 + (int)item31.gr3) : 1;
                                        if (gender == womanEnumId) item31.gr4 = item31.gr4 != 0 ? (1 + (int)item31.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item31.gr5 = item31.gr5 != 0 ? (1 + (int)item31.gr5) : 1;
                                        if (gender == womanEnumId) item31.gr6 = item31.gr6 != 0 ? (1 + (int)item31.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item31.gr7 = item31.gr7 != 0 ? (1 + (int)item31.gr7) : 1;
                                        if (gender == womanEnumId) item31.gr8 = item31.gr8 != 0 ? (1 + (int)item31.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item31.gr9 = item31.gr9 != 0 ? (1 + (int)item31.gr9) : 1;
                                        if (gender == womanEnumId) item31.gr10 = item31.gr10 != 0 ? (1 + (int)item31.gr10) : 1;
                                    }
                                }
                                /****************************************/
                                if (diagnos == strDiagId61)
                                {
                                    item32.gr1 = item32.gr1 != 0 ? (1 + (int)item32.gr1) : 1;

                                    if (gender == womanEnumId) item32.gr2 = item32.gr2 != 0 ? (1 + (int)item32.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item32.gr3 = item32.gr3 != 0 ? (1 + (int)item32.gr3) : 1;
                                        if (gender == womanEnumId) item32.gr4 = item32.gr4 != 0 ? (1 + (int)item32.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item32.gr5 = item32.gr5 != 0 ? (1 + (int)item32.gr5) : 1;
                                        if (gender == womanEnumId) item32.gr6 = item32.gr6 != 0 ? (1 + (int)item32.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item32.gr7 = item32.gr7 != 0 ? (1 + (int)item32.gr7) : 1;
                                        if (gender == womanEnumId) item32.gr8 = item32.gr8 != 0 ? (1 + (int)item32.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item32.gr9 = item32.gr9 != 0 ? (1 + (int)item32.gr9) : 1;
                                        if (gender == womanEnumId) item32.gr10 = item32.gr10 != 0 ? (1 + (int)item32.gr10) : 1;
                                    }
                                }
                                /***************************************/
                                if (diagnos == strDiagId62)
                                {
                                    item33.gr1 = item33.gr1 != 0 ? (1 + (int)item33.gr1) : 1;

                                    if (gender == womanEnumId) item33.gr2 = item33.gr2 != 0 ? (1 + (int)item33.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item33.gr3 = item33.gr3 != 0 ? (1 + (int)item33.gr3) : 1;
                                        if (gender == womanEnumId) item33.gr4 = item33.gr4 != 0 ? (1 + (int)item33.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item33.gr5 = item33.gr5 != 0 ? (1 + (int)item33.gr5) : 1;
                                        if (gender == womanEnumId) item33.gr6 = item33.gr6 != 0 ? (1 + (int)item33.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item33.gr7 = item33.gr7 != 0 ? (1 + (int)item33.gr7) : 1;
                                        if (gender == womanEnumId) item33.gr8 = item33.gr8 != 0 ? (1 + (int)item33.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item33.gr9 = item33.gr9 != 0 ? (1 + (int)item33.gr9) : 1;
                                        if (gender == womanEnumId) item33.gr10 = item33.gr10 != 0 ? (1 + (int)item33.gr10) : 1;
                                    }
                                }
                                /**************************************/
                                if (diagnos == strDiagId65)
                                {
                                    item34.gr1 = item34.gr1 != 0 ? (1 + (int)item34.gr1) : 1;

                                    if (gender == womanEnumId) item34.gr2 = item34.gr2 != 0 ? (1 + (int)item34.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item34.gr3 = item34.gr3 != 0 ? (1 + (int)item34.gr3) : 1;
                                        if (gender == womanEnumId) item34.gr4 = item34.gr4 != 0 ? (1 + (int)item34.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item34.gr5 = item34.gr5 != 0 ? (1 + (int)item34.gr5) : 1;
                                        if (gender == womanEnumId) item34.gr6 = item34.gr6 != 0 ? (1 + (int)item34.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item34.gr7 = item34.gr7 != 0 ? (1 + (int)item34.gr7) : 1;
                                        if (gender == womanEnumId) item34.gr8 = item34.gr8 != 0 ? (1 + (int)item34.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item34.gr9 = item34.gr9 != 0 ? (1 + (int)item34.gr9) : 1;
                                        if (gender == womanEnumId) item34.gr10 = item34.gr10 != 0 ? (1 + (int)item34.gr10) : 1;
                                    }
                                }
                                /*************************************/
                                if (diagnos == strDiagId66)
                                {
                                    item35.gr1 = item35.gr1 != 0 ? (1 + (int)item35.gr1) : 1;

                                    if (gender == womanEnumId) item35.gr2 = item35.gr2 != 0 ? (1 + (int)item35.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item35.gr3 = item35.gr3 != 0 ? (1 + (int)item35.gr3) : 1;
                                        if (gender == womanEnumId) item35.gr4 = item35.gr4 != 0 ? (1 + (int)item35.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item35.gr5 = item35.gr5 != 0 ? (1 + (int)item35.gr5) : 1;
                                        if (gender == womanEnumId) item35.gr6 = item35.gr6 != 0 ? (1 + (int)item35.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item35.gr7 = item35.gr7 != 0 ? (1 + (int)item35.gr7) : 1;
                                        if (gender == womanEnumId) item35.gr8 = item35.gr8 != 0 ? (1 + (int)item35.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item35.gr9 = item35.gr9 != 0 ? (1 + (int)item35.gr9) : 1;
                                        if (gender == womanEnumId) item35.gr10 = item35.gr10 != 0 ? (1 + (int)item35.gr10) : 1;
                                    }
                                }
                                /************************************/
                                if (diagnos == strDiagId68)
                                {
                                    item36.gr1 = item36.gr1 != 0 ? (1 + (int)item36.gr1) : 1;

                                    if (gender == womanEnumId) item36.gr2 = item36.gr2 != 0 ? (1 + (int)item36.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item36.gr3 = item36.gr3 != 0 ? (1 + (int)item36.gr3) : 1;
                                        if (gender == womanEnumId) item36.gr4 = item36.gr4 != 0 ? (1 + (int)item36.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item36.gr5 = item36.gr5 != 0 ? (1 + (int)item36.gr5) : 1;
                                        if (gender == womanEnumId) item36.gr6 = item36.gr6 != 0 ? (1 + (int)item36.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item36.gr7 = item36.gr7 != 0 ? (1 + (int)item36.gr7) : 1;
                                        if (gender == womanEnumId) item36.gr8 = item36.gr8 != 0 ? (1 + (int)item36.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item36.gr9 = item36.gr9 != 0 ? (1 + (int)item36.gr9) : 1;
                                        if (gender == womanEnumId) item36.gr10 = item36.gr10 != 0 ? (1 + (int)item36.gr10) : 1;
                                    }
                                }
                                /**************************************/
                                if (diagnos == strDiagId49)
                                {
                                    item37.gr1 = item37.gr1 != 0 ? (1 + (int)item37.gr1) : 1;

                                    if (gender == womanEnumId) item37.gr2 = item37.gr2 != 0 ? (1 + (int)item37.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item37.gr3 = item37.gr3 != 0 ? (1 + (int)item37.gr3) : 1;
                                        if (gender == womanEnumId) item37.gr4 = item37.gr4 != 0 ? (1 + (int)item37.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item37.gr5 = item37.gr5 != 0 ? (1 + (int)item37.gr5) : 1;
                                        if (gender == womanEnumId) item37.gr6 = item37.gr6 != 0 ? (1 + (int)item37.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item37.gr7 = item37.gr7 != 0 ? (1 + (int)item37.gr7) : 1;
                                        if (gender == womanEnumId) item37.gr8 = item37.gr8 != 0 ? (1 + (int)item37.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item37.gr9 = item37.gr9 != 0 ? (1 + (int)item37.gr9) : 1;
                                        if (gender == womanEnumId) item37.gr10 = item37.gr10 != 0 ? (1 + (int)item37.gr10) : 1;
                                    }
                                }
                                /***********************************/
                                if (diagnos == strDiagId70)
                                {
                                    item38.gr1 = item38.gr1 != 0 ? (1 + (int)item38.gr1) : 1;

                                    if (gender == womanEnumId) item38.gr2 = item38.gr2 != 0 ? (1 + (int)item38.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item38.gr3 = item38.gr3 != 0 ? (1 + (int)item38.gr3) : 1;
                                        if (gender == womanEnumId) item38.gr4 = item38.gr4 != 0 ? (1 + (int)item38.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item38.gr5 = item38.gr5 != 0 ? (1 + (int)item38.gr5) : 1;
                                        if (gender == womanEnumId) item38.gr6 = item38.gr6 != 0 ? (1 + (int)item38.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item38.gr7 = item38.gr7 != 0 ? (1 + (int)item38.gr7) : 1;
                                        if (gender == womanEnumId) item38.gr8 = item38.gr8 != 0 ? (1 + (int)item38.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item38.gr9 = item38.gr9 != 0 ? (1 + (int)item38.gr9) : 1;
                                        if (gender == womanEnumId) item38.gr10 = item38.gr10 != 0 ? (1 + (int)item38.gr10) : 1;
                                    }
                                }
                                /*********************************/
                                if (diagnos == strDiagId74)
                                {
                                    item39.gr1 = item39.gr1 != 0 ? (1 + (int)item39.gr1) : 1;

                                    if (gender == womanEnumId) item39.gr2 = item39.gr2 != 0 ? (1 + (int)item39.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item39.gr3 = item39.gr3 != 0 ? (1 + (int)item39.gr3) : 1;
                                        if (gender == womanEnumId) item39.gr4 = item39.gr4 != 0 ? (1 + (int)item39.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item39.gr5 = item39.gr5 != 0 ? (1 + (int)item39.gr5) : 1;
                                        if (gender == womanEnumId) item39.gr6 = item39.gr6 != 0 ? (1 + (int)item39.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item39.gr7 = item39.gr7 != 0 ? (1 + (int)item39.gr7) : 1;
                                        if (gender == womanEnumId) item39.gr8 = item39.gr8 != 0 ? (1 + (int)item39.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item39.gr9 = item39.gr9 != 0 ? (1 + (int)item39.gr9) : 1;
                                        if (gender == womanEnumId) item39.gr10 = item39.gr10 != 0 ? (1 + (int)item39.gr10) : 1;
                                    }
                                }
                                /**********************************/
                                if (diagnos == strDiagId53)
                                {
                                    item40.gr1 = item40.gr1 != 0 ? (1 + (int)item40.gr1) : 1;

                                    if (gender == womanEnumId) item40.gr2 = item40.gr2 != 0 ? (1 + (int)item40.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item40.gr3 = item40.gr3 != 0 ? (1 + (int)item40.gr3) : 1;
                                        if (gender == womanEnumId) item40.gr4 = item40.gr4 != 0 ? (1 + (int)item40.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item40.gr5 = item40.gr5 != 0 ? (1 + (int)item40.gr5) : 1;
                                        if (gender == womanEnumId) item40.gr6 = item40.gr6 != 0 ? (1 + (int)item40.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item40.gr7 = item40.gr7 != 0 ? (1 + (int)item40.gr7) : 1;
                                        if (gender == womanEnumId) item40.gr8 = item40.gr8 != 0 ? (1 + (int)item40.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item40.gr9 = item40.gr9 != 0 ? (1 + (int)item40.gr9) : 1;
                                        if (gender == womanEnumId) item40.gr10 = item40.gr10 != 0 ? (1 + (int)item40.gr10) : 1;
                                    }
                                }
                                /*******************************************/
                                if (diagnos == strDiagId52)
                                {
                                    item41.gr1 = item41.gr1 != 0 ? (1 + (int)item41.gr1) : 1;

                                    if (gender == womanEnumId) item41.gr2 = item41.gr2 != 0 ? (1 + (int)item41.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item41.gr3 = item41.gr3 != 0 ? (1 + (int)item41.gr3) : 1;
                                        if (gender == womanEnumId) item41.gr4 = item41.gr4 != 0 ? (1 + (int)item41.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item41.gr5 = item41.gr5 != 0 ? (1 + (int)item41.gr5) : 1;
                                        if (gender == womanEnumId) item41.gr6 = item41.gr6 != 0 ? (1 + (int)item41.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item41.gr7 = item41.gr7 != 0 ? (1 + (int)item41.gr7) : 1;
                                        if (gender == womanEnumId) item41.gr8 = item41.gr8 != 0 ? (1 + (int)item41.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item41.gr9 = item41.gr9 != 0 ? (1 + (int)item41.gr9) : 1;
                                        if (gender == womanEnumId) item41.gr10 = item41.gr10 != 0 ? (1 + (int)item41.gr10) : 1;
                                    }
                                }
                                /***********************************/
                                if (diagnos == strDiagId56)
                                {
                                    item42.gr1 = item42.gr1 != 0 ? (1 + (int)item42.gr1) : 1;

                                    if (gender == womanEnumId) item42.gr2 = item42.gr2 != 0 ? (1 + (int)item42.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item42.gr3 = item42.gr3 != 0 ? (1 + (int)item42.gr3) : 1;
                                        if (gender == womanEnumId) item42.gr4 = item42.gr4 != 0 ? (1 + (int)item42.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item42.gr5 = item42.gr5 != 0 ? (1 + (int)item42.gr5) : 1;
                                        if (gender == womanEnumId) item42.gr6 = item42.gr6 != 0 ? (1 + (int)item42.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item42.gr7 = item42.gr7 != 0 ? (1 + (int)item42.gr7) : 1;
                                        if (gender == womanEnumId) item42.gr8 = item42.gr8 != 0 ? (1 + (int)item42.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item42.gr9 = item42.gr9 != 0 ? (1 + (int)item42.gr9) : 1;
                                        if (gender == womanEnumId) item42.gr10 = item42.gr10 != 0 ? (1 + (int)item42.gr10) : 1;
                                    }
                                }
                                /**********************************************/
                                if (diagnos == strDiagId54)
                                {
                                    item43.gr1 = item43.gr1 != 0 ? (1 + (int)item43.gr1) : 1;

                                    if (gender == womanEnumId) item43.gr2 = item43.gr2 != 0 ? (1 + (int)item43.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item43.gr3 = item43.gr3 != 0 ? (1 + (int)item43.gr3) : 1;
                                        if (gender == womanEnumId) item43.gr4 = item43.gr4 != 0 ? (1 + (int)item43.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item43.gr5 = item43.gr5 != 0 ? (1 + (int)item43.gr5) : 1;
                                        if (gender == womanEnumId) item43.gr6 = item43.gr6 != 0 ? (1 + (int)item43.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item43.gr7 = item43.gr7 != 0 ? (1 + (int)item43.gr7) : 1;
                                        if (gender == womanEnumId) item43.gr8 = item43.gr8 != 0 ? (1 + (int)item43.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item43.gr9 = item43.gr9 != 0 ? (1 + (int)item43.gr9) : 1;
                                        if (gender == womanEnumId) item43.gr10 = item43.gr10 != 0 ? (1 + (int)item43.gr10) : 1;
                                    }
                                }
                                /***********************************/
                                if (diagnos == strDiagId71)
                                {
                                    item44.gr1 = item44.gr1 != 0 ? (1 + (int)item44.gr1) : 1;

                                    if (gender == womanEnumId) item44.gr2 = item44.gr2 != 0 ? (1 + (int)item44.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item44.gr3 = item44.gr3 != 0 ? (1 + (int)item44.gr3) : 1;
                                        if (gender == womanEnumId) item44.gr4 = item44.gr4 != 0 ? (1 + (int)item44.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item44.gr5 = item44.gr5 != 0 ? (1 + (int)item44.gr5) : 1;
                                        if (gender == womanEnumId) item44.gr6 = item44.gr6 != 0 ? (1 + (int)item44.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item44.gr7 = item44.gr7 != 0 ? (1 + (int)item44.gr7) : 1;
                                        if (gender == womanEnumId) item44.gr8 = item44.gr8 != 0 ? (1 + (int)item44.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item44.gr9 = item44.gr9 != 0 ? (1 + (int)item44.gr9) : 1;
                                        if (gender == womanEnumId) item44.gr10 = item44.gr10 != 0 ? (1 + (int)item44.gr10) : 1;
                                    }
                                }
                            }
                        }
                    }
                }
            }
            static void RemoveRows(WorkflowContext context, Guid reportId)
            {
                var docRepo = context.Documents;
                var rows = new List<Guid>();
                var qb = new QueryBuilder(reportItemDefId, context.UserId);
                qb.Where("Report").Eq(reportId).Or("Report").IsNull();
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read()) rows.Add(reader.GetGuid(0));
                }
                foreach (var rowId in rows)
                {
                    docRepo.DeleteById(rowId);
                }
            }
            private static readonly Guid reportDefId = new Guid("{17789FEE-2908-4E01-8E16-2ECAF4A75C7A}"); //Отчет о распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности
            private static readonly Guid reportItemDefId = new Guid("{10AB1374-EA9C-493B-B5F6-CD6A40273B9B}"); //Распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности

            private static readonly Guid childStatCardDefId = new Guid("{363E89D0-5E31-45B5-82B7-42E83DF96E1F}"); //Статистический талон ребенка с ОВЗ
            private static readonly Guid childActDefId = new Guid("{0ECF44B6-2B2D-4687-B7B0-07BA5F942AC6}"); //Медицинский акт ребенка с ОВЗ
            private static readonly Guid personDefId = new Guid("{D71CE61A-9B59-4B5E-8713-8131DBB5BA02}"); //Person 
            public static readonly Guid districtDefId = new Guid("{A3FCA356-82A9-4BBD-872A-8333BEC6E41A}"); //Район
            public static readonly Guid cityDefId = new Guid("{4BB6D32D-5181-4031-BA49-CF5910D6D883}"); //Города районного значения

            public static readonly Guid goalForGroup = new Guid("{8FD84B27-FF2A-40A4-A87A-BC254DC9D853}"); //Цель -> Для установления группы

            public static readonly Guid ageOf1EnumId = new Guid("{484C1AF3-3203-478D-97B4-B7977738A194}"); //От 0-3 лет
            public static readonly Guid ageOf2EnumId = new Guid("{124DA030-994C-4F2D-AD5F-750986CCDC96}"); //От 4-7 лет
            public static readonly Guid ageOf3EnumId = new Guid("{CFDA5599-9767-430E-AC90-632D3FBDBF1F}"); //От 8-14 лет
            public static readonly Guid ageOf4EnumId = new Guid("{30DA048C-85C4-4078-9A63-0CDB40A7747A}"); //От 15-17 лет

            //Инвалидность установлена на срок
            public static readonly Guid termEnumId1 = new Guid("{C0C639C1-4069-42BD-B9C5-0C4C0EAD41CE}"); //1 год
            public static readonly Guid termEnumId2 = new Guid("{CAB664A9-513D-4939-AB17-31ACF97C7592}"); //2 года
            public static readonly Guid termEnumId3 = new Guid("{4C270330-A4A0-40B7-9E2C-6726AE4BAD6C}"); //5 лет
            public static readonly Guid termEnumId4 = new Guid("{B1F91F0F-EA5C-4DA4-9DE6-C3FC0142E66F}"); //до 18 лет

            public static readonly Guid childGroupEnId = new Guid("{D145ABA1-EADA-442B-9D8D-AD10BCD126D2}"); //Ребенок с ОВЗ
            public static readonly Guid notInstalledEnId = new Guid("{BEB4542B-0C03-494A-BD60-AA6BA8E8BF4C}"); //Не установлена

            public static readonly Guid villageEnumId = new Guid("{65DF9C4D-A18B-4080-855F-4800E2A19C35}"); //Cельская местность//DistrictType
            public static readonly Guid cityEnumId = new Guid("{DE3D24A1-64D3-4647-B711-31F334D24416}"); //Городская местность//DistrictType
            public static readonly Guid womanEnumId = new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"); //Женский пол
            public static readonly Guid primaryEnumId = new Guid("{34129BC5-5B31-4189-87FA-799402F7E99F}"); //Первичное
            public static readonly Guid ApprovedStateId = new Guid("{32062CB7-C31C-4AFB-ADF3-F9F9AEEFCE59}");  //Подписанные

            //диагнозы
            private static readonly Guid strDiagId1 = new Guid("{9FF329FE-F547-42BE-817F-ED989FFB6573}"); //Туберкулез/ А 15-19
            private static readonly Guid strDiagId2 = new Guid("{99BC4A06-B78C-4A88-9F5C-AD4835563758}"); //Туберкулез  легких/ А 15-16
            private static readonly Guid strDiagId3 = new Guid("{2F9950BC-62B8-4B2B-865A-1C9C080CCC4E}"); //Злокачественные новообразования/ С 00-97
            private static readonly Guid strDiagId4 = new Guid("{C9CDD032-DC56-4027-A7D8-DBFE2F29BDE2}"); //Болезни эндокринной системы, нарушения обмена веществ/ Е 00-90
            private static readonly Guid strDiagId5 = new Guid("{C22D27F2-89F8-4355-A962-8EDE8294D052}"); //Заболeвания щитовидной железы/ E 00-07
            private static readonly Guid strDiagId6 = new Guid("{81E09427-D877-4C77-8609-E813D1BAF5FF}"); //Сахарный диабет/ E 10-14
            private static readonly Guid strDiagId7 = new Guid("{7ACAB39A-5CEE-4EF0-AAAB-10764F111DC0}"); //Психические расстройства/ F 00-99
            private static readonly Guid strDiagId8 = new Guid("{1F2922AB-423A-4997-BAB8-5D18538B5A15}"); //Шизофрения/ F 20
            private static readonly Guid strDiagId9 = new Guid("{22E82EC9-8BAA-48FD-AFD8-17619B0AD476}"); //Умственная отсталость/ F 70-79
            private static readonly Guid strDiagId10 = new Guid("{070AADAE-4453-4753-B939-44FD21544953}"); //Умственная отсталость, в сочетании ДЦП/ F 70-79
            private static readonly Guid strDiagId11 = new Guid("{BA1B55AC-F4C2-4112-BABD-7E986B3E2B07}"); //Органическое слабоумие/ F 00-03
            private static readonly Guid strDiagId12 = new Guid("{970AE4FA-9B31-447E-AF8B-9567A8F62F3F}"); //Органическое слабоумие в сочетании ДЦП/ F 00-03
            private static readonly Guid strDiagId13 = new Guid("{A9D88506-1CF4-437A-8B8C-40AB1AF88C12}"); //Расстройство психологического развития/ F 80-89
            private static readonly Guid strDiagId14 = new Guid("{B1E87505-BE6E-46AA-BDE7-FC556CD53D2B}"); //Огранические расстройство личности/ F 06-07
            private static readonly Guid strDiagId15 = new Guid("{1452F4DA-2382-4CAD-A621-3A758F4A430B}"); //Аутизм
            private static readonly Guid strDiagId16 = new Guid("{4BB66F12-B96C-4917-BFB3-0947D41AFA52}"); //Болезни нервной системы/ G 00-99
            private static readonly Guid strDiagId17 = new Guid("{9E0B999D-9AB4-4667-88F9-35DC37C1D743}"); //Воспалительные болезни нервной системы/ G 00-09
            private static readonly Guid strDiagId18 = new Guid("{471214D9-9EB8-4A00-B4ED-A05E77C5876A}"); //Дегенеративные, демилиенизирующие болезни/ G 10-37
            private static readonly Guid strDiagId19 = new Guid("{E2E0C9F8-F413-41F3-A8A6-8674EDEEAC64}"); //Эпилепсия/ G 40-41
            private static readonly Guid strDiagId20 = new Guid("{F6BAE9AD-DDBA-4C71-9A36-E1106E9BCBD9}"); //Детский церебральный паралич/ G 80-83
            private static readonly Guid strDiagId21 = new Guid("{B811E7CB-8ED9-4BFF-A1C7-BA1FE20C8C81}"); //Последствия воспалительных болезней ЦНС/ G 09
            private static readonly Guid strDiagId22 = new Guid("{DFE168E8-7E30-4D8A-9AEF-54382B0A3932}"); //Болезни периферической нервной системы/ G 50-64
            private static readonly Guid strDiagId23 = new Guid("{40012DC1-53A1-4EE7-8F93-85547C827DB5}"); //Болезни органов чувств/ H 00-95
            private static readonly Guid strDiagId24 = new Guid("{24483E18-28AC-4981-9C29-B94075BE9725}"); //Болезни глаз/ H 00-59
            private static readonly Guid strDiagId25 = new Guid("{558D6E2E-E1E0-4D37-B200-A94D9953099F}"); //Болезни уха и сосцевидного отростка/ H 60-95
            private static readonly Guid strDiagId26 = new Guid("{E3D6EF80-B5E4-4DAE-9832-19FAD50A80F3}"); //Болезни системы кровообращения/ I 00-99
            private static readonly Guid strDiagId27 = new Guid("{D71970B1-0562-4905-AC26-77DE739CAF5C}"); //Хронические ревматические болезни сердца/  I 05-09
            private static readonly Guid strDiagId28 = new Guid("{E6D6A67F-ED33-4879-B1C2-9BC173BB457B}"); //Повышенное кровеносное давление/ I 10-15
            private static readonly Guid strDiagId29 = new Guid("{10712C7B-4FDC-4B6F-A50B-B7858FDD1211}"); //Ишемическая болезнь сердца/ I 20-25
            private static readonly Guid strDiagId30 = new Guid("{9549B0FD-2F0D-488A-8228-E990B01288D8}"); //Цереброваскулярные болезни/ I 60-69
            private static readonly Guid strDiagId31 = new Guid("{3363DE1E-864C-4063-BED7-4526F673AFF6}"); //Болезни органов дыхания / J 00-99
            private static readonly Guid strDiagId32 = new Guid("{866F3B61-AFCF-45F5-97BE-E0C23B87393C}"); //Бронхиальная астма/ J 45
            private static readonly Guid strDiagId33 = new Guid("{05479FEC-BC19-42B8-A0EC-37C63CE91205}"); //Болезни органов пищеварения/ K 00-93
            private static readonly Guid strDiagId34 = new Guid("{5E6F7098-6633-4B55-A920-82DD9538032A}"); //Болезни печени/ K 70-77
            private static readonly Guid strDiagId35 = new Guid("{225F29AD-6E5D-4DC5-B487-144D386D8DE8}"); //Болезни кожи, подкожной клетчатки/ L 00-99
            private static readonly Guid strDiagId36 = new Guid("{ECC9E612-FB40-4344-8298-5CD8BA40635F}"); //Болезни костно-мешечной системы и соединительной ткани/ M 00-99
            private static readonly Guid strDiagId37 = new Guid("{B3000363-8258-4F07-8234-0DE79E053660}"); //Ревматоидные/ M 05-14
            private static readonly Guid strDiagId38 = new Guid("{FD1C5BBA-0EA5-4929-8EB9-E6C957C2ADA4}"); //Дорсопатии, остеохондроз/ M 40-54
            private static readonly Guid strDiagId39 = new Guid("{1D4E81CB-2315-44C9-BDF3-B0FA874B8E61}"); //Остеохондроз позвоночника/ M 42
            private static readonly Guid strDiagId40 = new Guid("{87378F65-16F1-4B5D-83FB-53DD98628A75}"); //Оперированные дорсопатии, остеохондроз/  M 40-54
            private static readonly Guid strDiagId41 = new Guid("{3E0E50B5-9A3A-4DA2-A098-7147CB19833D}"); //Болезни мочевыводящих органов/ N 00-99
            private static readonly Guid strDiagId42 = new Guid("{82D1F915-CADF-4E7F-91A9-36B84CAB5A85}"); //Травмы, отравления и другие воздействия внешних причин/ S00 T98
            private static readonly Guid strDiagId43 = new Guid("{FC38C0AE-2C54-4609-B728-517D5BC481CF}"); //Травма глаз/ T 90.4
            private static readonly Guid strDiagId44 = new Guid("{3B607D89-91FB-4A90-9C77-61B71658950C}"); //Травма головы/ T-90
            private static readonly Guid strDiagId45 = new Guid("{F636A14B-B2F4-4EC9-9EBA-0A6A0F6CEA9C}"); //Травмы позвоночника/  T 91.1
            private static readonly Guid strDiagId46 = new Guid("{51EDADEE-1AD8-4E72-AC33-B41F057CD61B}"); //Травмы позвоночника с повреждением спинного мозга/  T 91.3
            private static readonly Guid strDiagId47 = new Guid("{0D31A297-B2C2-42A6-9406-81E258D93114}"); //Травмы нижних конечностей /  T 93
            private static readonly Guid strDiagId48 = new Guid("{961024D8-FF80-414E-9A3E-C669D167E996}"); //Термические, химические ожоги, отморожения/ T 95
            private static readonly Guid strDiagId49 = new Guid("{6E4156F7-3DEE-4191-9CFB-B44B8E6088E8}"); //Автодорожная травма/ S 00 T 98
            private static readonly Guid strDiagId50 = new Guid("{961BB1B1-2C65-4833-86FA-2FC02CBCDDA8}"); //Болезни вследствие воздействия ионизирующего облучения/ W 88
            private static readonly Guid strDiagId51 = new Guid("{F702AAD3-523D-4914-8B97-5D2B9905D231}"); //Болезни вследствие воздействия вибрации/ W 43
            private static readonly Guid strDiagId52 = new Guid("{E7271846-9AAA-4C52-AA19-CB01C3B765A2}"); //Болезни крови, кроветворных органов/ D 50-89
            private static readonly Guid strDiagId53 = new Guid("{41F09403-B4B7-46CA-92BF-B716523AFDE9}"); //Доброкачественные новообразования/ D 10-36
            private static readonly Guid strDiagId54 = new Guid("{D4050056-32C3-48FD-9718-EA7FE3294E82}"); //Бруцеллез/ A 23
            private static readonly Guid strDiagId55 = new Guid("{1DEDD889-4336-4622-85C0-9DDD1FF432D9}"); //Бруцеллез бытовой/ A 23
            private static readonly Guid strDiagId56 = new Guid("{F3B64F5D-6A6C-4343-B5B5-7B5E3CB92474}"); //Эхинококкоз/ B 67
            private static readonly Guid strDiagId57 = new Guid("{0CEAC906-B3D2-4AD8-9DE6-D3FA384F2CDF}"); //Врожденные пороки развития, хромосомные развития/ Q 00-99
            private static readonly Guid strDiagId58 = new Guid("{19309EF8-3706-45DE-8A74-E2652AEF8368}"); //Аномалии ЦНС/ Q 00-07
            private static readonly Guid strDiagId59 = new Guid("{C172D276-4C76-48F6-911F-D552D3A533D8}"); //Аномалии органов чувств/ Q 10 - 18
            private static readonly Guid strDiagId60 = new Guid("{018CC67A-9281-438B-9808-222AEFC31AE7}"); //Аномалии зрения/ Q 10 - 15
            private static readonly Guid strDiagId61 = new Guid("{7BAAF5C9-D1F4-4FC7-B270-DFBE6FE335B3}"); //Аномалии слуха/ Q 16 - 18
            private static readonly Guid strDiagId62 = new Guid("{52A085F0-7B28-4F13-BB33-BDD34AD94F3C}"); //Аномалии системы кровообращения/ Q 20-28
            private static readonly Guid strDiagId63 = new Guid("{62EA3A46-6964-4791-BF68-7DBD2DB70B3B}"); //Расщелина губы и неба/ Q35-37
            private static readonly Guid strDiagId64 = new Guid("{20F214CB-1B5B-4E69-A0CA-982096503776}"); //Врожденные деформации бедра, т\бедренного сустава/ Q 65
            private static readonly Guid strDiagId65 = new Guid("{44804C12-8795-4938-8585-40BA2C82BB8E}"); //Врожденные аномалии костно-мышечной системы/ Q 66-79
            private static readonly Guid strDiagId66 = new Guid("{E0459C10-17FF-4210-A4DF-53081F6E177B}"); //Хромосомные аномалии/ Q 91-99
            private static readonly Guid strDiagId67 = new Guid("{A4D44A12-8DC0-4B14-BF67-3E5D4C560871}"); //Болезни/ Q 90
            private static readonly Guid strDiagId68 = new Guid("{BC059B01-6570-41B3-B1C8-75E3CBAD60DA}"); //Состояния, возникающие в периетальном периоде/ P 00-96
            private static readonly Guid strDiagId69 = new Guid("{07C6C658-D589-48A1-803B-DBCA6603B543}"); //Болезни вызванные вирусом ВИЧ (СПИД)/ B 20-24
            private static readonly Guid strDiagId70 = new Guid("{EC422C17-E8E4-42A3-AD96-EBCBC07B7C7E}"); //Дети рожденные от матерей инфицированных ВИЧ/ ЦВ 20-24
            private static readonly Guid strDiagId71 = new Guid("{0ADE4B55-DF1D-46EA-954B-F3F9FB7CAE08}"); //Прочие болезни / Прочие
            private static readonly Guid strDiagId72 = new Guid("{25029E6F-916F-44DE-86B0-C018A8055D4F}"); //Трудовое увечье
            private static readonly Guid strDiagId73 = new Guid("{8F30CA1F-9187-463E-9D26-1BD525BF45F6}"); //Профессиональные болезни
            private static readonly Guid strDiagId74 = new Guid("{CBEBAF9D-B67D-4BB3-B715-DB252DC2C018}"); //Ликвидаторы последствий аварии на ЧАЭС
            private static readonly Guid strDiagId75 = new Guid("{C0B08AFD-85BB-4DB1-8D9D-6ED3CA43438E}"); //Пострадавшие в событиях 2010г. Бишкек, Талас
            private static readonly Guid strDiagId76 = new Guid("{6A2CF4F5-E0FC-4D70-9DD3-DA23F3049CD2}"); //Пострадавшие в событиях 2010г. Ош, Жалал-Абад
        }
        //Результаты первичных освидетельствований  детей в возрасте до 18 лет (человек), проживающих в ( ГОРОДСКАЯ МЕСТНОСТЬ + СЕЛЬСКАЯ МЕСТНОСТЬ)
        public static class PrimaryInvalidsOfCityVillage18Age
        {
            public static List<Report7D2Item> Execute(WorkflowContext context, int year, string distrSpr)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;

                /******************************************************************************************************************/
                var docs = new string[]
                {
                    "всего в том числе:  01         ",
                    "туберкулез  02    А15-19",
                    "новообразования  03    С00-97",
                    "б-ни эндокринной системы, расст-ва питания и нарушения обмена веществ  04    Е00-90",
                    "из них сахарный диабет  04.1  Е10-14",
                    "заболевания щитовидной железы  04.2  Е00-07",
                    "психические расстройства и расстройства поведения  05    F00-99",
                    "из них умственная отсталость  05.2  F70-79",
                    "из числа с умст.отсталостью, вследствие ДЦП  05.21 F70-79",
                    "расстройства психологического развития  05.3 F80-89",
                    "болезни нервной системы  06    G00-99",
                    "из них восп-ые болезни ЦНС  06.1  G00-09",
                    "другие дегенеративные болезни ЦНС  06.2  G30-47",
                    "Детский церебральный паралич  06.3  G80-83",
                    "Др.нарушения нервной системы  06.4  G90-99",
                    "Последствия инфекц.болезней ЦНС  07    B90-94",
                    "Болезни органов чувств  08    H00-95",
                    "Болезни глаз  08.1  H00-59",
                    "Болезни уха и сосцевидного отростка  08.2  H60-95",
                    "Болезни системы кровообращения  09    I00-99",
                    "Ревматические болезни сердца  09.1  I05-09",
                    "Болезни органов дыхания  10    J00-99",
                    "Из них астма  10.1  J45",
                    "Болезни органов пищеварения  11    K00-93",
                    "Костно-мышечной системы и соединительной ткани  12    M00-99",
                    "Из них дорсопатии  12.1  M40-54",
                    "Остеопатии, хондропатии  12.2  M80-94",
                    "Б-ни мочеполовой системы  13    N00-99",
                    "Врожденные аномалии(пороки развития), деформация и хромосомные нарушения  14    Q00-99",
                    "Из них аномалии ЦНС  14.1  Q00-07",
                    "Органов чувств  14.2  Q10-18",
                    "Зрения  14.21 Q10-15",
                    "Слуха  14.22 Q16-18",
                    "Аномалии системы кровообращения  14.3  Q20-28",
                    "Врожденные аномалии костно-мышечной системы  14.4  Q65-79",
                    "Хромосомные аномалии  14.5  Q90-99",
                    "Состояния, возникающие в перинатальном периоде  15    P00-96",
                    "Травмы, отравления, др.воздействия внешних причин  16    S00-T98",
                    "Б-нь, вызванная ВИЧ  17    B20-24",
                    "Б-ни, вызванные облучением (ЧАЭС)  18    W-88  ",
                    "Доброкачественные новообразования  19    D10-36",
                    "Болезни крови  20    D50-89",
                    "Эхинококкоз  21    B-67",
                    "Бруцеллез  22    A-23",
                    "Прочие болезни  23          "
                };
                var items = new List<Report7D2Item>();
                int i2 = 1;
                foreach (var i in docs)
                {
                    var item = new Report7D2Item();
                    item.rowName = i;
                    item.rowNo = i2;
                    i2++;
                    items.Add(item);
                }
                CalcItems(context, /*report, */year, orgId, distrSpr,
                    items[44], items[43], items[42], items[41], items[40], items[39],
                    items[38], items[37], items[36], items[35], items[34], items[33], items[32],
                    items[31], items[30], items[29], items[28], items[27], items[26], items[25],
                    items[24], items[23], items[22], items[21], items[20], items[19], items[18],
                    items[17], items[16], items[15], items[14], items[13], items[12], items[11],
                    items[10], items[9], items[8], items[7], items[6], items[5], items[4],
                    items[3], items[2], items[1], items[0]);
                return items;
            }
            public static void CalcItems(WorkflowContext context, int year, Guid orgId, string distrSpr,
                    Report7D2Item item44, Report7D2Item item43, Report7D2Item item42,
                    Report7D2Item item41, Report7D2Item item40, Report7D2Item item39, Report7D2Item item38,
                    Report7D2Item item37, Report7D2Item item36, Report7D2Item item35, Report7D2Item item34,
                    Report7D2Item item33, Report7D2Item item32, Report7D2Item item31, Report7D2Item item30,
                    Report7D2Item item29, Report7D2Item item28, Report7D2Item item27, Report7D2Item item26,
                    Report7D2Item item25, Report7D2Item item24, Report7D2Item item23, Report7D2Item item22,
                    Report7D2Item item21, Report7D2Item item20, Report7D2Item item19, Report7D2Item item18,
                    Report7D2Item item17, Report7D2Item item16, Report7D2Item item15, Report7D2Item item14,
                    Report7D2Item item13, Report7D2Item item12, Report7D2Item item11, Report7D2Item item10,
                    Report7D2Item item9, Report7D2Item item8, Report7D2Item item7, Report7D2Item item6,
                    Report7D2Item item5, Report7D2Item item4, Report7D2Item item3, Report7D2Item item2,
                    Report7D2Item item1, Report7D2Item item0)
            {
                var qb = new QueryBuilder(childStatCardDefId, context.UserId);
                qb.Where("&State").Eq(ApprovedStateId).And("Examination1").Eq(primaryEnumId);

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                    var actSrc = query.JoinSource(query.Source, childActDefId, SqlSourceJoinType.Inner, "ChildrensMedicalCertificate");
                    var distrSrc = query.JoinSource(actSrc, districtDefId, SqlSourceJoinType.LeftOuter, "DistrictId");
                    var citySrc = query.JoinSource(actSrc, cityDefId, SqlSourceJoinType.LeftOuter, "CityId");
                    query.AddCondition(ExpressionOperation.And, childStatCardDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    if (!string.IsNullOrEmpty(distrSpr))
                        query.AddCondition(ExpressionOperation.And, districtDefId, "NumberDis", ConditionOperation.Equal, distrSpr);

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(query.Source, "EndDateExamination");
                    query.AddAttribute(query.Source, "AgeOf1");
                    query.AddAttribute(query.Source, "Diagnosis");
                    query.AddAttribute(distrSrc, "DistrictType");
                    query.AddAttribute(citySrc, "DistrictType");
                    query.AddAttribute(personSrc, "Gender");

                    var table = new DataTable();
                    using (var reader = context.CreateSqlReader(query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var date = !(row[1] is DBNull) ? (DateTime)row[1] : DateTime.MinValue;
                        var ageOf = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                        var diagnos = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                        var district = row[4] is DBNull ? Guid.Empty : (Guid)row[4];
                        var city = row[5] is DBNull ? Guid.Empty : (Guid)row[5];
                        var gender = row[6] is DBNull ? Guid.Empty : (Guid)row[6];

                        if (appId != Guid.Empty)
                        {
                            if (date.Year == year && (district == villageEnumId) ||
                                date.Year == year && (city == villageEnumId) ||
                                date.Year == year && (city == cityEnumId) ||
                                date.Year == year && (city == cityEnumId))
                            {
                                item0.gr1 = item0.gr1 != 0 ? (1 + (int)item0.gr1) : 1;

                                if (gender == womanEnumId) item0.gr2 = item0.gr2 != 0 ? (1 + (int)item0.gr2) : 1;
                                //в том числе в возрасте
                                /*****************************************************************************************************************************/
                                if (ageOf == ageOf1EnumId)
                                {
                                    item0.gr3 = item0.gr3 != 0 ? (1 + (int)item0.gr3) : 1;
                                    if (gender == womanEnumId) item0.gr4 = item0.gr4 != 0 ? (1 + (int)item0.gr4) : 1;
                                }
                                if (ageOf == ageOf2EnumId)
                                {
                                    item0.gr5 = item0.gr5 != 0 ? (1 + (int)item0.gr5) : 1;
                                    if (gender == womanEnumId) item0.gr6 = item0.gr6 != 0 ? (1 + (int)item0.gr6) : 1;
                                }
                                if (ageOf == ageOf3EnumId)
                                {
                                    item0.gr7 = item0.gr7 != 0 ? (1 + (int)item0.gr7) : 1;
                                    if (gender == womanEnumId) item0.gr8 = item0.gr8 != 0 ? (1 + (int)item0.gr8) : 1;
                                }
                                if (ageOf == ageOf4EnumId)
                                {
                                    item0.gr9 = item0.gr9 != 0 ? (1 + (int)item0.gr9) : 1;
                                    if (gender == womanEnumId) item0.gr10 = item0.gr10 != 0 ? (1 + (int)item0.gr10) : 1;
                                }
                                //A15-19
                                if (diagnos == strDiagId1)
                                {
                                    item1.gr1 = item1.gr1 != 0 ? (1 + (int)item1.gr1) : 1;

                                    if (gender == womanEnumId) item1.gr2 = item1.gr2 != 0 ? (1 + (int)item1.gr2) : 1;
                                    //в том числе в возрасте
                                    /*****************************************************************************************************************************/
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item1.gr3 = item1.gr3 != 0 ? (1 + (int)item1.gr3) : 1;
                                        if (gender == womanEnumId) item1.gr4 = item1.gr4 != 0 ? (1 + (int)item1.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item1.gr5 = item1.gr5 != 0 ? (1 + (int)item1.gr5) : 1;
                                        if (gender == womanEnumId) item1.gr6 = item1.gr6 != 0 ? (1 + (int)item1.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item1.gr7 = item1.gr7 != 0 ? (1 + (int)item1.gr7) : 1;
                                        if (gender == womanEnumId) item1.gr8 = item1.gr8 != 0 ? (1 + (int)item1.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item1.gr9 = item1.gr9 != 0 ? (1 + (int)item1.gr9) : 1;
                                        if (gender == womanEnumId) item1.gr10 = item1.gr10 != 0 ? (1 + (int)item1.gr10) : 1;
                                    }
                                }
                                /***********************/
                                if (diagnos == strDiagId3)
                                {
                                    item2.gr1 = item2.gr1 != 0 ? (1 + (int)item2.gr1) : 1;

                                    if (gender == womanEnumId) item2.gr2 = item2.gr2 != 0 ? (1 + (int)item2.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item2.gr3 = item2.gr3 != 0 ? (1 + (int)item2.gr3) : 1;
                                        if (gender == womanEnumId) item2.gr4 = item2.gr4 != 0 ? (1 + (int)item2.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item2.gr5 = item2.gr5 != 0 ? (1 + (int)item2.gr5) : 1;
                                        if (gender == womanEnumId) item2.gr6 = item2.gr6 != 0 ? (1 + (int)item2.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item2.gr7 = item2.gr7 != 0 ? (1 + (int)item2.gr7) : 1;
                                        if (gender == womanEnumId) item2.gr8 = item2.gr8 != 0 ? (1 + (int)item2.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item2.gr9 = item2.gr9 != 0 ? (1 + (int)item2.gr9) : 1;
                                        if (gender == womanEnumId) item2.gr10 = item2.gr10 != 0 ? (1 + (int)item2.gr10) : 1;
                                    }
                                }
                                /************************************************/
                                if (diagnos == strDiagId4)
                                {
                                    item3.gr1 = item3.gr1 != 0 ? (1 + (int)item3.gr1) : 1;

                                    if (gender == womanEnumId) item3.gr2 = item3.gr2 != 0 ? (1 + (int)item3.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item3.gr3 = item3.gr3 != 0 ? (1 + (int)item3.gr3) : 1;
                                        if (gender == womanEnumId) item3.gr4 = item3.gr4 != 0 ? (1 + (int)item3.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item3.gr5 = item3.gr5 != 0 ? (1 + (int)item3.gr5) : 1;
                                        if (gender == womanEnumId) item3.gr6 = item3.gr6 != 0 ? (1 + (int)item3.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item3.gr7 = item3.gr7 != 0 ? (1 + (int)item3.gr7) : 1;
                                        if (gender == womanEnumId) item3.gr8 = item3.gr8 != 0 ? (1 + (int)item3.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item3.gr9 = item3.gr9 != 0 ? (1 + (int)item3.gr9) : 1;
                                        if (gender == womanEnumId) item3.gr10 = item3.gr10 != 0 ? (1 + (int)item3.gr10) : 1;
                                    }
                                }
                                /***********************************************/
                                if (diagnos == strDiagId6)
                                {
                                    item4.gr1 = item4.gr1 != 0 ? (1 + (int)item4.gr1) : 1;

                                    if (gender == womanEnumId) item4.gr2 = item4.gr2 != 0 ? (1 + (int)item4.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item4.gr3 = item4.gr3 != 0 ? (1 + (int)item4.gr3) : 1;
                                        if (gender == womanEnumId) item4.gr4 = item4.gr4 != 0 ? (1 + (int)item4.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item4.gr5 = item4.gr5 != 0 ? (1 + (int)item4.gr5) : 1;
                                        if (gender == womanEnumId) item4.gr6 = item4.gr6 != 0 ? (1 + (int)item4.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item4.gr7 = item4.gr7 != 0 ? (1 + (int)item4.gr7) : 1;
                                        if (gender == womanEnumId) item4.gr8 = item4.gr8 != 0 ? (1 + (int)item4.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item4.gr9 = item4.gr9 != 0 ? (1 + (int)item4.gr9) : 1;
                                        if (gender == womanEnumId) item4.gr10 = item4.gr10 != 0 ? (1 + (int)item4.gr10) : 1;
                                    }
                                }
                                /*********************************************/
                                if (diagnos == strDiagId5)
                                {
                                    item5.gr1 = item5.gr1 != 0 ? (1 + (int)item5.gr1) : 1;

                                    if (gender == womanEnumId) item5.gr2 = item5.gr2 != 0 ? (1 + (int)item5.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item5.gr3 = item5.gr3 != 0 ? (1 + (int)item5.gr3) : 1;
                                        if (gender == womanEnumId) item5.gr4 = item5.gr4 != 0 ? (1 + (int)item5.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item5.gr5 = item5.gr5 != 0 ? (1 + (int)item5.gr5) : 1;
                                        if (gender == womanEnumId) item5.gr6 = item5.gr6 != 0 ? (1 + (int)item5.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item5.gr7 = item5.gr7 != 0 ? (1 + (int)item5.gr7) : 1;
                                        if (gender == womanEnumId) item5.gr8 = item5.gr8 != 0 ? (1 + (int)item5.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item5.gr9 = item5.gr9 != 0 ? (1 + (int)item5.gr9) : 1;
                                        if (gender == womanEnumId) item5.gr10 = item5.gr10 != 0 ? (1 + (int)item5.gr10) : 1;
                                    }
                                }
                                /*************************************/
                                if (diagnos == strDiagId7)
                                {
                                    item6.gr1 = item6.gr1 != 0 ? (1 + (int)item6.gr1) : 1;

                                    if (gender == womanEnumId) item6.gr2 = item6.gr2 != 0 ? (1 + (int)item6.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item6.gr3 = item6.gr3 != 0 ? (1 + (int)item6.gr3) : 1;
                                        if (gender == womanEnumId) item6.gr4 = item6.gr4 != 0 ? (1 + (int)item6.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item6.gr5 = item6.gr5 != 0 ? (1 + (int)item6.gr5) : 1;
                                        if (gender == womanEnumId) item6.gr6 = item6.gr6 != 0 ? (1 + (int)item6.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item6.gr7 = item6.gr7 != 0 ? (1 + (int)item6.gr7) : 1;
                                        if (gender == womanEnumId) item6.gr8 = item6.gr8 != 0 ? (1 + (int)item6.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item6.gr9 = item6.gr9 != 0 ? (1 + (int)item6.gr9) : 1;
                                        if (gender == womanEnumId) item6.gr10 = item6.gr10 != 0 ? (1 + (int)item6.gr10) : 1;
                                    }
                                }
                                /********************************************************/
                                if (diagnos == strDiagId9)
                                {
                                    item7.gr1 = item7.gr1 != 0 ? (1 + (int)item7.gr1) : 1;

                                    if (gender == womanEnumId) item7.gr2 = item7.gr2 != 0 ? (1 + (int)item7.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item7.gr3 = item7.gr3 != 0 ? (1 + (int)item7.gr3) : 1;
                                        if (gender == womanEnumId) item7.gr4 = item7.gr4 != 0 ? (1 + (int)item7.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item7.gr5 = item7.gr5 != 0 ? (1 + (int)item7.gr5) : 1;
                                        if (gender == womanEnumId) item7.gr6 = item7.gr6 != 0 ? (1 + (int)item7.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item7.gr7 = item7.gr7 != 0 ? (1 + (int)item7.gr7) : 1;
                                        if (gender == womanEnumId) item7.gr8 = item7.gr8 != 0 ? (1 + (int)item7.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item7.gr9 = item7.gr9 != 0 ? (1 + (int)item7.gr9) : 1;
                                        if (gender == womanEnumId) item7.gr10 = item7.gr10 != 0 ? (1 + (int)item7.gr10) : 1;
                                    }
                                }
                                /****************************************/
                                if (diagnos == strDiagId10)
                                {
                                    item8.gr1 = item8.gr1 != 0 ? (1 + (int)item8.gr1) : 1;

                                    if (gender == womanEnumId) item8.gr2 = item8.gr2 != 0 ? (1 + (int)item8.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item8.gr3 = item8.gr3 != 0 ? (1 + (int)item8.gr3) : 1;
                                        if (gender == womanEnumId) item8.gr4 = item8.gr4 != 0 ? (1 + (int)item8.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item8.gr5 = item8.gr5 != 0 ? (1 + (int)item8.gr5) : 1;
                                        if (gender == womanEnumId) item8.gr6 = item8.gr6 != 0 ? (1 + (int)item8.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item8.gr7 = item8.gr7 != 0 ? (1 + (int)item8.gr7) : 1;
                                        if (gender == womanEnumId) item8.gr8 = item8.gr8 != 0 ? (1 + (int)item8.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item8.gr9 = item8.gr9 != 0 ? (1 + (int)item8.gr9) : 1;
                                        if (gender == womanEnumId) item8.gr10 = item8.gr10 != 0 ? (1 + (int)item8.gr10) : 1;
                                    }
                                }
                                /*******************************************/
                                if (diagnos == strDiagId13)
                                {
                                    item9.gr1 = item9.gr1 != 0 ? (1 + (int)item9.gr1) : 1;

                                    if (gender == womanEnumId) item9.gr2 = item9.gr2 != 0 ? (1 + (int)item9.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item9.gr3 = item9.gr3 != 0 ? (1 + (int)item9.gr3) : 1;
                                        if (gender == womanEnumId) item9.gr4 = item9.gr4 != 0 ? (1 + (int)item9.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item9.gr5 = item9.gr5 != 0 ? (1 + (int)item9.gr5) : 1;
                                        if (gender == womanEnumId) item9.gr6 = item9.gr6 != 0 ? (1 + (int)item9.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item9.gr7 = item9.gr7 != 0 ? (1 + (int)item9.gr7) : 1;
                                        if (gender == womanEnumId) item9.gr8 = item9.gr8 != 0 ? (1 + (int)item9.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item9.gr9 = item9.gr9 != 0 ? (1 + (int)item9.gr9) : 1;
                                        if (gender == womanEnumId) item9.gr10 = item9.gr10 != 0 ? (1 + (int)item9.gr10) : 1;
                                    }
                                }
                                /***************************************/
                                if (diagnos == strDiagId16)
                                {
                                    item10.gr1 = item10.gr1 != 0 ? (1 + (int)item10.gr1) : 1;

                                    if (gender == womanEnumId) item10.gr2 = item10.gr2 != 0 ? (1 + (int)item10.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item10.gr3 = item10.gr3 != 0 ? (1 + (int)item10.gr3) : 1;
                                        if (gender == womanEnumId) item10.gr4 = item10.gr4 != 0 ? (1 + (int)item10.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item10.gr5 = item10.gr5 != 0 ? (1 + (int)item10.gr5) : 1;
                                        if (gender == womanEnumId) item10.gr6 = item10.gr6 != 0 ? (1 + (int)item10.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item10.gr7 = item10.gr7 != 0 ? (1 + (int)item10.gr7) : 1;
                                        if (gender == womanEnumId) item10.gr8 = item10.gr8 != 0 ? (1 + (int)item10.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item10.gr9 = item10.gr9 != 0 ? (1 + (int)item10.gr9) : 1;
                                        if (gender == womanEnumId) item10.gr10 = item10.gr10 != 0 ? (1 + (int)item10.gr10) : 1;
                                    }
                                }
                                /*********************************************/
                                if (diagnos == strDiagId17)
                                {
                                    item11.gr1 = item11.gr1 != 0 ? (1 + (int)item11.gr1) : 1;

                                    if (gender == womanEnumId) item11.gr2 = item11.gr2 != 0 ? (1 + (int)item11.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item11.gr3 = item11.gr3 != 0 ? (1 + (int)item11.gr3) : 1;
                                        if (gender == womanEnumId) item11.gr4 = item11.gr4 != 0 ? (1 + (int)item11.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item11.gr5 = item11.gr5 != 0 ? (1 + (int)item11.gr5) : 1;
                                        if (gender == womanEnumId) item11.gr6 = item11.gr6 != 0 ? (1 + (int)item11.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item11.gr7 = item11.gr7 != 0 ? (1 + (int)item11.gr7) : 1;
                                        if (gender == womanEnumId) item11.gr8 = item11.gr8 != 0 ? (1 + (int)item11.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item11.gr9 = item11.gr9 != 0 ? (1 + (int)item11.gr9) : 1;
                                        if (gender == womanEnumId) item11.gr10 = item11.gr10 != 0 ? (1 + (int)item11.gr10) : 1;
                                    }
                                }
                                //if (diagnos == strDiagId)
                                /************************************************/
                                if (diagnos == strDiagId20)
                                {
                                    item13.gr1 = item13.gr1 != 0 ? (1 + (int)item13.gr1) : 1;

                                    if (gender == womanEnumId) item13.gr2 = item13.gr2 != 0 ? (1 + (int)item13.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item13.gr3 = item13.gr3 != 0 ? (1 + (int)item13.gr3) : 1;
                                        if (gender == womanEnumId) item13.gr4 = item13.gr4 != 0 ? (1 + (int)item13.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item13.gr5 = item13.gr5 != 0 ? (1 + (int)item13.gr5) : 1;
                                        if (gender == womanEnumId) item13.gr6 = item13.gr6 != 0 ? (1 + (int)item13.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item13.gr7 = item13.gr7 != 0 ? (1 + (int)item13.gr7) : 1;
                                        if (gender == womanEnumId) item13.gr8 = item13.gr8 != 0 ? (1 + (int)item13.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item13.gr9 = item13.gr9 != 0 ? (1 + (int)item13.gr9) : 1;
                                        if (gender == womanEnumId) item13.gr10 = item13.gr10 != 0 ? (1 + (int)item13.gr10) : 1;
                                    }
                                }
                                //if (diagnos == strDiagId)
                                //if (diagnos == strDiagId)
                                /***********************************************/
                                if (diagnos == strDiagId23)
                                {
                                    item16.gr1 = item16.gr1 != 0 ? (1 + (int)item16.gr1) : 1;

                                    if (gender == womanEnumId) item16.gr2 = item16.gr2 != 0 ? (1 + (int)item16.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item16.gr3 = item16.gr3 != 0 ? (1 + (int)item16.gr3) : 1;
                                        if (gender == womanEnumId) item16.gr4 = item16.gr4 != 0 ? (1 + (int)item16.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item16.gr5 = item16.gr5 != 0 ? (1 + (int)item16.gr5) : 1;
                                        if (gender == womanEnumId) item16.gr6 = item16.gr6 != 0 ? (1 + (int)item16.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item16.gr7 = item16.gr7 != 0 ? (1 + (int)item16.gr7) : 1;
                                        if (gender == womanEnumId) item16.gr8 = item16.gr8 != 0 ? (1 + (int)item16.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item16.gr9 = item16.gr9 != 0 ? (1 + (int)item16.gr9) : 1;
                                        if (gender == womanEnumId) item16.gr10 = item16.gr10 != 0 ? (1 + (int)item16.gr10) : 1;
                                    }
                                }
                                /********************************************/
                                if (diagnos == strDiagId24)
                                {
                                    item17.gr1 = item17.gr1 != 0 ? (1 + (int)item17.gr1) : 1;

                                    if (gender == womanEnumId) item17.gr2 = item17.gr2 != 0 ? (1 + (int)item17.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item17.gr3 = item17.gr3 != 0 ? (1 + (int)item17.gr3) : 1;
                                        if (gender == womanEnumId) item17.gr4 = item17.gr4 != 0 ? (1 + (int)item17.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item17.gr5 = item17.gr5 != 0 ? (1 + (int)item17.gr5) : 1;
                                        if (gender == womanEnumId) item17.gr6 = item17.gr6 != 0 ? (1 + (int)item17.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item17.gr7 = item17.gr7 != 0 ? (1 + (int)item17.gr7) : 1;
                                        if (gender == womanEnumId) item17.gr8 = item17.gr8 != 0 ? (1 + (int)item17.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item17.gr9 = item17.gr9 != 0 ? (1 + (int)item17.gr9) : 1;
                                        if (gender == womanEnumId) item17.gr10 = item17.gr10 != 0 ? (1 + (int)item17.gr10) : 1;
                                    }
                                }
                                /***************************************************/
                                if (diagnos == strDiagId25)
                                {
                                    item18.gr1 = item18.gr1 != 0 ? (1 + (int)item18.gr1) : 1;

                                    if (gender == womanEnumId) item18.gr2 = item18.gr2 != 0 ? (1 + (int)item18.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item18.gr3 = item18.gr3 != 0 ? (1 + (int)item18.gr3) : 1;
                                        if (gender == womanEnumId) item18.gr4 = item18.gr4 != 0 ? (1 + (int)item18.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item18.gr5 = item18.gr5 != 0 ? (1 + (int)item18.gr5) : 1;
                                        if (gender == womanEnumId) item18.gr6 = item18.gr6 != 0 ? (1 + (int)item18.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item18.gr7 = item18.gr7 != 0 ? (1 + (int)item18.gr7) : 1;
                                        if (gender == womanEnumId) item18.gr8 = item18.gr8 != 0 ? (1 + (int)item18.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item18.gr9 = item18.gr9 != 0 ? (1 + (int)item18.gr9) : 1;
                                        if (gender == womanEnumId) item18.gr10 = item18.gr10 != 0 ? (1 + (int)item18.gr10) : 1;
                                    }
                                }
                                /******************************************/
                                if (diagnos == strDiagId26)
                                {
                                    item19.gr1 = item19.gr1 != 0 ? (1 + (int)item19.gr1) : 1;

                                    if (gender == womanEnumId) item19.gr2 = item19.gr2 != 0 ? (1 + (int)item19.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item19.gr3 = item19.gr3 != 0 ? (1 + (int)item19.gr3) : 1;
                                        if (gender == womanEnumId) item19.gr4 = item19.gr4 != 0 ? (1 + (int)item19.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item19.gr5 = item19.gr5 != 0 ? (1 + (int)item19.gr5) : 1;
                                        if (gender == womanEnumId) item19.gr6 = item19.gr6 != 0 ? (1 + (int)item19.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item19.gr7 = item19.gr7 != 0 ? (1 + (int)item19.gr7) : 1;
                                        if (gender == womanEnumId) item19.gr8 = item19.gr8 != 0 ? (1 + (int)item19.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item19.gr9 = item19.gr9 != 0 ? (1 + (int)item19.gr9) : 1;
                                        if (gender == womanEnumId) item19.gr10 = item19.gr10 != 0 ? (1 + (int)item19.gr10) : 1;
                                    }
                                }
                                /**************************************/
                                if (diagnos == strDiagId27)
                                {
                                    item20.gr1 = item20.gr1 != 0 ? (1 + (int)item20.gr1) : 1;

                                    if (gender == womanEnumId) item20.gr2 = item20.gr2 != 0 ? (1 + (int)item20.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item20.gr3 = item20.gr3 != 0 ? (1 + (int)item20.gr3) : 1;
                                        if (gender == womanEnumId) item20.gr4 = item20.gr4 != 0 ? (1 + (int)item20.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item20.gr5 = item20.gr5 != 0 ? (1 + (int)item20.gr5) : 1;
                                        if (gender == womanEnumId) item20.gr6 = item20.gr6 != 0 ? (1 + (int)item20.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item20.gr7 = item20.gr7 != 0 ? (1 + (int)item20.gr7) : 1;
                                        if (gender == womanEnumId) item20.gr8 = item20.gr8 != 0 ? (1 + (int)item20.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item20.gr9 = item20.gr9 != 0 ? (1 + (int)item20.gr9) : 1;
                                        if (gender == womanEnumId) item20.gr10 = item20.gr10 != 0 ? (1 + (int)item20.gr10) : 1;
                                    }
                                }
                                /****************************************/
                                if (diagnos == strDiagId31)
                                {
                                    item21.gr1 = item21.gr1 != 0 ? (1 + (int)item21.gr1) : 1;

                                    if (gender == womanEnumId) item21.gr2 = item21.gr2 != 0 ? (1 + (int)item21.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item21.gr3 = item21.gr3 != 0 ? (1 + (int)item21.gr3) : 1;
                                        if (gender == womanEnumId) item21.gr4 = item21.gr4 != 0 ? (1 + (int)item21.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item21.gr5 = item21.gr5 != 0 ? (1 + (int)item21.gr5) : 1;
                                        if (gender == womanEnumId) item21.gr6 = item21.gr6 != 0 ? (1 + (int)item21.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item21.gr7 = item21.gr7 != 0 ? (1 + (int)item21.gr7) : 1;
                                        if (gender == womanEnumId) item21.gr8 = item21.gr8 != 0 ? (1 + (int)item21.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item21.gr9 = item21.gr9 != 0 ? (1 + (int)item21.gr9) : 1;
                                        if (gender == womanEnumId) item21.gr10 = item21.gr10 != 0 ? (1 + (int)item21.gr10) : 1;
                                    }
                                }
                                /********************************************/
                                if (diagnos == strDiagId32)
                                {
                                    item22.gr1 = item22.gr1 != 0 ? (1 + (int)item22.gr1) : 1;

                                    if (gender == womanEnumId) item22.gr2 = item22.gr2 != 0 ? (1 + (int)item22.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item22.gr3 = item22.gr3 != 0 ? (1 + (int)item22.gr3) : 1;
                                        if (gender == womanEnumId) item22.gr4 = item22.gr4 != 0 ? (1 + (int)item22.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item22.gr5 = item22.gr5 != 0 ? (1 + (int)item22.gr5) : 1;
                                        if (gender == womanEnumId) item22.gr6 = item22.gr6 != 0 ? (1 + (int)item22.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item22.gr7 = item22.gr7 != 0 ? (1 + (int)item22.gr7) : 1;
                                        if (gender == womanEnumId) item22.gr8 = item22.gr8 != 0 ? (1 + (int)item22.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item22.gr9 = item22.gr9 != 0 ? (1 + (int)item22.gr9) : 1;
                                        if (gender == womanEnumId) item22.gr10 = item22.gr10 != 0 ? (1 + (int)item22.gr10) : 1;
                                    }
                                }
                                /*****************************************/
                                if (diagnos == strDiagId33)
                                {
                                    item23.gr1 = item23.gr1 != 0 ? (1 + (int)item23.gr1) : 1;

                                    if (gender == womanEnumId) item23.gr2 = item23.gr2 != 0 ? (1 + (int)item23.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item23.gr3 = item23.gr3 != 0 ? (1 + (int)item23.gr3) : 1;
                                        if (gender == womanEnumId) item23.gr4 = item23.gr4 != 0 ? (1 + (int)item23.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item23.gr5 = item23.gr5 != 0 ? (1 + (int)item23.gr5) : 1;
                                        if (gender == womanEnumId) item23.gr6 = item23.gr6 != 0 ? (1 + (int)item23.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item23.gr7 = item23.gr7 != 0 ? (1 + (int)item23.gr7) : 1;
                                        if (gender == womanEnumId) item23.gr8 = item23.gr8 != 0 ? (1 + (int)item23.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item23.gr9 = item23.gr9 != 0 ? (1 + (int)item23.gr9) : 1;
                                        if (gender == womanEnumId) item23.gr10 = item23.gr10 != 0 ? (1 + (int)item23.gr10) : 1;
                                    }
                                }
                                /********************************************/
                                if (diagnos == strDiagId36)
                                {
                                    item24.gr1 = item24.gr1 != 0 ? (1 + (int)item24.gr1) : 1;

                                    if (gender == womanEnumId) item24.gr2 = item24.gr2 != 0 ? (1 + (int)item24.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item24.gr3 = item24.gr3 != 0 ? (1 + (int)item24.gr3) : 1;
                                        if (gender == womanEnumId) item24.gr4 = item24.gr4 != 0 ? (1 + (int)item24.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item24.gr5 = item24.gr5 != 0 ? (1 + (int)item24.gr5) : 1;
                                        if (gender == womanEnumId) item24.gr6 = item24.gr6 != 0 ? (1 + (int)item24.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item24.gr7 = item24.gr7 != 0 ? (1 + (int)item24.gr7) : 1;
                                        if (gender == womanEnumId) item24.gr8 = item24.gr8 != 0 ? (1 + (int)item24.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item24.gr9 = item24.gr9 != 0 ? (1 + (int)item24.gr9) : 1;
                                        if (gender == womanEnumId) item24.gr10 = item24.gr10 != 0 ? (1 + (int)item24.gr10) : 1;
                                    }
                                }
                                /**************************************************/
                                if (diagnos == strDiagId38)
                                {
                                    item25.gr1 = item25.gr1 != 0 ? (1 + (int)item25.gr1) : 1;

                                    if (gender == womanEnumId) item25.gr2 = item25.gr2 != 0 ? (1 + (int)item25.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item25.gr3 = item25.gr3 != 0 ? (1 + (int)item25.gr3) : 1;
                                        if (gender == womanEnumId) item25.gr4 = item25.gr4 != 0 ? (1 + (int)item25.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item25.gr5 = item25.gr5 != 0 ? (1 + (int)item25.gr5) : 1;
                                        if (gender == womanEnumId) item25.gr6 = item25.gr6 != 0 ? (1 + (int)item25.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item25.gr7 = item25.gr7 != 0 ? (1 + (int)item25.gr7) : 1;
                                        if (gender == womanEnumId) item25.gr8 = item25.gr8 != 0 ? (1 + (int)item25.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item25.gr9 = item25.gr9 != 0 ? (1 + (int)item25.gr9) : 1;
                                        if (gender == womanEnumId) item25.gr10 = item25.gr10 != 0 ? (1 + (int)item25.gr10) : 1;
                                    }
                                }
                                //if (diagnos == strDiagId)
                                /*************************************/
                                if (diagnos == strDiagId41)
                                {
                                    item27.gr1 = item27.gr1 != 0 ? (1 + (int)item27.gr1) : 1;

                                    if (gender == womanEnumId) item27.gr2 = item27.gr2 != 0 ? (1 + (int)item27.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item27.gr3 = item27.gr3 != 0 ? (1 + (int)item27.gr3) : 1;
                                        if (gender == womanEnumId) item27.gr4 = item27.gr4 != 0 ? (1 + (int)item27.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item27.gr5 = item27.gr5 != 0 ? (1 + (int)item27.gr5) : 1;
                                        if (gender == womanEnumId) item27.gr6 = item27.gr6 != 0 ? (1 + (int)item27.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item27.gr7 = item27.gr7 != 0 ? (1 + (int)item27.gr7) : 1;
                                        if (gender == womanEnumId) item27.gr8 = item27.gr8 != 0 ? (1 + (int)item27.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item27.gr9 = item27.gr9 != 0 ? (1 + (int)item27.gr9) : 1;
                                        if (gender == womanEnumId) item27.gr10 = item27.gr10 != 0 ? (1 + (int)item27.gr10) : 1;
                                    }
                                }
                                if (diagnos == strDiagId57)
                                {
                                    item28.gr1 = item28.gr1 != 0 ? (1 + (int)item28.gr1) : 1;

                                    if (gender == womanEnumId) item28.gr2 = item28.gr2 != 0 ? (1 + (int)item28.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item28.gr3 = item28.gr3 != 0 ? (1 + (int)item28.gr3) : 1;
                                        if (gender == womanEnumId) item28.gr4 = item28.gr4 != 0 ? (1 + (int)item28.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item28.gr5 = item28.gr5 != 0 ? (1 + (int)item28.gr5) : 1;
                                        if (gender == womanEnumId) item28.gr6 = item28.gr6 != 0 ? (1 + (int)item28.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item28.gr7 = item28.gr7 != 0 ? (1 + (int)item28.gr7) : 1;
                                        if (gender == womanEnumId) item28.gr8 = item28.gr8 != 0 ? (1 + (int)item28.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item28.gr9 = item28.gr9 != 0 ? (1 + (int)item28.gr9) : 1;
                                        if (gender == womanEnumId) item28.gr10 = item28.gr10 != 0 ? (1 + (int)item28.gr10) : 1;
                                    }
                                }
                                /***************************************/
                                if (diagnos == strDiagId58)
                                {
                                    item29.gr1 = item29.gr1 != 0 ? (1 + (int)item29.gr1) : 1;

                                    if (gender == womanEnumId) item29.gr2 = item29.gr2 != 0 ? (1 + (int)item29.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item29.gr3 = item29.gr3 != 0 ? (1 + (int)item29.gr3) : 1;
                                        if (gender == womanEnumId) item29.gr4 = item29.gr4 != 0 ? (1 + (int)item29.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item29.gr5 = item29.gr5 != 0 ? (1 + (int)item29.gr5) : 1;
                                        if (gender == womanEnumId) item29.gr6 = item29.gr6 != 0 ? (1 + (int)item29.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item29.gr7 = item29.gr7 != 0 ? (1 + (int)item29.gr7) : 1;
                                        if (gender == womanEnumId) item29.gr8 = item29.gr8 != 0 ? (1 + (int)item29.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item29.gr9 = item29.gr9 != 0 ? (1 + (int)item29.gr9) : 1;
                                        if (gender == womanEnumId) item29.gr10 = item29.gr10 != 0 ? (1 + (int)item29.gr10) : 1;
                                    }
                                }
                                /*************************************************/
                                if (diagnos == strDiagId59)
                                {
                                    item30.gr1 = item30.gr1 != 0 ? (1 + (int)item30.gr1) : 1;

                                    if (gender == womanEnumId) item30.gr2 = item30.gr2 != 0 ? (1 + (int)item30.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item30.gr3 = item30.gr3 != 0 ? (1 + (int)item30.gr3) : 1;
                                        if (gender == womanEnumId) item30.gr4 = item30.gr4 != 0 ? (1 + (int)item30.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item30.gr5 = item30.gr5 != 0 ? (1 + (int)item30.gr5) : 1;
                                        if (gender == womanEnumId) item30.gr6 = item30.gr6 != 0 ? (1 + (int)item30.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item30.gr7 = item30.gr7 != 0 ? (1 + (int)item30.gr7) : 1;
                                        if (gender == womanEnumId) item30.gr8 = item30.gr8 != 0 ? (1 + (int)item30.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item30.gr9 = item30.gr9 != 0 ? (1 + (int)item30.gr9) : 1;
                                        if (gender == womanEnumId) item30.gr10 = item30.gr10 != 0 ? (1 + (int)item30.gr10) : 1;
                                    }
                                }
                                /**************************************/
                                if (diagnos == strDiagId60)
                                {
                                    item31.gr1 = item31.gr1 != 0 ? (1 + (int)item31.gr1) : 1;

                                    if (gender == womanEnumId) item31.gr2 = item31.gr2 != 0 ? (1 + (int)item31.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item31.gr3 = item31.gr3 != 0 ? (1 + (int)item31.gr3) : 1;
                                        if (gender == womanEnumId) item31.gr4 = item31.gr4 != 0 ? (1 + (int)item31.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item31.gr5 = item31.gr5 != 0 ? (1 + (int)item31.gr5) : 1;
                                        if (gender == womanEnumId) item31.gr6 = item31.gr6 != 0 ? (1 + (int)item31.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item31.gr7 = item31.gr7 != 0 ? (1 + (int)item31.gr7) : 1;
                                        if (gender == womanEnumId) item31.gr8 = item31.gr8 != 0 ? (1 + (int)item31.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item31.gr9 = item31.gr9 != 0 ? (1 + (int)item31.gr9) : 1;
                                        if (gender == womanEnumId) item31.gr10 = item31.gr10 != 0 ? (1 + (int)item31.gr10) : 1;
                                    }
                                }
                                /****************************************/
                                if (diagnos == strDiagId61)
                                {
                                    item32.gr1 = item32.gr1 != 0 ? (1 + (int)item32.gr1) : 1;

                                    if (gender == womanEnumId) item32.gr2 = item32.gr2 != 0 ? (1 + (int)item32.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item32.gr3 = item32.gr3 != 0 ? (1 + (int)item32.gr3) : 1;
                                        if (gender == womanEnumId) item32.gr4 = item32.gr4 != 0 ? (1 + (int)item32.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item32.gr5 = item32.gr5 != 0 ? (1 + (int)item32.gr5) : 1;
                                        if (gender == womanEnumId) item32.gr6 = item32.gr6 != 0 ? (1 + (int)item32.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item32.gr7 = item32.gr7 != 0 ? (1 + (int)item32.gr7) : 1;
                                        if (gender == womanEnumId) item32.gr8 = item32.gr8 != 0 ? (1 + (int)item32.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item32.gr9 = item32.gr9 != 0 ? (1 + (int)item32.gr9) : 1;
                                        if (gender == womanEnumId) item32.gr10 = item32.gr10 != 0 ? (1 + (int)item32.gr10) : 1;
                                    }
                                }
                                /***************************************/
                                if (diagnos == strDiagId62)
                                {
                                    item33.gr1 = item33.gr1 != 0 ? (1 + (int)item33.gr1) : 1;

                                    if (gender == womanEnumId) item33.gr2 = item33.gr2 != 0 ? (1 + (int)item33.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item33.gr3 = item33.gr3 != 0 ? (1 + (int)item33.gr3) : 1;
                                        if (gender == womanEnumId) item33.gr4 = item33.gr4 != 0 ? (1 + (int)item33.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item33.gr5 = item33.gr5 != 0 ? (1 + (int)item33.gr5) : 1;
                                        if (gender == womanEnumId) item33.gr6 = item33.gr6 != 0 ? (1 + (int)item33.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item33.gr7 = item33.gr7 != 0 ? (1 + (int)item33.gr7) : 1;
                                        if (gender == womanEnumId) item33.gr8 = item33.gr8 != 0 ? (1 + (int)item33.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item33.gr9 = item33.gr9 != 0 ? (1 + (int)item33.gr9) : 1;
                                        if (gender == womanEnumId) item33.gr10 = item33.gr10 != 0 ? (1 + (int)item33.gr10) : 1;
                                    }
                                }
                                /**************************************/
                                if (diagnos == strDiagId65)
                                {
                                    item34.gr1 = item34.gr1 != 0 ? (1 + (int)item34.gr1) : 1;

                                    if (gender == womanEnumId) item34.gr2 = item34.gr2 != 0 ? (1 + (int)item34.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item34.gr3 = item34.gr3 != 0 ? (1 + (int)item34.gr3) : 1;
                                        if (gender == womanEnumId) item34.gr4 = item34.gr4 != 0 ? (1 + (int)item34.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item34.gr5 = item34.gr5 != 0 ? (1 + (int)item34.gr5) : 1;
                                        if (gender == womanEnumId) item34.gr6 = item34.gr6 != 0 ? (1 + (int)item34.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item34.gr7 = item34.gr7 != 0 ? (1 + (int)item34.gr7) : 1;
                                        if (gender == womanEnumId) item34.gr8 = item34.gr8 != 0 ? (1 + (int)item34.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item34.gr9 = item34.gr9 != 0 ? (1 + (int)item34.gr9) : 1;
                                        if (gender == womanEnumId) item34.gr10 = item34.gr10 != 0 ? (1 + (int)item34.gr10) : 1;
                                    }
                                }
                                /*************************************/
                                if (diagnos == strDiagId66)
                                {
                                    item35.gr1 = item35.gr1 != 0 ? (1 + (int)item35.gr1) : 1;

                                    if (gender == womanEnumId) item35.gr2 = item35.gr2 != 0 ? (1 + (int)item35.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item35.gr3 = item35.gr3 != 0 ? (1 + (int)item35.gr3) : 1;
                                        if (gender == womanEnumId) item35.gr4 = item35.gr4 != 0 ? (1 + (int)item35.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item35.gr5 = item35.gr5 != 0 ? (1 + (int)item35.gr5) : 1;
                                        if (gender == womanEnumId) item35.gr6 = item35.gr6 != 0 ? (1 + (int)item35.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item35.gr7 = item35.gr7 != 0 ? (1 + (int)item35.gr7) : 1;
                                        if (gender == womanEnumId) item35.gr8 = item35.gr8 != 0 ? (1 + (int)item35.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item35.gr9 = item35.gr9 != 0 ? (1 + (int)item35.gr9) : 1;
                                        if (gender == womanEnumId) item35.gr10 = item35.gr10 != 0 ? (1 + (int)item35.gr10) : 1;
                                    }
                                }
                                /************************************/
                                if (diagnos == strDiagId68)
                                {
                                    item36.gr1 = item36.gr1 != 0 ? (1 + (int)item36.gr1) : 1;

                                    if (gender == womanEnumId) item36.gr2 = item36.gr2 != 0 ? (1 + (int)item36.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item36.gr3 = item36.gr3 != 0 ? (1 + (int)item36.gr3) : 1;
                                        if (gender == womanEnumId) item36.gr4 = item36.gr4 != 0 ? (1 + (int)item36.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item36.gr5 = item36.gr5 != 0 ? (1 + (int)item36.gr5) : 1;
                                        if (gender == womanEnumId) item36.gr6 = item36.gr6 != 0 ? (1 + (int)item36.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item36.gr7 = item36.gr7 != 0 ? (1 + (int)item36.gr7) : 1;
                                        if (gender == womanEnumId) item36.gr8 = item36.gr8 != 0 ? (1 + (int)item36.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item36.gr9 = item36.gr9 != 0 ? (1 + (int)item36.gr9) : 1;
                                        if (gender == womanEnumId) item36.gr10 = item36.gr10 != 0 ? (1 + (int)item36.gr10) : 1;
                                    }
                                }
                                /**************************************/
                                if (diagnos == strDiagId49)
                                {
                                    item37.gr1 = item37.gr1 != 0 ? (1 + (int)item37.gr1) : 1;

                                    if (gender == womanEnumId) item37.gr2 = item37.gr2 != 0 ? (1 + (int)item37.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item37.gr3 = item37.gr3 != 0 ? (1 + (int)item37.gr3) : 1;
                                        if (gender == womanEnumId) item37.gr4 = item37.gr4 != 0 ? (1 + (int)item37.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item37.gr5 = item37.gr5 != 0 ? (1 + (int)item37.gr5) : 1;
                                        if (gender == womanEnumId) item37.gr6 = item37.gr6 != 0 ? (1 + (int)item37.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item37.gr7 = item37.gr7 != 0 ? (1 + (int)item37.gr7) : 1;
                                        if (gender == womanEnumId) item37.gr8 = item37.gr8 != 0 ? (1 + (int)item37.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item37.gr9 = item37.gr9 != 0 ? (1 + (int)item37.gr9) : 1;
                                        if (gender == womanEnumId) item37.gr10 = item37.gr10 != 0 ? (1 + (int)item37.gr10) : 1;
                                    }
                                }
                                /***********************************/
                                if (diagnos == strDiagId70)
                                {
                                    item38.gr1 = item38.gr1 != 0 ? (1 + (int)item38.gr1) : 1;

                                    if (gender == womanEnumId) item38.gr2 = item38.gr2 != 0 ? (1 + (int)item38.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item38.gr3 = item38.gr3 != 0 ? (1 + (int)item38.gr3) : 1;
                                        if (gender == womanEnumId) item38.gr4 = item38.gr4 != 0 ? (1 + (int)item38.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item38.gr5 = item38.gr5 != 0 ? (1 + (int)item38.gr5) : 1;
                                        if (gender == womanEnumId) item38.gr6 = item38.gr6 != 0 ? (1 + (int)item38.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item38.gr7 = item38.gr7 != 0 ? (1 + (int)item38.gr7) : 1;
                                        if (gender == womanEnumId) item38.gr8 = item38.gr8 != 0 ? (1 + (int)item38.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item38.gr9 = item38.gr9 != 0 ? (1 + (int)item38.gr9) : 1;
                                        if (gender == womanEnumId) item38.gr10 = item38.gr10 != 0 ? (1 + (int)item38.gr10) : 1;
                                    }
                                }
                                /*********************************/
                                if (diagnos == strDiagId74)
                                {
                                    item39.gr1 = item39.gr1 != 0 ? (1 + (int)item39.gr1) : 1;

                                    if (gender == womanEnumId) item39.gr2 = item39.gr2 != 0 ? (1 + (int)item39.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item39.gr3 = item39.gr3 != 0 ? (1 + (int)item39.gr3) : 1;
                                        if (gender == womanEnumId) item39.gr4 = item39.gr4 != 0 ? (1 + (int)item39.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item39.gr5 = item39.gr5 != 0 ? (1 + (int)item39.gr5) : 1;
                                        if (gender == womanEnumId) item39.gr6 = item39.gr6 != 0 ? (1 + (int)item39.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item39.gr7 = item39.gr7 != 0 ? (1 + (int)item39.gr7) : 1;
                                        if (gender == womanEnumId) item39.gr8 = item39.gr8 != 0 ? (1 + (int)item39.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item39.gr9 = item39.gr9 != 0 ? (1 + (int)item39.gr9) : 1;
                                        if (gender == womanEnumId) item39.gr10 = item39.gr10 != 0 ? (1 + (int)item39.gr10) : 1;
                                    }
                                }
                                /**********************************/
                                if (diagnos == strDiagId53)
                                {
                                    item40.gr1 = item40.gr1 != 0 ? (1 + (int)item40.gr1) : 1;

                                    if (gender == womanEnumId) item40.gr2 = item40.gr2 != 0 ? (1 + (int)item40.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item40.gr3 = item40.gr3 != 0 ? (1 + (int)item40.gr3) : 1;
                                        if (gender == womanEnumId) item40.gr4 = item40.gr4 != 0 ? (1 + (int)item40.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item40.gr5 = item40.gr5 != 0 ? (1 + (int)item40.gr5) : 1;
                                        if (gender == womanEnumId) item40.gr6 = item40.gr6 != 0 ? (1 + (int)item40.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item40.gr7 = item40.gr7 != 0 ? (1 + (int)item40.gr7) : 1;
                                        if (gender == womanEnumId) item40.gr8 = item40.gr8 != 0 ? (1 + (int)item40.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item40.gr9 = item40.gr9 != 0 ? (1 + (int)item40.gr9) : 1;
                                        if (gender == womanEnumId) item40.gr10 = item40.gr10 != 0 ? (1 + (int)item40.gr10) : 1;
                                    }
                                }
                                /*******************************************/
                                if (diagnos == strDiagId52)
                                {
                                    item41.gr1 = item41.gr1 != 0 ? (1 + (int)item41.gr1) : 1;

                                    if (gender == womanEnumId) item41.gr2 = item41.gr2 != 0 ? (1 + (int)item41.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item41.gr3 = item41.gr3 != 0 ? (1 + (int)item41.gr3) : 1;
                                        if (gender == womanEnumId) item41.gr4 = item41.gr4 != 0 ? (1 + (int)item41.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item41.gr5 = item41.gr5 != 0 ? (1 + (int)item41.gr5) : 1;
                                        if (gender == womanEnumId) item41.gr6 = item41.gr6 != 0 ? (1 + (int)item41.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item41.gr7 = item41.gr7 != 0 ? (1 + (int)item41.gr7) : 1;
                                        if (gender == womanEnumId) item41.gr8 = item41.gr8 != 0 ? (1 + (int)item41.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item41.gr9 = item41.gr9 != 0 ? (1 + (int)item41.gr9) : 1;
                                        if (gender == womanEnumId) item41.gr10 = item41.gr10 != 0 ? (1 + (int)item41.gr10) : 1;
                                    }
                                }
                                /***********************************/
                                if (diagnos == strDiagId56)
                                {
                                    item42.gr1 = item42.gr1 != 0 ? (1 + (int)item42.gr1) : 1;

                                    if (gender == womanEnumId) item42.gr2 = item42.gr2 != 0 ? (1 + (int)item42.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item42.gr3 = item42.gr3 != 0 ? (1 + (int)item42.gr3) : 1;
                                        if (gender == womanEnumId) item42.gr4 = item42.gr4 != 0 ? (1 + (int)item42.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item42.gr5 = item42.gr5 != 0 ? (1 + (int)item42.gr5) : 1;
                                        if (gender == womanEnumId) item42.gr6 = item42.gr6 != 0 ? (1 + (int)item42.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item42.gr7 = item42.gr7 != 0 ? (1 + (int)item42.gr7) : 1;
                                        if (gender == womanEnumId) item42.gr8 = item42.gr8 != 0 ? (1 + (int)item42.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item42.gr9 = item42.gr9 != 0 ? (1 + (int)item42.gr9) : 1;
                                        if (gender == womanEnumId) item42.gr10 = item42.gr10 != 0 ? (1 + (int)item42.gr10) : 1;
                                    }
                                }
                                /**********************************************/
                                if (diagnos == strDiagId54)
                                {
                                    item43.gr1 = item43.gr1 != 0 ? (1 + (int)item43.gr1) : 1;

                                    if (gender == womanEnumId) item43.gr2 = item43.gr2 != 0 ? (1 + (int)item43.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item43.gr3 = item43.gr3 != 0 ? (1 + (int)item43.gr3) : 1;
                                        if (gender == womanEnumId) item43.gr4 = item43.gr4 != 0 ? (1 + (int)item43.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item43.gr5 = item43.gr5 != 0 ? (1 + (int)item43.gr5) : 1;
                                        if (gender == womanEnumId) item43.gr6 = item43.gr6 != 0 ? (1 + (int)item43.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item43.gr7 = item43.gr7 != 0 ? (1 + (int)item43.gr7) : 1;
                                        if (gender == womanEnumId) item43.gr8 = item43.gr8 != 0 ? (1 + (int)item43.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item43.gr9 = item43.gr9 != 0 ? (1 + (int)item43.gr9) : 1;
                                        if (gender == womanEnumId) item43.gr10 = item43.gr10 != 0 ? (1 + (int)item43.gr10) : 1;
                                    }
                                }
                                /***********************************/
                                if (diagnos == strDiagId71)
                                {
                                    item44.gr1 = item44.gr1 != 0 ? (1 + (int)item44.gr1) : 1;

                                    if (gender == womanEnumId) item44.gr2 = item44.gr2 != 0 ? (1 + (int)item44.gr2) : 1;
                                    //в том числе в возрасте
                                    if (ageOf == ageOf1EnumId)
                                    {
                                        item44.gr3 = item44.gr3 != 0 ? (1 + (int)item44.gr3) : 1;
                                        if (gender == womanEnumId) item44.gr4 = item44.gr4 != 0 ? (1 + (int)item44.gr4) : 1;
                                    }
                                    if (ageOf == ageOf2EnumId)
                                    {
                                        item44.gr5 = item44.gr5 != 0 ? (1 + (int)item44.gr5) : 1;
                                        if (gender == womanEnumId) item44.gr6 = item44.gr6 != 0 ? (1 + (int)item44.gr6) : 1;
                                    }
                                    if (ageOf == ageOf3EnumId)
                                    {
                                        item44.gr7 = item44.gr7 != 0 ? (1 + (int)item44.gr7) : 1;
                                        if (gender == womanEnumId) item44.gr8 = item44.gr8 != 0 ? (1 + (int)item44.gr8) : 1;
                                    }
                                    if (ageOf == ageOf4EnumId)
                                    {
                                        item44.gr9 = item44.gr9 != 0 ? (1 + (int)item44.gr9) : 1;
                                        if (gender == womanEnumId) item44.gr10 = item44.gr10 != 0 ? (1 + (int)item44.gr10) : 1;
                                    }
                                }
                            }
                        }
                    }
                }
            }
            static void RemoveRows(WorkflowContext context, Guid reportId)
            {
                var docRepo = context.Documents;
                var rows = new List<Guid>();
                var qb = new QueryBuilder(reportItemDefId, context.UserId);
                qb.Where("Report").Eq(reportId).Or("Report").IsNull();
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read()) rows.Add(reader.GetGuid(0));
                }
                foreach (var rowId in rows)
                {
                    docRepo.DeleteById(rowId);
                }
            }
            private static readonly Guid reportDefId = new Guid("{17789FEE-2908-4E01-8E16-2ECAF4A75C7A}"); //Отчет о распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности
            private static readonly Guid reportItemDefId = new Guid("{10AB1374-EA9C-493B-B5F6-CD6A40273B9B}"); //Распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности

            private static readonly Guid childStatCardDefId = new Guid("{363E89D0-5E31-45B5-82B7-42E83DF96E1F}"); //Статистический талон ребенка с ОВЗ
            private static readonly Guid childActDefId = new Guid("{0ECF44B6-2B2D-4687-B7B0-07BA5F942AC6}"); //Медицинский акт ребенка с ОВЗ
            private static readonly Guid personDefId = new Guid("{D71CE61A-9B59-4B5E-8713-8131DBB5BA02}"); //Person 
            public static readonly Guid districtDefId = new Guid("{A3FCA356-82A9-4BBD-872A-8333BEC6E41A}"); //Район
            public static readonly Guid cityDefId = new Guid("{4BB6D32D-5181-4031-BA49-CF5910D6D883}"); //Города районного значения

            public static readonly Guid goalForGroup = new Guid("{8FD84B27-FF2A-40A4-A87A-BC254DC9D853}"); //Цель -> Для установления группы

            public static readonly Guid ageOf1EnumId = new Guid("{484C1AF3-3203-478D-97B4-B7977738A194}"); //От 0-3 лет
            public static readonly Guid ageOf2EnumId = new Guid("{124DA030-994C-4F2D-AD5F-750986CCDC96}"); //От 4-7 лет
            public static readonly Guid ageOf3EnumId = new Guid("{CFDA5599-9767-430E-AC90-632D3FBDBF1F}"); //От 8-14 лет
            public static readonly Guid ageOf4EnumId = new Guid("{30DA048C-85C4-4078-9A63-0CDB40A7747A}"); //От 15-17 лет

            //Инвалидность установлена на срок
            public static readonly Guid termEnumId1 = new Guid("{C0C639C1-4069-42BD-B9C5-0C4C0EAD41CE}"); //1 год
            public static readonly Guid termEnumId2 = new Guid("{CAB664A9-513D-4939-AB17-31ACF97C7592}"); //2 года
            public static readonly Guid termEnumId3 = new Guid("{4C270330-A4A0-40B7-9E2C-6726AE4BAD6C}"); //5 лет
            public static readonly Guid termEnumId4 = new Guid("{B1F91F0F-EA5C-4DA4-9DE6-C3FC0142E66F}"); //до 18 лет

            public static readonly Guid childGroupEnId = new Guid("{D145ABA1-EADA-442B-9D8D-AD10BCD126D2}"); //Ребенок с ОВЗ
            public static readonly Guid notInstalledEnId = new Guid("{BEB4542B-0C03-494A-BD60-AA6BA8E8BF4C}"); //Не установлена

            public static readonly Guid villageEnumId = new Guid("{65DF9C4D-A18B-4080-855F-4800E2A19C35}"); //Cельская местность//DistrictType
            public static readonly Guid cityEnumId = new Guid("{DE3D24A1-64D3-4647-B711-31F334D24416}"); //Городская местность//DistrictType
            public static readonly Guid womanEnumId = new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"); //Женский пол
            public static readonly Guid primaryEnumId = new Guid("{34129BC5-5B31-4189-87FA-799402F7E99F}"); //Первичное
            public static readonly Guid ApprovedStateId = new Guid("{32062CB7-C31C-4AFB-ADF3-F9F9AEEFCE59}");  //Подписанные

            //диагнозы
            private static readonly Guid strDiagId1 = new Guid("{9FF329FE-F547-42BE-817F-ED989FFB6573}"); //Туберкулез/ А 15-19
            private static readonly Guid strDiagId2 = new Guid("{99BC4A06-B78C-4A88-9F5C-AD4835563758}"); //Туберкулез  легких/ А 15-16
            private static readonly Guid strDiagId3 = new Guid("{2F9950BC-62B8-4B2B-865A-1C9C080CCC4E}"); //Злокачественные новообразования/ С 00-97
            private static readonly Guid strDiagId4 = new Guid("{C9CDD032-DC56-4027-A7D8-DBFE2F29BDE2}"); //Болезни эндокринной системы, нарушения обмена веществ/ Е 00-90
            private static readonly Guid strDiagId5 = new Guid("{C22D27F2-89F8-4355-A962-8EDE8294D052}"); //Заболeвания щитовидной железы/ E 00-07
            private static readonly Guid strDiagId6 = new Guid("{81E09427-D877-4C77-8609-E813D1BAF5FF}"); //Сахарный диабет/ E 10-14
            private static readonly Guid strDiagId7 = new Guid("{7ACAB39A-5CEE-4EF0-AAAB-10764F111DC0}"); //Психические расстройства/ F 00-99
            private static readonly Guid strDiagId8 = new Guid("{1F2922AB-423A-4997-BAB8-5D18538B5A15}"); //Шизофрения/ F 20
            private static readonly Guid strDiagId9 = new Guid("{22E82EC9-8BAA-48FD-AFD8-17619B0AD476}"); //Умственная отсталость/ F 70-79
            private static readonly Guid strDiagId10 = new Guid("{070AADAE-4453-4753-B939-44FD21544953}"); //Умственная отсталость, в сочетании ДЦП/ F 70-79
            private static readonly Guid strDiagId11 = new Guid("{BA1B55AC-F4C2-4112-BABD-7E986B3E2B07}"); //Органическое слабоумие/ F 00-03
            private static readonly Guid strDiagId12 = new Guid("{970AE4FA-9B31-447E-AF8B-9567A8F62F3F}"); //Органическое слабоумие в сочетании ДЦП/ F 00-03
            private static readonly Guid strDiagId13 = new Guid("{A9D88506-1CF4-437A-8B8C-40AB1AF88C12}"); //Расстройство психологического развития/ F 80-89
            private static readonly Guid strDiagId14 = new Guid("{B1E87505-BE6E-46AA-BDE7-FC556CD53D2B}"); //Огранические расстройство личности/ F 06-07
            private static readonly Guid strDiagId15 = new Guid("{1452F4DA-2382-4CAD-A621-3A758F4A430B}"); //Аутизм
            private static readonly Guid strDiagId16 = new Guid("{4BB66F12-B96C-4917-BFB3-0947D41AFA52}"); //Болезни нервной системы/ G 00-99
            private static readonly Guid strDiagId17 = new Guid("{9E0B999D-9AB4-4667-88F9-35DC37C1D743}"); //Воспалительные болезни нервной системы/ G 00-09
            private static readonly Guid strDiagId18 = new Guid("{471214D9-9EB8-4A00-B4ED-A05E77C5876A}"); //Дегенеративные, демилиенизирующие болезни/ G 10-37
            private static readonly Guid strDiagId19 = new Guid("{E2E0C9F8-F413-41F3-A8A6-8674EDEEAC64}"); //Эпилепсия/ G 40-41
            private static readonly Guid strDiagId20 = new Guid("{F6BAE9AD-DDBA-4C71-9A36-E1106E9BCBD9}"); //Детский церебральный паралич/ G 80-83
            private static readonly Guid strDiagId21 = new Guid("{B811E7CB-8ED9-4BFF-A1C7-BA1FE20C8C81}"); //Последствия воспалительных болезней ЦНС/ G 09
            private static readonly Guid strDiagId22 = new Guid("{DFE168E8-7E30-4D8A-9AEF-54382B0A3932}"); //Болезни периферической нервной системы/ G 50-64
            private static readonly Guid strDiagId23 = new Guid("{40012DC1-53A1-4EE7-8F93-85547C827DB5}"); //Болезни органов чувств/ H 00-95
            private static readonly Guid strDiagId24 = new Guid("{24483E18-28AC-4981-9C29-B94075BE9725}"); //Болезни глаз/ H 00-59
            private static readonly Guid strDiagId25 = new Guid("{558D6E2E-E1E0-4D37-B200-A94D9953099F}"); //Болезни уха и сосцевидного отростка/ H 60-95
            private static readonly Guid strDiagId26 = new Guid("{E3D6EF80-B5E4-4DAE-9832-19FAD50A80F3}"); //Болезни системы кровообращения/ I 00-99
            private static readonly Guid strDiagId27 = new Guid("{D71970B1-0562-4905-AC26-77DE739CAF5C}"); //Хронические ревматические болезни сердца/  I 05-09
            private static readonly Guid strDiagId28 = new Guid("{E6D6A67F-ED33-4879-B1C2-9BC173BB457B}"); //Повышенное кровеносное давление/ I 10-15
            private static readonly Guid strDiagId29 = new Guid("{10712C7B-4FDC-4B6F-A50B-B7858FDD1211}"); //Ишемическая болезнь сердца/ I 20-25
            private static readonly Guid strDiagId30 = new Guid("{9549B0FD-2F0D-488A-8228-E990B01288D8}"); //Цереброваскулярные болезни/ I 60-69
            private static readonly Guid strDiagId31 = new Guid("{3363DE1E-864C-4063-BED7-4526F673AFF6}"); //Болезни органов дыхания / J 00-99
            private static readonly Guid strDiagId32 = new Guid("{866F3B61-AFCF-45F5-97BE-E0C23B87393C}"); //Бронхиальная астма/ J 45
            private static readonly Guid strDiagId33 = new Guid("{05479FEC-BC19-42B8-A0EC-37C63CE91205}"); //Болезни органов пищеварения/ K 00-93
            private static readonly Guid strDiagId34 = new Guid("{5E6F7098-6633-4B55-A920-82DD9538032A}"); //Болезни печени/ K 70-77
            private static readonly Guid strDiagId35 = new Guid("{225F29AD-6E5D-4DC5-B487-144D386D8DE8}"); //Болезни кожи, подкожной клетчатки/ L 00-99
            private static readonly Guid strDiagId36 = new Guid("{ECC9E612-FB40-4344-8298-5CD8BA40635F}"); //Болезни костно-мешечной системы и соединительной ткани/ M 00-99
            private static readonly Guid strDiagId37 = new Guid("{B3000363-8258-4F07-8234-0DE79E053660}"); //Ревматоидные/ M 05-14
            private static readonly Guid strDiagId38 = new Guid("{FD1C5BBA-0EA5-4929-8EB9-E6C957C2ADA4}"); //Дорсопатии, остеохондроз/ M 40-54
            private static readonly Guid strDiagId39 = new Guid("{1D4E81CB-2315-44C9-BDF3-B0FA874B8E61}"); //Остеохондроз позвоночника/ M 42
            private static readonly Guid strDiagId40 = new Guid("{87378F65-16F1-4B5D-83FB-53DD98628A75}"); //Оперированные дорсопатии, остеохондроз/  M 40-54
            private static readonly Guid strDiagId41 = new Guid("{3E0E50B5-9A3A-4DA2-A098-7147CB19833D}"); //Болезни мочевыводящих органов/ N 00-99
            private static readonly Guid strDiagId42 = new Guid("{82D1F915-CADF-4E7F-91A9-36B84CAB5A85}"); //Травмы, отравления и другие воздействия внешних причин/ S00 T98
            private static readonly Guid strDiagId43 = new Guid("{FC38C0AE-2C54-4609-B728-517D5BC481CF}"); //Травма глаз/ T 90.4
            private static readonly Guid strDiagId44 = new Guid("{3B607D89-91FB-4A90-9C77-61B71658950C}"); //Травма головы/ T-90
            private static readonly Guid strDiagId45 = new Guid("{F636A14B-B2F4-4EC9-9EBA-0A6A0F6CEA9C}"); //Травмы позвоночника/  T 91.1
            private static readonly Guid strDiagId46 = new Guid("{51EDADEE-1AD8-4E72-AC33-B41F057CD61B}"); //Травмы позвоночника с повреждением спинного мозга/  T 91.3
            private static readonly Guid strDiagId47 = new Guid("{0D31A297-B2C2-42A6-9406-81E258D93114}"); //Травмы нижних конечностей /  T 93
            private static readonly Guid strDiagId48 = new Guid("{961024D8-FF80-414E-9A3E-C669D167E996}"); //Термические, химические ожоги, отморожения/ T 95
            private static readonly Guid strDiagId49 = new Guid("{6E4156F7-3DEE-4191-9CFB-B44B8E6088E8}"); //Автодорожная травма/ S 00 T 98
            private static readonly Guid strDiagId50 = new Guid("{961BB1B1-2C65-4833-86FA-2FC02CBCDDA8}"); //Болезни вследствие воздействия ионизирующего облучения/ W 88
            private static readonly Guid strDiagId51 = new Guid("{F702AAD3-523D-4914-8B97-5D2B9905D231}"); //Болезни вследствие воздействия вибрации/ W 43
            private static readonly Guid strDiagId52 = new Guid("{E7271846-9AAA-4C52-AA19-CB01C3B765A2}"); //Болезни крови, кроветворных органов/ D 50-89
            private static readonly Guid strDiagId53 = new Guid("{41F09403-B4B7-46CA-92BF-B716523AFDE9}"); //Доброкачественные новообразования/ D 10-36
            private static readonly Guid strDiagId54 = new Guid("{D4050056-32C3-48FD-9718-EA7FE3294E82}"); //Бруцеллез/ A 23
            private static readonly Guid strDiagId55 = new Guid("{1DEDD889-4336-4622-85C0-9DDD1FF432D9}"); //Бруцеллез бытовой/ A 23
            private static readonly Guid strDiagId56 = new Guid("{F3B64F5D-6A6C-4343-B5B5-7B5E3CB92474}"); //Эхинококкоз/ B 67
            private static readonly Guid strDiagId57 = new Guid("{0CEAC906-B3D2-4AD8-9DE6-D3FA384F2CDF}"); //Врожденные пороки развития, хромосомные развития/ Q 00-99
            private static readonly Guid strDiagId58 = new Guid("{19309EF8-3706-45DE-8A74-E2652AEF8368}"); //Аномалии ЦНС/ Q 00-07
            private static readonly Guid strDiagId59 = new Guid("{C172D276-4C76-48F6-911F-D552D3A533D8}"); //Аномалии органов чувств/ Q 10 - 18
            private static readonly Guid strDiagId60 = new Guid("{018CC67A-9281-438B-9808-222AEFC31AE7}"); //Аномалии зрения/ Q 10 - 15
            private static readonly Guid strDiagId61 = new Guid("{7BAAF5C9-D1F4-4FC7-B270-DFBE6FE335B3}"); //Аномалии слуха/ Q 16 - 18
            private static readonly Guid strDiagId62 = new Guid("{52A085F0-7B28-4F13-BB33-BDD34AD94F3C}"); //Аномалии системы кровообращения/ Q 20-28
            private static readonly Guid strDiagId63 = new Guid("{62EA3A46-6964-4791-BF68-7DBD2DB70B3B}"); //Расщелина губы и неба/ Q35-37
            private static readonly Guid strDiagId64 = new Guid("{20F214CB-1B5B-4E69-A0CA-982096503776}"); //Врожденные деформации бедра, т\бедренного сустава/ Q 65
            private static readonly Guid strDiagId65 = new Guid("{44804C12-8795-4938-8585-40BA2C82BB8E}"); //Врожденные аномалии костно-мышечной системы/ Q 66-79
            private static readonly Guid strDiagId66 = new Guid("{E0459C10-17FF-4210-A4DF-53081F6E177B}"); //Хромосомные аномалии/ Q 91-99
            private static readonly Guid strDiagId67 = new Guid("{A4D44A12-8DC0-4B14-BF67-3E5D4C560871}"); //Болезни/ Q 90
            private static readonly Guid strDiagId68 = new Guid("{BC059B01-6570-41B3-B1C8-75E3CBAD60DA}"); //Состояния, возникающие в периетальном периоде/ P 00-96
            private static readonly Guid strDiagId69 = new Guid("{07C6C658-D589-48A1-803B-DBCA6603B543}"); //Болезни вызванные вирусом ВИЧ (СПИД)/ B 20-24
            private static readonly Guid strDiagId70 = new Guid("{EC422C17-E8E4-42A3-AD96-EBCBC07B7C7E}"); //Дети рожденные от матерей инфицированных ВИЧ/ ЦВ 20-24
            private static readonly Guid strDiagId71 = new Guid("{0ADE4B55-DF1D-46EA-954B-F3F9FB7CAE08}"); //Прочие болезни / Прочие
            private static readonly Guid strDiagId72 = new Guid("{25029E6F-916F-44DE-86B0-C018A8055D4F}"); //Трудовое увечье
            private static readonly Guid strDiagId73 = new Guid("{8F30CA1F-9187-463E-9D26-1BD525BF45F6}"); //Профессиональные болезни
            private static readonly Guid strDiagId74 = new Guid("{CBEBAF9D-B67D-4BB3-B715-DB252DC2C018}"); //Ликвидаторы последствий аварии на ЧАЭС
            private static readonly Guid strDiagId75 = new Guid("{C0B08AFD-85BB-4DB1-8D9D-6ED3CA43438E}"); //Пострадавшие в событиях 2010г. Бишкек, Талас
            private static readonly Guid strDiagId76 = new Guid("{6A2CF4F5-E0FC-4D70-9DD3-DA23F3049CD2}"); //Пострадавшие в событиях 2010г. Ош, Жалал-Абад
        }

        //Результаты переосвидетельствований детей- инвалидов в возрасте до 18 лет
        public static class RepetExamInvalids18Age
        {
            public static List<Report7D5Item> Execute(WorkflowContext context, int year, string distrSpr)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;

                var docs = new string[]
                {
                    "Переосвидетельствовано всего 01  ",
                    "В том числе для определения инвалидности 02  ",
                    "всего 03  ",
                    "из них ДЦП 04  ",
                    "Всего признаны инвалидами жен.пол     ",
                    "Освидетельствованы для других целей 05  ",
                    "Определение кресло-коляски  05.1",
                    "Определение в дома интернаты  05.2",
                    "Определение протезирования  05.3",
                    "Определения обучения 05.4",
                    "Сложная консультация 05.5",
                    "Другие 05.6"
                };
                var items = new List<Report7D5Item>();
                int i2 = 1;
                foreach (var i in docs)
                {
                    var item = new Report7D5Item();
                    item.rowName = i;
                    item.rowNo = i2;
                    i2++;
                    items.Add(item);
                }
                CalcItems(context, /*report*/ year, orgId, distrSpr, items[11],  items[10], items[9], items[8], items[7], items[6], items[5], items[4], items[3], items[2], items[1], items[0]);
                return items;
            }
            public static void CalcItems(WorkflowContext context, int year, Guid orgId, string distrSpr, Report7D5Item item11, Report7D5Item item10, Report7D5Item item9, Report7D5Item item8, Report7D5Item item7, Report7D5Item item6, Report7D5Item item5, Report7D5Item item4, Report7D5Item item3, Report7D5Item item2, Report7D5Item item1, Report7D5Item item0)
            {
                var qb = new QueryBuilder(childStatCardDefId, context.UserId);
                qb.Where("&State").Eq(ApprovedStateId).And("Examination1").Eq(repetEnumId);

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                    var actSrc = query.JoinSource(query.Source, childActDefId, SqlSourceJoinType.Inner, "ChildrensMedicalCertificate");
                    var distrSrc = query.JoinSource(actSrc, districtDefId, SqlSourceJoinType.LeftOuter, "DistrictId");
                    var citySrc = query.JoinSource(actSrc, cityDefId, SqlSourceJoinType.LeftOuter, "CityId");
                    query.AddCondition(ExpressionOperation.And, childStatCardDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    if (!string.IsNullOrEmpty(distrSpr))
                        query.AddCondition(ExpressionOperation.And, districtDefId, "NumberDis", ConditionOperation.Equal, distrSpr);

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(query.Source, "EndDateExamination");
                    query.AddAttribute(personSrc, "Gender");
                    query.AddAttribute(query.Source, "DisabilityGroup"); 
                    query.AddAttribute(distrSrc, "DistrictType");
                    query.AddAttribute(citySrc, "DistrictType");
                    query.AddAttribute(query.Source, "term");
                    query.AddAttribute(query.Source, "goal");
                    query.AddAttribute(query.Source, "Diagnosis");
                    query.AddAttribute(query.Source, "goal11");
                    query.AddAttribute(query.Source, "goal9");
                    query.AddAttribute(query.Source, "goal8");
                    query.AddAttribute(query.Source, "goal17");
                    query.AddAttribute(query.Source, "goal18");

                    var table = new DataTable();
                    using (var reader = context.CreateSqlReader(query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var date = !(row[1] is DBNull) ? (DateTime)row[1] : DateTime.MinValue;
                        var gender = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                        var group = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                        var district = row[4] is DBNull ? Guid.Empty : (Guid)row[4];
                        var city = row[5] is DBNull ? Guid.Empty : (Guid)row[5];
                        var term = row[6] is DBNull ? Guid.Empty : (Guid)row[6];
                        var goal = row[7] is DBNull ? false : (bool)row[7];
                        var diagnoz = row[8] is DBNull ? Guid.Empty : (Guid)row[8];
                        var goal11 = row[9] is DBNull ? false : (bool)row[9];
                        var goal9 = row[10] is DBNull ? Guid.Empty : (Guid)row[10];
                        var goal8 = row[11] is DBNull ? false : (bool)row[11];
                        var goal17 = row[12] is DBNull ? false : (bool)row[12];
                        var goal18 = row[13] is DBNull ? false : (bool)row[13];

                        if (appId != Guid.Empty)
                        {
                            if (date.Year == year)
                            {
                                item0.gr1 = item0.gr1 != 0 ? (1 + (int)item0.gr1) : 1;
                                if(goal) item1.gr1 = item1.gr1 != 0 ? (1 + (int)item1.gr1) : 1;

                                item2.gr1 = item2.gr1 != 0 ? (1 + (int)item2.gr1) : 1;
                                if (group == childGroupEnId)
                                {
                                    item2.gr2 = item2.gr2 != 0 ? (1 + (int)item2.gr2) : 1;
                                    if (district == cityEnumId || city == cityEnumId)
                                    {
                                        if (term == termEnumId1 || term == termEnumId2) item2.gr3 = item2.gr3 != 0 ? (1 + (int)item2.gr3) : 1;
                                        if (term == termEnumId3) item2.gr4 = item2.gr4 != 0 ? (1 + (int)item2.gr4) : 1;
                                        if (term == termEnumId4) item2.gr5 = item2.gr5 != 0 ? (1 + (int)item2.gr5) : 1;
                                        if (term != Guid.Empty) item2.gr6 = item2.gr6 != 0 ? (1 + (int)item2.gr6) : 1;
                                    }
                                    if (district == villageEnumId || city == cityEnumId)
                                    {
                                        if (term == termEnumId1 || term == termEnumId2) item2.gr7 = item2.gr7 != 0 ? (1 + (int)item2.gr7) : 1;
                                        if (term == termEnumId3) item2.gr8 = item2.gr8 != 0 ? (1 + (int)item2.gr8) : 1;
                                        if (term == termEnumId4) item2.gr9 = item2.gr9 != 0 ? (1 + (int)item2.gr9) : 1;
                                        if (term != Guid.Empty) item2.gr10 = item2.gr10 != 0 ? (1 + (int)item2.gr10) : 1;
                                    }
                                }
                                if (goal && group == notInstalledEnId)
                                {
                                    item3.gr11 = item3.gr11 != 0 ? (1 + (int)item3.gr11) : 1;
                                    if (district == cityEnumId || city == cityEnumId) item3.gr12 = item3.gr12 != 0 ? (1 + (int)item3.gr12) : 1;
                                    if (district == villageEnumId || city == cityEnumId) item3.gr12 = item3.gr12 != 0 ? (1 + (int)item3.gr12) : 1;
                                }
                                if (diagnoz == strDiagId10 || diagnoz == strDiagId12)
                                {
                                    item4.gr1 = item4.gr1 != 0 ? (1 + (int)item4.gr1) : 1;
                                    if (group == childGroupEnId)
                                    {
                                        item4.gr2 = item4.gr2 != 0 ? (1 + (int)item4.gr2) : 1;
                                        if (district == cityEnumId || city == cityEnumId)
                                        {
                                            if (term == termEnumId1 || term == termEnumId2) item4.gr3 = item4.gr3 != 0 ? (1 + (int)item4.gr3) : 1;
                                            if (term == termEnumId3) item4.gr4 = item4.gr4 != 0 ? (1 + (int)item4.gr4) : 1;
                                            if (term == termEnumId4) item4.gr5 = item4.gr5 != 0 ? (1 + (int)item4.gr5) : 1;
                                            if (term != Guid.Empty) item4.gr6 = item4.gr6 != 0 ? (1 + (int)item4.gr6) : 1;
                                        }
                                        if (district == villageEnumId || city == cityEnumId)
                                        {
                                            if (term == termEnumId1 || term == termEnumId2) item4.gr7 = item4.gr7 != 0 ? (1 + (int)item4.gr7) : 1;
                                            if (term == termEnumId3) item4.gr8 = item4.gr8 != 0 ? (1 + (int)item4.gr8) : 1;
                                            if (term == termEnumId4) item4.gr9 = item4.gr9 != 0 ? (1 + (int)item4.gr9) : 1;
                                            if (term != Guid.Empty) item4.gr10 = item4.gr10 != 0 ? (1 + (int)item4.gr10) : 1;
                                        }
                                    }
                                    if (goal && group == notInstalledEnId)
                                    {
                                        item4.gr11 = item4.gr11 != 0 ? (1 + (int)item4.gr11) : 1;
                                        if (district == cityEnumId || city == cityEnumId) item4.gr12 = item4.gr12 != 0 ? (1 + (int)item4.gr12) : 1;
                                        if (district == villageEnumId || city == cityEnumId) item4.gr12 = item4.gr12 != 0 ? (1 + (int)item4.gr12) : 1;
                                    }
                                }
                                if (group == childGroupEnId && gender == womanEnumId) item5.gr1 = item5.gr1 != 0 ? (1 + (int)item5.gr1) : 1;
                                if (goal8 || goal9 != Guid.Empty || goal11 || goal17 || goal18)
                                {
                                    item6.gr1 = item6.gr1 != 0 ? (1 + (int)item6.gr1) : 1;
                                    if (goal11) item7.gr1 = item7.gr1 != 0 ? (1 + (int)item7.gr1) : 1;
                                    if (goal9 != Guid.Empty) item8.gr1 = item8.gr1 != 0 ? (1 + (int)item8.gr1) : 1;
                                    if (goal8) item9.gr1 = item9.gr1 != 0 ? (1 + (int)item9.gr1) : 1;
                                    //if (?????) item7.gr1 = item7.gr1 != 0 ? (1 + (int)item7.gr1) : 1;
                                    if (goal17) item10.gr1 = item10.gr1 != 0 ? (1 + (int)item10.gr1) : 1;
                                    if (goal18) item11.gr1 = item11.gr1 != 0 ? (1 + (int)item11.gr1) : 1;
                                }
                            }
                        }
                    }
                }
            }
            static void RemoveRows(WorkflowContext context, Guid reportId)
            {
                var docRepo = context.Documents;
                var rows = new List<Guid>();
                var qb = new QueryBuilder(reportItemDefId, context.UserId);
                qb.Where("Report").Eq(reportId).Or("Report").IsNull();
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read()) rows.Add(reader.GetGuid(0));
                }
                foreach (var rowId in rows)
                {
                    docRepo.DeleteById(rowId);
                }
            }
            private static readonly Guid reportDefId = new Guid("{17789FEE-2908-4E01-8E16-2ECAF4A75C7A}"); //Отчет о распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности
            private static readonly Guid reportItemDefId = new Guid("{10AB1374-EA9C-493B-B5F6-CD6A40273B9B}"); //Распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности
            
            private static readonly Guid childStatCardDefId = new Guid("{363E89D0-5E31-45B5-82B7-42E83DF96E1F}"); //Статистический талон ребенка с ОВЗ
            private static readonly Guid childActDefId = new Guid("{0ECF44B6-2B2D-4687-B7B0-07BA5F942AC6}"); //Медицинский акт ребенка с ОВЗ
            private static readonly Guid dinamicDefId = new Guid("{FFBD36FF-615E-49F7-AB5B-9C787C07B981}"); //Динамика инвалидности
            private static readonly Guid personDefId = new Guid("{D71CE61A-9B59-4B5E-8713-8131DBB5BA02}"); //Person 
            public static readonly Guid districtDefId = new Guid("{A3FCA356-82A9-4BBD-872A-8333BEC6E41A}"); //Район
            public static readonly Guid cityDefId = new Guid("{4BB6D32D-5181-4031-BA49-CF5910D6D883}"); //Города районного значения

            public static readonly Guid repetEnumId = new Guid("{A1F1D6CD-C1CD-4BF8-8F4A-DA124D47C250}"); //Повторные
            public static readonly Guid pensionAge = new Guid("{9B207DB0-8214-4BA7-A8C4-635EF87B583A}"); //Лицо пенсионного возраста
            private static readonly Guid reasonDisEnumdId = new Guid("{2E3209F0-0002-4DA2-9E63-6FAEDDF1983D}"); //	Трудовое увечье

            public static readonly Guid ageOf1EnumId = new Guid("{484C1AF3-3203-478D-97B4-B7977738A194}"); //От 0-3 лет
            public static readonly Guid ageOf2EnumId = new Guid("{124DA030-994C-4F2D-AD5F-750986CCDC96}"); //От 4-7 лет
            public static readonly Guid ageOf3EnumId = new Guid("{CFDA5599-9767-430E-AC90-632D3FBDBF1F}"); //От 8-14 лет
            public static readonly Guid ageOf4EnumId = new Guid("{30DA048C-85C4-4078-9A63-0CDB40A7747A}"); //От 15-17 лет

            //Инвалидность установлена на срок
            public static readonly Guid termEnumId1 = new Guid("{C0C639C1-4069-42BD-B9C5-0C4C0EAD41CE}"); //1 год
            public static readonly Guid termEnumId2 = new Guid("{CAB664A9-513D-4939-AB17-31ACF97C7592}"); //2 года
            public static readonly Guid termEnumId3 = new Guid("{4C270330-A4A0-40B7-9E2C-6726AE4BAD6C}"); //5 лет
            public static readonly Guid termEnumId4 = new Guid("{B1F91F0F-EA5C-4DA4-9DE6-C3FC0142E66F}"); //до 18 лет

            public static readonly Guid childGroupEnId = new Guid("{D145ABA1-EADA-442B-9D8D-AD10BCD126D2}"); //Ребенок с ОВЗ
            public static readonly Guid notInstalledEnId = new Guid("{BEB4542B-0C03-494A-BD60-AA6BA8E8BF4C}"); //Не установлена

            private static readonly Guid strDiagId10 = new Guid("{070AADAE-4453-4753-B939-44FD21544953}"); //Умственная отсталость, в сочетании ДЦП/ F 70-79
            private static readonly Guid strDiagId12 = new Guid("{970AE4FA-9B31-447E-AF8B-9567A8F62F3F}"); //Органическое слабоумие в сочетании ДЦП/ F 00-03

            public static readonly Guid cityEnumId = new Guid("{DE3D24A1-64D3-4647-B711-31F334D24416}"); //Городская местность//DistrictType.
            public static readonly Guid villageEnumId = new Guid("{65DF9C4D-A18B-4080-855F-4800E2A19C35}"); //Cельская местность//DistrictType
            public static readonly Guid womanEnumId = new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"); //Женский пол
            public static readonly Guid primaryEnumId = new Guid("{34129BC5-5B31-4189-87FA-799402F7E99F}"); //Первичное

            public static readonly Guid ApprovedStateId = new Guid("{32062CB7-C31C-4AFB-ADF3-F9F9AEEFCE59}");  //Подписанные
        }

        //Рекомендации по реабилитации детей-инвалидов 
        public static class RecomRehabDisabilities18Age
        {
            public static List<Report8Item> Execute(WorkflowContext context, int year, string distrSpr)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;

                /******************************************************************************************************************/
                var docs = new string[]
                {
                    "Выдано индивидуальных программ реабилитации всего  01   ",
                    "Выдано рекомендаций по медицинской реабилитации   02   ",
                    "Их них дано заключений о нуждаемости:- в восстановительной терапии  02.1 ",
                    "- в реконструктивной хирургии  02.2",
                    "- в санаторно-курортном лечении  02.3",
                    "Выдано рекомендаций в получении дошкольного воспитания  03   ",
                    "Из них:- в дошкольных образовательных учреждениях общего назначения  03.1 ",
                    "- в дошкольных специальных (коррекционных) учреждениях для воспитанников с отклонениями в развитии    03.2 ",
                    "Выдано рекомендаций в получении общего образования  04   ",
                    "Из них:  в образовательных учреждениях общего назначения  04.1 ",
                    "- в дошкольных специальных (коррекционных) учреждениях для обучающихся воспитанников с отклонениями в развитии    04.2 ",
                    "По зрению  04.21",
                    "По слуху  04.22",
                    "По психическим расстройствам  04.23",
                    "- на дому по специальным программам  04.3 ",
                    "- по инклюзивной программе  04.4 ",
                    "Выдано рекомендаций по профессиональной ориентации (включая профессиональное обучение, переобучение, повышение квалификации)    05   ",
                    "Из них:  В условиях производства  05.1 ",
                    "- в профтехучилищах и техникумах системы органов социальной защиты  05.2 ",
                    "- в техникумах и ПТУ системы образования  05.3 ",
                    "- в высших учебных заведениях  05.4 ",
                    "- в УПП      05.5 ",
                    "Выдано рекомендаций в трудоустройстве  06   ",
                    "Из них: В обычных условиях производства  06.1 ",
                    "В специально созданных условиях труда на дому 06.02",
                    "Выдано заключений о нуждаемости в технических средствах реабилитации – всего  07   ",
                    "Кресла-коляски  07.1 ",
                    "Протезирование  07.2 ",
                    "Протезы рук  07.21",
                    "Протезы ног  07.22",
                    "Эндопротезы  07.23",
                    "Косметические протезы  07.23",
                    "Ортезы  07.3 ",
                    "Ортопедическая обувь  07.4 ",
                    "Слуховые аппараты  07.5 ",
                    "Технические средства при нарушениях зрения  07.6 ",
                    "Голосообразующие аппараты  07.8 ",
                    "Бытовые средства  08   ",
                    "Кресел стульев с санитарным освещением  08.1 ",
                    "Специальных средств при нарушении функции выделения  08.2 ",
                    "Абсорбирующего белья, памперсов  08.3 ",
                    "Бытовые приспособления  08.4 ",
                    "И другие  08.5 "
                };
                var items = new List<Report8Item>();
                int i2 = 1;
                foreach (var i in docs)
                {
                    var item = new Report8Item();
                    item.rowName = i;
                    item.rowNo = i2;
                    i2++;
                    items.Add(item);
                }
                CalcItems(context, /*report*/ year, orgId, distrSpr, items[42], items[41], items[40], items[39],
                    items[38], items[37], items[36], items[35], items[34], items[33], items[32],
                    items[31], items[30], items[29], items[28], items[27], items[26], items[25],
                    items[24], items[23], items[22], items[21], items[20], items[19], items[18],
                    items[17], items[16], items[15], items[14], items[13], items[12], items[11],
                    items[10], items[9], items[8], items[7], items[6], items[5], items[4],
                    items[3], items[2], items[1], items[0]);
                return items;
            }
            public static void CalcItems(WorkflowContext context, int year, Guid orgId, string distrSpr,
                    Report8Item item42, Report8Item item41, Report8Item item40,
                    Report8Item item39, Report8Item item38, Report8Item item37, Report8Item item36,
                    Report8Item item35, Report8Item item34, Report8Item item33, Report8Item item32,
                    Report8Item item31, Report8Item item30, Report8Item item29, Report8Item item28,
                    Report8Item item27, Report8Item item26, Report8Item item25, Report8Item item24,
                    Report8Item item23, Report8Item item22, Report8Item item21, Report8Item item20,
                    Report8Item item19, Report8Item item18, Report8Item item17, Report8Item item16,
                    Report8Item item15, Report8Item item14, Report8Item item13, Report8Item item12,
                    Report8Item item11, Report8Item item10, Report8Item item9, Report8Item item8,
                    Report8Item item7, Report8Item item6, Report8Item item5, Report8Item item4,
                    Report8Item item3, Report8Item item2, Report8Item item1, Report8Item item0)
            {
                var qb = new QueryBuilder(childStatCardDefId, context.UserId);
                qb.Where("&State").Eq(ApprovedStateId);

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                    query.AddCondition(ExpressionOperation.And, childStatCardDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    if (!string.IsNullOrEmpty(distrSpr))
                        query.AddCondition(ExpressionOperation.And, districtDefId, "NumberDis", ConditionOperation.Equal, distrSpr);

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(query.Source, "EndDateExamination");
                    query.AddAttribute(query.Source, "Examination1");
                    query.AddAttribute(query.Source, "TalonIPR");
                    query.AddAttribute(query.Source, "RestorativeTherapy");
                    query.AddAttribute(query.Source, "ReconstructiveSurgery");
                    query.AddAttribute(query.Source, "SpaProvision");
                    query.AddAttribute(query.Source, "RehabilitationCenter");
                    query.AddAttribute(query.Source, "HospitalTreatment");
                    query.AddAttribute(query.Source, "Hospitalization");
                    query.AddAttribute(query.Source, "ObsheeObrazovanie1");
                    query.AddAttribute(query.Source, "PreschoolEducation1");
                    query.AddAttribute(query.Source, "ProfeOrientasiya");
                    query.AddAttribute(query.Source, "ObespProfOrientasya");
                    query.AddAttribute(query.Source, "Placement");
                    query.AddAttribute(query.Source, "01");
                    query.AddAttribute(query.Source, "02");
                    query.AddAttribute(query.Source, "03");
                    query.AddAttribute(query.Source, "04");
                    query.AddAttribute(query.Source, "05");
                    query.AddAttribute(query.Source, "06");
                    query.AddAttribute(query.Source, "07");
                    query.AddAttribute(query.Source, "08");
                    query.AddAttribute(query.Source, "09");
                    query.AddAttribute(query.Source, "10");
                    query.AddAttribute(query.Source, "11");
                    query.AddAttribute(query.Source, "12");
                    query.AddAttribute(query.Source, "13");
                    query.AddAttribute(query.Source, "14");
                    query.AddAttribute(query.Source, "15");
                    query.AddAttribute(query.Source, "16");
                    query.AddAttribute(query.Source, "17");
                    query.AddAttribute(query.Source, "18");
                    query.AddAttribute(query.Source, "19");
                    query.AddAttribute(query.Source, "20");
                    query.AddAttribute(query.Source, "goal");                    
                    query.AddAttribute(query.Source, "DisabilityGroup");

                    var table = new DataTable();
                    using (var reader = context.CreateSqlReader(query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }

                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var date = !(row[1] is DBNull) ? (DateTime)row[1] : DateTime.MinValue;
                        var prReExam = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                        var ipr = row[3] is DBNull ? false : (bool)row[3];
                        var recom1 = row[4] is DBNull ? false : (bool)row[4];
                        var recom2 = row[5] is DBNull ? false : (bool)row[5];
                        var recom3 = row[6] is DBNull ? false : (bool)row[6];
                        var recom4 = row[7] is DBNull ? false : (bool)row[7];
                        var recom5 = row[8] is DBNull ? false : (bool)row[8];
                        var recom6 = row[9] is DBNull ? false : (bool)row[9];
                        var recom7 = row[10] is DBNull ? Guid.Empty : (Guid)row[10];
                        var recom8 = row[11] is DBNull ? Guid.Empty : (Guid)row[11];
                        var recom9 = row[12] is DBNull ? Guid.Empty : (Guid)row[12];
                        var recom10 = row[13] is DBNull ? Guid.Empty : (Guid)row[13];
                        var recom11 = row[14] is DBNull ? Guid.Empty : (Guid)row[14];
                        var plant1 = row[15] is DBNull ? false : (bool)row[15];
                        var plant2 = row[16] is DBNull ? false : (bool)row[16];
                        var plant3 = row[17] is DBNull ? false : (bool)row[17];
                        var plant4 = row[18] is DBNull ? false : (bool)row[18];
                        var plant5 = row[19] is DBNull ? false : (bool)row[19];
                        var plant6 = row[20] is DBNull ? false : (bool)row[20];
                        var plant7 = row[21] is DBNull ? false : (bool)row[21];
                        var plant8 = row[22] is DBNull ? false : (bool)row[22];
                        var plant9 = row[23] is DBNull ? false : (bool)row[23];
                        var plant10 = row[24] is DBNull ? false : (bool)row[24];
                        var plant11 = row[25] is DBNull ? false : (bool)row[25];
                        var plant12 = row[26] is DBNull ? false : (bool)row[26];
                        var plant13 = row[27] is DBNull ? false : (bool)row[27];
                        var plant14 = row[28] is DBNull ? false : (bool)row[28];
                        var plant15 = row[29] is DBNull ? false : (bool)row[29];
                        var plant16 = row[30] is DBNull ? false : (bool)row[30];
                        var plant17 = row[31] is DBNull ? false : (bool)row[31];
                        var plant18 = row[32] is DBNull ? false : (bool)row[32];
                        var plant19 = row[33] is DBNull ? false : (bool)row[33];
                        var plant20 = row[34] is DBNull ? false : (bool)row[34];
                        var goal = row[35] is DBNull ? false : (bool)row[35];
                        //var implement = row[36] is DBNull ? Guid.Empty : (Guid)row[36];
                        var group = row[36] is DBNull ? Guid.Empty : (Guid)row[36];

                        if (appId != Guid.Empty)
                        {
                            if (date.Year == year)
                            {
                                if (ipr)
                                {
                                    item0.gr1 = item0.gr1 != 0 ? (1 + (int)item0.gr1) : 1;
                                    if (prReExam == primaryEnumId) item0.gr2 = item0.gr2 != 0 ? (1 + (int)item0.gr2) : 1;
                                    //if () item0.gr3 = item0.gr3 != 0 ? (1 + (int)item0.gr3) : 1;
                                    /*if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                    {
                                        item0.gr4 = item0.gr4 != 0 ? (1 + (int)item0.gr4) : 1;
                                    }*/
                                    if (goal && group == notInstalledEnId) item0.gr5 = item0.gr5 != 0 ? (1 + (int)item0.gr5) : 1;
                                    if (prReExam != primaryEnumId && group == notInstalledEnId) item0.gr6 = item0.gr6 != 0 ? (1 + (int)item0.gr6) : 1;
                                }
                                if (recom1 || recom2 || recom3 || recom4 || recom5 || recom6)
                                {
                                    item1.gr1 = item1.gr1 != 0 ? (1 + (int)item1.gr1) : 1;
                                    if (prReExam == primaryEnumId) item1.gr2 = item1.gr2 != 0 ? (1 + (int)item1.gr2) : 1;
                                    //if () item1.gr3 = item1.gr3 != 0 ? (1 + (int)item1.gr3) : 1;
                                    //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                    //{
                                    //    item1.gr4 = item1.gr4 != 0 ? (1 + (int)item1.gr4) : 1;
                                    //}
                                    if (goal && group == notInstalledEnId) item1.gr5 = item1.gr5 != 0 ? (1 + (int)item1.gr5) : 1;
                                    if (prReExam != primaryEnumId && group == notInstalledEnId) item1.gr6 = item1.gr6 != 0 ? (1 + (int)item1.gr6) : 1;

                                    if (recom1)
                                    {
                                        item2.gr1 = item2.gr1 != 0 ? (1 + (int)item2.gr1) : 1;
                                        if (prReExam == primaryEnumId) item2.gr2 = item2.gr2 != 0 ? (1 + (int)item2.gr2) : 1;
                                        //if () item2.gr3 = item2.gr3 != 0 ? (1 + (int)item2.gr3) : 1;
                                        //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        //{
                                        //    item2.gr4 = item2.gr4 != 0 ? (1 + (int)item2.gr4) : 1;
                                        //}
                                        if (goal && group == notInstalledEnId) item2.gr5 = item2.gr5 != 0 ? (1 + (int)item2.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalledEnId) item2.gr6 = item2.gr6 != 0 ? (1 + (int)item2.gr6) : 1;
                                    }
                                    if (recom2)
                                    {
                                        item3.gr1 = item3.gr1 != 0 ? (1 + (int)item3.gr1) : 1;
                                        if (prReExam == primaryEnumId) item3.gr2 = item3.gr2 != 0 ? (1 + (int)item3.gr2) : 1;
                                        //if () item3.gr3 = item3.gr3 != 0 ? (1 + (int)item3.gr3) : 1;
                                        //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        //{
                                        //    item3.gr4 = item3.gr4 != 0 ? (1 + (int)item3.gr4) : 1;
                                        //}
                                        if (goal && group == notInstalledEnId) item3.gr5 = item3.gr5 != 0 ? (1 + (int)item3.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalledEnId) item3.gr6 = item3.gr6 != 0 ? (1 + (int)item3.gr6) : 1;
                                    }
                                    if (recom3)
                                    {
                                        item4.gr1 = item4.gr1 != 0 ? (1 + (int)item4.gr1) : 1;
                                        if (prReExam == primaryEnumId) item4.gr2 = item4.gr2 != 0 ? (1 + (int)item4.gr2) : 1;
                                        //if () item4.gr3 = item4.gr3 != 0 ? (1 + (int)item4.gr3) : 1;
                                        //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        //{
                                        //    item4.gr4 = item4.gr4 != 0 ? (1 + (int)item4.gr4) : 1;
                                        //}
                                        if (goal && group == notInstalledEnId) item4.gr5 = item4.gr5 != 0 ? (1 + (int)item4.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalledEnId) item4.gr6 = item4.gr6 != 0 ? (1 + (int)item4.gr6) : 1;
                                    }
                                }
                                if (recom7 != Guid.Empty)
                                {
                                    item5.gr1 = item5.gr1 != 0 ? (1 + (int)item5.gr1) : 1;
                                    if (prReExam == primaryEnumId) item5.gr2 = item5.gr2 != 0 ? (1 + (int)item5.gr2) : 1;
                                    //if () item5.gr3 = item5.gr3 != 0 ? (1 + (int)item5.gr3) : 1;
                                    //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                    //{
                                    //    item5.gr4 = item5.gr4 != 0 ? (1 + (int)item5.gr4) : 1;
                                    //}
                                    if (goal && group == notInstalledEnId) item5.gr5 = item5.gr5 != 0 ? (1 + (int)item5.gr5) : 1;
                                    if (prReExam != primaryEnumId && group == notInstalledEnId) item5.gr6 = item5.gr6 != 0 ? (1 + (int)item5.gr6) : 1;

                                    if (recom7 == recom7EnId1)
                                    {
                                        item6.gr1 = item6.gr1 != 0 ? (1 + (int)item6.gr1) : 1;
                                        if (prReExam == primaryEnumId) item6.gr2 = item6.gr2 != 0 ? (1 + (int)item6.gr2) : 1;
                                        //if () item6.gr3 = item6.gr3 != 0 ? (1 + (int)item6.gr3) : 1;
                                        //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        //{
                                        //    item6.gr4 = item6.gr4 != 0 ? (1 + (int)item6.gr4) : 1;
                                        //}
                                        if (goal && group == notInstalledEnId) item6.gr5 = item6.gr5 != 0 ? (1 + (int)item6.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalledEnId) item6.gr6 = item6.gr6 != 0 ? (1 + (int)item6.gr6) : 1;
                                    }
                                    if (recom7 == recom7EnId2)
                                    {
                                        item7.gr1 = item7.gr1 != 0 ? (1 + (int)item7.gr1) : 1;
                                        if (prReExam == primaryEnumId) item7.gr2 = item7.gr2 != 0 ? (1 + (int)item7.gr2) : 1;
                                        //if () item7.gr3 = item7.gr3 != 0 ? (1 + (int)item7.gr3) : 1;
                                        //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        //{
                                        //    item7.gr4 = item7.gr4 != 0 ? (1 + (int)item7.gr4) : 1;
                                        //}
                                        if (goal && group == notInstalledEnId) item7.gr5 = item7.gr5 != 0 ? (1 + (int)item7.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalledEnId) item7.gr6 = item7.gr6 != 0 ? (1 + (int)item7.gr6) : 1;
                                    }
                                }
                                if (recom8 != Guid.Empty)
                                {
                                    item8.gr1 = item8.gr1 != 0 ? (1 + (int)item8.gr1) : 1;
                                    if (prReExam == primaryEnumId) item8.gr2 = item8.gr2 != 0 ? (1 + (int)item8.gr2) : 1;
                                    //if () item8.gr3 = item8.gr3 != 0 ? (1 + (int)item8.gr3) : 1;
                                    //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                    //{
                                    //    item8.gr4 = item8.gr4 != 0 ? (1 + (int)item8.gr4) : 1;
                                    //}
                                    if (goal && group == notInstalledEnId) item8.gr5 = item8.gr5 != 0 ? (1 + (int)item8.gr5) : 1;
                                    if (prReExam != primaryEnumId && group == notInstalledEnId) item8.gr6 = item8.gr6 != 0 ? (1 + (int)item8.gr6) : 1;
                                }
                                /*if (recom8 == recom8EnId1)
                                {
                                    item9.gr1 = item9.gr1 != 0 ? (1 + (int)item9.gr1) : 1;
                                    if (prReExam == primaryEnumId) item9.gr2 = item9.gr2 != 0 ? (1 + (int)item9.gr2) : 1;
                                    //if () item9.gr3 = item9.gr3 != 0 ? (1 + (int)item9.gr3) : 1;
                                    if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                    {
                                        item9.gr4 = item9.gr4 != 0 ? (1 + (int)item9.gr4) : 1;
                                    }
                                    if (goal && group == notInstalledEnId) item9.gr5 = item9.gr5 != 0 ? (1 + (int)item9.gr5) : 1;
                                    if (prReExam != primaryEnumId && group == notInstalledEnId) item9.gr6 = item9.gr6 != 0 ? (1 + (int)item9.gr6) : 1;
                                }*/

                                /**********************************
                                 ?????????
                                 /*************************************/

                                if (recom10 != Guid.Empty)
                                {
                                    item16.gr1 = item16.gr1 != 0 ? (1 + (int)item16.gr1) : 1;
                                    if (prReExam == primaryEnumId) item16.gr2 = item16.gr2 != 0 ? (1 + (int)item16.gr2) : 1;
                                    //if () item16.gr3 = item16.gr3 != 0 ? (1 + (int)item16.gr3) : 1;
                                    //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                    //{
                                    //    item16.gr4 = item16.gr4 != 0 ? (1 + (int)item16.gr4) : 1;
                                    //}
                                    if (goal && group == notInstalledEnId) item16.gr5 = item16.gr5 != 0 ? (1 + (int)item16.gr5) : 1;
                                    if (prReExam != primaryEnumId && group == notInstalledEnId) item16.gr6 = item16.gr6 != 0 ? (1 + (int)item16.gr6) : 1;

                                    if (recom10 == recom10EnId1)
                                    {
                                        item17.gr1 = item17.gr1 != 0 ? (1 + (int)item17.gr1) : 1;
                                        if (prReExam == primaryEnumId) item17.gr2 = item17.gr2 != 0 ? (1 + (int)item17.gr2) : 1;
                                        //if () item17.gr3 = item17.gr3 != 0 ? (1 + (int)item17.gr3) : 1;
                                        //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        //{
                                        //    item17.gr4 = item17.gr4 != 0 ? (1 + (int)item17.gr4) : 1;
                                        //}
                                        if (goal && group == notInstalledEnId) item17.gr5 = item17.gr5 != 0 ? (1 + (int)item17.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalledEnId) item17.gr6 = item17.gr6 != 0 ? (1 + (int)item17.gr6) : 1;
                                    }

                                    if (recom10 == recom10EnId3)
                                    {
                                        item18.gr1 = item18.gr1 != 0 ? (1 + (int)item18.gr1) : 1;
                                        if (prReExam == primaryEnumId) item18.gr2 = item18.gr2 != 0 ? (1 + (int)item18.gr2) : 1;
                                        //if () item18.gr3 = item18.gr3 != 0 ? (1 + (int)item18.gr3) : 1;
                                        //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        //{
                                        //    item18.gr4 = item18.gr4 != 0 ? (1 + (int)item18.gr4) : 1;
                                        //}
                                        if (goal && group == notInstalledEnId) item18.gr5 = item18.gr5 != 0 ? (1 + (int)item18.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalledEnId) item18.gr6 = item18.gr6 != 0 ? (1 + (int)item18.gr6) : 1;
                                    }

                                    if (recom10 == recom10EnId2)
                                    {
                                        item19.gr1 = item19.gr1 != 0 ? (1 + (int)item19.gr1) : 1;
                                        if (prReExam == primaryEnumId) item19.gr2 = item19.gr2 != 0 ? (1 + (int)item19.gr2) : 1;
                                        //if () item19.gr3 = item19.gr3 != 0 ? (1 + (int)item19.gr3) : 1;
                                        //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        //{
                                        //    item19.gr4 = item19.gr4 != 0 ? (1 + (int)item19.gr4) : 1;
                                        //}
                                        if (goal && group == notInstalledEnId) item19.gr5 = item19.gr5 != 0 ? (1 + (int)item19.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalledEnId) item19.gr6 = item19.gr6 != 0 ? (1 + (int)item19.gr6) : 1;
                                    }

                                    if (recom10 == recom10EnId4)
                                    {
                                        item20.gr1 = item20.gr1 != 0 ? (1 + (int)item20.gr1) : 1;
                                        if (prReExam == primaryEnumId) item20.gr2 = item20.gr2 != 0 ? (1 + (int)item20.gr2) : 1;
                                        //if () item20.gr3 = item20.gr3 != 0 ? (1 + (int)item20.gr3) : 1;
                                        //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        //{
                                        //    item20.gr4 = item20.gr4 != 0 ? (1 + (int)item20.gr4) : 1;
                                        //}
                                        if (goal && group == notInstalledEnId) item20.gr5 = item20.gr5 != 0 ? (1 + (int)item20.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalledEnId) item20.gr6 = item20.gr6 != 0 ? (1 + (int)item20.gr6) : 1;
                                    }
                                }
                                //item21 ?????????????????

                                /****************************************/
                                if (recom11 != Guid.Empty)
                                {
                                    item22.gr1 = item22.gr1 != 0 ? (1 + (int)item22.gr1) : 1;
                                    if (prReExam == primaryEnumId) item22.gr2 = item22.gr2 != 0 ? (1 + (int)item22.gr2) : 1;
                                    //if () item22.gr3 = item22.gr3 != 0 ? (1 + (int)item22.gr3) : 1;
                                    //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                    //{
                                    //    item22.gr4 = item22.gr4 != 0 ? (1 + (int)item22.gr4) : 1;
                                    //}
                                    if (goal && group == notInstalledEnId) item22.gr5 = item22.gr5 != 0 ? (1 + (int)item22.gr5) : 1;
                                    if (prReExam != primaryEnumId && group == notInstalledEnId) item22.gr6 = item22.gr6 != 0 ? (1 + (int)item22.gr6) : 1;

                                    if (recom11 == recom11EnId1)
                                    {
                                        item23.gr1 = item23.gr1 != 0 ? (1 + (int)item23.gr1) : 1;
                                        if (prReExam == primaryEnumId) item23.gr2 = item23.gr2 != 0 ? (1 + (int)item23.gr2) : 1;
                                        ////if () item23.gr3 = item23.gr3 != 0 ? (1 + (int)item23.gr3) : 1;
                                        //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        //{
                                        //    item23.gr4 = item23.gr4 != 0 ? (1 + (int)item23.gr4) : 1;
                                        //}
                                        if (goal && group == notInstalledEnId) item23.gr5 = item23.gr5 != 0 ? (1 + (int)item23.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalledEnId) item23.gr6 = item23.gr6 != 0 ? (1 + (int)item23.gr6) : 1;
                                    }

                                    if (recom11 == recom11EnId2 || recom11 == recom11EnId3)
                                    {
                                        item24.gr1 = item24.gr1 != 0 ? (1 + (int)item24.gr1) : 1;
                                        if (prReExam == primaryEnumId) item24.gr2 = item24.gr2 != 0 ? (1 + (int)item24.gr2) : 1;
                                        //if () item24.gr3 = item24.gr3 != 0 ? (1 + (int)item24.gr3) : 1;
                                        //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        //{
                                        //    item24.gr4 = item24.gr4 != 0 ? (1 + (int)item24.gr4) : 1;
                                        //}
                                        if (goal && group == notInstalledEnId) item24.gr5 = item24.gr5 != 0 ? (1 + (int)item24.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalledEnId) item24.gr6 = item24.gr6 != 0 ? (1 + (int)item24.gr6) : 1;
                                    }
                                }
                                //средства реабилитации
                                if (plant1 || plant2 || plant3 || plant4 || plant5 || plant6 || plant7 ||
                                    plant8 || plant9 || plant10 || plant11 || plant12 || plant13 || plant14 ||
                                    plant15 || plant16 || plant17 || plant18 || plant19 || plant20)
                                {
                                    item25.gr1 = item25.gr1 != 0 ? (1 + (int)item25.gr1) : 1;
                                    if (prReExam == primaryEnumId) item25.gr2 = item25.gr2 != 0 ? (1 + (int)item25.gr2) : 1;
                                    //if () item25.gr3 = item25.gr3 != 0 ? (1 + (int)item25.gr3) : 1;
                                    //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                    //{
                                    //    item25.gr4 = item25.gr4 != 0 ? (1 + (int)item25.gr4) : 1;
                                    //}
                                    if (goal && group == notInstalledEnId) item25.gr5 = item25.gr5 != 0 ? (1 + (int)item25.gr5) : 1;
                                    if (prReExam != primaryEnumId && group == notInstalledEnId) item25.gr6 = item25.gr6 != 0 ? (1 + (int)item25.gr6) : 1;

                                    if (plant1)
                                    {
                                        item26.gr1 = item26.gr1 != 0 ? (1 + (int)item26.gr1) : 1;
                                        if (prReExam == primaryEnumId) item26.gr2 = item26.gr2 != 0 ? (1 + (int)item26.gr2) : 1;
                                        //if () item26.gr3 = item26.gr3 != 0 ? (1 + (int)item26.gr3) : 1;
                                        //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        //{
                                        //    item26.gr4 = item26.gr4 != 0 ? (1 + (int)item26.gr4) : 1;
                                        //}
                                        if (goal && group == notInstalledEnId) item26.gr5 = item26.gr5 != 0 ? (1 + (int)item26.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalledEnId) item26.gr6 = item26.gr6 != 0 ? (1 + (int)item26.gr6) : 1;
                                    }
                                    if (plant3)
                                    {
                                        item27.gr1 = item27.gr1 != 0 ? (1 + (int)item27.gr1) : 1;
                                        if (prReExam == primaryEnumId) item27.gr2 = item27.gr2 != 0 ? (1 + (int)item27.gr2) : 1;
                                        //if () item27.gr3 = item27.gr3 != 0 ? (1 + (int)item27.gr3) : 1;
                                        //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        //{
                                        //    item27.gr4 = item27.gr4 != 0 ? (1 + (int)item27.gr4) : 1;
                                        //}
                                        if (goal && group == notInstalledEnId) item27.gr5 = item27.gr5 != 0 ? (1 + (int)item27.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalledEnId) item27.gr6 = item27.gr6 != 0 ? (1 + (int)item27.gr6) : 1;
                                    }
                                    if (plant4)
                                    {
                                        item28.gr1 = item28.gr1 != 0 ? (1 + (int)item28.gr1) : 1;
                                        if (prReExam == primaryEnumId) item28.gr2 = item28.gr2 != 0 ? (1 + (int)item28.gr2) : 1;
                                        ////if () item28.gr3 = item28.gr3 != 0 ? (1 + (int)item28.gr3) : 1;
                                        //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        //{
                                        //    item28.gr4 = item28.gr4 != 0 ? (1 + (int)item28.gr4) : 1;
                                        //}
                                        if (goal && group == notInstalledEnId) item28.gr5 = item28.gr5 != 0 ? (1 + (int)item28.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalledEnId) item28.gr6 = item28.gr6 != 0 ? (1 + (int)item28.gr6) : 1;
                                    }

                                    if (plant5)
                                    {
                                        item29.gr1 = item29.gr1 != 0 ? (1 + (int)item29.gr1) : 1;
                                        if (prReExam == primaryEnumId) item29.gr2 = item29.gr2 != 0 ? (1 + (int)item29.gr2) : 1;
                                        ////if () item29.gr3 = item29.gr3 != 0 ? (1 + (int)item29.gr3) : 1;
                                        //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        //{
                                        //    item29.gr4 = item29.gr4 != 0 ? (1 + (int)item29.gr4) : 1;
                                        //}
                                        if (goal && group == notInstalledEnId) item29.gr5 = item29.gr5 != 0 ? (1 + (int)item29.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalledEnId) item29.gr6 = item29.gr6 != 0 ? (1 + (int)item29.gr6) : 1;
                                    }

                                    if (plant7)
                                    {
                                        item30.gr1 = item30.gr1 != 0 ? (1 + (int)item30.gr1) : 1;
                                        if (prReExam == primaryEnumId) item30.gr2 = item30.gr2 != 0 ? (1 + (int)item30.gr2) : 1;
                                        ////if () item30.gr3 = item30.gr3 != 0 ? (1 + (int)item30.gr3) : 1;
                                        //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        //{
                                        //    item30.gr4 = item30.gr4 != 0 ? (1 + (int)item30.gr4) : 1;
                                        //}
                                        if (goal && group == notInstalledEnId) item30.gr5 = item30.gr5 != 0 ? (1 + (int)item30.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalledEnId) item30.gr6 = item30.gr6 != 0 ? (1 + (int)item30.gr6) : 1;
                                    }

                                    if (plant8)
                                    {
                                        item31.gr1 = item31.gr1 != 0 ? (1 + (int)item31.gr1) : 1;
                                        if (prReExam == primaryEnumId) item31.gr2 = item31.gr2 != 0 ? (1 + (int)item31.gr2) : 1;
                                        //if () item31.gr3 = item31.gr3 != 0 ? (1 + (int)item31.gr3) : 1;
                                        //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        //{
                                        //    item31.gr4 = item31.gr4 != 0 ? (1 + (int)item31.gr4) : 1;
                                        //}
                                        if (goal && group == notInstalledEnId) item31.gr5 = item31.gr5 != 0 ? (1 + (int)item31.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalledEnId) item31.gr6 = item31.gr6 != 0 ? (1 + (int)item31.gr6) : 1;
                                    }

                                    if (plant9)
                                    {
                                        item32.gr1 = item32.gr1 != 0 ? (1 + (int)item32.gr1) : 1;
                                        if (prReExam == primaryEnumId) item32.gr2 = item32.gr2 != 0 ? (1 + (int)item32.gr2) : 1;
                                        //if () item32.gr3 = item32.gr3 != 0 ? (1 + (int)item32.gr3) : 1;
                                        //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        //{
                                        //    item32.gr4 = item32.gr4 != 0 ? (1 + (int)item32.gr4) : 1;
                                        //}
                                        if (goal && group == notInstalledEnId) item32.gr5 = item32.gr5 != 0 ? (1 + (int)item32.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalledEnId) item32.gr6 = item32.gr6 != 0 ? (1 + (int)item32.gr6) : 1;
                                    }

                                    if (plant10)
                                    {
                                        item33.gr1 = item33.gr1 != 0 ? (1 + (int)item33.gr1) : 1;
                                        if (prReExam == primaryEnumId) item33.gr2 = item33.gr2 != 0 ? (1 + (int)item33.gr2) : 1;
                                        //if () item33.gr3 = item33.gr3 != 0 ? (1 + (int)item33.gr3) : 1;
                                        //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        //{
                                        //    item33.gr4 = item33.gr4 != 0 ? (1 + (int)item33.gr4) : 1;
                                        //}
                                        if (goal && group == notInstalledEnId) item33.gr5 = item33.gr5 != 0 ? (1 + (int)item33.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalledEnId) item33.gr6 = item33.gr6 != 0 ? (1 + (int)item33.gr6) : 1;
                                    }

                                    if (plant11)
                                    {
                                        item34.gr1 = item34.gr1 != 0 ? (1 + (int)item34.gr1) : 1;
                                        if (prReExam == primaryEnumId) item34.gr2 = item34.gr2 != 0 ? (1 + (int)item34.gr2) : 1;
                                        //if () item34.gr3 = item34.gr3 != 0 ? (1 + (int)item34.gr3) : 1;
                                        //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        //{
                                        //    item34.gr4 = item34.gr4 != 0 ? (1 + (int)item34.gr4) : 1;
                                        //}
                                        if (goal && group == notInstalledEnId) item34.gr5 = item34.gr5 != 0 ? (1 + (int)item34.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalledEnId) item34.gr6 = item34.gr6 != 0 ? (1 + (int)item34.gr6) : 1;
                                    }

                                    if (plant6)
                                    {
                                        item35.gr1 = item35.gr1 != 0 ? (1 + (int)item35.gr1) : 1;
                                        if (prReExam == primaryEnumId) item35.gr2 = item35.gr2 != 0 ? (1 + (int)item35.gr2) : 1;
                                        //if () item35.gr3 = item35.gr3 != 0 ? (1 + (int)item35.gr3) : 1;
                                        //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        //{
                                        //    item35.gr4 = item35.gr4 != 0 ? (1 + (int)item35.gr4) : 1;
                                        //}
                                        if (goal && group == notInstalledEnId) item35.gr5 = item35.gr5 != 0 ? (1 + (int)item35.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalledEnId) item35.gr6 = item35.gr6 != 0 ? (1 + (int)item35.gr6) : 1;
                                    }
                                    /*if (item36?????)
                                    {
                                        item36.gr1 = item36.gr1 != 0 ? (1 + (int)item36.gr1) : 1;
                                        if (prReExam == primaryEnumId) item36.gr2 = item36.gr2 != 0 ? (1 + (int)item36.gr2) : 1;
                                        //if () item36.gr3 = item36.gr3 != 0 ? (1 + (int)item36.gr3) : 1;
                                        if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        {
                                            item36.gr4 = item36.gr4 != 0 ? (1 + (int)item36.gr4) : 1;
                                        }
                                        if (goal && group == notInstalledEnId) item36.gr5 = item36.gr5 != 0 ? (1 + (int)item36.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalledEnId) item36.gr6 = item36.gr6 != 0 ? (1 + (int)item36.gr6) : 1;
                                    }*/

                                    /***/
                                    if (plant13 || plant14 || plant16 || plant17 || plant2 || plant12 || plant15)
                                    {
                                        item37.gr1 = item37.gr1 != 0 ? (1 + (int)item37.gr1) : 1;
                                        if (prReExam == primaryEnumId) item37.gr2 = item37.gr2 != 0 ? (1 + (int)item37.gr2) : 1;
                                        //if () item37.gr3 = item37.gr3 != 0 ? (1 + (int)item37.gr3) : 1;
                                        //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                        //{
                                        //    item37.gr4 = item37.gr4 != 0 ? (1 + (int)item37.gr4) : 1;
                                        //}
                                        if (goal && group == notInstalledEnId) item37.gr5 = item37.gr5 != 0 ? (1 + (int)item37.gr5) : 1;
                                        if (prReExam != primaryEnumId && group == notInstalledEnId) item37.gr6 = item37.gr6 != 0 ? (1 + (int)item37.gr6) : 1;

                                        if (plant13)
                                        {
                                            item38.gr1 = item38.gr1 != 0 ? (1 + (int)item38.gr1) : 1;
                                            if (prReExam == primaryEnumId) item38.gr2 = item38.gr2 != 0 ? (1 + (int)item38.gr2) : 1;
                                            //if () item38.gr3 = item38.gr3 != 0 ? (1 + (int)item38.gr3) : 1;
                                            //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                            //{
                                            //    item38.gr4 = item38.gr4 != 0 ? (1 + (int)item38.gr4) : 1;
                                            //}
                                            if (goal && group == notInstalledEnId) item38.gr5 = item38.gr5 != 0 ? (1 + (int)item38.gr5) : 1;
                                            if (prReExam != primaryEnumId && group == notInstalledEnId) item38.gr6 = item38.gr6 != 0 ? (1 + (int)item38.gr6) : 1;
                                        }

                                        if (plant14)
                                        {
                                            item39.gr1 = item39.gr1 != 0 ? (1 + (int)item39.gr1) : 1;
                                            if (prReExam == primaryEnumId) item39.gr2 = item39.gr2 != 0 ? (1 + (int)item39.gr2) : 1;
                                            //if () item39.gr3 = item39.gr3 != 0 ? (1 + (int)item39.gr3) : 1;
                                            //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                            //{
                                            //    item39.gr4 = item39.gr4 != 0 ? (1 + (int)item39.gr4) : 1;
                                            //}
                                            if (goal && group == notInstalledEnId) item39.gr5 = item39.gr5 != 0 ? (1 + (int)item39.gr5) : 1;
                                            if (prReExam != primaryEnumId && group == notInstalledEnId) item39.gr6 = item39.gr6 != 0 ? (1 + (int)item39.gr6) : 1;
                                        }

                                        if (plant16)
                                        {
                                            item40.gr1 = item40.gr1 != 0 ? (1 + (int)item40.gr1) : 1;
                                            if (prReExam == primaryEnumId) item40.gr2 = item40.gr2 != 0 ? (1 + (int)item40.gr2) : 1;
                                            //if () item40.gr3 = item40.gr3 != 0 ? (1 + (int)item40.gr3) : 1;
                                            //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                            //{
                                            //    item40.gr4 = item40.gr4 != 0 ? (1 + (int)item40.gr4) : 1;
                                            //}
                                            if (goal && group == notInstalledEnId) item40.gr5 = item40.gr5 != 0 ? (1 + (int)item40.gr5) : 1;
                                            if (prReExam != primaryEnumId && group == notInstalledEnId) item40.gr6 = item40.gr6 != 0 ? (1 + (int)item40.gr6) : 1;
                                        }

                                        if (plant17)
                                        {
                                            item41.gr1 = item41.gr1 != 0 ? (1 + (int)item41.gr1) : 1;
                                            if (prReExam == primaryEnumId) item41.gr2 = item41.gr2 != 0 ? (1 + (int)item41.gr2) : 1;
                                            //if () item41.gr3 = item41.gr3 != 0 ? (1 + (int)item41.gr3) : 1;
                                            //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                            //{
                                            //    item41.gr4 = item41.gr4 != 0 ? (1 + (int)item41.gr4) : 1;
                                            //}
                                            if (goal && group == notInstalledEnId) item41.gr5 = item41.gr5 != 0 ? (1 + (int)item41.gr5) : 1;
                                            if (prReExam != primaryEnumId && group == notInstalledEnId) item41.gr6 = item41.gr6 != 0 ? (1 + (int)item41.gr6) : 1;
                                        }

                                        if (plant2 || plant12 || plant15)
                                        {
                                            item42.gr1 = item42.gr1 != 0 ? (1 + (int)item42.gr1) : 1;
                                            if (prReExam == primaryEnumId) item42.gr2 = item42.gr2 != 0 ? (1 + (int)item42.gr2) : 1;
                                            //if () item42.gr3 = item42.gr3 != 0 ? (1 + (int)item42.gr3) : 1;
                                            //if (implement == implementedId1 || implement == implementedId2 || implement == implementedId3)
                                            //{
                                            //    item42.gr4 = item42.gr4 != 0 ? (1 + (int)item42.gr4) : 1;
                                            //}
                                            if (goal && group == notInstalledEnId) item42.gr5 = item42.gr5 != 0 ? (1 + (int)item42.gr5) : 1;
                                            if (prReExam != primaryEnumId && group == notInstalledEnId) item42.gr6 = item42.gr6 != 0 ? (1 + (int)item42.gr6) : 1;
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            static void RemoveRows(WorkflowContext context, Guid reportId)
            {
                var docRepo = context.Documents;
                var rows = new List<Guid>();
                var qb = new QueryBuilder(reportItemDefId, context.UserId);
                qb.Where("Report").Eq(reportId).Or("Report").IsNull();
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read()) rows.Add(reader.GetGuid(0));
                }
                foreach (var rowId in rows)
                {
                    docRepo.DeleteById(rowId);
                }
            }
            private static readonly Guid reportDefId = new Guid("{17789FEE-2908-4E01-8E16-2ECAF4A75C7A}"); //Отчет о распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности
            private static readonly Guid reportItemDefId = new Guid("{10AB1374-EA9C-493B-B5F6-CD6A40273B9B}"); //Распределение признанных ЛОВЗ по формам болезней, возрасту и группам инвалидности

            private static readonly Guid childStatCardDefId = new Guid("{363E89D0-5E31-45B5-82B7-42E83DF96E1F}"); //Статистический талон ребенка с ОВЗ
            private static readonly Guid childActDefId = new Guid("{0ECF44B6-2B2D-4687-B7B0-07BA5F942AC6}"); //Медицинский акт ребенка с ОВЗ
            private static readonly Guid personDefId = new Guid("{D71CE61A-9B59-4B5E-8713-8131DBB5BA02}"); //Person 
            public static readonly Guid districtDefId = new Guid("{A3FCA356-82A9-4BBD-872A-8333BEC6E41A}"); //Район
            public static readonly Guid cityDefId = new Guid("{4BB6D32D-5181-4031-BA49-CF5910D6D883}"); //Города районного значения

            public static readonly Guid goalForGroup = new Guid("{8FD84B27-FF2A-40A4-A87A-BC254DC9D853}"); //Цель -> Для установления группы


            public static readonly Guid childGroupEnId = new Guid("{D145ABA1-EADA-442B-9D8D-AD10BCD126D2}"); //Ребенок с ОВЗ
            public static readonly Guid notInstalledEnId = new Guid("{BEB4542B-0C03-494A-BD60-AA6BA8E8BF4C}"); //Не установлена

            public static readonly Guid cityEnumId = new Guid("{DE3D24A1-64D3-4647-B711-31F334D24416}"); //Городская местность//DistrictType
            public static readonly Guid villageEnumId = new Guid("{65DF9C4D-A18B-4080-855F-4800E2A19C35}"); //Cская местность//DistrictType
            public static readonly Guid womanEnumId = new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"); //Женский пол
            public static readonly Guid primaryEnumId = new Guid("{34129BC5-5B31-4189-87FA-799402F7E99F}"); //Первичное
            public static readonly Guid ApprovedStateId = new Guid("{32062CB7-C31C-4AFB-ADF3-F9F9AEEFCE59}");  //Подписанные

            //фактическое исполнение
            public static readonly Guid implementedId1 = new Guid("{49162394-ABE3-496A-A1B5-823566283AE4}"); //Выполнено
            public static readonly Guid implementedId2 = new Guid("{B7CE10F4-F53E-4465-A954-2B89BFF77F74}"); //Не выполнено
            public static readonly Guid implementedId3 = new Guid("{CD12709D-6AFC-491A-9D70-D298246476D3}"); //Частично

            public static readonly Guid recom7EnId1 = new Guid("{D8484FAB-4F51-4003-AFD8-A0A5E364D8EB}"); //Образовательное учреждение общего назначения 
            public static readonly Guid recom7EnId2 = new Guid("{95038B6D-062A-457F-9DE9-089C4BA582FF}"); //Специальное (коррекционное) образовательное учреждение для обучающихся, воспитанников с отклонениями в развитиии
            public static readonly Guid recom8EnId1 = new Guid("{E1AFB86F-3A5D-4BB9-8FEF-A9EB6E8E4C66}"); //В дошкольных образовательных учреждениях общего назначения
            public static readonly Guid recom10EnId1 = new Guid("{E61F2E04-0097-4609-98E1-3B3D95A25A8F}"); //В условиях производства
            public static readonly Guid recom10EnId2 = new Guid("{1E5508BA-AF0C-4B12-BA06-B3F98FAB9F82}"); //В профессионально-технических учреждениях системы образования
            public static readonly Guid recom10EnId3 = new Guid("{E2F8330E-D94F-4C5A-B6B9-56C42213BCE1}"); //В профессионально-технических учреждениях системы органов социальной защиты
            public static readonly Guid recom10EnId4 = new Guid("{8F188272-E396-4146-BDFE-8247D364AE56}"); //В высших учебных заведениях
            public static readonly Guid recom11EnId1 = new Guid("{69A06341-A672-4A36-A8DC-80232DA07CA7}"); //В обычных условиях производства
            public static readonly Guid recom11EnId2 = new Guid("{76E28619-A4B2-49D0-AABF-CC33A407C505}"); //В специально созданных условиях труда
            public static readonly Guid recom11EnId3 = new Guid("{A4294DC8-A46B-4CAF-BC3C-E5FB4DC414C8}"); //На дому
            
            //причины инвалидности
            private static readonly Guid reasonDisEnumdId1 = new Guid("{3A8053A5-CD06-49D3-A551-2247655B13C3}"); //	Общее заболевание
            private static readonly Guid reasonDisEnumdId2 = new Guid("{9AF55221-0264-4349-9B36-A8E1313250B6}"); //	ЛОВЗ с детства
            private static readonly Guid reasonDisEnumdId3 = new Guid("{2E3209F0-0002-4DA2-9E63-6FAEDDF1983D}"); //	Трудовое увечье
            private static readonly Guid reasonDisEnumdId4 = new Guid("{383E70E5-E9BE-4AE5-B5DF-323D4463DD51}"); //	Профессиональное заболевание
            private static readonly Guid reasonDisEnumdId5 = new Guid("{0CD8E76E-CF20-41CF-B7EE-4FE85EA39435}"); //	Военная травма (если увечье, заболевание получено лицом, проходящим освидетельствование, при "исполнении обязанностей военной службы")
            private static readonly Guid reasonDisEnumdId6 = new Guid("{4A8BC253-701C-44FB-B840-10F6BD8E97BD}"); //	Заболевание "получено в период прохождения военной службы"
            private static readonly Guid reasonDisEnumdId7 = new Guid("{1A607F61-EDDD-4A7B-9FBF-55483127D986}"); //	Заболевание "нет, не связано с военной службой"
            private static readonly Guid reasonDisEnumdId8 = new Guid("{41313E17-2275-4027-9563-5323FF096E3F}"); //	Заболевание "да, получено в период прохождения службы" в органах внутренних дел
            private static readonly Guid reasonDisEnumdId9 = new Guid("{68E6804C-046A-45AD-9AD8-1C50C4026530}"); //	Заболевание "нет, не связано со службой в органах внутренних дел"
            private static readonly Guid reasonDisEnumdId10 = new Guid("{8AA8807E-A40A-44D2-839C-5270E9F2C52C}"); // Ранение (контузия, травма, увечье) "нет, не связано с военной службой"
            private static readonly Guid reasonDisEnumdId11 = new Guid("{04F87DB6-EBB7-4B09-8856-F7DFF538479E}"); //	Ранение (контузия, травма, увечье) "да, получено при защите СССР"
            private static readonly Guid reasonDisEnumdId12 = new Guid("{119DC79B-42D0-4102-AE42-A902A4EF806B}"); // Ранение (контузия, травма, увечье) "да, получено при исполнении обязанностей службы в органах внутренних дел"
            private static readonly Guid reasonDisEnumdId13 = new Guid("{A6EABF70-F864-4A97-B528-839DE6607B07}"); // Заболевание связано с катастрофой на ЧАЭС
            private static readonly Guid reasonDisEnumdId14 = new Guid("{9FB37C19-2251-41FD-ABAA-7E3CD243CCDF}"); // Заболевание связано с испытанием ядерного оружия на Семипалатинском полигоне
            private static readonly Guid reasonDisEnumdId15 = new Guid("{1A2B628F-CC8C-49C9-8774-561EB1812AE5}"); // Травма, полученная в событиях, произошедших 6 апреля 2010 года в Таласской области КР
            private static readonly Guid reasonDisEnumdId16 = new Guid("{6FF1C743-3767-4D73-A035-1F8647C88F5F}"); // Травма, полученная в событиях, произошедших 7 апреля 2010 года в городе Бишкек КР
            private static readonly Guid reasonDisEnumdId17 = new Guid("{9289772B-C917-4EC0-BC60-45D69BA8D855}"); // Травма, полученная в событиях, произошедших 13-14, а также 19 мая 2010 года в городе Джалал-Абад КР
            private static readonly Guid reasonDisEnumdId18 = new Guid("{99159F4A-BB7C-4A5C-AD48-B71E7592DF08}"); // Травма, полученная в июньских событиях 2010 года в городе Ош и Ошской, Джалал-Абадской областях КР
        }
        
        //МОДУЛЬ БРРП        
        //Сведения о численности получателей, среднем размере и выплаченной сумме пособий по БР по состоянию
        public static class CalBenefitReportsByRegionsBR
        {
            private static readonly Guid reportDefId = new Guid("{F3269C26-5380-43D4-873C-BF9B54318770}"); //  Заявка на выплату
            private static readonly Guid reportItemDefId = new Guid("{32AEB528-1226-478D-B451-1301E01284D5}"); //Наименование столбцов заявки на выплату 
            private static readonly Guid birthBenefitDefId = new Guid("{46C27FED-B9E0-4DAA-9DD4-F984A526D9B5}"); //Сведения о расходах по выплате пособий по беременности и родам
            private static readonly Guid personDefId = new Guid("{D71CE61A-9B59-4B5E-8713-8131DBB5BA02}"); //ФИО получателей пособий по беременности и родом
            private static readonly Guid femaleEnId = new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"); //Женский
            private static readonly Guid maleEnId = new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"); //Мужской

            private static readonly Guid appPregBenefitDefId = new Guid("{379C813C-E5AF-4ACF-9D4D-7FF8AF40AEAE}"); //Заявление на назначение пособия по беременности и родом
            private static readonly Guid legalReportDefId = new Guid("{EC14A952-D4D8-4EA8-90F5-50121CC4B173}"); //Разделы отчетов для юридического лица
            private static readonly Guid orgPofileDefId = new Guid("{BB23529B-072D-4E85-87D4-337473458EC2}"); //Профиль организации
            private static readonly Guid approvedStateId = new Guid("{9A1F1E23-1E8B-4830-AD99-1D0AB3272564}");  //утвержден
            public static List<Guid> bishkekList = new List<Guid>//г.Бишкек              
            {                                                            
                //  new Guid("{E59E153E-4FE9-4872-BBD0-9E183793EFEF}"),            
                new Guid("{D4C5884F-1820-4DF5-9BF8-C48202ACB801}"),//первомайский                          
                new Guid("{20FF5245-DB58-443A-A31B-061200E939AA}"),//октябрь                 
                new Guid("{52315837-1B8F-4B80-9D8C-160214F4681A}"),//свердлово               
                new Guid("{E3BFB034-7638-4C14-8C0F-EA823CCA7A5B}")//ленин                                      
            };
            public static List<Guid> chuiList = new List<Guid>//Чуйская область
            {                                                                                            
                // new Guid("{41E34648-6C9D-44D0-8CA5-941DB051B163}"),
                new Guid("{30658F5A-DC22-4A7A-AAF6-63DFB7070C50}"),//чуй
                new Guid("{DC2174B4-479B-4F6F-9A9D-9BA28AB715CD}"),//аламудун
                new Guid("{7866D332-C471-4873-8F8B-6DA9EDC3683A}"),//ыссык-ата           
                new Guid("{C8641D03-B553-4F95-ADFB-EC002FD64E06}"),//москва
                new Guid("{19F7870D-4B5E-457A-B159-528F71374E1E}"),//жайыл                             
                new Guid("{093AFB08-3F18-4E5C-8EB6-86EF0DD711B9}"),//сокулук
                new Guid("{668D6957-1F76-49DE-B9AD-0F2C635DF2DD}"),//кемин                                    
                new Guid("{8B6510F7-3B6B-4C9D-B8A1-2349B78B2CF3}"),//город токмок
                new Guid("{5DF10BBC-D256-40F8-B641-5EF31CE11540}")//панфилов                                 
            };
            public static List<Guid> issyk_kulList = new List<Guid>//Иссык-Кульская область
            {
                // new Guid("{AD009808-FBAC-43CA-8671-5E790C213497}"),
                new Guid("{23DB562E-C0B7-4B7E-AC16-967C96500444}"),//балыкчы
                new Guid("{3277F73D-B02D-4F35-AD1A-80B349EECF6B}"),//тон
                new Guid("{C748CDB5-502A-4243-8494-48E224968019}"),//тюп                                                                         
                new Guid("{046FF80D-4D26-4E30-A41F-17873C0E2C8F}"),//жети-огуз  
                new Guid("{14EB7AEF-C331-4085-A83E-0F5EEBF2EAA3}"),//иссык-куль                                 
                new Guid("{1F892B98-97B4-4B58-B61F-7DFECBAC3B5E}"),//ак-суу
                new Guid("{AB27C82D-8348-4DBA-BA9C-CEAE3A67704E}")//каракол
            };
            public static List<Guid> narynList = new List<Guid>//Нарынская область
            {                                                                                
                // new Guid("{CF4CA271-9202-4A5A-AE49-EB6237C33982}"),
                new Guid("{51C381F2-6AD6-4382-81F9-3D36E9ABEA08}"),//кочкор
                new Guid("{4313A514-83B6-4FED-9731-4D838A6E91CD}"),//нарын район
                new Guid("{93DF61DD-A2FE-4F52-B961-F1B27BD27A8C}"),//нарын г
                new Guid("{B3C93041-BBEA-445D-B7E1-D42D9F3692C3}"),//акталаа
                new Guid("{B3EA3DE1-5D76-461C-90AC-68D312B7B665}"),//жумгал
                new Guid("{69EAAC3D-3525-4CE3-8C5E-42123B4ED9CB}")//ат-баши
            };
            public static List<Guid> talasList = new List<Guid>//Таласская область
            {
                //new Guid("{BC710978-8C0B-4063-8BA9-A12F75DE4829}"),
                new Guid("{C6D92271-6FF2-4641-A83F-D02610060C43}"),//кара-буура  
                new Guid("{3BB3CB8F-A747-4026-9031-C6B67EA9735B}"),//г талас
                new Guid("{16FD5BFF-7AB4-4B40-AAFB-0282BA5BE32E}"),//талас рн
                new Guid("{B8DACAD8-0118-4147-8BD2-30DCE891E5EB}"),//манас
                new Guid("{7F311898-D254-4668-8184-D1794E695A19}")//бакай-ата
            };
            public static List<Guid> jalal_abad = new List<Guid>//Джалал-Абадская область
            {
                // new Guid("{3ED50EFB-3E20-407C-93CB-9D8E0EF15B1B}"),
                new Guid("{18DBE2BE-BBB6-4BC2-9A33-8B25856C0382}"),//г джалалабад
                new Guid("{E4964796-6658-46A9-BD49-A34B3275CB1F}"),//ноокен
                new Guid("{DC448CE3-49F4-43F1-AEAA-F782341C62C0}"),//сузак
                new Guid("{AA65C2F7-3091-40E5-939D-6A18250E125A}"),//каракуль
                new Guid("{9D8B0CA0-D618-4157-AF15-5E7CCA7D9F23}"),//ташкумыр
                new Guid("{64ECD259-A848-474B-8E8D-571612A7E43B}"),//токтогул рн
                new Guid("{17F5601A-36B7-4FAC-A980-07F349239D5B}"),//базар-коргон
                new Guid("{9AFA2870-4609-4D8A-8417-11C2DBDEC94B}"),//майлысуу
                new Guid("{B42B4F13-2AA5-43D2-B738-CB02CA647D47}"),//кок-жангак
                new Guid("{B0A96501-F5F4-48A4-8103-6C7A7BA290C4}"),//тогуз-торо
                new Guid("{60F22545-CB84-4795-81A3-2EEEEB0FB88A}"),//ала-бука
                new Guid("{2765827A-88EF-4144-8050-9A2FD66FB136}"),//аксы
                new Guid("{A598BEA0-37C9-4DC2-9BC7-FB3AA1097E14}")//чаткал
            };
            public static List<Guid> oshList = new List<Guid>//Ошская область
            {
                // new Guid("{E01E9890-2A41-454E-9EC1-3D4AAF50ED62}"),
                new Guid("{8B739BFD-CF8F-4380-A246-8A34BCE9A231}"),//ош
                new Guid("{B382A964-BBD7-4540-B6E4-BC9250AB7005}"),//араван
                new Guid("{A3282FFC-BAFE-4B4E-99D0-C68509BE6133}"),//ноокат
                new Guid("{E5411CDD-3CAF-4798-A7BF-FD57C856C82B}"),//алай
                new Guid("{59FF6F9C-F047-4E25-B837-669AA0596B07}"),//кара-суу
                new Guid("{C1A54A26-CA15-4C29-8DEB-957F5B0FD002}"),//чон-алай
                new Guid("{E425497A-3C82-424E-9691-71EAAD4759D8}"),//узген рн
                new Guid("{D62E0B83-E589-491D-B0A4-8BEA42178231}"),//узген г
                new Guid("{A2317371-CC1D-4EB3-8ADF-D7BA33B75F87}")//каракулджа
            };
            public static List<Guid> batkenList = new List<Guid>//Баткенская область
            {
                //new Guid("{4E98AD82-8ED4-4727-8E24-678921AB534C}"),
                new Guid("{C7B6AA81-A4B7-4AD6-BE03-E4B54E8084DA}"),//лейлек
                new Guid("{5EE1AC59-52A1-45E3-84EC-54AD09FC9F1E}"),//баткен рн
                new Guid("{D328865B-EDE4-4674-92C6-C134F55C3C6F}"),//баткен г
                new Guid("{879F3420-E45A-4E11-9394-D0B1A0091805}"),//кадамжай
                new Guid("{32AF3EA3-4100-406F-8825-20CB8A1877AA}"),//кызыл-кия
                new Guid("{FF3B071C-FC51-4F64-8BD4-11A5377E93D2}")//сулюкта                                               
            };
            public static List<Guid> osh = new List<Guid>
            {
                new Guid ("{A99E469A-E8D4-4139-B89A-CE4AF6AA0733}")
            };
            public static List<ReportBR1Item> Execute(WorkflowContext context, DateTime fd, DateTime ld)
            {
                //var items = new List<ReportBR1Item>();
                return CalcItems(context, fd, ld);
            }             
            public static List<ReportBR1Item> CalcItems(WorkflowContext context, DateTime fd, DateTime ld)
            {
                var items = new List<ReportBR1Item>();
                var qb = new QueryBuilder(appPregBenefitDefId, context.UserId);
                qb.Where("RegDate").Ge(fd).And("RegDate").Le(ld).And("&State").Eq(approvedStateId);

                var query = context.CreateSqlQuery(qb.Def); //беременность роды - юр. лицо
                var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                var orgProfileSrc = query.JoinSource(query.Source, orgPofileDefId, SqlSourceJoinType.LeftOuter, "OrgProfile");

                query.AddAttribute(query.Source, "&Id");
                query.AddAttribute(personSrc, "Gender");
                query.AddAttribute(query.Source, "Citizenship");
                query.AddAttribute(query.Source, "AssignedAmountRepublicBudgetBR"); //За счет республиканского бюджета (сом)
                query.AddAttribute(query.Source, "&OrgId");

                var table = new DataTable();
                using (var reader = context.CreateSqlReader(query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    var gender = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                    var nation = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                    decimal repbudjet = row[3] is DBNull ? 0m : (decimal)row[3];
                    var orgId = row[4] is DBNull ? Guid.Empty : (Guid)row[4];

                    if (orgId == Guid.Empty) continue;
                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);
                   
                    if (appId != Guid.Empty)
                    {
                        rayon.gr3 += 1;
                        if (gender == femaleEnId) rayon.gr4 += 1;
                        if (gender == maleEnId) rayon.gr5 += 1;
                        if (nation != Guid.Empty)
                        {
                            rayon.gr6 += 1;
                            if (nation.Equals(new Guid("{D159B901-DD6F-4564-8397-F37830FE82B5}"))) rayon.gr7_1 += 1;
                            if (nation.Equals(new Guid("{A7BEED6D-35CA-4507-A413-D9060D02E224}"))) rayon.gr7_2 += 1;
                            if (nation.Equals(new Guid("{681AED4D-4D6D-4429-94FA-FC4AE2B72465}"))) rayon.gr7_3 += 1;
                            if (nation.Equals(new Guid("{54D8D699-6D32-456F-A76D-8FA84AF6FFAD}"))) rayon.gr7_4 += 1;
                            if (nation.Equals(new Guid("{D6E80CC1-D738-44B9-9BA8-9E16532EBBC5}"))) rayon.gr7_5 += 1;
                            if (nation.Equals(new Guid("{8E017A65-D826-4D4A-B42B-4CA957503310}"))) rayon.gr7_6 += 1;
                        }
                                
                        if (repbudjet != 0) rayon.gr8 = ((decimal?)rayon.gr8 ?? 0m) + repbudjet;
                        if (rayon.gr8 != 0) rayon.gr9 = rayon.gr6 / rayon.gr8;
                    }
                } 
                //Заявление на назначение пособия по беременности и родом
                var qbL = new QueryBuilder(birthBenefitDefId, context.UserId);
                qbL.Where("LegalReportSection").Include("ReportDate").Ge(fd).And("ReportDate").Le(ld).And("&State").Eq(approvedStateId).End();

                var queryL = context.CreateSqlQuery(qbL.Def); //беременность роды - юр. лицо
                personSrc = queryL.JoinSource(queryL.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                var legalSrc = queryL.JoinSource(queryL.Source, legalReportDefId, SqlSourceJoinType.Inner, "LegalReportSection");
                var orgProfSrcL = queryL.JoinSource(legalSrc, orgPofileDefId, SqlSourceJoinType.Inner, "OrgProfile");

                queryL.AddAttribute(queryL.Source, "&Id");
                queryL.AddAttribute(personSrc, "Gender");
                queryL.AddAttribute(queryL.Source, "Nationality");
                queryL.AddAttribute(queryL.Source, "BirthCadThrowRepublicBudget"); //За счет республиканского бюджета (сом)
                queryL.AddAttribute(queryL.Source, "&OrgId");
                
                var tableL = new DataTable();
                using (var readerL = context.CreateSqlReader(queryL))
                {
                    readerL.Open();
                    readerL.Fill(tableL);
                    readerL.Close();
                }
                foreach (DataRow row in tableL.Rows)
                {
                    var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    var gender = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                    var nation = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                    decimal repbudjet = row[3] is DBNull ? 0m : (decimal)row[3];
                    var orgId = row[4] is DBNull ? Guid.Empty : (Guid)row[4];

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);
                    if (appId != Guid.Empty)
                    {
                        rayon.gr3 += 1;
                        if (gender == femaleEnId) rayon.gr4 += 1;
                        if (gender == maleEnId) rayon.gr5 += 1;
                        if (nation != Guid.Empty)
                        {
                            rayon.gr6 += 1;
                            if (nation.Equals(new Guid("{D159B901-DD6F-4564-8397-F37830FE82B5}"))) rayon.gr7_1 += 1;
                            if (nation.Equals(new Guid("{A7BEED6D-35CA-4507-A413-D9060D02E224}"))) rayon.gr7_2 += 1;
                            if (nation.Equals(new Guid("{681AED4D-4D6D-4429-94FA-FC4AE2B72465}"))) rayon.gr7_3 += 1;
                            if (nation.Equals(new Guid("{54D8D699-6D32-456F-A76D-8FA84AF6FFAD}"))) rayon.gr7_4 += 1;
                            if (nation.Equals(new Guid("{D6E80CC1-D738-44B9-9BA8-9E16532EBBC5}"))) rayon.gr7_5 += 1;
                            if (nation.Equals(new Guid("{8E017A65-D826-4D4A-B42B-4CA957503310}"))) rayon.gr7_6 += 1;
                        }
                        if (repbudjet != 0) rayon.gr8 = ((decimal?)rayon.gr8 ?? 0m) + repbudjet;
                        if(rayon.gr8 != 0) rayon.gr9 = rayon.gr6 / rayon.gr8;
                    }
                }
                // RegionReportItem regionReportItem = new RegionReportItem();
                foreach (var subItem in items)
                {
                    if (bishkekList.Contains(subItem.GetOrgId())) subItem.RegionName = "г.Бишкек";
                    //regionReportItem.BishkekCityRegion.Add(subItem);
                    if (chuiList.Contains(subItem.GetOrgId())) subItem.RegionName = "Чуйская область";
                    //regionReportItem.ChuyRegion.Add(subItem);
                    if (talasList.Contains(subItem.GetOrgId())) subItem.RegionName = "Таласская область";
                    //regionReportItem.TalasRegion.Add(subItem);
                    if (issyk_kulList.Contains(subItem.GetOrgId())) subItem.RegionName = "Иссык-Кульская область";
                    //regionReportItem.YssykKolRegion.Add(subItem);
                    if (narynList.Contains(subItem.GetOrgId())) subItem.RegionName = "Нарынская область";
                    //regionReportItem.NarynRegion.Add(subItem);
                    if (batkenList.Contains(subItem.GetOrgId())) subItem.RegionName = "Баткенская область";
                    //regionReportItem.BatkenRegion.Add(subItem);
                    if (oshList.Contains(subItem.GetOrgId())) subItem.RegionName = "Ошская область";
                    //regionReportItem.OshRegion.Add(subItem);
                    if (osh.Contains(subItem.GetOrgId())) subItem.RegionName = "г.Ош";
                    //regionReportItem.OshCityRegion.Add(subItem);
                    if (jalal_abad.Contains(subItem.GetOrgId())) subItem.RegionName = "Джалал-Абадская область";
                    //regionReportItem.JalalAbadRegion.Add(subItem);
                }
                return items;
            }
            //[DataContract]
            public class RegionReportItem
            {
                public RegionReportItem()
                {
                    ChuyRegion = new List<ReportBR1Item>();
                    YssykKolRegion = new List<ReportBR1Item>();
                    NarynRegion = new List<ReportBR1Item>();
                    TalasRegion = new List<ReportBR1Item>();
                    OshRegion = new List<ReportBR1Item>();
                    JalalAbadRegion = new List<ReportBR1Item>();
                    BatkenRegion = new List<ReportBR1Item>();
                    BishkekCityRegion = new List<ReportBR1Item>();
                    OshCityRegion = new List<ReportBR1Item>();
                }
                public List<ReportBR1Item> ChuyRegion { get; set; }
                public List<ReportBR1Item> YssykKolRegion { get; set; }
                public List<ReportBR1Item> NarynRegion { get; set; }
                public List<ReportBR1Item> TalasRegion { get; set; }
                public List<ReportBR1Item> OshRegion { get; set; }
                public List<ReportBR1Item> JalalAbadRegion { get; set; }
                public List<ReportBR1Item> BatkenRegion { get; set; }
                public List<ReportBR1Item> BishkekCityRegion { get; set; }
                public List<ReportBR1Item> OshCityRegion { get; set; }
            }
            static ReportBR1Item GetReportItem(List<ReportBR1Item> items, string orgName, Guid orgId)
            {
                var item = items.FirstOrDefault(x => x.OrgName == orgName);
                if (item != null) return item;
                item = new ReportBR1Item(orgId)
                {
                    OrgName = orgName,
                };
                items.Add(item);
                return item;
            }
        }
        //Сведения о численности получателей пособия по БР по категориям получателей
        public static class CalBenefitReportsBR
        {
            public static List<ReportBR2Item> Execute(WorkflowContext context, DateTime fd, DateTime ld)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;

                var docs = new string[]
                {
                    "Лица, работающие в предприятиях, организациях и учреждениях (на основании трудового договора или приказа работодателя)",
                    "из них: в бюджетных организациях",
                    "в не бюджетных организациях",
                    "коммерческих организациях",
                    "Лица, занимающиеся предпринимательской деятельностью без образования юридического лица (на основе патента или свидетельства ГНС или НСК)",
                    "Члены крестьянских (фермерских) хозяйств без образования юридического лица",
                    "Официальные безработные с правом на пособие по безработице"
                };
                var items = new List<ReportBR2Item>();
                int i2 = 1;
                foreach (var i in docs)
                {
                    var item = new ReportBR2Item();
                    item.rowName = i;
                    item.rowNo = i2;
                    i2++;
                    items.Add(item);
                }
                CalcItems(context, /*report*/ fd, ld, orgId, items[6], items[5], items[4], items[3], items[2], items[1], items[0]);
                return items;
            }
            public static void CalcItems(WorkflowContext context, DateTime fd, DateTime ld, Guid orgId, ReportBR2Item item6, ReportBR2Item item5, ReportBR2Item item4, ReportBR2Item item3, ReportBR2Item item2, ReportBR2Item item1, ReportBR2Item item0)
            {
                var qb = new QueryBuilder(legalPregDefId, context.UserId);
                qb.Where("LegalReportSection").Include("ReportDate").Ge(fd).And("ReportDate").Le(ld).And("&State").Eq(approvedStateId).End();

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                    var legalSrc = query.JoinSource(query.Source, legalSectionDefId, SqlSourceJoinType.Inner, "LegalReportSection");

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(legalSrc, "OrgState");
                    query.AddAttribute(personSrc, "Gender");
                    query.AddAttribute(query.Source, "BirthCadThrowRepublicBudget");
                    query.AddAttribute(legalSrc, "RegCoefficient");
                    query.AddAttribute(query.Source, "Repeated");

                    var table = new DataTable();
                    using (var reader = context.CreateSqlReader(query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var orgState = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                        var gender = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                        decimal repbudjet = row[3] is DBNull ? 0m: (decimal)row[3];
                        var coef = row[4] is DBNull ? false : (bool)row[4];
                        var reExam = row[5] is DBNull ? false : (bool)row[5];

                        if (appId != Guid.Empty)
                        {
                            item0.gr3 = item0.gr3 != 0 ? (1 + (int)item0.gr3) : 1;
                            if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item0.gr4 += 1;
                            if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item0.gr5 += 1;
                            if (repbudjet != 0)
                            {
                                item0.gr6 = ((decimal?)item0.gr6 ?? 0m) + repbudjet;
                                item0.gr7 = item0.gr6 / item0.gr3;
                            }
                            if (coef)
                            {
                                item0.gr8 = item0.gr8 != 0 ? (1 + (int)item0.gr8) : 1;
                                if (repbudjet != 0) item0.gr9 = ((decimal?)item0.gr9 ?? 0m) + repbudjet;
                                item0.gr10 = item0.gr9 / item0.gr8;
                                if (reExam)
                                {
                                    item0.gr11 = item0.gr11 != 0 ? (1 + (int)item0.gr11) : 1;
                                    if (repbudjet != 0) item0.gr12 = ((decimal?)item0.gr12 ?? 0m) + repbudjet;
                                    item0.gr13 = item0.gr12 / item0.gr11;
                                }
                            }
                            else
                            {
                                item0.gr14 = item0.gr14 != 0 ? (1 + (int)item0.gr14) : 1;
                                if (repbudjet != 0) item0.gr15 = ((decimal?)item0.gr15 ?? 0m) + repbudjet;
                                item0.gr16 = item0.gr15 / item0.gr14;
                                if (reExam)
                                {
                                    item0.gr17 = item0.gr17 != 0 ? (1 + (int)item0.gr17) : 1;
                                    if (repbudjet != 0) item0.gr18 = ((decimal?)item0.gr18 ?? 0m) + repbudjet;
                                    item0.gr19 = item0.gr18 / item0.gr17;
                                }
                            }
                            //в бюджетных организациях
                            if (orgState.Equals(new Guid("{2E75D2D7-9337-4C30-AD6E-0F325B1B80DA}")))
                            {
                                item1.gr3 = item1.gr3 != 0 ? (1 + (int)item1.gr3) : 1;
                                if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item1.gr4 += 1;
                                if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item1.gr5 += 1;
                                if (repbudjet != 0)
                                {
                                    item1.gr6 = ((decimal?)item1.gr6 ?? 0m) + repbudjet;
                                    item1.gr7 = item1.gr6 / item1.gr3;
                                }
                                if (coef)
                                {
                                    item1.gr8 = item1.gr8 != 0 ? (1 + (int)item1.gr8) : 1;
                                    if (repbudjet != 0) item1.gr9 = ((decimal?)item1.gr9 ?? 0m) + repbudjet;
                                    item1.gr10 = item1.gr9 / item1.gr8;
                                    if (reExam)
                                    {
                                        item1.gr11 = item1.gr11 != 0 ? (1 + (int)item1.gr11) : 1;
                                        if (repbudjet != 0) item1.gr12 = ((decimal?)item1.gr12 ?? 0m) + repbudjet;
                                        item1.gr13 = item1.gr12 / item1.gr11;
                                    }
                                }
                                else
                                {
                                    item1.gr14 = item1.gr14 != 0 ? (1 + (int)item1.gr14) : 1;
                                    if (repbudjet != 0) item1.gr15 = ((decimal?)item1.gr15 ?? 0m) + repbudjet;
                                    item1.gr16 = item1.gr15 / item1.gr14;
                                    if (reExam)
                                    {
                                        item1.gr17 = item1.gr17 != 0 ? (1 + (int)item1.gr17) : 1;
                                        if (repbudjet != 0) item1.gr18 = ((decimal?)item1.gr18 ?? 0m) + repbudjet;
                                        item1.gr19 = item1.gr18 / item1.gr17;
                                    }
                                }
                            }
                            //в не бюджетных организациях
                            if (orgState.Equals(new Guid("{92AE6357-07CF-4E7B-ADF2-7573B2FE2228}")))
                            {
                                item2.gr3 = item2.gr3 != 0 ? (1 + (int)item2.gr3) : 1;
                                if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item2.gr4 += 1;
                                if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item2.gr5 += 1;
                                if (repbudjet != 0)
                                {
                                    item2.gr6 = ((decimal?)item2.gr6 ?? 0m) + repbudjet;
                                    item2.gr7 = item2.gr6 / item2.gr3;
                                }
                                if (coef)
                                {
                                    item2.gr8 = item2.gr8 != 0 ? (1 + (int)item2.gr8) : 1;
                                    if (repbudjet != 0) item2.gr9 = ((decimal?)item2.gr9 ?? 0m) + repbudjet;
                                    item2.gr10 = item2.gr9 / item2.gr8;
                                    if (reExam)
                                    {
                                        item2.gr11 = item2.gr11 != 0 ? (1 + (int)item2.gr11) : 1;
                                        if (repbudjet != 0) item2.gr12 = ((decimal?)item2.gr12 ?? 0m) + repbudjet;
                                        item2.gr13 = item2.gr12 / item2.gr11;
                                    }
                                }
                                else
                                {
                                    item2.gr14 = item2.gr14 != 0 ? (1 + (int)item2.gr14) : 1;
                                    if (repbudjet != 0) item2.gr15 = ((decimal?)item2.gr15 ?? 0m) + repbudjet;
                                    item2.gr16 = item2.gr15 / item2.gr14;
                                    if (reExam)
                                    {
                                        item2.gr17 = item2.gr17 != 0 ? (1 + (int)item2.gr17) : 1;
                                        if (repbudjet != 0) item2.gr18 = ((decimal?)item2.gr18 ?? 0m) + repbudjet;
                                        item2.gr19 = item2.gr18 / item2.gr17;
                                    }
                                }
                            }
                            //коммерческих организациях
                            if (orgState.Equals(new Guid("{41515AB6-8D53-425C-8642-9713BA2779D4}")))
                            {
                                item3.gr3 = item3.gr3 != 0 ? (1 + (int)item3.gr3) : 1;
                                if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item3.gr4 += 1;
                                if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item3.gr5 += 1;
                                if (repbudjet != 0)
                                {
                                    item3.gr6 = ((decimal?)item3.gr6 ?? 0m) + repbudjet;
                                    item3.gr7 = item3.gr6 / item3.gr3;
                                }
                                if (coef)
                                {
                                    item3.gr8 = item3.gr8 != 0 ? (1 + (int)item3.gr8) : 1;
                                    if (repbudjet != 0) item3.gr9 = ((decimal?)item3.gr9 ?? 0m) + repbudjet;
                                    item3.gr10 = item3.gr9 / item3.gr8;
                                    if (reExam)
                                    {
                                        item3.gr11 = item3.gr11 != 0 ? (1 + (int)item3.gr11) : 1;
                                        if (repbudjet != 0) item3.gr12 = ((decimal?)item3.gr12 ?? 0m) + repbudjet;
                                        item3.gr13 = item3.gr12 / item3.gr11;
                                    }
                                }
                                else
                                {
                                    item3.gr14 = item3.gr14 != 0 ? (1 + (int)item3.gr14) : 1;
                                    if (repbudjet != 0) item3.gr15 = ((decimal?)item3.gr15 ?? 0m) + repbudjet;
                                    item3.gr16 = item3.gr15 / item3.gr14;
                                    if (reExam)
                                    {
                                        item3.gr17 = item3.gr17 != 0 ? (1 + (int)item3.gr17) : 1;
                                        if (repbudjet != 0) item3.gr18 = ((decimal?)item3.gr18 ?? 0m) + repbudjet;
                                        item3.gr19 = item3.gr18 / item3.gr17;
                                    }
                                }
                            }
                        }
                    }
                }
                var qb1 = new QueryBuilder(appPregnancyDefId, context.UserId);
                qb1.Where("RegDate").Ge(fd).And("RegDate").Le(ld).And("&State").Eq(approvedStateId);

                using (var query1 = SqlQueryBuilder.Build(context.DataContext, qb1.Def))
                {
                    var personSrc1 = query1.JoinSource(query1.Source, personDefId, SqlSourceJoinType.Inner, "Person");

                    query1.AddAttribute(query1.Source, "&Id");
                    query1.AddAttribute(personSrc1, "Gender");
                    query1.AddAttribute(query1.Source, "AssignedAmountRepublicBudgetBR");
                    query1.AddAttribute(query1.Source, "Сoefficient");
                    query1.AddAttribute(query1.Source, "IndividualBusiness");
                    query1.AddAttribute(query1.Source, "PeasantFarming");
                    query1.AddAttribute(query1.Source, "OfficiallyUnemployed");
                    query1.AddAttribute(query1.Source, "PrefApplication");

                    var table1 = new DataTable();
                    using (var reader = context.CreateSqlReader(query1))
                    {
                        reader.Open();
                        reader.Fill(table1);
                        reader.Close();
                    }
                    foreach (DataRow row in table1.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];                      
                        var gender = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                        var repbudjet = row[2] is DBNull ? 0m : (decimal)row[2];
                        var coef = row[3] is DBNull ? 0 : (double)row[3];
                        var ip = row[4] is DBNull ? false : (bool)row[4];
                        var kfx = row[5] is DBNull ? false : (bool)row[5];
                        var ob = row[6] is DBNull ? false : (bool)row[6];
                        var reExam = row[7] is DBNull ? Guid.Empty : (Guid)row[7];

                        if (appId != Guid.Empty)
                        {
                            if (ip)
                            {
                                item4.gr3 = item4.gr3 != 0 ? (1 + (int)item4.gr3) : 1;
                                if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item4.gr4 += 1;
                                if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item4.gr5 += 1;
                                if (repbudjet != 0)
                                {
                                    item4.gr6 = ((decimal?)item4.gr6 ?? 0m) + repbudjet;
                                    item4.gr7 = item4.gr6 / item4.gr3;
                                }
                                if (coef != 0)
                                {
                                    item4.gr8 = item4.gr8 != 0 ? (1 + (int)item4.gr8) : 1;
                                    if (repbudjet != 0) item4.gr9 = ((decimal?)item4.gr9 ?? 0m) + repbudjet;
                                    item4.gr10 = item4.gr9 / item4.gr8;
                                    if (reExam != Guid.Empty)
                                    {
                                        item4.gr11 = item4.gr11 != 0 ? (1 + (int)item4.gr11) : 1;
                                        if (repbudjet != 0) item4.gr12 = ((decimal?)item4.gr12 ?? 0m) + repbudjet;
                                        item4.gr13 = item4.gr12 / item4.gr11;
                                    }
                                }
                                else
                                {
                                    item4.gr14 = item4.gr14 != 0 ? (1 + (int)item4.gr14) : 1;
                                    if (repbudjet != 0) item4.gr15 = ((decimal?)item4.gr15 ?? 0m) + repbudjet;
                                    item4.gr16 = item4.gr15 / item4.gr14;
                                    if (reExam != Guid.Empty)
                                    {
                                        item4.gr17 = item4.gr17 != 0 ? (1 + (int)item4.gr17) : 1;
                                        if (repbudjet != 0) item4.gr18 = ((decimal?)item4.gr18 ?? 0m) + repbudjet;
                                        item4.gr19 = item4.gr18 / item4.gr17;
                                    }
                                }
                            }
                            if (kfx)
                            {
                                item5.gr3 = item5.gr3 != 0 ? (1 + (int)item5.gr3) : 1;
                                if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item5.gr4 += 1;
                                if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item5.gr5 += 1;
                                if (repbudjet != 0)
                                {
                                    item5.gr6 = ((decimal?)item5.gr6 ?? 0m) + repbudjet;
                                    item5.gr7 = item5.gr6 / item5.gr3;
                                }
                                if (coef != 0)
                                {
                                    item5.gr8 = item5.gr8 != 0 ? (1 + (int)item5.gr8) : 1;
                                    if (repbudjet != 0) item5.gr9 = ((decimal?)item5.gr9 ?? 0m) + repbudjet;
                                    item5.gr10 = item5.gr9 / item5.gr8;
                                    if (reExam != Guid.Empty)
                                    {
                                        item5.gr11 = item5.gr11 != 0 ? (1 + (int)item5.gr11) : 1;
                                        if (repbudjet != 0) item5.gr12 = ((decimal?)item5.gr12 ?? 0m) + repbudjet;
                                        item5.gr13 = item5.gr12 / item5.gr11;
                                    }
                                }
                                else
                                {
                                    item5.gr14 = item5.gr14 != 0 ? (1 + (int)item5.gr14) : 1;
                                    if (repbudjet != 0) item5.gr15 = ((decimal?)item5.gr15 ?? 0m) + repbudjet;
                                    item5.gr16 = item5.gr15 / item5.gr14;
                                    if (reExam != Guid.Empty)
                                    {
                                        item5.gr17 = item5.gr17 != 0 ? (1 + (int)item5.gr17) : 1;
                                        if (repbudjet != 0) item5.gr18 = ((decimal?)item5.gr18 ?? 0m) + repbudjet;
                                        item5.gr19 = item5.gr18 / item5.gr17;
                                    }
                                }
                            }
                            if (ob)
                            {
                                item6.gr3 = item6.gr3 != 0 ? (1 + (int)item6.gr3) : 1;
                                if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item6.gr4 += 1;
                                if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item6.gr5 += 1;
                                if (repbudjet != 0)
                                {
                                    item6.gr6 = ((decimal?)item6.gr6 ?? 0m) + repbudjet;
                                    item6.gr7 = item6.gr6 / item6.gr3;
                                }
                                if (coef != 0)
                                {
                                    item6.gr8 = item6.gr8 != 0 ? (1 + (int)item6.gr8) : 1;
                                    if (repbudjet != 0) item6.gr9 = ((decimal?)item6.gr9 ?? 0m) + repbudjet;
                                    item6.gr10 = item6.gr9 / item6.gr8;
                                    if (reExam != Guid.Empty)
                                    {
                                        item6.gr11 = item6.gr11 != 0 ? (1 + (int)item6.gr11) : 1;
                                        if (repbudjet != 0) item6.gr12 = ((decimal?)item6.gr12 ?? 0m) + repbudjet;
                                        item6.gr13 = item6.gr12 / item6.gr11;
                                    }
                                }
                                else
                                {
                                    item6.gr14 = item6.gr14 != 0 ? (1 + (int)item6.gr14) : 1;
                                    if (repbudjet != 0) item6.gr15 = ((decimal?)item6.gr15 ?? 0m) + repbudjet;
                                    item6.gr16 = item6.gr15 / item6.gr14;
                                    if (reExam != Guid.Empty)
                                    {
                                        item6.gr17 = item6.gr17 != 0 ? (1 + (int)item6.gr17) : 1;
                                        if (repbudjet != 0) item6.gr18 = ((decimal?)item6.gr18 ?? 0m) + repbudjet;
                                        item6.gr19 = item6.gr18 / item6.gr17;
                                    }
                                }
                            }
                        }
                    }
                }
            }
            static void RemoveRows(WorkflowContext context, Guid reportId)
            {
                var docRepo = context.Documents;
                var rows = new List<Guid>();
                var qb = new QueryBuilder(reportItemDefId, context.UserId);
                qb.Where("Report").Eq(reportId).Or("Report").IsNull();
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read()) rows.Add(reader.GetGuid(0));
                }
                foreach (var rowId in rows)
                {
                    docRepo.DeleteById(rowId);
                }
            }

            private static readonly Guid legalPregDefId = new Guid("{46C27FED-B9E0-4DAA-9DD4-F984A526D9B5}"); //Сведения о расходах по выплате пособий по беременности и родам
            private static readonly Guid legalSectionDefId = new Guid("{EC14A952-D4D8-4EA8-90F5-50121CC4B173}"); //Разделы отчетов для юридического лица
            private static readonly Guid personDefId = new Guid("{D71CE61A-9B59-4B5E-8713-8131DBB5BA02}"); //Person
            private static readonly Guid appPregnancyDefId = new Guid("{379C813C-E5AF-4ACF-9D4D-7FF8AF40AEAE}"); //Заявление на назначение пособия по беременности и родом
            private static readonly Guid approvedStateId = new Guid("{9A1F1E23-1E8B-4830-AD99-1D0AB3272564}");  //утвержден

            private static readonly Guid reportItemDefId = new Guid("{32AEB528-1226-478D-B451-1301E01284D5}"); //Наименование столбцов заявки на выплату 
        }
        //Динамика численности получателей БР с 2019 года
        public static class DinamicReportsBR
        {
            private static readonly Guid reportDefId = new Guid("{F3269C26-5380-43D4-873C-BF9B54318770}"); //  Заявка на выплату
            private static readonly Guid reportItemDefId = new Guid("{32AEB528-1226-478D-B451-1301E01284D5}"); //Наименование столбцов заявки на выплату 
            private static readonly Guid birthBenefitDefId = new Guid("{46C27FED-B9E0-4DAA-9DD4-F984A526D9B5}"); //Сведения о расходах по выплате пособий по беременности и родам

            private static readonly Guid appBirthDefId = new Guid("{379C813C-E5AF-4ACF-9D4D-7FF8AF40AEAE}"); //Заявление на назначение пособия по беременности и родом
            private static readonly Guid legalReportDefId = new Guid("{EC14A952-D4D8-4EA8-90F5-50121CC4B173}"); //Разделы отчетов для юридического лица
            private static readonly Guid orgPofileDefId = new Guid("{BB23529B-072D-4E85-87D4-337473458EC2}"); //Профиль организации
            private static readonly Guid approvedStateId = new Guid("{9A1F1E23-1E8B-4830-AD99-1D0AB3272564}");  //утвержден
            public static List<ReportBR3Item> Execute(WorkflowContext context, int year)
            {
                var items = new List<ReportBR3Item>();
                CalcItems(context, year, items);
                return items;
            }
            public static void CalcItems(WorkflowContext context, int year, List<ReportBR3Item> items)
            {
                var qb = new QueryBuilder(birthBenefitDefId, context.UserId);
                qb.Where("LegalReportSection").Include("&State").Eq(approvedStateId).End();

                var query = context.CreateSqlQuery(qb.Def); //беременность роды - юр. лицо
                var legalSrc = query.JoinSource(query.Source, legalReportDefId, SqlSourceJoinType.Inner, "LegalReportSection");

                query.AddAttribute(query.Source, "&Id");
                query.AddAttribute(query.Source, "Nationality");
                query.AddAttribute(query.Source, "BirthCadThrowRepublicBudget"); //За счет республиканского бюджета (сом)
                query.AddAttribute(legalSrc, "ReportDate");

                var table = new DataTable();
                using (var reader = context.CreateSqlReader(query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    var nation = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                    decimal repbudjet = row[2] is DBNull ? 0m : (decimal)row[2];
                    var reportDate = row[3] is DBNull ? DateTime.MaxValue : (DateTime)row[3];

                    var item = new ReportBR3Item();
                    var today = DateTime.Today;
                    if (appId != Guid.Empty)
                    {
                        if (reportDate.Year == year)
                        {
                            item.gr1 = reportDate.Year;
                            item.gr2 += 1;
                            if (nation.Equals(new Guid("{D159B901-DD6F-4564-8397-F37830FE82B5}"))) item.gr3_1 += 1;
                            if (nation.Equals(new Guid("{A7BEED6D-35CA-4507-A413-D9060D02E224}"))) item.gr3_2 += 1;
                            if (nation.Equals(new Guid("{681AED4D-4D6D-4429-94FA-FC4AE2B72465}"))) item.gr3_3 += 1;
                            if (nation.Equals(new Guid("{54D8D699-6D32-456F-A76D-8FA84AF6FFAD}"))) item.gr3_4 += 1;
                            if (nation.Equals(new Guid("{D6E80CC1-D738-44B9-9BA8-9E16532EBBC5}"))) item.gr3_5 += 1;
                            if (nation.Equals(new Guid("{8E017A65-D826-4D4A-B42B-4CA957503310}"))) item.gr3_6 += 1;
                            if (repbudjet != 0) item.gr4 = ((decimal?)item.gr4 ?? 0m) + repbudjet;
                            item.gr5 = item.gr4 / item.gr2;
                            items.Add(item);
                        }
                    }
                }
                //Заявление на назначение пособия по беременности и родом
                var qbApp = new QueryBuilder(appBirthDefId, context.UserId);
                qbApp.Where("&State").Eq(approvedStateId);
                var queryApp = context.CreateSqlQuery(qbApp.Def);

                queryApp.AddAttribute(queryApp.Source, "&Id");
                queryApp.AddAttribute(queryApp.Source, "Citizenship");
                queryApp.AddAttribute(queryApp.Source, "AssignedAmountRepublicBudgetBR");
                queryApp.AddAttribute(queryApp.Source, "RegDate");                

                var tableApp = new DataTable();
                using (var readerL = context.CreateSqlReader(queryApp))
                {
                    readerL.Open();
                    readerL.Fill(tableApp);
                    readerL.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    var nation = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                    decimal repbudjet = row[2] is DBNull ? 0m : (decimal)row[2];
                    var regDate = row[3] is DBNull ? DateTime.MaxValue : (DateTime)row[3];

                    var item = new ReportBR3Item();
                    var today = DateTime.Today;
                    if (appId != Guid.Empty)
                    {
                        if (regDate.Year >= year)
                        {
                            item.gr1 = regDate.Year;
                            item.gr2 += 1;
                            if (nation.Equals(new Guid("{D159B901-DD6F-4564-8397-F37830FE82B5}"))) item.gr3_1 += 1;
                            if (nation.Equals(new Guid("{A7BEED6D-35CA-4507-A413-D9060D02E224}"))) item.gr3_2 += 1;
                            if (nation.Equals(new Guid("{681AED4D-4D6D-4429-94FA-FC4AE2B72465}"))) item.gr3_3 += 1;
                            if (nation.Equals(new Guid("{54D8D699-6D32-456F-A76D-8FA84AF6FFAD}"))) item.gr3_4 += 1;
                            if (nation.Equals(new Guid("{D6E80CC1-D738-44B9-9BA8-9E16532EBBC5}"))) item.gr3_5 += 1;
                            if (nation.Equals(new Guid("{8E017A65-D826-4D4A-B42B-4CA957503310}"))) item.gr3_6 += 1;
                            if (repbudjet != 0) item.gr4 = ((decimal?)item.gr4 ?? 0m) + repbudjet;
                            item.gr5 = item.gr4 / item.gr2;
                            items.Add(item);
                        }
                    }
                }
            }
        }

        //Сведения о численности получателей, среднем размере и выплаченной сумме пособий по РП по состоянию
        public static class CalBenefitReportsByRegionsRP
        {
            private static readonly Guid reportDefId = new Guid("{F3269C26-5380-43D4-873C-BF9B54318770}"); //  Заявка на выплату
            private static readonly Guid reportItemDefId = new Guid("{32AEB528-1226-478D-B451-1301E01284D5}"); //Наименование столбцов заявки на выплату 
            private static readonly Guid legalRitualDefId = new Guid("{89ADB43B-0D29-4287-AF5B-0E0DCED18B01}"); //Сведения о расходах по выплате ритуального пособия
            private static readonly Guid personDefId = new Guid("{D71CE61A-9B59-4B5E-8713-8131DBB5BA02}"); //ФИО получателей пособий по беременности и родом
            private static readonly Guid femaleEnId = new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"); //Женский
            private static readonly Guid maleEnId = new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"); //Женский

            private static readonly Guid appRitualDefId = new Guid("{A7762DDE-ABB8-4A22-B942-33DB2C2C6E58}"); //Заявление на назначение ритуального пособия (на погребение)
            private static readonly Guid legalReportDefId = new Guid("{EC14A952-D4D8-4EA8-90F5-50121CC4B173}"); //Разделы отчетов для юридического лица
            private static readonly Guid orgPofileDefId = new Guid("{BB23529B-072D-4E85-87D4-337473458EC2}"); //Профиль организации
            private static readonly Guid approvedStateId = new Guid("{9A1F1E23-1E8B-4830-AD99-1D0AB3272564}");  //утвержден
            public static List<Guid> bishkekList = new List<Guid>//г.Бишкек              
            {                                                            
                //  new Guid("{E59E153E-4FE9-4872-BBD0-9E183793EFEF}"),            
                new Guid("{D4C5884F-1820-4DF5-9BF8-C48202ACB801}"),//первомайский                          
                new Guid("{20FF5245-DB58-443A-A31B-061200E939AA}"),//октябрь                 
                new Guid("{52315837-1B8F-4B80-9D8C-160214F4681A}"),//свердлово               
                new Guid("{E3BFB034-7638-4C14-8C0F-EA823CCA7A5B}")//ленин                                      
            };
            public static List<Guid> chuiList = new List<Guid>//Чуйская область
            {                                                                                            
                // new Guid("{41E34648-6C9D-44D0-8CA5-941DB051B163}"),
                new Guid("{30658F5A-DC22-4A7A-AAF6-63DFB7070C50}"),//чуй
                new Guid("{DC2174B4-479B-4F6F-9A9D-9BA28AB715CD}"),//аламудун
                new Guid("{7866D332-C471-4873-8F8B-6DA9EDC3683A}"),//ыссык-ата           
                new Guid("{C8641D03-B553-4F95-ADFB-EC002FD64E06}"),//москва
                new Guid("{19F7870D-4B5E-457A-B159-528F71374E1E}"),//жайыл                             
                new Guid("{093AFB08-3F18-4E5C-8EB6-86EF0DD711B9}"),//сокулук
                new Guid("{668D6957-1F76-49DE-B9AD-0F2C635DF2DD}"),//кемин                                    
                new Guid("{8B6510F7-3B6B-4C9D-B8A1-2349B78B2CF3}"),//город токмок
                new Guid("{5DF10BBC-D256-40F8-B641-5EF31CE11540}")//панфилов                                 
            };
            public static List<Guid> issyk_kulList = new List<Guid>//Иссык-Кульская область
            {
                // new Guid("{AD009808-FBAC-43CA-8671-5E790C213497}"),
                new Guid("{23DB562E-C0B7-4B7E-AC16-967C96500444}"),//балыкчы
                new Guid("{3277F73D-B02D-4F35-AD1A-80B349EECF6B}"),//тон
                new Guid("{C748CDB5-502A-4243-8494-48E224968019}"),//тюп                                                                         
                new Guid("{046FF80D-4D26-4E30-A41F-17873C0E2C8F}"),//жети-огуз  
                new Guid("{14EB7AEF-C331-4085-A83E-0F5EEBF2EAA3}"),//иссык-куль                                 
                new Guid("{1F892B98-97B4-4B58-B61F-7DFECBAC3B5E}"),//ак-суу
                new Guid("{AB27C82D-8348-4DBA-BA9C-CEAE3A67704E}")//каракол
            };
            public static List<Guid> narynList = new List<Guid>//Нарынская область
            {                                                                                
                // new Guid("{CF4CA271-9202-4A5A-AE49-EB6237C33982}"),
                new Guid("{51C381F2-6AD6-4382-81F9-3D36E9ABEA08}"),//кочкор
                new Guid("{4313A514-83B6-4FED-9731-4D838A6E91CD}"),//нарын район
                new Guid("{93DF61DD-A2FE-4F52-B961-F1B27BD27A8C}"),//нарын г
                new Guid("{B3C93041-BBEA-445D-B7E1-D42D9F3692C3}"),//акталаа
                new Guid("{B3EA3DE1-5D76-461C-90AC-68D312B7B665}"),//жумгал
                new Guid("{69EAAC3D-3525-4CE3-8C5E-42123B4ED9CB}")//ат-баши
            };
            public static List<Guid> talasList = new List<Guid>//Таласская область
            {
                //new Guid("{BC710978-8C0B-4063-8BA9-A12F75DE4829}"),
                new Guid("{C6D92271-6FF2-4641-A83F-D02610060C43}"),//кара-буура  
                new Guid("{3BB3CB8F-A747-4026-9031-C6B67EA9735B}"),//г талас
                new Guid("{16FD5BFF-7AB4-4B40-AAFB-0282BA5BE32E}"),//талас рн
                new Guid("{B8DACAD8-0118-4147-8BD2-30DCE891E5EB}"),//манас
                new Guid("{7F311898-D254-4668-8184-D1794E695A19}")//бакай-ата
            };
            public static List<Guid> jalal_abad = new List<Guid>//Джалал-Абадская область
            {
                // new Guid("{3ED50EFB-3E20-407C-93CB-9D8E0EF15B1B}"),
                new Guid("{18DBE2BE-BBB6-4BC2-9A33-8B25856C0382}"),//г джалалабад
                new Guid("{E4964796-6658-46A9-BD49-A34B3275CB1F}"),//ноокен
                new Guid("{DC448CE3-49F4-43F1-AEAA-F782341C62C0}"),//сузак
                new Guid("{AA65C2F7-3091-40E5-939D-6A18250E125A}"),//каракуль
                new Guid("{9D8B0CA0-D618-4157-AF15-5E7CCA7D9F23}"),//ташкумыр
                new Guid("{64ECD259-A848-474B-8E8D-571612A7E43B}"),//токтогул рн
                new Guid("{17F5601A-36B7-4FAC-A980-07F349239D5B}"),//базар-коргон
                new Guid("{9AFA2870-4609-4D8A-8417-11C2DBDEC94B}"),//майлысуу
                new Guid("{B42B4F13-2AA5-43D2-B738-CB02CA647D47}"),//кок-жангак
                new Guid("{B0A96501-F5F4-48A4-8103-6C7A7BA290C4}"),//тогуз-торо
                new Guid("{60F22545-CB84-4795-81A3-2EEEEB0FB88A}"),//ала-бука
                new Guid("{2765827A-88EF-4144-8050-9A2FD66FB136}"),//аксы
                new Guid("{A598BEA0-37C9-4DC2-9BC7-FB3AA1097E14}")//чаткал
            };
            public static List<Guid> oshList = new List<Guid>//Ошская область
            {
                // new Guid("{E01E9890-2A41-454E-9EC1-3D4AAF50ED62}"),
                new Guid("{8B739BFD-CF8F-4380-A246-8A34BCE9A231}"),//ош
                new Guid("{B382A964-BBD7-4540-B6E4-BC9250AB7005}"),//араван
                new Guid("{A3282FFC-BAFE-4B4E-99D0-C68509BE6133}"),//ноокат
                new Guid("{E5411CDD-3CAF-4798-A7BF-FD57C856C82B}"),//алай
                new Guid("{59FF6F9C-F047-4E25-B837-669AA0596B07}"),//кара-суу
                new Guid("{C1A54A26-CA15-4C29-8DEB-957F5B0FD002}"),//чон-алай
                new Guid("{E425497A-3C82-424E-9691-71EAAD4759D8}"),//узген рн
                new Guid("{D62E0B83-E589-491D-B0A4-8BEA42178231}"),//узген г
                new Guid("{A2317371-CC1D-4EB3-8ADF-D7BA33B75F87}")//каракулджа
            };
            public static List<Guid> batkenList = new List<Guid>//Баткенская область
            {
                //new Guid("{4E98AD82-8ED4-4727-8E24-678921AB534C}"),
                new Guid("{C7B6AA81-A4B7-4AD6-BE03-E4B54E8084DA}"),//лейлек
                new Guid("{5EE1AC59-52A1-45E3-84EC-54AD09FC9F1E}"),//баткен рн
                new Guid("{D328865B-EDE4-4674-92C6-C134F55C3C6F}"),//баткен г
                new Guid("{879F3420-E45A-4E11-9394-D0B1A0091805}"),//кадамжай
                new Guid("{32AF3EA3-4100-406F-8825-20CB8A1877AA}"),//кызыл-кия
                new Guid("{FF3B071C-FC51-4F64-8BD4-11A5377E93D2}")//сулюкта                                               
            };
            public static List<Guid> osh = new List<Guid>
            {
                new Guid ("{A99E469A-E8D4-4139-B89A-CE4AF6AA0733}")
            };
            public static List<ReportRP1Item> Execute(WorkflowContext context, DateTime fd, DateTime ld)
            {
                return CalcItems(context, fd, ld);
            }
            public static List<ReportRP1Item> CalcItems(WorkflowContext context, DateTime fd, DateTime ld)
            {
                var items = new List<ReportRP1Item>();
                var qb = new QueryBuilder(appRitualDefId, context.UserId);
                qb.Where("RegDate").Ge(fd).And("RegDate").Le(ld).And("&State").Eq(approvedStateId);

                var query = context.CreateSqlQuery(qb.Def); //беременность роды - юр. лицо
                var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Person");
               // var orgProfileSrc = query.JoinSource(query.Source, orgPofileDefId, SqlSourceJoinType.Inner, "OrgProfile");

                query.AddAttribute(query.Source, "&Id");
                query.AddAttribute(personSrc, "Gender");
                query.AddAttribute(query.Source, "Citizenship");
                query.AddAttribute(query.Source, "AssignedAmountRepublicBudget"); //За счет республиканского бюджета (сом)
                query.AddAttribute(query.Source, "&OrgId");

                var table = new DataTable();
                using (var reader = context.CreateSqlReader(query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    var gender = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                    var nation = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                    decimal repbudjet = row[3] is DBNull ? 0m : (decimal)row[3];
                    var orgId = row[4] is DBNull ? Guid.Empty : (Guid)row[4];

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);

                    if (appId != Guid.Empty)
                    {
                        if(gender != Guid.Empty)
                        {
                            rayon.gr3 += 1;
                            if (gender == femaleEnId) rayon.gr4 += 1;
                            if (gender == maleEnId) rayon.gr5 += 1;
                            if (nation != Guid.Empty)
                            {
                                rayon.gr6 += 1;
                                if (nation.Equals(new Guid("{9AD0E64A-0DAB-41E5-9BA6-2BBDCC0A5A7D}"))) rayon.gr7_1 += 1;
                                if (nation.Equals(new Guid("{D760CC4E-052B-472F-A647-DB267C7D4B46}"))) rayon.gr7_2 += 1;
                            }
                            if (repbudjet != 0) rayon.gr8 = ((decimal?)rayon.gr8 ?? 0m) + repbudjet;
                        }                        
                    }
                }
                var qbL = new QueryBuilder(legalRitualDefId, context.UserId);
                qbL.Where("LegalReportSection").Include("ReportDate").Ge(fd).And("ReportDate").Le(ld).And("&State").Eq(approvedStateId).End();

                var queryL = context.CreateSqlQuery(qbL.Def); //беременность роды - юр. лицо
                personSrc = queryL.JoinSource(queryL.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                var legalSrc = queryL.JoinSource(queryL.Source, legalReportDefId, SqlSourceJoinType.Inner, "LegalReportSection");
               // var orgProfSrcL = queryL.JoinSource(legalSrc, orgPofileDefId, SqlSourceJoinType.Inner, "OrgProfile");

                queryL.AddAttribute(queryL.Source, "&Id");
                queryL.AddAttribute(personSrc, "Gender");
                queryL.AddAttribute(queryL.Source, "Citizenship");
                queryL.AddAttribute(queryL.Source, "DeadCadThrowRepublicBudget"); //За счет республиканского бюджета (сом)
                queryL.AddAttribute(queryL.Source, "&OrgId");

                var tableL = new DataTable();
                using (var readerL = context.CreateSqlReader(queryL))
                {
                    readerL.Open();
                    readerL.Fill(tableL);
                    readerL.Close();
                }
                foreach (DataRow row in tableL.Rows)
                {
                    var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    var gender = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                    var nation = row[2] is DBNull ? Guid.Empty : (Guid)row[2];
                    var repbudjet = row[3] is DBNull ? 0m : (decimal)row[3];
                    var orgId = row[4] is DBNull ? Guid.Empty : (Guid)row[4];

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);

                    if (appId != Guid.Empty)
                    {
                        if (gender != Guid.Empty)
                        {
                            rayon.gr3 += 1;
                            if (gender == femaleEnId) rayon.gr4 += 1;
                            if (gender == maleEnId) rayon.gr5 += 1;
                            if (nation != Guid.Empty)
                            {
                                rayon.gr6 += 1;
                                if (nation.Equals(new Guid("{9AD0E64A-0DAB-41E5-9BA6-2BBDCC0A5A7D}"))) rayon.gr7_1 += 1;
                                if (nation.Equals(new Guid("{D760CC4E-052B-472F-A647-DB267C7D4B46}"))) rayon.gr7_2 += 1;
                            }
                            if (repbudjet != 0) rayon.gr8 = ((decimal?)rayon.gr8 ?? 0m) + repbudjet;
                        }                        
                    }
                }
                // RegionReportItem regionReportItem = new RegionReportItem();
                foreach (var subItem in items)
                {
                    if (bishkekList.Contains(subItem.GetOrgId())) subItem.RegionName = "г.Бишкек";
                    //regionReportItem.BishkekCityRegion.Add(subItem);
                    if (chuiList.Contains(subItem.GetOrgId())) subItem.RegionName = "Чуйская область";
                    //regionReportItem.ChuyRegion.Add(subItem);
                    if (talasList.Contains(subItem.GetOrgId())) subItem.RegionName = "Таласская область";
                    //regionReportItem.TalasRegion.Add(subItem);
                    if (issyk_kulList.Contains(subItem.GetOrgId())) subItem.RegionName = "Иссык-Кульская область";
                    //regionReportItem.YssykKolRegion.Add(subItem);
                    if (narynList.Contains(subItem.GetOrgId())) subItem.RegionName = "Нарынская область";
                    //regionReportItem.NarynRegion.Add(subItem);
                    if (batkenList.Contains(subItem.GetOrgId())) subItem.RegionName = "Баткенская область";
                    //regionReportItem.BatkenRegion.Add(subItem);
                    if (oshList.Contains(subItem.GetOrgId())) subItem.RegionName = "Ошская область";
                    //regionReportItem.OshRegion.Add(subItem);
                    if (osh.Contains(subItem.GetOrgId())) subItem.RegionName = "г.Ош";
                    //regionReportItem.OshCityRegion.Add(subItem);
                    if (jalal_abad.Contains(subItem.GetOrgId())) subItem.RegionName = "Джалал-Абадская область";
                    //regionReportItem.JalalAbadRegion.Add(subItem);
                }
                return items;
            }
            //[DataContract]
            public class RegionReportItem
            {
                public RegionReportItem()
                {
                    ChuyRegion = new List<ReportRP1Item>();
                    YssykKolRegion = new List<ReportRP1Item>();
                    NarynRegion = new List<ReportRP1Item>();
                    TalasRegion = new List<ReportRP1Item>();
                    OshRegion = new List<ReportRP1Item>();
                    JalalAbadRegion = new List<ReportRP1Item>();
                    BatkenRegion = new List<ReportRP1Item>();
                    BishkekCityRegion = new List<ReportRP1Item>();
                    OshCityRegion = new List<ReportRP1Item>();
                }
                public List<ReportRP1Item> ChuyRegion { get; set; }
                public List<ReportRP1Item> YssykKolRegion { get; set; }
                public List<ReportRP1Item> NarynRegion { get; set; }
                public List<ReportRP1Item> TalasRegion { get; set; }
                public List<ReportRP1Item> OshRegion { get; set; }
                public List<ReportRP1Item> JalalAbadRegion { get; set; }
                public List<ReportRP1Item> BatkenRegion { get; set; }
                public List<ReportRP1Item> BishkekCityRegion { get; set; }
                public List<ReportRP1Item> OshCityRegion { get; set; }
            }
            static ReportRP1Item GetReportItem(List<ReportRP1Item> items, string orgName, Guid orgId)
            {
                var item = items.FirstOrDefault(x => x.OrgName == orgName);
                if (item != null) return item;
                item = new ReportRP1Item(orgId)
                {
                    OrgName = orgName,
                };
                items.Add(item);
                return item;
            }
        }
        //Сведения о численности получателей пособия по БР по категориям получателей
        public static class CalBenefitReportsRP
        {
            public static List<ReportRP2Item> Execute(WorkflowContext context, DateTime fd, DateTime ld)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;

                var docs = new string[]
                {
                    "Лица, работающие в организациях и учреждениях (на основании трудового договора или приказа работодателя)",
                    "из них: Члены семьи, находящиеся на иждивении работника",
                    "Лица, осуществляющие предпринимательскую деятельность без образования юридического лица(индивидуальные предприниматели, работающие на основе патента или сидетельства ГНС* или НСК**)",
                    "Члены семьи, находящиеся на иждивении индивидуального предпринимателя",
                    "Члены крестьянских(фермерских) хозяйств без образования юридического лица",
                    "Члены семьи, находящиеся на иждивении члена КФХ",
                    "Официальные безработные, состоящие на учете в службе занятости",
                    "Члены семьи, находящиеся на иждивении официального безработного",
                    "Лица, получающие социальное пособие",
                    "Члены семьи, находящиеся на иждивении получателя соцпособия",
                    "Безработные(неработающие лица), не зарегистрированные в службе занятости",
                    "Члены семьи, находящиеся на иждивении безработного(неработающего лица)"
                };
                var items = new List<ReportRP2Item>();
                int i2 = 1;
                foreach (var i in docs)
                {
                    var item = new ReportRP2Item();
                    item.rowName = i;
                    item.rowNo = i2;
                    i2++;
                    items.Add(item);
                }
                CalcItems(context, /*report*/ fd, ld, orgId,
                items[11], items[10], items[9], items[8], items[7],
                items[6], items[5], items[4], items[3], items[2], items[1], items[0]);
                return items;
            }
            public static void CalcItems(WorkflowContext context, DateTime fd, DateTime ld, Guid orgId,
                ReportRP2Item item11, ReportRP2Item item10, ReportRP2Item item9, ReportRP2Item item8, ReportRP2Item item7,
                ReportRP2Item item6, ReportRP2Item item5, ReportRP2Item item4, ReportRP2Item item3, ReportRP2Item item2, ReportRP2Item item1, ReportRP2Item item0)
            {
                var qb = new QueryBuilder(legalRitualDefId, context.UserId);
                    qb.Where("LegalReportSection").Include("ReportDate").Ge(fd).And("ReportDate").Le(ld).And("&State").Eq(approvedStateId).End();

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var personSrc = query.JoinSource(query.Source, personDefId, SqlSourceJoinType.Inner, "Person");
                    var legalSrc = query.JoinSource(query.Source, legalSectionDefId, SqlSourceJoinType.Inner, "LegalReportSection");

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(personSrc, "Gender");
                    query.AddAttribute(personSrc, "BirthDate");
                    query.AddAttribute(query.Source, "DeadCadThrowRepublicBudget");
                    query.AddAttribute(query.Source, "FamilyMember");

                    var table = new DataTable();
                    using (var reader = context.CreateSqlReader(query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var gender = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                        var bd = row[2] is DBNull ? DateTime.MaxValue : (DateTime)row[2];
                        decimal repbudjet = row[3] is DBNull ? 0m : (decimal)row[3];
                        var famMember = row[4] is DBNull ? false : (bool)row[4];
                        var today = DateTime.Today;
                        var age = today.Year - bd.Year;
                        if (appId != Guid.Empty)
                        {
                            item0.gr3 = item0.gr3 != 0 ? (1 + (int)item0.gr3) : 1;
                            if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item0.gr4 += 1;
                            if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item0.gr5 += 1;
                            if (age <= 18)
                            {
                                if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item0.gr6 += 1;
                                if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item0.gr7 += 1;
                            }
                            if (repbudjet != 0) item0.gr8 = ((decimal?)item0.gr8 ?? 0m) + repbudjet;
                                item0.gr9 = item0.gr8 / item0.gr3;
                            //Члены семьи, находящиеся на иждивении работника
                            if (famMember)
                            {
                                item1.gr3 = item1.gr3 != 0 ? (1 + (int)item1.gr3) : 1;
                                if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item1.gr4 += 1;
                                if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item1.gr5 += 1;
                                if (age <= 18)
                                {
                                    if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item1.gr6 += 1;
                                    if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item1.gr7 += 1;
                                }
                                if (repbudjet != 0) item1.gr8 = ((decimal?)item1.gr8 ?? 0m) + repbudjet;
                                item1.gr9 = item1.gr8 / item1.gr3;
                            }
                        }
                    }
                }
                var qb1 = new QueryBuilder(appRitualDefId, context.UserId);
                qb1.Where("RegDate").Ge(fd).And("RegDate").Le(ld).And("&State").Eq(approvedStateId);

                using (var query1 = SqlQueryBuilder.Build(context.DataContext, qb1.Def))
                {
                    var personSrc1 = query1.JoinSource(query1.Source, personDefId, SqlSourceJoinType.Inner, "Person");

                    query1.AddAttribute(query1.Source, "&Id");
                    query1.AddAttribute(personSrc1, "Gender");
                    query1.AddAttribute(personSrc1, "BirthDate");
                    query1.AddAttribute(query1.Source, "AssignedAmountRepublicBudget");
                    query1.AddAttribute(query1.Source, "CategoriesOfRitalBenefits");

                    var table1 = new DataTable();
                    using (var reader = context.CreateSqlReader(query1))
                    {
                        reader.Open();
                        reader.Fill(table1);
                        reader.Close();
                    }
                    foreach (DataRow row in table1.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var gender = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                        var bd = row[2] is DBNull ? DateTime.MaxValue : (DateTime)row[2];
                        var repbudjet = row[3] is DBNull ? 0m : (decimal)row[3];
                        var category = row[4] is DBNull ? Guid.Empty : (Guid)row[4];
                        var today = DateTime.Today;
                        var age = today.Year - bd.Year;
                        if (appId != Guid.Empty)
                        {
                            //ИП
                            if (category.Equals(new Guid("{FBE9520C-C6FB-4D05-AA38-10500C54E680}")))
                            {
                                item2.gr3 = item2.gr3 != 0 ? (1 + (int)item2.gr3) : 1;
                                if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item2.gr4 += 1;
                                if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item2.gr5 += 1;
                                if (age <= 18)
                                {
                                    if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item2.gr6 += 1;
                                    if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item2.gr7 += 1;
                                }
                                if (repbudjet != 0) item2.gr8 = ((decimal?)item2.gr8 ?? 0m) + repbudjet;
                                item2.gr9 = item2.gr8 / item2.gr3;
                            }
                            //Член семьи состоявший на иждивении ИП
                            if (category.Equals(new Guid("{7701BEC8-8239-45D5-AB5F-A85BFD0A8949}")))
                            {
                                item3.gr3 = item3.gr3 != 0 ? (1 + (int)item3.gr3) : 1;
                                if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item3.gr4 += 1;
                                if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item3.gr5 += 1;
                                if (age <= 18)
                                {
                                    if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item3.gr6 += 1;
                                    if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item3.gr7 += 1;
                                }
                                if (repbudjet != 0) item3.gr8 = ((decimal?)item3.gr8 ?? 0m) + repbudjet;
                                item3.gr9 = item3.gr8 / item3.gr3;
                            }
                            //Члены крестьянских (фермерских) хозяйств без образования юридического лица
                            if (category.Equals(new Guid("{DBAB3219-38FA-4A3A-AF5A-BCF0435F0FA3}")))
                            {
                                item4.gr3 = item4.gr3 != 0 ? (1 + (int)item4.gr3) : 1;
                                if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item4.gr4 += 1;
                                if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item4.gr5 += 1;
                                if (age <= 18)
                                {
                                    if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item4.gr6 += 1;
                                    if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item4.gr7 += 1;
                                }
                                if (repbudjet != 0) item4.gr8 = ((decimal?)item4.gr8 ?? 0m) + repbudjet;
                                item4.gr9 = item4.gr8 / item4.gr3;
                            }
                            //Члены семьи, находящиеся на иждивении члена КФХ
                            if (category.Equals(new Guid("{29840D05-362A-4D17-8B5F-934A7DBFCD07}")))
                            {
                                item5.gr3 = item5.gr3 != 0 ? (1 + (int)item5.gr3) : 1;
                                if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item5.gr4 += 1;
                                if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item5.gr5 += 1;
                                if (age <= 18)
                                {
                                    if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item5.gr6 += 1;
                                    if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item5.gr7 += 1;
                                }
                                if (repbudjet != 0) item5.gr8 = ((decimal?)item5.gr8 ?? 0m) + repbudjet;
                                item5.gr9 = item5.gr8 / item5.gr3;
                            }
                            //Официальные безработные, состоящие на учете в службе занятости
                            if (category.Equals(new Guid("{E04A2023-6B44-4FAA-A010-BBC63FA76831}")))
                            {
                                item6.gr3 = item6.gr3 != 0 ? (1 + (int)item6.gr3) : 1;
                                if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item6.gr4 += 1;
                                if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item6.gr5 += 1;
                                if (age <= 18)
                                {
                                    if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item6.gr6 += 1;
                                    if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item6.gr7 += 1;
                                }
                                if (repbudjet != 0) item6.gr8 = ((decimal?)item6.gr8 ?? 0m) + repbudjet;
                                item6.gr9 = item6.gr8 / item6.gr3;
                            }
                            //Члены семьи, находящиеся на иждивении официального безработного
                            if (category.Equals(new Guid("{1CB2518B-8CA0-4B5C-B0FB-1596F6A98508}")))
                            {
                                item7.gr3 = item7.gr3 != 0 ? (1 + (int)item7.gr3) : 1;
                                if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item7.gr4 += 1;
                                if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item7.gr5 += 1;
                                if (age <= 18)
                                {
                                    if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item7.gr6 += 1;
                                    if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item7.gr7 += 1;
                                }
                                if (repbudjet != 0) item7.gr8 = ((decimal?)item7.gr8 ?? 0m) + repbudjet;
                                item7.gr9 = item7.gr8 / item7.gr3;
                            }
                            //Получатель соц. пособия
                            if (category.Equals(new Guid("{95BB1AF7-B6F0-465F-AB87-C55938651E96}")))
                            {
                                item8.gr3 = item8.gr3 != 0 ? (1 + (int)item8.gr3) : 1;
                                if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item8.gr4 += 1;
                                if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item8.gr5 += 1;
                                if (age <= 18)
                                {
                                    if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item8.gr6 += 1;
                                    if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item8.gr7 += 1;
                                }
                                if (repbudjet != 0) item8.gr8 = ((decimal?)item8.gr8 ?? 0m) + repbudjet;
                                item8.gr9 = item8.gr8 / item8.gr3;
                            }
                            //Член семьи, состоявший на иждивении получателя соц. пособия
                            if (category.Equals(new Guid("{36D6BD74-E609-4197-A473-60647745CC58}")))
                            {
                                item9.gr3 = item9.gr3 != 0 ? (1 + (int)item9.gr3) : 1;
                                if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item9.gr4 += 1;
                                if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item9.gr5 += 1;
                                if (age <= 18)
                                {
                                    if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item9.gr6 += 1;
                                    if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item9.gr7 += 1;
                                }
                                if (repbudjet != 0) item9.gr8 = ((decimal?)item9.gr8 ?? 0m) + repbudjet;
                                item9.gr9 = item9.gr8 / item9.gr3;
                            }
                            //Безработное лицо
                            if (category.Equals(new Guid("{21369665-8ED8-4D41-A050-DEBAF5161703}")))
                            {
                                item10.gr3 = item10.gr3 != 0 ? (1 + (int)item10.gr3) : 1;
                                if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item10.gr4 += 1;
                                if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item10.gr5 += 1;
                                if (age <= 18)
                                {
                                    if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item10.gr6 += 1;
                                    if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item10.gr7 += 1;
                                }
                                if (repbudjet != 0) item10.gr8 = ((decimal?)item10.gr8 ?? 0m) + repbudjet;
                                item10.gr9 = item10.gr8 / item10.gr3;
                            }
                            //Член семьи состоявший на иждивении безработного лица
                            if (category.Equals(new Guid("{760460B6-3157-4A9A-A0EF-F0239AF33274}")))
                            {
                                item11.gr3 = item11.gr3 != 0 ? (1 + (int)item11.gr3) : 1;
                                if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item11.gr4 += 1;
                                if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item11.gr5 += 1;
                                if (age <= 18)
                                {
                                    if (gender.Equals(new Guid("{56E07640-5B5B-47FA-832D-A6639F36EB71}"))) item11.gr6 += 1;
                                    if (gender.Equals(new Guid("{74C6C7FE-53C6-4492-A62F-65A7A49AB644}"))) item11.gr7 += 1;
                                }
                                if (repbudjet != 0) item11.gr8 = ((decimal?)item11.gr8 ?? 0m) + repbudjet;
                                item11.gr9 = item11.gr8 / item11.gr3;
                            }
                        }
                    }
                }
            }
            static void RemoveRows(WorkflowContext context, Guid reportId)
            {
                var docRepo = context.Documents;
                var rows = new List<Guid>();
                var qb = new QueryBuilder(reportItemDefId, context.UserId);
                qb.Where("Report").Eq(reportId).Or("Report").IsNull();
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read()) rows.Add(reader.GetGuid(0));
                }
                foreach (var rowId in rows)
                {
                    docRepo.DeleteById(rowId);
                }
            }
            private static readonly Guid legalRitualDefId = new Guid("{89ADB43B-0D29-4287-AF5B-0E0DCED18B01}"); //Сведения о расходах по выплате ритуального пособия
            private static readonly Guid legalSectionDefId = new Guid("{EC14A952-D4D8-4EA8-90F5-50121CC4B173}"); //Разделы отчетов для юридического лица
            private static readonly Guid personDefId = new Guid("{D71CE61A-9B59-4B5E-8713-8131DBB5BA02}"); //Person
            private static readonly Guid appRitualDefId = new Guid("{A7762DDE-ABB8-4A22-B942-33DB2C2C6E58}"); //Заявление на назначение ритуального пособия (на погребение)
            private static readonly Guid approvedStateId = new Guid("{9A1F1E23-1E8B-4830-AD99-1D0AB3272564}");  //утвержден

            private static readonly Guid reportItemDefId = new Guid("{32AEB528-1226-478D-B451-1301E01284D5}"); //Наименование столбцов заявки на выплату 
        }

        //Динамика численности получателей ритуального пособия с 2019 года
        public static class DinamicReportsRP
        {
            private static readonly Guid reportDefId = new Guid("{F3269C26-5380-43D4-873C-BF9B54318770}"); //  Заявка на выплату
            private static readonly Guid reportItemDefId = new Guid("{32AEB528-1226-478D-B451-1301E01284D5}"); //Наименование столбцов заявки на выплату 
            private static readonly Guid ritualBenefitDefId = new Guid("{89ADB43B-0D29-4287-AF5B-0E0DCED18B01}"); //Сведения о расходах по выплате ритуального пособия            

            private static readonly Guid appRitualDefId = new Guid("{A7762DDE-ABB8-4A22-B942-33DB2C2C6E58}"); //Заявление на назначение ритуального пособия (на погребение)
            private static readonly Guid legalReportDefId = new Guid("{EC14A952-D4D8-4EA8-90F5-50121CC4B173}"); //Разделы отчетов для юридического лица
            private static readonly Guid orgPofileDefId = new Guid("{BB23529B-072D-4E85-87D4-337473458EC2}"); //Профиль организации
            private static readonly Guid approvedStateId = new Guid("{9A1F1E23-1E8B-4830-AD99-1D0AB3272564}");  //утвержден         
            
            public static List<ReportRP3Item> Execute(WorkflowContext context, int year)
            {
                var items = new List<ReportRP3Item>();
                CalcItems(context, year, items);
                return items;
            }
            public static void CalcItems(WorkflowContext context, int year, List<ReportRP3Item> items)
            {
                var qb = new QueryBuilder(ritualBenefitDefId, context.UserId);
                qb.Where("LegalReportSection").Include("&State").Eq(approvedStateId).End();                
                
                var query = context.CreateSqlQuery(qb.Def); //беременность роды - юр. лицо
                var legalSrc = query.JoinSource(query.Source, legalReportDefId, SqlSourceJoinType.Inner, "LegalReportSection");

                query.AddAttribute(query.Source, "&Id");
                query.AddAttribute(query.Source, "Citizenship");
                query.AddAttribute(query.Source, "DeadCadThrowRepublicBudget"); //За счет республиканского бюджета (сом)
                query.AddAttribute(legalSrc, "ReportDate");

                var table = new DataTable();
                using (var reader = context.CreateSqlReader(query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    var nation = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                    decimal repbudjet = row[2] is DBNull ? 0m : (decimal)row[2];
                    var reportDate = row[3] is DBNull ? DateTime.MaxValue : (DateTime)row[3];

                    var item = new ReportRP3Item();
                    var today = DateTime.Today;
                    if(appId != Guid.Empty)
                    {
                        if (reportDate.Year == year)
                        {
                            item.gr1 = reportDate.Year;
                            item.gr2 += 1;
                            if (nation.Equals(new Guid("{9AD0E64A-0DAB-41E5-9BA6-2BBDCC0A5A7D}"))) item.gr3_1 += 1;
                            if (nation.Equals(new Guid("{D760CC4E-052B-472F-A647-DB267C7D4B46}"))) item.gr3_2 += 1;
                            if (repbudjet != 0) item.gr4 = ((decimal?)item.gr4 ?? 0m) + repbudjet;
                            item.gr5 = item.gr4 / item.gr2;
                            items.Add(item);
                        }                        
                    }
                }
                //Сведения о расходах по выплате ритуального пособия
                var qbApp = new QueryBuilder(appRitualDefId, context.UserId);
                qbApp.Where("&State").Eq(approvedStateId);
                var queryApp = context.CreateSqlQuery(qbApp.Def);                               

                queryApp.AddAttribute(queryApp.Source, "&Id");
                queryApp.AddAttribute(queryApp.Source, "Citizenship");
                queryApp.AddAttribute(queryApp.Source, "AssignedAmountRepublicBudget");
                queryApp.AddAttribute(queryApp.Source, "RegDate");                

                var tableApp = new DataTable();
                using (var readerL = context.CreateSqlReader(queryApp))
                {
                    readerL.Open();
                    readerL.Fill(tableApp);
                    readerL.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    var nation = row[1] is DBNull ? Guid.Empty : (Guid)row[1];
                    decimal repbudjet = row[2] is DBNull ? 0m : (decimal)row[2];
                    var regDate = row[3] is DBNull ? DateTime.MaxValue : (DateTime)row[3];

                    var item = new ReportRP3Item();
                    var today = DateTime.Today;
                    if(appId != Guid.Empty)
                    {
                        if (regDate.Year >= year)
                        {
                            item.gr1 = regDate.Year;
                            item.gr2 += 1;
                            if (nation.Equals(new Guid("{9AD0E64A-0DAB-41E5-9BA6-2BBDCC0A5A7D}"))) item.gr3_1 += 1;
                            if (nation.Equals(new Guid("{D760CC4E-052B-472F-A647-DB267C7D4B46}"))) item.gr3_2 += 1;
                            if (repbudjet != 0) item.gr4 = ((decimal?)item.gr4 ?? 0m) + repbudjet;
                            item.gr5 = item.gr4 / item.gr2;
                            items.Add(item);
                        }                        
                    }
                }
            }
        }

        //Сведения о численности получателей пособия по БР по категориям получателей
        public static class Report_F8
        {
            public static List<ReportF8Item> Execute(WorkflowContext context, DateTime fd, DateTime ld)
            {
                var ui = context.GetUserInfo();
                var orgId = ui.OrganizationId.Value;

                var docs = new string[]
                {
                    "Юридических лиц",
                    "ИП",
                    "Член КФХ",
                    "Безработная",
                    "Итого по беременности и родам",
                    "На погребение 100%",
                    "На погребение 50%",
                    "На погребение 20%",
                    "Итого на погребение",
                    "Всего"
                };
                var items = new List<ReportF8Item>();
                int i2 = 1;
                foreach (var i in docs)
                {
                    var item = new ReportF8Item();
                    item.rowName = i;
                    item.rowNo = i2;
                    i2++;
                    items.Add(item);
                }
                CalcItems(context, /*report*/ fd, ld, orgId, items[9], items[8], items[7], items[6], items[5], items[4], items[3], items[2], items[1], items[0]);
                return items;
            }
            public static void CalcItems(WorkflowContext context, DateTime fd, DateTime ld, Guid orgId, ReportF8Item item9, ReportF8Item item8, ReportF8Item item7, ReportF8Item item6, ReportF8Item item5, ReportF8Item item4, ReportF8Item item3, ReportF8Item item2, ReportF8Item item1, ReportF8Item item0)
            {
                var today = DateTime.Today;
                var year = today.Year;
                var fromFd = new DateTime(year, 1, 1);
                var lastFd = fromFd.AddMonths(-1); //01-12-2019
                var lastLd = fromFd.AddDays(-1); //31-12-2019

                var qb = new QueryBuilder(legalPregDefId, context.UserId);
                qb.Where("LegalReportSection").Include("ReportDate").Ge(lastFd).And("ReportDate").Le(ld).And("&State").Eq(approvedStateId).End();

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    var legalSrc = query.JoinSource(query.Source, legalSectionDefId, SqlSourceJoinType.Inner, "LegalReportSection");
                    query.AddCondition(ExpressionOperation.And, legalPregDefId, "&OrgId", ConditionOperation.Equal, orgId);
                    var legalPINSrc = query.JoinSource(query.Source, legPersonDefId, SqlSourceJoinType.Inner, "Person");
                    var legINNSrc = query.JoinSource(legalSrc, legalPersonDefId, SqlSourceJoinType.Inner, "LegalPerson");

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(query.Source, "BirthCadThrowRepublicBudget");
                    query.AddAttribute(legalSrc, "ReportDate");
                    query.AddAttribute(legalPINSrc, "PIN");
                    query.AddAttribute(legINNSrc, "PIN");

                    var table = new DataTable();
                    using (var reader = context.CreateSqlReader(query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        decimal repbudjet = row[1] is DBNull ? 0m : (decimal)row[1];
                        var reportDate = row[2] is DBNull ? DateTime.MaxValue : (DateTime)row[2];
                        var pin = row[3] is DBNull ? "---" : (string)row[3];
                        var inn = row[4] is DBNull ? "---" : (string)row[4];

                        if (appId != Guid.Empty)
                        {
                            item0.gr5 = item0.gr5 != 0 ? (1 + (int)item0.gr5) : 1;
                            if (repbudjet != 0) item0.gr6 = ((decimal?)item0.gr6 ?? 0m) + repbudjet;
                            if (reportDate >= fd && reportDate <= ld)
                            {
                                item0.test += inn + ": " + pin + " ";
                                item0.gr7 = item0.gr7 != 0 ? (1 + (int)item0.gr7) : 1;
                                item0.gr11 = item0.gr7;
                                if (repbudjet != 0) item0.gr8 = ((decimal?)item0.gr8 ?? 0m) + repbudjet;
                                item0.gr12 = item0.gr8;
                            }
                            if (reportDate >= lastFd && reportDate <= fd)
                            {
                                //item0.gr9 += 1;    
                                item0.gr9 = item0.gr5 - item0.gr7;
                                if (repbudjet != 0) item0.gr10 = ((decimal?)item0.gr10 ?? 0m) + repbudjet;
                            }
                        }                               
                    }
                }
                //ИП
                var qb1 = new QueryBuilder(appPregnancyDefId, context.UserId);
                qb1.Where("&OrgId").Eq(orgId).And("RegDate").Ge(lastFd).And("RegDate").Le(ld).And("&State").Eq(approvedStateId);

                using (var query1 = SqlQueryBuilder.Build(context.DataContext, qb1.Def))
                {
                    query1.AddAttribute(query1.Source, "&Id");                  
                    query1.AddAttribute(query1.Source, "AssignedAmountRepublicBudgetBR");                    
                    query1.AddAttribute(query1.Source, "IndividualBusiness");
                    query1.AddAttribute(query1.Source, "RegDate");
                    query1.AddAttribute(query1.Source, "Service");

                    var table1 = new DataTable();
                    using (var reader = context.CreateSqlReader(query1))
                    {
                        reader.Open();
                        reader.Fill(table1);
                        reader.Close();
                    }
                    foreach (DataRow row in table1.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var repbudjet = row[1] is DBNull ? 0m : (decimal)row[1];
                        var ip = row[2] is DBNull ? false : (bool)row[2];
                        var regDate = row[3] is DBNull ? DateTime.MaxValue : (DateTime)row[3];
                        var service = row[4] is DBNull ? Guid.Empty : (Guid)row[4];

                        if (appId != Guid.Empty)
                        {
                            if (ip)
                            {
                                item1.gr5 = item1.gr5 != 0 ? (1 + (int)item1.gr5) : 1;
                                if (repbudjet != 0) item1.gr6 = ((decimal?)item1.gr6 ?? 0m) + repbudjet;
                                if (regDate >= fd && regDate <= ld)
                                {
                                    item1.gr7 = item1.gr7 != 0 ? (1 + (int)item1.gr7) : 1;
                                    item1.gr11 = item1.gr7;
                                    if (repbudjet != 0)
                                    {
                                        item1.gr8 = ((decimal?)item1.gr8 ?? 0m) + repbudjet;
                                        item1.gr12 = item1.gr8;
                                        if (service.Equals(new Guid("{E334A112-E22E-4240-A4F6-07521DEC6AA1}")))
                                        {
                                            item1.gr13 += repbudjet * (decimal)0.005;
                                        }
                                        else if (service.Equals(new Guid("{6DDA2402-1C73-4B34-8C46-6321B3BE0C51}")))
                                        {
                                            item1.gr13 += repbudjet * (decimal)0.013;                                            
                                        }
                                    }
                                }
                                if (regDate >= lastFd && regDate <= fd)
                                {
                                    //item1.gr9 += 1;
                                    item1.gr9 = item1.gr5 - item1.gr7;
                                    if (repbudjet != 0) item1.gr10 = ((decimal?)item1.gr10 ?? 0m) + repbudjet;
                                }
                            }                            
                        }
                    }
                }
                //КФХ
                var qb2 = new QueryBuilder(appPregnancyDefId, context.UserId);
                qb2.Where("&OrgId").Eq(orgId).And("RegDate").Ge(lastFd).And("RegDate").Le(ld).And("&State").Eq(approvedStateId);

                using (var query2 = SqlQueryBuilder.Build(context.DataContext, qb2.Def))
                {
                    query2.AddAttribute(query2.Source, "&Id");
                    query2.AddAttribute(query2.Source, "AssignedAmountRepublicBudgetBR");
                    query2.AddAttribute(query2.Source, "PeasantFarming");
                    query2.AddAttribute(query2.Source, "RegDate");
                    query2.AddAttribute(query2.Source, "Service");
                    query2.AddAttribute(query2.Source, "RegNo");

                    var table2 = new DataTable();
                    using (var reader = context.CreateSqlReader(query2))
                    {
                        reader.Open();
                        reader.Fill(table2);
                        reader.Close();
                    }
                    foreach (DataRow row in table2.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var repbudjet = row[1] is DBNull ? 0m : (decimal)row[1];
                        var kfx = row[2] is DBNull ? false : (bool)row[2];
                        var regDate = row[3] is DBNull ? DateTime.MaxValue : (DateTime)row[3];
                        var service = row[4] is DBNull ? Guid.Empty : (Guid)row[4];
                        var no = row[5] is DBNull ? "" : row[5].ToString();


                        if (appId != Guid.Empty)
                        {
                            if (kfx)
                            {
                                item2.gr5 = item2.gr5 != 0 ? (1 + (int)item2.gr5) : 1;
                                if (repbudjet != 0) item2.gr6 = ((decimal?)item2.gr6 ?? 0m) + repbudjet;
                                if (regDate >= fd && regDate <= ld)
                                {
                                    item2.gr7 = item2.gr7 != 0 ? (1 + (int)item2.gr7) : 1;
                                    item2.gr11 = item2.gr7;
                                    if (repbudjet != 0)
                                    {
                                        item2.gr8 = ((decimal?)item2.gr8 ?? 0m) + repbudjet;
                                        item2.gr12 = item2.gr8;
                                        if (service.Equals(new Guid("{E334A112-E22E-4240-A4F6-07521DEC6AA1}"))) //банк
                                        { 
                                            item2.gr13 += repbudjet * (decimal)0.005;
                                        }
                                        else if (service.Equals(new Guid("{6DDA2402-1C73-4B34-8C46-6321B3BE0C51}"))) //банк
                                        {
                                            item2.gr13 += repbudjet * (decimal)0.013;                                           
                                        }
                                    }
                                }
                                if (regDate >= lastFd && regDate <= fd)
                                {
                                    //item2.gr9 += 1;
                                    //item2.test += no + ";";
                                    item2.gr9 = item2.gr5 - item2.gr7;
                                    if (repbudjet != 0) item2.gr10 = ((decimal?)item2.gr10 ?? 0m) + repbudjet;
                                }
                            }
                        }
                    }
                }
                //ОБ
                var qb3 = new QueryBuilder(appPregnancyDefId, context.UserId);
                qb3.Where("&OrgId").Eq(orgId).And("RegDate").Ge(lastFd).And("RegDate").Le(ld).And("&State").Eq(approvedStateId);

                using (var query3 = SqlQueryBuilder.Build(context.DataContext, qb3.Def))
                {
                    query3.AddAttribute(query3.Source, "&Id");
                    query3.AddAttribute(query3.Source, "AssignedAmountRepublicBudgetBR");
                    query3.AddAttribute(query3.Source, "OfficiallyUnemployed");
                    query3.AddAttribute(query3.Source, "RegDate");
                    query3.AddAttribute(query3.Source, "Service");

                    var table3 = new DataTable();
                    using (var reader = context.CreateSqlReader(query3))
                    {
                        reader.Open();
                        reader.Fill(table3);
                        reader.Close();
                    }
                    foreach (DataRow row in table3.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var repbudjet = row[1] is DBNull ? 0m : (decimal)row[1];
                        var ob = row[2] is DBNull ? false : (bool)row[2];
                        var regDate = row[3] is DBNull ? DateTime.MaxValue : (DateTime)row[3];
                        var service = row[4] is DBNull ? Guid.Empty : (Guid)row[4];

                        if (appId != Guid.Empty)
                        {
                            if (ob)
                            {
                                item3.gr5 = item3.gr5 != 0 ? (1 + (int)item3.gr5) : 1;
                                if (repbudjet != 0) item3.gr6 = ((decimal?)item3.gr6 ?? 0m) + repbudjet;
                                if (regDate >= fd && regDate <= ld)
                                {
                                    item3.gr7 = item3.gr7 != 0 ? (1 + (int)item3.gr7) : 1;
                                    item3.gr11 = item3.gr7;
                                    if (repbudjet != 0)
                                    {
                                        item3.gr8 = ((decimal?)item3.gr8 ?? 0m) + repbudjet;
                                        item3.gr12 = item3.gr8;
                                        if (service.Equals(new Guid("{E334A112-E22E-4240-A4F6-07521DEC6AA1}")))
                                        {
                                            item3.gr13 += repbudjet * (decimal)0.005;
                                        }
                                        else if (service.Equals(new Guid("{6DDA2402-1C73-4B34-8C46-6321B3BE0C51}")))
                                        {
                                            item3.gr13 += repbudjet * (decimal)0.013;
                                        }
                                    }
                                }
                                if (regDate >= lastFd && regDate <= fd)
                                {
                                    //item3.gr9 += 1;
                                    item3.gr9 = item3.gr5 - item3.gr7;
                                    if (repbudjet != 0) item3.gr10 = ((decimal?)item3.gr10 ?? 0m) + repbudjet;
                                }
                            }
                        }
                    }
                }
                item4.gr3 = item0.gr3 + item1.gr3 + item2.gr3 + item3.gr3;
                item4.gr4 = item0.gr4 + item1.gr4 + item2.gr4 + item3.gr4;
                item4.gr5 = item0.gr5 + item1.gr5 + item2.gr5 + item3.gr5;
                item4.gr6 = item0.gr6 + item1.gr6 + item2.gr6 + item3.gr6;
                item4.gr7 = item0.gr7 + item1.gr7 + item2.gr7 + item3.gr7;
                item4.gr8 = item0.gr8 + item1.gr8 + item2.gr8 + item3.gr8;
                item4.gr9 = item0.gr9 + item1.gr9 + item2.gr9 + item3.gr9;
                item4.gr10 = item0.gr10 + item1.gr10 + item2.gr10 + item3.gr10;
                item4.gr11 = item0.gr11 + item1.gr11 + item2.gr11 + item3.gr11;
                item4.gr12 = item0.gr12 + item1.gr12 + item2.gr12 + item3.gr12;
                item4.gr13 = item1.gr13 + item2.gr13 + item3.gr13;

                //РП
                var qb4 = new QueryBuilder(legalRitualDefId, context.UserId);
                qb4.Where("LegalReportSection").Include("ReportDate").Ge(lastFd).And("ReportDate").Le(ld).And("&State").Eq(approvedStateId).End();

                using (var query = SqlQueryBuilder.Build(context.DataContext, qb4.Def))
                {
                    var legalSrc = query.JoinSource(query.Source, legalSectionDefId, SqlSourceJoinType.Inner, "LegalReportSection");
                    query.AddCondition(ExpressionOperation.And, legalRitualDefId, "&OrgId", ConditionOperation.Equal, orgId);

                    query.AddAttribute(query.Source, "&Id");
                    query.AddAttribute(query.Source, "DeadCadThrowRepublicBudget");
                    query.AddAttribute(legalSrc, "ReportDate");

                    var table = new DataTable();
                    using (var reader = context.CreateSqlReader(query))
                    {
                        reader.Open();
                        reader.Fill(table);
                        reader.Close();
                    }
                    foreach (DataRow row in table.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        decimal repbudjet = row[1] is DBNull ? 0m : (decimal)row[1];
                        var reportDate = row[2] is DBNull ? DateTime.MaxValue : (DateTime)row[2];

                        if (appId != Guid.Empty)
                        {
                            item5.gr5 = item5.gr5 != 0 ? (1 + (int)item5.gr5) : 1;
                            if (repbudjet != 0) item5.gr6 = ((decimal?)item5.gr6 ?? 0m) + repbudjet;
                            if (reportDate >= fd && reportDate <= ld)
                            {
                                item5.gr7 = item5.gr7 != 0 ? (1 + (int)item5.gr7) : 1;
                                item5.gr11 = item5.gr7;
                                if (repbudjet != 0) item5.gr8 = ((decimal?)item5.gr8 ?? 0m) + repbudjet;
                                item5.gr12 = item5.gr8;
                            }
                            if (reportDate >= lastFd && reportDate <= fd)
                            {
                                item5.gr9 += 1;
                                if (repbudjet != 0) item5.gr10 = ((decimal?)item5.gr10 ?? 0m) + repbudjet;
                            }
                            item5.gr3 = GetCountLegalReport(context, orgId, ld);
                            item5.gr4 = GetRPAmountLegalReport(context, orgId, ld);
                        }
                    }
                }
                /**************************************************************************************************/
                //100%
                var qb5 = new QueryBuilder(appRitualDefId, context.UserId);
                qb5.Where("&OrgId").Eq(orgId).And("RegDate").Ge(lastFd).And("RegDate").Le(ld).And("CategoriesOfRitalBenefits").Eq(categoryEnumId1).And("&State").Eq(approvedStateId);

                using (var query1 = SqlQueryBuilder.Build(context.DataContext, qb5.Def))
                {
                    query1.AddAttribute(query1.Source, "&Id");
                    query1.AddAttribute(query1.Source, "AssignedAmountRepublicBudget");
                    query1.AddAttribute(query1.Source, "RegDate");
                    query1.AddAttribute(query1.Source, "Service");

                    var table1 = new DataTable();
                    using (var reader = context.CreateSqlReader(query1))
                    {
                        reader.Open();
                        reader.Fill(table1);
                        reader.Close();
                    }
                    foreach (DataRow row in table1.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var repbudjet = row[1] is DBNull ? 0m : (decimal)row[1];
                        var regDate = row[2] is DBNull ? DateTime.MaxValue : (DateTime)row[2];
                        var service = row[3] is DBNull ? Guid.Empty : (Guid)row[3];

                        if (appId != Guid.Empty)
                        {
                            item5.gr5 = item5.gr5 != 0 ? (1 + (int)item5.gr5) : 1;
                            if (repbudjet != 0) item5.gr6 = ((decimal?)item5.gr6 ?? 0m) + repbudjet;
                            if (regDate >= fd && regDate <= ld)
                            {
                                item5.gr7 = item5.gr7 != 0 ? (1 + (int)item5.gr7) : 1;
                                item5.gr11 = item5.gr7;
                                if (repbudjet != 0)
                                {
                                    item5.gr8 = ((decimal?)item5.gr8 ?? 0m) + repbudjet;
                                    item5.gr12 = item5.gr8;
                                    if (service.Equals(new Guid("{E334A112-E22E-4240-A4F6-07521DEC6AA1}")))
                                    {
                                        item5.gr13 += repbudjet * (decimal)0.005;
                                    }
                                    else if (service.Equals(new Guid("{6DDA2402-1C73-4B34-8C46-6321B3BE0C51}")))
                                    {
                                        item5.gr13 += repbudjet * (decimal)0.013;
                                    }
                                    item8.gr13 += item5.gr13;
                                    item9.gr13 += item8.gr13;
                                }
                            }
                            if (regDate >= lastFd && regDate <= fd)
                            {
                                item5.gr9 += 1;
                                if (repbudjet != 0) item5.gr10 = ((decimal?)item5.gr10 ?? 0m) + repbudjet;
                            }
                        }
                    }
                }
                //50%
                var qb6 = new QueryBuilder(appRitualDefId, context.UserId);
                qb6.Where("&OrgId").Eq(orgId).And("RegDate").Ge(lastFd).And("RegDate").Le(ld).And("CategoriesOfRitalBenefits").In(list50Category).And("&State").Eq(approvedStateId);

                using (var query6 = SqlQueryBuilder.Build(context.DataContext, qb6.Def))
                {
                    query6.AddAttribute(query6.Source, "&Id");
                    query6.AddAttribute(query6.Source, "AssignedAmountRepublicBudget");
                    query6.AddAttribute(query6.Source, "RegDate");
                    query6.AddAttribute(query6.Source, "Service");

                    var table6 = new DataTable();
                    using (var reader = context.CreateSqlReader(query6))
                    {
                        reader.Open();
                        reader.Fill(table6);
                        reader.Close();
                    }
                    foreach (DataRow row in table6.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var repbudjet = row[1] is DBNull ? 0m : (decimal)row[1];
                        var regDate = row[2] is DBNull ? DateTime.MaxValue : (DateTime)row[2];
                        var service = row[3] is DBNull ? Guid.Empty : (Guid)row[3];

                        if (appId != Guid.Empty)
                        {
                            item6.gr5 = item6.gr5 != 0 ? (1 + (int)item6.gr5) : 1;
                            if (repbudjet != 0) item6.gr6 = ((decimal?)item6.gr6 ?? 0m) + repbudjet;
                            if (regDate >= fd && regDate <= ld)
                            {
                                item6.gr7 = item6.gr7 != 0 ? (1 + (int)item6.gr7) : 1;
                                item6.gr11 = item6.gr7;
                                if (repbudjet != 0)
                                {
                                    item6.gr8 = ((decimal?)item6.gr8 ?? 0m) + repbudjet;
                                    item6.gr12 = item6.gr8;
                                    if (service.Equals(new Guid("{E334A112-E22E-4240-A4F6-07521DEC6AA1}")))
                                    {
                                        item6.gr13 += repbudjet * (decimal)0.005;
                                    }
                                    else if (service.Equals(new Guid("{6DDA2402-1C73-4B34-8C46-6321B3BE0C51}")))
                                    {
                                        item6.gr13 += repbudjet * (decimal)0.013;
                                    }
                                    item8.gr13 += item6.gr13;
                                    item9.gr13 += item8.gr13;
                                }
                            }
                            if (regDate >= lastFd && regDate <= fd)
                            {
                                item6.gr9 += 1;
                                if (repbudjet != 0) item6.gr10 = ((decimal?)item6.gr10 ?? 0m) + repbudjet;
                            }
                        }
                    }
                }
                //20%
                var qb7 = new QueryBuilder(appRitualDefId, context.UserId);
                qb7.Where("&OrgId").Eq(orgId).And("RegDate").Ge(lastFd).And("RegDate").Le(ld).And("CategoriesOfRitalBenefits").In(list20Category).And("&State").Eq(approvedStateId);

                using (var query2 = SqlQueryBuilder.Build(context.DataContext, qb7.Def))
                {
                    query2.AddAttribute(query2.Source, "&Id");
                    query2.AddAttribute(query2.Source, "AssignedAmountRepublicBudget");
                    query2.AddAttribute(query2.Source, "RegDate");
                    query2.AddAttribute(query2.Source, "Service");

                    var table2 = new DataTable();
                    using (var reader = context.CreateSqlReader(query2))
                    {
                        reader.Open();
                        reader.Fill(table2);
                        reader.Close();
                    }
                    foreach (DataRow row in table2.Rows)
                    {
                        var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                        var repbudjet = row[1] is DBNull ? 0m : (decimal)row[1];
                        var regDate = row[2] is DBNull ? DateTime.MaxValue : (DateTime)row[2];
                        var service = row[3] is DBNull ? Guid.Empty : (Guid)row[3];

                        if (appId != Guid.Empty)
                        {
                            item7.gr5 = item7.gr5 != 0 ? (1 + (int)item7.gr5) : 1;
                            if (repbudjet != 0) item7.gr6 = ((decimal?)item7.gr6 ?? 0m) + repbudjet;
                            if (regDate >= fd && regDate <= ld)
                            {
                                item7.gr7 = item7.gr7 != 0 ? (1 + (int)item7.gr7) : 1;
                                item7.gr11 = item7.gr7;
                                if (repbudjet != 0)
                                {
                                    item7.gr8 = ((decimal?)item7.gr8 ?? 0m) + repbudjet;
                                    item7.gr12 = item7.gr8;
                                    if (service.Equals(new Guid("{E334A112-E22E-4240-A4F6-07521DEC6AA1}")))
                                    {
                                        item7.gr13 += repbudjet * (decimal)0.005;
                                    }
                                    else if (service.Equals(new Guid("{6DDA2402-1C73-4B34-8C46-6321B3BE0C51}")))
                                    {
                                        item7.gr13 += repbudjet * (decimal)0.013;
                                    }
                                    item8.gr13 += item7.gr13;
                                    item9.gr13 += item8.gr13;
                                }
                            }
                            if (regDate >= lastFd && regDate <= fd)
                            {
                                item7.gr9 += 1;
                                if (repbudjet != 0) item7.gr10 = ((decimal?)item7.gr10 ?? 0m) + repbudjet;
                            }
                        }
                    }
                }

                item8.gr3 = item5.gr3 + item6.gr3 + item7.gr3;
                item8.gr4 = item5.gr4 + item6.gr4 + item7.gr4;
                item8.gr5 = item5.gr5 + item6.gr5 + item7.gr5;
                item8.gr6 = item5.gr6 + item6.gr6 + item7.gr6;
                item8.gr7 = item5.gr7 + item6.gr7 + item7.gr7;
                item8.gr8 = item5.gr8 + item6.gr8 + item7.gr8;
                item8.gr9 = item5.gr9 + item6.gr9 + item7.gr9;
                item8.gr10 = item5.gr10 + item6.gr10 + item7.gr10;
                item8.gr11 = item5.gr11 + item6.gr11 + item7.gr11;
                item8.gr12 = item5.gr12 + item6.gr12 + item7.gr12;
                //item8.gr13 = item6.gr13 + item7.gr13 + item8.gr13;

                item9.gr3 = item4.gr3 + item8.gr3;
                item9.gr4 = item4.gr4 + item8.gr4;
                item9.gr5 = item4.gr5 + item8.gr5;
                item9.gr6 = item4.gr6 + item8.gr6;
                item9.gr7 = item4.gr7 + item8.gr7;
                item9.gr8 = item4.gr8 + item8.gr8;
                item9.gr9 = item4.gr9 + item8.gr9;
                item9.gr10 = item4.gr10 + item8.gr10;
                item9.gr11 = item4.gr11 + item8.gr11;
                item9.gr12 = item4.gr12 + item8.gr12;
                //item9.gr13 = item4.gr13 + item8.gr13;
            }
            private static decimal GetAmountLegalReport(WorkflowContext context, Guid orgId, DateTime ld)
            {
                var today = DateTime.Today;
                var year = today.Year;
                var fromFd = new DateTime(year, 1, 1);
                var lastFd = fromFd.AddMonths(-1);
                var lastLd = fromFd.AddDays(-1);
                var qb = new QueryBuilder(legalSectionDefId, context.UserId);
                qb.Where("&OrgId").Eq(orgId).And("ReportDate").Ge(lastFd).And("ReportDate").Le(ld).And("&State").Eq(approvedStateId);
                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    query.AddAttribute(query.Source, "brTotalAmount", SqlQuerySummaryFunction.Sum);
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                        if (reader.Read()) return !reader.Reader.IsDBNull(0) ? reader.GetDecimal(0) : 0;
                    return 0m;
                }
            }
            private static decimal GetRPAmountLegalReport(WorkflowContext context, Guid orgId, DateTime ld)
            {
                var today = DateTime.Today;
                var year = today.Year;
                var fromFd = new DateTime(year, 1, 1);
                var lastFd = fromFd.AddMonths(-1);
                var lastLd = fromFd.AddDays(-1);
                var qb = new QueryBuilder(legalSectionDefId, context.UserId);
                qb.Where("&OrgId").Eq(orgId).And("ReportDate").Ge(lastFd).And("ReportDate").Le(ld).And("&State").Eq(approvedStateId);
                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    query.AddAttribute(query.Source, "ritTotalAmount", SqlQuerySummaryFunction.Sum);
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                        if (reader.Read()) return !reader.Reader.IsDBNull(0) ? reader.GetDecimal(0) : 0;
                    return 0m;
                }
            }
            private static int GetCountLegalReport(WorkflowContext context, Guid orgId, DateTime ld)
            {
                var today = DateTime.Today;
                var year = today.Year;
                var fromFd = new DateTime(year, 1, 1);
                var lastFd = fromFd.AddMonths(-1);
                var lastLd = fromFd.AddDays(-1);
                var qb = new QueryBuilder(legalSectionDefId, context.UserId);
                qb.Where("&OrgId").Eq(orgId).And("ReportDate").Ge(lastFd).And("ReportDate").Le(ld).And("&State").Eq(approvedStateId);
                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                   // var legalSrc = query.JoinSource(query.Source, legalSectionDefId, SqlSourceJoinType.LeftOuter, "LegalReportSection");
                    query.AddAttribute(query.Source, "LegalPerson", SqlQuerySummaryFunction.Count);
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                        if (reader.Read()) return !reader.Reader.IsDBNull(0) ? reader.GetInt32(0) : 0;
                    return 0;
                }
            }
            static void RemoveRows(WorkflowContext context, Guid reportId)
            {
                var docRepo = context.Documents;
                var rows = new List<Guid>();
                var qb = new QueryBuilder(reportItemDefId, context.UserId);
                qb.Where("Report").Eq(reportId).Or("Report").IsNull();
                var query = SqlQueryBuilder.Build(context.DataContext, qb.Def);
                query.AddAttribute("&Id");
                using (var reader = new SqlQueryReader(context.DataContext, query))
                {
                    while (reader.Read()) rows.Add(reader.GetGuid(0));
                }
                foreach (var rowId in rows)
                {
                    docRepo.DeleteById(rowId);
                }
            }

            private static readonly Guid legalPregDefId = new Guid("{46C27FED-B9E0-4DAA-9DD4-F984A526D9B5}"); //Сведения о расходах по выплате пособий по беременности и родам
            private static readonly Guid legalRitualDefId = new Guid("{89ADB43B-0D29-4287-AF5B-0E0DCED18B01}"); //Сведения о расходах по выплате ритуального пособия
            private static readonly Guid appPregnancyDefId = new Guid("{379C813C-E5AF-4ACF-9D4D-7FF8AF40AEAE}"); //Заявление на назначение пособия по беременности и родом
            private static readonly Guid appRitualDefId = new Guid("{A7762DDE-ABB8-4A22-B942-33DB2C2C6E58}"); //Заявление на назначение ритуального пособия (на погребение)
            private static readonly Guid legPersonDefId = new Guid("{D71CE61A-9B59-4B5E-8713-8131DBB5BA02}");

            private static readonly Guid legalSectionDefId = new Guid("{EC14A952-D4D8-4EA8-90F5-50121CC4B173}"); //Разделы отчетов для юридического лица
            private static readonly Guid legalPersonDefId = new Guid("{61AF4CEA-D77A-4305-8F0A-81A001BE5CFD}"); //Юридическое лицо            
            private static readonly Guid approvedStateId = new Guid("{9A1F1E23-1E8B-4830-AD99-1D0AB3272564}");  //утвержден

            private static readonly Guid reportItemDefId = new Guid("{32AEB528-1226-478D-B451-1301E01284D5}"); //Наименование столбцов заявки на выплату 
            //100%
            static Guid categoryEnumId1 = new Guid("{17092E08-8FB9-4507-9274-09D2A19C356F}"); //Работающее лицо
            //50%    
            private static Guid categoryEnumId2 = new Guid("{FBE9520C-C6FB-4D05-AA38-10500C54E680}"); //ИП
            private static Guid categoryEnumId3 = new Guid("{DBAB3219-38FA-4A3A-AF5A-BCF0435F0FA3}"); //Глава или совершеннолетний член КФХ   
            private static Guid categoryEnumId4 = new Guid("{E04A2023-6B44-4FAA-A010-BBC63FA76831}"); //Официально безработный
            private static Guid categoryEnumId5 = new Guid("{8DEABB5A-2C5A-4057-9B51-C8B016DD421E}"); //Член семьи, находящийся на иждивении работающего лица
            private static Guid categoryEnumId6 = new Guid("{95BB1AF7-B6F0-465F-AB87-C55938651E96}"); //Получатель соц. пособия
            //20%
            private static Guid categoryEnumId7 = new Guid("{7701BEC8-8239-45D5-AB5F-A85BFD0A8949}"); //Член семьи состоявший на иждивении ИП
            private static Guid categoryEnumId8 = new Guid("{29840D05-362A-4D17-8B5F-934A7DBFCD07}"); //Член семьи, состаявший на иждивении главы или совершеннолетнего члена КФХ
            private static Guid categoryEnumId9 = new Guid("{1CB2518B-8CA0-4B5C-B0FB-1596F6A98508}"); //Член семьи, состоявший на иждивении официального безработного
            private static Guid categoryEnumId10 = new Guid("{36D6BD74-E609-4197-A473-60647745CC58}"); //Член семьи, состоявший на иждивении получателя соц. пособия     
            private static Guid categoryEnumId11 = new Guid("{21369665-8ED8-4D41-A050-DEBAF5161703}"); //Безработное лицо                                                          
            private static Guid categoryEnumId111 = new Guid("{760460B6-3157-4A9A-A0EF-F0239AF33274}"); //Член семьи состоявший на иждивении безработного лица

            private static readonly object[] list100Category = new object[]
            {
                categoryEnumId1
            };
            private static readonly object[] list50Category = new object[]
            {
                categoryEnumId2,
                categoryEnumId3,
                categoryEnumId4,
                categoryEnumId5,
                categoryEnumId6
            };
            private static readonly object[] list20Category = new object[]
            {
                categoryEnumId7,
                categoryEnumId8,
                categoryEnumId9,
                categoryEnumId10,
                categoryEnumId11,
                categoryEnumId111
            };
        }

        //Сводная заявка по БРРП Форма 8
        public static class Report_F8SVOD
        {
            private static readonly Guid legalPregDefId = new Guid("{46C27FED-B9E0-4DAA-9DD4-F984A526D9B5}"); //Сведения о расходах по выплате пособий по беременности и родам            
            private static readonly Guid appPregancyDefId = new Guid("{379C813C-E5AF-4ACF-9D4D-7FF8AF40AEAE}"); //Заявление на назначение пособия по беременности и родом

            private static readonly Guid appRitualDefId = new Guid("{A7762DDE-ABB8-4A22-B942-33DB2C2C6E58}"); //Заявление на назначение ритуального пособия (на погребение)
            private static readonly Guid legalRitualDefId = new Guid("{89ADB43B-0D29-4287-AF5B-0E0DCED18B01}"); //Сведения о расходах по выплате ритуального пособия

            private static readonly Guid legalSectionDefId = new Guid("{EC14A952-D4D8-4EA8-90F5-50121CC4B173}"); //Разделы отчетов для юридического лица
            private static readonly Guid legalPersonDefId = new Guid("{61AF4CEA-D77A-4305-8F0A-81A001BE5CFD}"); //Юридическое лицо            
            private static readonly Guid approvedStateId = new Guid("{9A1F1E23-1E8B-4830-AD99-1D0AB3272564}");  //утвержден

            public static List<Guid> bishkekList = new List<Guid>//г.Бишкек              
            {                                                            
                //  new Guid("{E59E153E-4FE9-4872-BBD0-9E183793EFEF}"),            
                new Guid("{D4C5884F-1820-4DF5-9BF8-C48202ACB801}"),//первомайский                          
                new Guid("{20FF5245-DB58-443A-A31B-061200E939AA}"),//октябрь                 
                new Guid("{52315837-1B8F-4B80-9D8C-160214F4681A}"),//свердлово               
                new Guid("{E3BFB034-7638-4C14-8C0F-EA823CCA7A5B}")//ленин                                      
            };
            public static List<Guid> chuiList = new List<Guid>//Чуйская область
            {                                                                                            
                // new Guid("{41E34648-6C9D-44D0-8CA5-941DB051B163}"),
                new Guid("{30658F5A-DC22-4A7A-AAF6-63DFB7070C50}"),//чуй
                new Guid("{DC2174B4-479B-4F6F-9A9D-9BA28AB715CD}"),//аламудун
                new Guid("{7866D332-C471-4873-8F8B-6DA9EDC3683A}"),//ыссык-ата           
                new Guid("{C8641D03-B553-4F95-ADFB-EC002FD64E06}"),//москва
                new Guid("{19F7870D-4B5E-457A-B159-528F71374E1E}"),//жайыл                             
                new Guid("{093AFB08-3F18-4E5C-8EB6-86EF0DD711B9}"),//сокулук
                new Guid("{668D6957-1F76-49DE-B9AD-0F2C635DF2DD}"),//кемин                                    
                new Guid("{8B6510F7-3B6B-4C9D-B8A1-2349B78B2CF3}"),//город токмок
                new Guid("{5DF10BBC-D256-40F8-B641-5EF31CE11540}")//панфилов                                 
            };
            public static List<Guid> issyk_kulList = new List<Guid>//Иссык-Кульская область
            {
                // new Guid("{AD009808-FBAC-43CA-8671-5E790C213497}"),
                new Guid("{23DB562E-C0B7-4B7E-AC16-967C96500444}"),//балыкчы
                new Guid("{3277F73D-B02D-4F35-AD1A-80B349EECF6B}"),//тон
                new Guid("{C748CDB5-502A-4243-8494-48E224968019}"),//тюп                                                                         
                new Guid("{046FF80D-4D26-4E30-A41F-17873C0E2C8F}"),//жети-огуз  
                new Guid("{14EB7AEF-C331-4085-A83E-0F5EEBF2EAA3}"),//иссык-куль                                 
                new Guid("{1F892B98-97B4-4B58-B61F-7DFECBAC3B5E}"),//ак-суу
                new Guid("{AB27C82D-8348-4DBA-BA9C-CEAE3A67704E}")//каракол
            };
            public static List<Guid> narynList = new List<Guid>//Нарынская область
            {                                                                                
                // new Guid("{CF4CA271-9202-4A5A-AE49-EB6237C33982}"),
                new Guid("{51C381F2-6AD6-4382-81F9-3D36E9ABEA08}"),//кочкор
                new Guid("{4313A514-83B6-4FED-9731-4D838A6E91CD}"),//нарын район
                new Guid("{93DF61DD-A2FE-4F52-B961-F1B27BD27A8C}"),//нарын г
                new Guid("{B3C93041-BBEA-445D-B7E1-D42D9F3692C3}"),//акталаа
                new Guid("{B3EA3DE1-5D76-461C-90AC-68D312B7B665}"),//жумгал
                new Guid("{69EAAC3D-3525-4CE3-8C5E-42123B4ED9CB}")//ат-баши
            };
            public static List<Guid> talasList = new List<Guid>//Таласская область
            {
                //new Guid("{BC710978-8C0B-4063-8BA9-A12F75DE4829}"),
                new Guid("{C6D92271-6FF2-4641-A83F-D02610060C43}"),//кара-буура  
                new Guid("{3BB3CB8F-A747-4026-9031-C6B67EA9735B}"),//г талас
                new Guid("{16FD5BFF-7AB4-4B40-AAFB-0282BA5BE32E}"),//талас рн
                new Guid("{B8DACAD8-0118-4147-8BD2-30DCE891E5EB}"),//манас
                new Guid("{7F311898-D254-4668-8184-D1794E695A19}")//бакай-ата
            };
            public static List<Guid> jalal_abad = new List<Guid>//Джалал-Абадская область
            {
                // new Guid("{3ED50EFB-3E20-407C-93CB-9D8E0EF15B1B}"),
                new Guid("{18DBE2BE-BBB6-4BC2-9A33-8B25856C0382}"),//г джалалабад
                new Guid("{E4964796-6658-46A9-BD49-A34B3275CB1F}"),//ноокен
                new Guid("{DC448CE3-49F4-43F1-AEAA-F782341C62C0}"),//сузак
                new Guid("{AA65C2F7-3091-40E5-939D-6A18250E125A}"),//каракуль
                new Guid("{9D8B0CA0-D618-4157-AF15-5E7CCA7D9F23}"),//ташкумыр
                new Guid("{64ECD259-A848-474B-8E8D-571612A7E43B}"),//токтогул рн
                new Guid("{17F5601A-36B7-4FAC-A980-07F349239D5B}"),//базар-коргон
                new Guid("{9AFA2870-4609-4D8A-8417-11C2DBDEC94B}"),//майлысуу
                new Guid("{B42B4F13-2AA5-43D2-B738-CB02CA647D47}"),//кок-жангак
                new Guid("{B0A96501-F5F4-48A4-8103-6C7A7BA290C4}"),//тогуз-торо
                new Guid("{60F22545-CB84-4795-81A3-2EEEEB0FB88A}"),//ала-бука
                new Guid("{2765827A-88EF-4144-8050-9A2FD66FB136}"),//аксы
                new Guid("{A598BEA0-37C9-4DC2-9BC7-FB3AA1097E14}")//чаткал
            };
            public static List<Guid> oshList = new List<Guid>//Ошская область
            {
                // new Guid("{E01E9890-2A41-454E-9EC1-3D4AAF50ED62}"),
                new Guid("{8B739BFD-CF8F-4380-A246-8A34BCE9A231}"),//ош
                new Guid("{B382A964-BBD7-4540-B6E4-BC9250AB7005}"),//араван
                new Guid("{A3282FFC-BAFE-4B4E-99D0-C68509BE6133}"),//ноокат
                new Guid("{E5411CDD-3CAF-4798-A7BF-FD57C856C82B}"),//алай
                new Guid("{59FF6F9C-F047-4E25-B837-669AA0596B07}"),//кара-суу
                new Guid("{C1A54A26-CA15-4C29-8DEB-957F5B0FD002}"),//чон-алай
                new Guid("{E425497A-3C82-424E-9691-71EAAD4759D8}"),//узген рн
                new Guid("{D62E0B83-E589-491D-B0A4-8BEA42178231}"),//узген г
                new Guid("{A2317371-CC1D-4EB3-8ADF-D7BA33B75F87}")//каракулджа
            };
            public static List<Guid> batkenList = new List<Guid>//Баткенская область
            {
                //new Guid("{4E98AD82-8ED4-4727-8E24-678921AB534C}"),
                new Guid("{C7B6AA81-A4B7-4AD6-BE03-E4B54E8084DA}"),//лейлек
                new Guid("{5EE1AC59-52A1-45E3-84EC-54AD09FC9F1E}"),//баткен рн
                new Guid("{D328865B-EDE4-4674-92C6-C134F55C3C6F}"),//баткен г
                new Guid("{879F3420-E45A-4E11-9394-D0B1A0091805}"),//кадамжай
                new Guid("{32AF3EA3-4100-406F-8825-20CB8A1877AA}"),//кызыл-кия
                new Guid("{FF3B071C-FC51-4F64-8BD4-11A5377E93D2}")//сулюкта                                               
            };
            public static List<Guid> osh = new List<Guid>
            {
                new Guid ("{A99E469A-E8D4-4139-B89A-CE4AF6AA0733}")
            };
            public static List<ReportF8SVODItem> Execute(WorkflowContext context, DateTime fd, DateTime ld)
            {
                return CalcItems(context, fd, ld);
            }
            public static List<ReportF8SVODItem> CalcItems(WorkflowContext context, DateTime fd, DateTime ld)
            {
                var items = new List<ReportF8SVODItem>();
                var today = DateTime.Today;
                var year = today.Year;
                var fromFd = new DateTime(year, 1, 1);
                var lastFd = fromFd.AddMonths(-1);
                var lastLd = fromFd.AddDays(-1);
                var qb = new QueryBuilder(legalPregDefId, context.UserId);
                qb.Where("LegalReportSection").Include("ReportDate").Ge(lastFd).And("ReportDate").Le(ld).And("&State").Eq(approvedStateId).End();

                var query = context.CreateSqlQuery(qb.Def); //беременность роды - юр. лицо   
                var legalSrc = query.JoinSource(query.Source, legalSectionDefId, SqlSourceJoinType.Inner, "LegalReportSection");                

                query.AddAttribute(query.Source, "&Id");
                query.AddAttribute(query.Source, "BirthCadThrowRepublicBudget");
                query.AddAttribute(legalSrc, "ReportDate");
                query.AddAttribute(query.Source, "&OrgId");
                query.AddOrderAttribute(query.Source, "&OrgName");

                var table = new DataTable();
                using (var reader = context.CreateSqlReader(query))
                {
                    reader.Open();
                    reader.Fill(table);
                    reader.Close();
                }
                foreach (DataRow row in table.Rows)
                {
                    var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    decimal repbudjet = row[1] is DBNull ? 0m : (decimal)row[1];
                    var reportDate = row[2] is DBNull ? DateTime.MaxValue : (DateTime)row[2];
                    var orgId = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                    
                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);

                    if (appId != Guid.Empty)
                    {
                        rayon.gr5 += 1;
                        if (repbudjet != 0) rayon.gr6 = ((decimal?)rayon.gr6 ?? 0m) + repbudjet;
                        if (reportDate >= fd && reportDate <= ld)
                        {
                            rayon.gr7 += 1;                           
                            if (repbudjet != 0) rayon.gr8 = ((decimal?)rayon.gr8 ?? 0m) + repbudjet;
                            rayon.gr11 = rayon.gr7;
                            rayon.gr12 = rayon.gr8;                            
                        }
                        if (reportDate >= lastFd && reportDate <= fd)
                        {
                            rayon.gr9 += 1;
                            if (repbudjet != 0) rayon.gr10 = ((decimal?)rayon.gr10 ?? 0m) + repbudjet;
                        }
                    }
                }

                var qb1 = new QueryBuilder(appPregancyDefId, context.UserId);
                qb1.Where("RegDate").Ge(lastFd).And("RegDate").Le(ld).And("&State").Eq(approvedStateId);

                var queryL = context.CreateSqlQuery(qb1.Def);
                queryL.AddAttribute(queryL.Source, "&Id");
                queryL.AddAttribute(queryL.Source, "AssignedAmountRepublicBudgetBR");
                queryL.AddAttribute(queryL.Source, "RegDate");
                queryL.AddAttribute(queryL.Source, "Service");
                queryL.AddAttribute(queryL.Source, "&OrgId");
                queryL.AddOrderAttribute(queryL.Source, "&OrgName");

                var tableL = new DataTable();
                using (var readerL = context.CreateSqlReader(queryL))
                {
                    readerL.Open();
                    readerL.Fill(tableL);
                    readerL.Close();
                }
                foreach (DataRow row in tableL.Rows)
                {
                    var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    var repbudjet = row[1] is DBNull ? 0m : (decimal)row[1];
                    var regDate = row[2] is DBNull ? DateTime.MaxValue : (DateTime)row[2];
                    var service = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                    var orgId = row[4] is DBNull ? Guid.Empty : (Guid)row[4];                   

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);

                    if (appId != Guid.Empty)
                    {
                        rayon.gr5 += 1;
                        if (repbudjet != 0) rayon.gr6 = ((decimal?)rayon.gr6 ?? 0m) + repbudjet;
                        if (regDate >= lastFd && regDate <= fd)
                        {
                            ///throw new ApplicationException(no + "; ");
                            rayon.gr9 += 1;
                            if (repbudjet != 0) rayon.gr10 = ((decimal?)rayon.gr10 ?? 0m) + repbudjet;
                        }
                        if (regDate >= fd && regDate <= ld)
                        {
                            rayon.gr7 += 1;
                            rayon.gr11 = rayon.gr7;
                            if (repbudjet != 0)
                            {
                                rayon.gr8 = ((decimal?)rayon.gr8 ?? 0m) + repbudjet;
                                rayon.gr12 = rayon.gr8;
                                if (service.Equals(new Guid("{6DDA2402-1C73-4B34-8C46-6321B3BE0C51}")))
                                {
                                    rayon.gr13 += repbudjet * (decimal)0.013;
                                }
                                else if (service.Equals(new Guid("{E334A112-E22E-4240-A4F6-07521DEC6AA1}")))
                                {
                                    rayon.gr14 += repbudjet * (decimal)0.005;
                                }
                            }
                            rayon.gr15 = rayon.gr12 + rayon.gr13 + rayon.gr14;
                            if (rayon.gr12 != 0 || rayon.gr11 != 0)
                            {
                                rayon.gr16 = Math.Round((rayon.gr12 / rayon.gr11) * 1000, 1);
                            }
                        }
                    }
                }
                var qb2 = new QueryBuilder(legalRitualDefId, context.UserId);
                qb2.Where("LegalReportSection").Include("ReportDate").Ge(lastFd).And("ReportDate").Le(ld).And("&State").Eq(approvedStateId).End();
                var query2 = context.CreateSqlQuery(qb2.Def); 
                var legalSrc2 = query2.JoinSource(query2.Source, legalSectionDefId, SqlSourceJoinType.Inner, "LegalReportSection");

                query2.AddAttribute(query2.Source, "&Id");
                query2.AddAttribute(query2.Source, "DeadCadThrowRepublicBudget");
                query2.AddAttribute(legalSrc2, "ReportDate");
                query2.AddAttribute(query2.Source, "&OrgId");
                query2.AddOrderAttribute(query2.Source, "&OrgName");

                var table2 = new DataTable();
                using (var reader = context.CreateSqlReader(query2))
                {
                    reader.Open();
                    reader.Fill(table2);
                    reader.Close();
                }
                foreach (DataRow row in table2.Rows)
                {
                    var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    decimal repbudjet = row[1] is DBNull ? 0m : (decimal)row[1];
                    var reportDate = row[2] is DBNull ? DateTime.MaxValue : (DateTime)row[2];
                    var orgId = row[3] is DBNull ? Guid.Empty : (Guid)row[3];

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);

                    if (appId != Guid.Empty)
                    {
                        rayon.gr17 += 1;
                        if (repbudjet != 0) rayon.gr18 = ((decimal?)rayon.gr18 ?? 0m) + repbudjet;                        
                        if (reportDate >= fd && reportDate <= ld)
                        {
                            rayon.gr19 += 1;
                            if (repbudjet != 0) rayon.gr20 = ((decimal?)rayon.gr20 ?? 0m) + repbudjet;
                            rayon.gr23 = rayon.gr19;
                            rayon.gr24 = rayon.gr20;
                        }
                        if (reportDate >= lastFd && reportDate <= fd)
                        {
                            rayon.gr21 += 1;
                            if (repbudjet != 0) rayon.gr22 = ((decimal?)rayon.gr22 ?? 0m) + repbudjet;
                        }
                    }
                }

                var qb3 = new QueryBuilder(appRitualDefId, context.UserId);
                qb3.Where("RegDate").Ge(lastFd).And("RegDate").Le(ld).And("&State").Eq(approvedStateId);

                var query3 = context.CreateSqlQuery(qb3.Def);
                query3.AddAttribute(query3.Source, "&Id");
                query3.AddAttribute(query3.Source, "AssignedAmountRepublicBudget");
                query3.AddAttribute(query3.Source, "RegDate");
                query3.AddAttribute(query3.Source, "Service");
                query3.AddAttribute(query3.Source, "&OrgId");
                query3.AddOrderAttribute(query3.Source, "&OrgName");

                var table3 = new DataTable();
                using (var reader = context.CreateSqlReader(query3))
                {
                    reader.Open();
                    reader.Fill(table3);
                    reader.Close();
                }
                foreach (DataRow row in table3.Rows)
                {
                    var appId = row[0] is DBNull ? Guid.Empty : (Guid)row[0];
                    decimal repbudjet = row[1] is DBNull ? 0m : (decimal)row[1];
                    var regDate = row[2] is DBNull ? DateTime.MaxValue : (DateTime)row[2];
                    var service = row[3] is DBNull ? Guid.Empty : (Guid)row[3];
                    var orgId = row[4] is DBNull ? Guid.Empty : (Guid)row[4];

                    var orgNameRayon = context.Orgs.GetOrgName(orgId);
                    var rayon = GetReportItem(items, orgNameRayon, orgId);

                    if (appId != Guid.Empty)
                    {
                        rayon.gr17 += 1;
                        if (repbudjet != 0) rayon.gr18 = ((decimal?)rayon.gr18 ?? 0m) + repbudjet;

                        if (regDate >= fd && regDate <= ld)
                        {
                            rayon.gr19 += 1;  
                            rayon.gr20 = ((decimal?)rayon.gr20 ?? 0m) + repbudjet;
                            rayon.gr23 = rayon.gr19;
                            rayon.gr24 = rayon.gr20;
                            if (service.Equals(new Guid("{6DDA2402-1C73-4B34-8C46-6321B3BE0C51}")))
                            {
                                rayon.gr25 += repbudjet * (decimal)0.013;
                            }
                            else if (service.Equals(new Guid("{E334A112-E22E-4240-A4F6-07521DEC6AA1}")))
                            {
                                rayon.gr26 += repbudjet * (decimal)0.005;
                            }                        
                        }
                        if (regDate >= lastFd && regDate <= fd)
                        {
                            rayon.gr21 += 1;
                            if (repbudjet != 0) rayon.gr22 = ((decimal?)rayon.gr22 ?? 0m) + repbudjet;
                        }
                        rayon.gr27 = rayon.gr24 + rayon.gr25 + rayon.gr26;
                        if(rayon.gr24 != 0 || rayon.gr23 != 0)
                        {
                            rayon.gr28 = Math.Round((rayon.gr24 / rayon.gr23) * 1000, 1);
                        }                        
                    }
                }
                // RegionReportItem regionReportItem = new RegionReportItem();
                foreach (var subItem in items)
                {
                    if (bishkekList.Contains(subItem.GetOrgId())) subItem.RegionName = "аг.Бишкек";
                    //regionReportItem.BishkekCityRegion.Add(subItem);
                    if (chuiList.Contains(subItem.GetOrgId())) subItem.RegionName = "аЧуйская область";
                    //regionReportItem.ChuyRegion.Add(subItem);
                    if (talasList.Contains(subItem.GetOrgId())) subItem.RegionName = "бТаласская область";
                    //regionReportItem.TalasRegion.Add(subItem);
                    if (issyk_kulList.Contains(subItem.GetOrgId())) subItem.RegionName = "вИссык-Кульская область";
                    //regionReportItem.YssykKolRegion.Add(subItem);
                    if (narynList.Contains(subItem.GetOrgId())) subItem.RegionName = "гНарынская область";
                    //regionReportItem.NarynRegion.Add(subItem);
                    if (batkenList.Contains(subItem.GetOrgId())) subItem.RegionName = "дБаткенская область";
                    //regionReportItem.BatkenRegion.Add(subItem);
                    if (oshList.Contains(subItem.GetOrgId())) subItem.RegionName = "еОшская область";
                    //regionReportItem.OshRegion.Add(subItem);
                    if (osh.Contains(subItem.GetOrgId())) subItem.RegionName = "жг.Ош";
                    //regionReportItem.OshCityRegion.Add(subItem);
                    if (jalal_abad.Contains(subItem.GetOrgId())) subItem.RegionName = "зДжалал-Абадская область";
                    //regionReportItem.JalalAbadRegion.Add(subItem);
                }
                return items;
            }
            private static decimal GetRPAmountLegalReport(WorkflowContext context, Guid orgId, DateTime ld)
            {
                var today = DateTime.Today;
                var year = today.Year;
                var fromFd = new DateTime(year, 1, 1);
                var lastFd = fromFd.AddMonths(-1);
                var qb = new QueryBuilder(legalSectionDefId, context.UserId);
                qb.Where("&OrgId").Eq(orgId).And("ReportDate").Ge(lastFd).And("ReportDate").Le(ld).And("&State").Eq(approvedStateId);
                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    query.AddAttribute(query.Source, "ritTotalAmount", SqlQuerySummaryFunction.Sum);
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                        if (reader.Read()) return !reader.Reader.IsDBNull(0) ? reader.GetDecimal(0) : 0;
                    return 0m;
                }
            }
            private static int GetCountLegalReport(WorkflowContext context, Guid orgId, DateTime ld)
            {
                var today = DateTime.Today;
                var year = today.Year;
                var fromFd = new DateTime(year, 1, 1);
                var lastFd = fromFd.AddMonths(-1);
                var qb = new QueryBuilder(legalSectionDefId, context.UserId);
                qb.Where("&OrgId").Eq(orgId).And("ReportDate").Ge(lastFd).And("ReportDate").Le(ld).And("&State").Eq(approvedStateId);
                using (var query = SqlQueryBuilder.Build(context.DataContext, qb.Def))
                {
                    // var legalSrc = query.JoinSource(query.Source, legalSectionDefId, SqlSourceJoinType.LeftOuter, "LegalReportSection");
                    query.AddAttribute(query.Source, "LegalPerson", SqlQuerySummaryFunction.Count);
                    using (SqlQueryReader reader = new SqlQueryReader(context.DataContext, query))
                        if (reader.Read()) return !reader.Reader.IsDBNull(0) ? reader.GetInt32(0) : 0;
                    return 0;
                }
            }
            //[DataContract]
            public class RegionReportItem
            {
                public RegionReportItem()
                {
                    ChuyRegion = new List<ReportF8SVODItem>();
                    YssykKolRegion = new List<ReportF8SVODItem>();
                    NarynRegion = new List<ReportF8SVODItem>();
                    TalasRegion = new List<ReportF8SVODItem>();
                    OshRegion = new List<ReportF8SVODItem>();
                    JalalAbadRegion = new List<ReportF8SVODItem>();
                    BatkenRegion = new List<ReportF8SVODItem>();
                    BishkekCityRegion = new List<ReportF8SVODItem>();
                    OshCityRegion = new List<ReportF8SVODItem>();
                }
                public List<ReportF8SVODItem> ChuyRegion { get; set; }
                public List<ReportF8SVODItem> YssykKolRegion { get; set; }
                public List<ReportF8SVODItem> NarynRegion { get; set; }
                public List<ReportF8SVODItem> TalasRegion { get; set; }
                public List<ReportF8SVODItem> OshRegion { get; set; }
                public List<ReportF8SVODItem> JalalAbadRegion { get; set; }
                public List<ReportF8SVODItem> BatkenRegion { get; set; }
                public List<ReportF8SVODItem> BishkekCityRegion { get; set; }
                public List<ReportF8SVODItem> OshCityRegion { get; set; }
            }
            static ReportF8SVODItem GetReportItem(List<ReportF8SVODItem> items, string orgName, Guid orgId)
            {
                var item = items.FirstOrDefault(x => x.OrgName == orgName);
                if (item != null) return item;
                item = new ReportF8SVODItem(orgId)
                {
                    OrgName = orgName,
                };
                items.Add(item);
                return item;
            }
        }
    }
}


